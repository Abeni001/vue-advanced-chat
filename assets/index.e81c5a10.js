const mS=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};mS();function pS(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const gS=()=>{},_S=Object.assign,vS=Object.prototype.hasOwnProperty,Id=(e,t)=>vS.call(e,t),Ss=Array.isArray,hh=e=>C3(e)==="[object Map]",yS=e=>typeof e=="function",bS=e=>typeof e=="string",tp=e=>typeof e=="symbol",Rd=e=>e!==null&&typeof e=="object",wS=Object.prototype.toString,C3=e=>wS.call(e),ES=e=>C3(e).slice(8,-1),np=e=>bS(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,I3=(e,t)=>!Object.is(e,t),SS=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let vr;class TS{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&vr&&(this.parent=vr,this.index=(vr.scopes||(vr.scopes=[])).push(this)-1)}run(t){if(this.active){const n=vr;try{return vr=this,t()}finally{vr=n}}}on(){vr=this}off(){vr=this.parent}stop(t){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function kS(e,t=vr){t&&t.active&&t.effects.push(e)}const ip=e=>{const t=new Set(e);return t.w=0,t.n=0,t},R3=e=>(e.w&Os)>0,M3=e=>(e.n&Os)>0,AS=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Os},xS=e=>{const{deps:t}=e;if(t.length){let n=0;for(let i=0;i<t.length;i++){const r=t[i];R3(r)&&!M3(r)?r.delete(e):t[n++]=r,r.w&=~Os,r.n&=~Os}t.length=n}},d1=new WeakMap;let Pl=0,Os=1;const f1=30;let ir;const Io=Symbol(""),m1=Symbol("");class rp{constructor(t,n=null,i){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,kS(this,i)}run(){if(!this.active)return this.fn();let t=ir,n=Ts;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=ir,ir=this,Ts=!0,Os=1<<++Pl,Pl<=f1?AS(this):vv(this),this.fn()}finally{Pl<=f1&&xS(this),Os=1<<--Pl,ir=this.parent,Ts=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ir===this?this.deferStop=!0:this.active&&(vv(this),this.onStop&&this.onStop(),this.active=!1)}}function vv(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Ts=!0;const O3=[];function rl(){O3.push(Ts),Ts=!1}function sl(){const e=O3.pop();Ts=e===void 0?!0:e}function Fi(e,t,n){if(Ts&&ir){let i=d1.get(e);i||d1.set(e,i=new Map);let r=i.get(n);r||i.set(n,r=ip()),N3(r)}}function N3(e,t){let n=!1;Pl<=f1?M3(e)||(e.n|=Os,n=!R3(e)):n=!e.has(ir),n&&(e.add(ir),ir.deps.push(e))}function Xr(e,t,n,i,r,s){const o=d1.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(n==="length"&&Ss(e))o.forEach((l,c)=>{(c==="length"||c>=i)&&a.push(l)});else switch(n!==void 0&&a.push(o.get(n)),t){case"add":Ss(e)?np(n)&&a.push(o.get("length")):(a.push(o.get(Io)),hh(e)&&a.push(o.get(m1)));break;case"delete":Ss(e)||(a.push(o.get(Io)),hh(e)&&a.push(o.get(m1)));break;case"set":hh(e)&&a.push(o.get(Io));break}if(a.length===1)a[0]&&p1(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);p1(ip(l))}}function p1(e,t){const n=Ss(e)?e:[...e];for(const i of n)i.computed&&yv(i);for(const i of n)i.computed||yv(i)}function yv(e,t){(e!==ir||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const CS=pS("__proto__,__v_isRef,__isVue"),F3=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(tp)),IS=sp(),RS=sp(!1,!0),MS=sp(!0),bv=OS();function OS(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const i=Pt(this);for(let s=0,o=this.length;s<o;s++)Fi(i,"get",s+"");const r=i[t](...n);return r===-1||r===!1?i[t](...n.map(Pt)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){rl();const i=Pt(this)[t].apply(this,n);return sl(),i}}),e}function sp(e=!1,t=!1){return function(i,r,s){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&s===(e?t?GS:U3:t?P3:B3).get(i))return i;const o=Ss(i);if(!e&&o&&Id(bv,r))return Reflect.get(bv,r,s);const a=Reflect.get(i,r,s);return(tp(r)?F3.has(r):CS(r))||(e||Fi(i,"get",r),t)?a:ti(a)?o&&np(r)?a:a.value:Rd(a)?e?j3(a):lp(a):a}}const NS=L3(),FS=L3(!0);function L3(e=!1){return function(n,i,r,s){let o=n[i];if(fc(o)&&ti(o)&&!ti(r))return!1;if(!e&&!fc(r)&&(g1(r)||(r=Pt(r),o=Pt(o)),!Ss(n)&&ti(o)&&!ti(r)))return o.value=r,!0;const a=Ss(n)&&np(i)?Number(i)<n.length:Id(n,i),l=Reflect.set(n,i,r,s);return n===Pt(s)&&(a?I3(r,o)&&Xr(n,"set",i,r):Xr(n,"add",i,r)),l}}function LS(e,t){const n=Id(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&Xr(e,"delete",t,void 0),i}function DS(e,t){const n=Reflect.has(e,t);return(!tp(t)||!F3.has(t))&&Fi(e,"has",t),n}function BS(e){return Fi(e,"iterate",Ss(e)?"length":Io),Reflect.ownKeys(e)}const D3={get:IS,set:NS,deleteProperty:LS,has:DS,ownKeys:BS},PS={get:MS,set(e,t){return!0},deleteProperty(e,t){return!0}},US=_S({},D3,{get:RS,set:FS}),op=e=>e,Md=e=>Reflect.getPrototypeOf(e);function Ru(e,t,n=!1,i=!1){e=e.__v_raw;const r=Pt(e),s=Pt(t);n||(t!==s&&Fi(r,"get",t),Fi(r,"get",s));const{has:o}=Md(r),a=i?op:n?hp:up;if(o.call(r,t))return a(e.get(t));if(o.call(r,s))return a(e.get(s));e!==r&&e.get(t)}function Mu(e,t=!1){const n=this.__v_raw,i=Pt(n),r=Pt(e);return t||(e!==r&&Fi(i,"has",e),Fi(i,"has",r)),e===r?n.has(e):n.has(e)||n.has(r)}function Ou(e,t=!1){return e=e.__v_raw,!t&&Fi(Pt(e),"iterate",Io),Reflect.get(e,"size",e)}function wv(e){e=Pt(e);const t=Pt(this);return Md(t).has.call(t,e)||(t.add(e),Xr(t,"add",e,e)),this}function Ev(e,t){t=Pt(t);const n=Pt(this),{has:i,get:r}=Md(n);let s=i.call(n,e);s||(e=Pt(e),s=i.call(n,e));const o=r.call(n,e);return n.set(e,t),s?I3(t,o)&&Xr(n,"set",e,t):Xr(n,"add",e,t),this}function Sv(e){const t=Pt(this),{has:n,get:i}=Md(t);let r=n.call(t,e);r||(e=Pt(e),r=n.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return r&&Xr(t,"delete",e,void 0),s}function Tv(){const e=Pt(this),t=e.size!==0,n=e.clear();return t&&Xr(e,"clear",void 0,void 0),n}function Nu(e,t){return function(i,r){const s=this,o=s.__v_raw,a=Pt(o),l=t?op:e?hp:up;return!e&&Fi(a,"iterate",Io),o.forEach((c,d)=>i.call(r,l(c),l(d),s))}}function Fu(e,t,n){return function(...i){const r=this.__v_raw,s=Pt(r),o=hh(s),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=r[e](...i),d=n?op:t?hp:up;return!t&&Fi(s,"iterate",l?m1:Io),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[d(u[0]),d(u[1])]:d(u),done:f}},[Symbol.iterator](){return this}}}}function cs(e){return function(...t){return e==="delete"?!1:this}}function jS(){const e={get(s){return Ru(this,s)},get size(){return Ou(this)},has:Mu,add:wv,set:Ev,delete:Sv,clear:Tv,forEach:Nu(!1,!1)},t={get(s){return Ru(this,s,!1,!0)},get size(){return Ou(this)},has:Mu,add:wv,set:Ev,delete:Sv,clear:Tv,forEach:Nu(!1,!0)},n={get(s){return Ru(this,s,!0)},get size(){return Ou(this,!0)},has(s){return Mu.call(this,s,!0)},add:cs("add"),set:cs("set"),delete:cs("delete"),clear:cs("clear"),forEach:Nu(!0,!1)},i={get(s){return Ru(this,s,!0,!0)},get size(){return Ou(this,!0)},has(s){return Mu.call(this,s,!0)},add:cs("add"),set:cs("set"),delete:cs("delete"),clear:cs("clear"),forEach:Nu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Fu(s,!1,!1),n[s]=Fu(s,!0,!1),t[s]=Fu(s,!1,!0),i[s]=Fu(s,!0,!0)}),[e,n,t,i]}const[HS,VS,qS,zS]=jS();function ap(e,t){const n=t?e?zS:qS:e?VS:HS;return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Id(n,r)&&r in i?n:i,r,s)}const $S={get:ap(!1,!1)},WS={get:ap(!1,!0)},KS={get:ap(!0,!1)},B3=new WeakMap,P3=new WeakMap,U3=new WeakMap,GS=new WeakMap;function YS(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function XS(e){return e.__v_skip||!Object.isExtensible(e)?0:YS(ES(e))}function lp(e){return fc(e)?e:cp(e,!1,D3,$S,B3)}function QS(e){return cp(e,!1,US,WS,P3)}function j3(e){return cp(e,!0,PS,KS,U3)}function cp(e,t,n,i,r){if(!Rd(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=r.get(e);if(s)return s;const o=XS(e);if(o===0)return e;const a=new Proxy(e,o===2?i:n);return r.set(e,a),a}function ka(e){return fc(e)?ka(e.__v_raw):!!(e&&e.__v_isReactive)}function fc(e){return!!(e&&e.__v_isReadonly)}function g1(e){return!!(e&&e.__v_isShallow)}function H3(e){return ka(e)||fc(e)}function Pt(e){const t=e&&e.__v_raw;return t?Pt(t):e}function V3(e){return SS(e,"__v_skip",!0),e}const up=e=>Rd(e)?lp(e):e,hp=e=>Rd(e)?j3(e):e;function ZS(e){Ts&&ir&&(e=Pt(e),N3(e.dep||(e.dep=ip())))}function JS(e,t){e=Pt(e),e.dep&&p1(e.dep)}function ti(e){return!!(e&&e.__v_isRef===!0)}function eT(e){return ti(e)?e.value:e}const tT={get:(e,t,n)=>eT(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return ti(r)&&!ti(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function q3(e){return ka(e)?e:new Proxy(e,tT)}class nT{constructor(t,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new rp(t,()=>{this._dirty||(this._dirty=!0,JS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=Pt(this);return ZS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function iT(e,t,n=!1){let i,r;const s=yS(e);return s?(i=e,r=gS):(i=e.get,r=e.set),new nT(i,r,s||!r,n)}function rT(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}function dp(e){if(xt(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Di(i)?aT(i):dp(i);if(r)for(const s in r)t[s]=r[s]}return t}else{if(Di(e))return e;if(si(e))return e}}const sT=/;(?![^(]*\))/g,oT=/:(.+)/;function aT(e){const t={};return e.split(sT).forEach(n=>{if(n){const i=n.split(oT);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Da(e){let t="";if(Di(e))t=e;else if(xt(e))for(let n=0;n<e.length;n++){const i=Da(e[n]);i&&(t+=i+" ")}else if(si(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const z3=e=>Di(e)?e:e==null?"":xt(e)||si(e)&&(e.toString===X3||!yt(e.toString))?JSON.stringify(e,$3,2):String(e),$3=(e,t)=>t&&t.__v_isRef?$3(e,t.value):K3(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:G3(t)?{[`Set(${t.size})`]:[...t.values()]}:si(t)&&!xt(t)&&!Q3(t)?String(t):t,$t={},Aa=[],xr=()=>{},lT=()=>!1,cT=/^on[^a-z]/,fp=e=>cT.test(e),W3=e=>e.startsWith("onUpdate:"),Li=Object.assign,mp=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},uT=Object.prototype.hasOwnProperty,Mt=(e,t)=>uT.call(e,t),xt=Array.isArray,K3=e=>pp(e)==="[object Map]",G3=e=>pp(e)==="[object Set]",yt=e=>typeof e=="function",Di=e=>typeof e=="string",si=e=>e!==null&&typeof e=="object",Y3=e=>si(e)&&yt(e.then)&&yt(e.catch),X3=Object.prototype.toString,pp=e=>X3.call(e),Q3=e=>pp(e)==="[object Object]",dh=rT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Od=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},hT=/-(\w)/g,Ir=Od(e=>e.replace(hT,(t,n)=>n?n.toUpperCase():"")),dT=/\B([A-Z])/g,Nd=Od(e=>e.replace(dT,"-$1").toLowerCase()),gp=Od(e=>e.charAt(0).toUpperCase()+e.slice(1)),cm=Od(e=>e?`on${gp(e)}`:""),kv=(e,t)=>!Object.is(e,t),um=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},_1=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},fT=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Av;const mT=()=>Av||(Av=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function ks(e,t,n,i){let r;try{r=i?e(...i):e()}catch(s){Fd(s,t,n)}return r}function Xi(e,t,n,i){if(yt(e)){const s=ks(e,t,n,i);return s&&Y3(s)&&s.catch(o=>{Fd(o,t,n)}),s}const r=[];for(let s=0;s<e.length;s++)r.push(Xi(e[s],t,n,i));return r}function Fd(e,t,n,i=!0){const r=t?t.vnode:null;if(t){let s=t.parent;const o=t.proxy,a=n;for(;s;){const c=s.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,o,a)===!1)return}s=s.parent}const l=t.appContext.config.errorHandler;if(l){ks(l,null,10,[e,o,a]);return}}pT(e,n,r,i)}function pT(e,t,n,i=!0){console.error(e)}let Ch=!1,v1=!1;const ki=[];let Br=0;const Xl=[];let Ul=null,pa=0;const Ql=[];let _s=null,ga=0;const Z3=Promise.resolve();let _p=null,y1=null;function gT(e){const t=_p||Z3;return e?t.then(this?e.bind(this):e):t}function _T(e){let t=Br+1,n=ki.length;for(;t<n;){const i=t+n>>>1;mc(ki[i])<e?t=i+1:n=i}return t}function J3(e){(!ki.length||!ki.includes(e,Ch&&e.allowRecurse?Br+1:Br))&&e!==y1&&(e.id==null?ki.push(e):ki.splice(_T(e.id),0,e),ew())}function ew(){!Ch&&!v1&&(v1=!0,_p=Z3.then(iw))}function vT(e){const t=ki.indexOf(e);t>Br&&ki.splice(t,1)}function tw(e,t,n,i){xt(e)?n.push(...e):(!t||!t.includes(e,e.allowRecurse?i+1:i))&&n.push(e),ew()}function yT(e){tw(e,Ul,Xl,pa)}function bT(e){tw(e,_s,Ql,ga)}function Ld(e,t=null){if(Xl.length){for(y1=t,Ul=[...new Set(Xl)],Xl.length=0,pa=0;pa<Ul.length;pa++)Ul[pa]();Ul=null,pa=0,y1=null,Ld(e,t)}}function nw(e){if(Ld(),Ql.length){const t=[...new Set(Ql)];if(Ql.length=0,_s){_s.push(...t);return}for(_s=t,_s.sort((n,i)=>mc(n)-mc(i)),ga=0;ga<_s.length;ga++)_s[ga]();_s=null,ga=0}}const mc=e=>e.id==null?1/0:e.id;function iw(e){v1=!1,Ch=!0,Ld(e),ki.sort((n,i)=>mc(n)-mc(i));const t=xr;try{for(Br=0;Br<ki.length;Br++){const n=ki[Br];n&&n.active!==!1&&ks(n,null,14)}}finally{Br=0,ki.length=0,nw(),Ch=!1,_p=null,(ki.length||Xl.length||Ql.length)&&iw(e)}}function wT(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||$t;let r=n;const s=t.startsWith("update:"),o=s&&t.slice(7);if(o&&o in i){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:f}=i[d]||$t;f&&(r=n.map(m=>m.trim())),u&&(r=n.map(fT))}let a,l=i[a=cm(t)]||i[a=cm(Ir(t))];!l&&s&&(l=i[a=cm(Nd(t))]),l&&Xi(l,e,6,r);const c=i[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Xi(c,e,6,r)}}function rw(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let o={},a=!1;if(!yt(e)){const l=c=>{const d=rw(c,t,!0);d&&(a=!0,Li(o,d))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!a?(i.set(e,null),null):(xt(s)?s.forEach(l=>o[l]=null):Li(o,s),i.set(e,o),o)}function Dd(e,t){return!e||!fp(t)?!1:(t=t.slice(2).replace(/Once$/,""),Mt(e,t[0].toLowerCase()+t.slice(1))||Mt(e,Nd(t))||Mt(e,t))}let Gi=null,Bd=null;function Ih(e){const t=Gi;return Gi=e,Bd=e&&e.type.__scopeId||null,t}function ET(e){Bd=e}function ST(){Bd=null}function TT(e,t=Gi,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&Bv(-1);const s=Ih(t),o=e(...r);return Ih(s),i._d&&Bv(1),o};return i._n=!0,i._c=!0,i._d=!0,i}function hm(e){const{type:t,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:d,renderCache:u,data:f,setupState:m,ctx:h,inheritAttrs:R}=e;let M,C;const _=Ih(e);try{if(n.shapeFlag&4){const F=r||i;M=wr(d.call(F,F,u,s,m,f,h)),C=l}else{const F=t;M=wr(F.length>1?F(s,{attrs:l,slots:a,emit:c}):F(s,null)),C=t.props?l:kT(l)}}catch(F){Zl.length=0,Fd(F,e,1),M=Ci(cr)}let x=M;if(C&&R!==!1){const F=Object.keys(C),{shapeFlag:O}=x;F.length&&O&7&&(o&&F.some(W3)&&(C=AT(C,o)),x=Ns(x,C))}return n.dirs&&(x=Ns(x),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&(x.transition=n.transition),M=x,Ih(_),M}const kT=e=>{let t;for(const n in e)(n==="class"||n==="style"||fp(n))&&((t||(t={}))[n]=e[n]);return t},AT=(e,t)=>{const n={};for(const i in e)(!W3(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function xT(e,t,n){const{props:i,children:r,component:s}=e,{props:o,children:a,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?xv(i,o,c):!!o;if(l&8){const d=t.dynamicProps;for(let u=0;u<d.length;u++){const f=d[u];if(o[f]!==i[f]&&!Dd(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?xv(i,o,c):!0:!!o;return!1}function xv(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!Dd(n,s))return!0}return!1}function CT({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const IT=e=>e.__isSuspense;function RT(e,t){t&&t.pendingBranch?xt(e)?t.effects.push(...e):t.effects.push(e):bT(e)}function MT(e,t){if(xn){let n=xn.provides;const i=xn.parent&&xn.parent.provides;i===n&&(n=xn.provides=Object.create(i)),n[e]=t}}function dm(e,t,n=!1){const i=xn||Gi;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return n&&yt(t)?t.call(i.proxy):t}}const Cv={};function fm(e,t,n){return sw(e,t,n)}function sw(e,t,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:o}=$t){const a=xn;let l,c=!1,d=!1;if(ti(e)?(l=()=>e.value,c=g1(e)):ka(e)?(l=()=>e,i=!0):xt(e)?(d=!0,c=e.some(C=>ka(C)||g1(C)),l=()=>e.map(C=>{if(ti(C))return C.value;if(ka(C))return bo(C);if(yt(C))return ks(C,a,2)})):yt(e)?t?l=()=>ks(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),Xi(e,a,3,[f])}:l=xr,t&&i){const C=l;l=()=>bo(C())}let u,f=C=>{u=M.onStop=()=>{ks(C,a,4)}};if(gc)return f=xr,t?n&&Xi(t,a,3,[l(),d?[]:void 0,f]):l(),xr;let m=d?[]:Cv;const h=()=>{if(!!M.active)if(t){const C=M.run();(i||c||(d?C.some((_,x)=>kv(_,m[x])):kv(C,m)))&&(u&&u(),Xi(t,a,3,[C,m===Cv?void 0:m,f]),m=C)}else M.run()};h.allowRecurse=!!t;let R;r==="sync"?R=h:r==="post"?R=()=>fi(h,a&&a.suspense):R=()=>yT(h);const M=new rp(l,R);return t?n?h():m=M.run():r==="post"?fi(M.run.bind(M),a&&a.suspense):M.run(),()=>{M.stop(),a&&a.scope&&mp(a.scope.effects,M)}}function OT(e,t,n){const i=this.proxy,r=Di(e)?e.includes(".")?ow(i,e):()=>i[e]:e.bind(i,i);let s;yt(t)?s=t:(s=t.handler,n=t);const o=xn;Ba(this);const a=sw(r,s.bind(i),n);return o?Ba(o):Ro(),a}function ow(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function bo(e,t){if(!si(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ti(e))bo(e.value,t);else if(xt(e))for(let n=0;n<e.length;n++)bo(e[n],t);else if(G3(e)||K3(e))e.forEach(n=>{bo(n,t)});else if(Q3(e))for(const n in e)bo(e[n],t);return e}function NT(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return uw(()=>{e.isMounted=!0}),hw(()=>{e.isUnmounting=!0}),e}const Hi=[Function,Array],FT={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Hi,onEnter:Hi,onAfterEnter:Hi,onEnterCancelled:Hi,onBeforeLeave:Hi,onLeave:Hi,onAfterLeave:Hi,onLeaveCancelled:Hi,onBeforeAppear:Hi,onAppear:Hi,onAfterAppear:Hi,onAppearCancelled:Hi},setup(e,{slots:t}){const n=bk(),i=NT();let r;return()=>{const s=t.default&&lw(t.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const R of s)if(R.type!==cr){o=R;break}}const a=Pt(e),{mode:l}=a;if(i.isLeaving)return mm(o);const c=Iv(o);if(!c)return mm(o);const d=b1(c,a,i,n);w1(c,d);const u=n.subTree,f=u&&Iv(u);let m=!1;const{getTransitionKey:h}=c.type;if(h){const R=h();r===void 0?r=R:R!==r&&(r=R,m=!0)}if(f&&f.type!==cr&&(!fo(c,f)||m)){const R=b1(f,a,i,n);if(w1(f,R),l==="out-in")return i.isLeaving=!0,R.afterLeave=()=>{i.isLeaving=!1,n.update()},mm(o);l==="in-out"&&c.type!==cr&&(R.delayLeave=(M,C,_)=>{const x=aw(i,f);x[String(f.key)]=f,M._leaveCb=()=>{C(),M._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=_})}return o}}},LT=FT;function aw(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function b1(e,t,n,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:f,onAfterLeave:m,onLeaveCancelled:h,onBeforeAppear:R,onAppear:M,onAfterAppear:C,onAppearCancelled:_}=t,x=String(e.key),F=aw(n,e),O=(T,S)=>{T&&Xi(T,i,9,S)},N=(T,S)=>{const g=S[1];O(T,S),xt(T)?T.every(b=>b.length<=1)&&g():T.length<=1&&g()},v={mode:s,persisted:o,beforeEnter(T){let S=a;if(!n.isMounted)if(r)S=R||a;else return;T._leaveCb&&T._leaveCb(!0);const g=F[x];g&&fo(e,g)&&g.el._leaveCb&&g.el._leaveCb(),O(S,[T])},enter(T){let S=l,g=c,b=d;if(!n.isMounted)if(r)S=M||l,g=C||c,b=_||d;else return;let y=!1;const w=T._enterCb=A=>{y||(y=!0,A?O(b,[T]):O(g,[T]),v.delayedLeave&&v.delayedLeave(),T._enterCb=void 0)};S?N(S,[T,w]):w()},leave(T,S){const g=String(e.key);if(T._enterCb&&T._enterCb(!0),n.isUnmounting)return S();O(u,[T]);let b=!1;const y=T._leaveCb=w=>{b||(b=!0,S(),w?O(h,[T]):O(m,[T]),T._leaveCb=void 0,F[g]===e&&delete F[g])};F[g]=e,f?N(f,[T,y]):y()},clone(T){return b1(T,t,n,i)}};return v}function mm(e){if(Pd(e))return e=Ns(e),e.children=null,e}function Iv(e){return Pd(e)?e.children?e.children[0]:void 0:e}function w1(e,t){e.shapeFlag&6&&e.component?w1(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function lw(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let o=e[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===Wi?(o.patchFlag&128&&r++,i=i.concat(lw(o.children,t,a))):(t||o.type!==cr)&&i.push(a!=null?Ns(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}const fh=e=>!!e.type.__asyncLoader,Pd=e=>e.type.__isKeepAlive;function DT(e,t){cw(e,"a",t)}function BT(e,t){cw(e,"da",t)}function cw(e,t,n=xn){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Ud(t,i,n),n){let r=n.parent;for(;r&&r.parent;)Pd(r.parent.vnode)&&PT(i,t,n,r),r=r.parent}}function PT(e,t,n,i){const r=Ud(t,e,i,!0);dw(()=>{mp(i[t],r)},n)}function Ud(e,t,n=xn,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;rl(),Ba(n);const a=Xi(t,n,e,o);return Ro(),sl(),a});return i?r.unshift(s):r.push(s),s}}const rs=e=>(t,n=xn)=>(!gc||e==="sp")&&Ud(e,t,n),UT=rs("bm"),uw=rs("m"),jT=rs("bu"),HT=rs("u"),hw=rs("bum"),dw=rs("um"),VT=rs("sp"),qT=rs("rtg"),zT=rs("rtc");function $T(e,t=xn){Ud("ec",e,t)}function mh(e,t){const n=Gi;if(n===null)return e;const i=Hd(n)||n.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[o,a,l,c=$t]=t[s];yt(o)&&(o={mounted:o,updated:o}),o.deep&&bo(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:c})}return e}function Gs(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(rl(),Xi(l,n,8,[e.el,a,e,t]),sl())}}const fw="components";function WT(e,t){return GT(fw,e,!0,t)||e}const KT=Symbol();function GT(e,t,n=!0,i=!1){const r=Gi||xn;if(r){const s=r.type;if(e===fw){const a=kk(s,!1);if(a&&(a===t||a===Ir(t)||a===gp(Ir(t))))return s}const o=Rv(r[e]||s[e],t)||Rv(r.appContext[e],t);return!o&&i?s:o}}function Rv(e,t){return e&&(e[t]||e[Ir(t)]||e[gp(Ir(t))])}function mw(e,t,n,i){let r;const s=n&&n[i];if(xt(e)||Di(e)){r=new Array(e.length);for(let o=0,a=e.length;o<a;o++)r[o]=t(e[o],o,void 0,s&&s[o])}else if(typeof e=="number"){r=new Array(e);for(let o=0;o<e;o++)r[o]=t(o+1,o,void 0,s&&s[o])}else if(si(e))if(e[Symbol.iterator])r=Array.from(e,(o,a)=>t(o,a,void 0,s&&s[a]));else{const o=Object.keys(e);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];r[a]=t(e[c],c,a,s&&s[a])}}else r=[];return n&&(n[i]=r),r}const E1=e=>e?xw(e)?Hd(e)||e.proxy:E1(e.parent):null,Rh=Li(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>E1(e.parent),$root:e=>E1(e.root),$emit:e=>e.emit,$options:e=>gw(e),$forceUpdate:e=>e.f||(e.f=()=>J3(e.update)),$nextTick:e=>e.n||(e.n=gT.bind(e.proxy)),$watch:e=>OT.bind(e)}),YT={get({_:e},t){const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const m=o[t];if(m!==void 0)switch(m){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(i!==$t&&Mt(i,t))return o[t]=1,i[t];if(r!==$t&&Mt(r,t))return o[t]=2,r[t];if((c=e.propsOptions[0])&&Mt(c,t))return o[t]=3,s[t];if(n!==$t&&Mt(n,t))return o[t]=4,n[t];S1&&(o[t]=0)}}const d=Rh[t];let u,f;if(d)return t==="$attrs"&&Fi(e,"get",t),d(e);if((u=a.__cssModules)&&(u=u[t]))return u;if(n!==$t&&Mt(n,t))return o[t]=4,n[t];if(f=l.config.globalProperties,Mt(f,t))return f[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return r!==$t&&Mt(r,t)?(r[t]=n,!0):i!==$t&&Mt(i,t)?(i[t]=n,!0):Mt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||e!==$t&&Mt(e,o)||t!==$t&&Mt(t,o)||(a=s[0])&&Mt(a,o)||Mt(i,o)||Mt(Rh,o)||Mt(r.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Mt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let S1=!0;function XT(e){const t=gw(e),n=e.proxy,i=e.ctx;S1=!1,t.beforeCreate&&Mv(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:u,mounted:f,beforeUpdate:m,updated:h,activated:R,deactivated:M,beforeDestroy:C,beforeUnmount:_,destroyed:x,unmounted:F,render:O,renderTracked:N,renderTriggered:v,errorCaptured:T,serverPrefetch:S,expose:g,inheritAttrs:b,components:y,directives:w,filters:A}=t;if(c&&QT(c,i,null,e.appContext.config.unwrapInjectedRef),o)for(const K in o){const H=o[K];yt(H)&&(i[K]=H.bind(n))}if(r){const K=r.call(n,n);si(K)&&(e.data=lp(K))}if(S1=!0,s)for(const K in s){const H=s[K],$=yt(H)?H.bind(n,n):yt(H.get)?H.get.bind(n,n):xr,p=!yt(H)&&yt(H.set)?H.set.bind(n):xr,I=xk({get:$,set:p});Object.defineProperty(i,K,{enumerable:!0,configurable:!0,get:()=>I.value,set:Z=>I.value=Z})}if(a)for(const K in a)pw(a[K],i,n,K);if(l){const K=yt(l)?l.call(n):l;Reflect.ownKeys(K).forEach(H=>{MT(H,K[H])})}d&&Mv(d,e,"c");function j(K,H){xt(H)?H.forEach($=>K($.bind(n))):H&&K(H.bind(n))}if(j(UT,u),j(uw,f),j(jT,m),j(HT,h),j(DT,R),j(BT,M),j($T,T),j(zT,N),j(qT,v),j(hw,_),j(dw,F),j(VT,S),xt(g))if(g.length){const K=e.exposed||(e.exposed={});g.forEach(H=>{Object.defineProperty(K,H,{get:()=>n[H],set:$=>n[H]=$})})}else e.exposed||(e.exposed={});O&&e.render===xr&&(e.render=O),b!=null&&(e.inheritAttrs=b),y&&(e.components=y),w&&(e.directives=w)}function QT(e,t,n=xr,i=!1){xt(e)&&(e=T1(e));for(const r in e){const s=e[r];let o;si(s)?"default"in s?o=dm(s.from||r,s.default,!0):o=dm(s.from||r):o=dm(s),ti(o)&&i?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):t[r]=o}}function Mv(e,t,n){Xi(xt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function pw(e,t,n,i){const r=i.includes(".")?ow(n,i):()=>n[i];if(Di(e)){const s=t[e];yt(s)&&fm(r,s)}else if(yt(e))fm(r,e.bind(n));else if(si(e))if(xt(e))e.forEach(s=>pw(s,t,n,i));else{const s=yt(e.handler)?e.handler.bind(n):t[e.handler];yt(s)&&fm(r,s,e)}}function gw(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,a=s.get(t);let l;return a?l=a:!r.length&&!n&&!i?l=t:(l={},r.length&&r.forEach(c=>Mh(l,c,o,!0)),Mh(l,t,o)),s.set(t,l),l}function Mh(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&Mh(e,s,n,!0),r&&r.forEach(o=>Mh(e,o,n,!0));for(const o in t)if(!(i&&o==="expose")){const a=ZT[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const ZT={data:Ov,props:ao,emits:ao,methods:ao,computed:ao,beforeCreate:Xn,created:Xn,beforeMount:Xn,mounted:Xn,beforeUpdate:Xn,updated:Xn,beforeDestroy:Xn,beforeUnmount:Xn,destroyed:Xn,unmounted:Xn,activated:Xn,deactivated:Xn,errorCaptured:Xn,serverPrefetch:Xn,components:ao,directives:ao,watch:ek,provide:Ov,inject:JT};function Ov(e,t){return t?e?function(){return Li(yt(e)?e.call(this,this):e,yt(t)?t.call(this,this):t)}:t:e}function JT(e,t){return ao(T1(e),T1(t))}function T1(e){if(xt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Xn(e,t){return e?[...new Set([].concat(e,t))]:t}function ao(e,t){return e?Li(Li(Object.create(null),e),t):t}function ek(e,t){if(!e)return t;if(!t)return e;const n=Li(Object.create(null),e);for(const i in t)n[i]=Xn(e[i],t[i]);return n}function tk(e,t,n,i=!1){const r={},s={};_1(s,jd,1),e.propsDefaults=Object.create(null),_w(e,t,r,s);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);n?e.props=i?r:QS(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function nk(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=e,a=Pt(r),[l]=e.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const d=e.vnode.dynamicProps;for(let u=0;u<d.length;u++){let f=d[u];if(Dd(e.emitsOptions,f))continue;const m=t[f];if(l)if(Mt(s,f))m!==s[f]&&(s[f]=m,c=!0);else{const h=Ir(f);r[h]=k1(l,a,h,m,e,!1)}else m!==s[f]&&(s[f]=m,c=!0)}}}else{_w(e,t,r,s)&&(c=!0);let d;for(const u in a)(!t||!Mt(t,u)&&((d=Nd(u))===u||!Mt(t,d)))&&(l?n&&(n[u]!==void 0||n[d]!==void 0)&&(r[u]=k1(l,a,u,void 0,e,!0)):delete r[u]);if(s!==a)for(const u in s)(!t||!Mt(t,u)&&!0)&&(delete s[u],c=!0)}c&&Xr(e,"set","$attrs")}function _w(e,t,n,i){const[r,s]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(dh(l))continue;const c=t[l];let d;r&&Mt(r,d=Ir(l))?!s||!s.includes(d)?n[d]=c:(a||(a={}))[d]=c:Dd(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=Pt(n),c=a||$t;for(let d=0;d<s.length;d++){const u=s[d];n[u]=k1(r,l,u,c[u],e,!Mt(c,u))}}return o}function k1(e,t,n,i,r,s){const o=e[n];if(o!=null){const a=Mt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&yt(l)){const{propsDefaults:c}=r;n in c?i=c[n]:(Ba(r),i=c[n]=l.call(null,t),Ro())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===Nd(n))&&(i=!0))}return i}function vw(e,t,n=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const s=e.props,o={},a=[];let l=!1;if(!yt(e)){const d=u=>{l=!0;const[f,m]=vw(u,t,!0);Li(o,f),m&&a.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!s&&!l)return i.set(e,Aa),Aa;if(xt(s))for(let d=0;d<s.length;d++){const u=Ir(s[d]);Nv(u)&&(o[u]=$t)}else if(s)for(const d in s){const u=Ir(d);if(Nv(u)){const f=s[d],m=o[u]=xt(f)||yt(f)?{type:f}:f;if(m){const h=Dv(Boolean,m.type),R=Dv(String,m.type);m[0]=h>-1,m[1]=R<0||h<R,(h>-1||Mt(m,"default"))&&a.push(u)}}}const c=[o,a];return i.set(e,c),c}function Nv(e){return e[0]!=="$"}function Fv(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Lv(e,t){return Fv(e)===Fv(t)}function Dv(e,t){return xt(t)?t.findIndex(n=>Lv(n,e)):yt(t)&&Lv(t,e)?0:-1}const yw=e=>e[0]==="_"||e==="$stable",vp=e=>xt(e)?e.map(wr):[wr(e)],ik=(e,t,n)=>{if(t._n)return t;const i=TT((...r)=>vp(t(...r)),n);return i._c=!1,i},bw=(e,t,n)=>{const i=e._ctx;for(const r in e){if(yw(r))continue;const s=e[r];if(yt(s))t[r]=ik(r,s,i);else if(s!=null){const o=vp(s);t[r]=()=>o}}},ww=(e,t)=>{const n=vp(t);e.slots.default=()=>n},rk=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=Pt(t),_1(t,"_",n)):bw(t,e.slots={})}else e.slots={},t&&ww(e,t);_1(e.slots,jd,1)},sk=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,o=$t;if(i.shapeFlag&32){const a=t._;a?n&&a===1?s=!1:(Li(r,t),!n&&a===1&&delete r._):(s=!t.$stable,bw(t,r)),o=t}else t&&(ww(e,t),o={default:1});if(s)for(const a in r)!yw(a)&&!(a in o)&&delete r[a]};function Ew(){return{app:null,config:{isNativeTag:lT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ok=0;function ak(e,t){return function(i,r=null){yt(i)||(i=Object.assign({},i)),r!=null&&!si(r)&&(r=null);const s=Ew(),o=new Set;let a=!1;const l=s.app={_uid:ok++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:Ik,get config(){return s.config},set config(c){},use(c,...d){return o.has(c)||(c&&yt(c.install)?(o.add(c),c.install(l,...d)):yt(c)&&(o.add(c),c(l,...d))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,d){return d?(s.components[c]=d,l):s.components[c]},directive(c,d){return d?(s.directives[c]=d,l):s.directives[c]},mount(c,d,u){if(!a){const f=Ci(i,r);return f.appContext=s,d&&t?t(f,c):e(f,c,u),a=!0,l._container=c,c.__vue_app__=l,Hd(f.component)||f.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,d){return s.provides[c]=d,l}};return l}}function A1(e,t,n,i,r=!1){if(xt(e)){e.forEach((f,m)=>A1(f,t&&(xt(t)?t[m]:t),n,i,r));return}if(fh(i)&&!r)return;const s=i.shapeFlag&4?Hd(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=e,c=t&&t.r,d=a.refs===$t?a.refs={}:a.refs,u=a.setupState;if(c!=null&&c!==l&&(Di(c)?(d[c]=null,Mt(u,c)&&(u[c]=null)):ti(c)&&(c.value=null)),yt(l))ks(l,a,12,[o,d]);else{const f=Di(l),m=ti(l);if(f||m){const h=()=>{if(e.f){const R=f?d[l]:l.value;r?xt(R)&&mp(R,s):xt(R)?R.includes(s)||R.push(s):f?(d[l]=[s],Mt(u,l)&&(u[l]=d[l])):(l.value=[s],e.k&&(d[e.k]=l.value))}else f?(d[l]=o,Mt(u,l)&&(u[l]=o)):m&&(l.value=o,e.k&&(d[e.k]=o))};o?(h.id=-1,fi(h,n)):h()}}}const fi=RT;function lk(e){return ck(e)}function ck(e,t){const n=mT();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:f,setScopeId:m=xr,cloneNode:h,insertStaticContent:R}=e,M=(k,L,q,W=null,G=null,ie=null,ce=!1,J=null,re=!!L.dynamicChildren)=>{if(k===L)return;k&&!fo(k,L)&&(W=qe(k),D(k,G,ie,!0),k=null),L.patchFlag===-2&&(re=!1,L.dynamicChildren=null);const{type:Q,ref:Ee,shapeFlag:fe}=L;switch(Q){case yp:C(k,L,q,W);break;case cr:_(k,L,q,W);break;case pm:k==null&&x(L,q,W,ce);break;case Wi:w(k,L,q,W,G,ie,ce,J,re);break;default:fe&1?N(k,L,q,W,G,ie,ce,J,re):fe&6?A(k,L,q,W,G,ie,ce,J,re):(fe&64||fe&128)&&Q.process(k,L,q,W,G,ie,ce,J,re,we)}Ee!=null&&G&&A1(Ee,k&&k.ref,ie,L||k,!L)},C=(k,L,q,W)=>{if(k==null)i(L.el=a(L.children),q,W);else{const G=L.el=k.el;L.children!==k.children&&c(G,L.children)}},_=(k,L,q,W)=>{k==null?i(L.el=l(L.children||""),q,W):L.el=k.el},x=(k,L,q,W)=>{[k.el,k.anchor]=R(k.children,L,q,W,k.el,k.anchor)},F=({el:k,anchor:L},q,W)=>{let G;for(;k&&k!==L;)G=f(k),i(k,q,W),k=G;i(L,q,W)},O=({el:k,anchor:L})=>{let q;for(;k&&k!==L;)q=f(k),r(k),k=q;r(L)},N=(k,L,q,W,G,ie,ce,J,re)=>{ce=ce||L.type==="svg",k==null?v(L,q,W,G,ie,ce,J,re):g(k,L,G,ie,ce,J,re)},v=(k,L,q,W,G,ie,ce,J)=>{let re,Q;const{type:Ee,props:fe,shapeFlag:Te,transition:Ce,patchFlag:Le,dirs:ue}=k;if(k.el&&h!==void 0&&Le===-1)re=k.el=h(k.el);else{if(re=k.el=o(k.type,ie,fe&&fe.is,fe),Te&8?d(re,k.children):Te&16&&S(k.children,re,null,W,G,ie&&Ee!=="foreignObject",ce,J),ue&&Gs(k,null,W,"created"),fe){for(const ee in fe)ee!=="value"&&!dh(ee)&&s(re,ee,null,fe[ee],ie,k.children,W,G,be);"value"in fe&&s(re,"value",null,fe.value),(Q=fe.onVnodeBeforeMount)&&mr(Q,W,k)}T(re,k,k.scopeId,ce,W)}ue&&Gs(k,null,W,"beforeMount");const ve=(!G||G&&!G.pendingBranch)&&Ce&&!Ce.persisted;ve&&Ce.beforeEnter(re),i(re,L,q),((Q=fe&&fe.onVnodeMounted)||ve||ue)&&fi(()=>{Q&&mr(Q,W,k),ve&&Ce.enter(re),ue&&Gs(k,null,W,"mounted")},G)},T=(k,L,q,W,G)=>{if(q&&m(k,q),W)for(let ie=0;ie<W.length;ie++)m(k,W[ie]);if(G){let ie=G.subTree;if(L===ie){const ce=G.vnode;T(k,ce,ce.scopeId,ce.slotScopeIds,G.parent)}}},S=(k,L,q,W,G,ie,ce,J,re=0)=>{for(let Q=re;Q<k.length;Q++){const Ee=k[Q]=J?bs(k[Q]):wr(k[Q]);M(null,Ee,L,q,W,G,ie,ce,J)}},g=(k,L,q,W,G,ie,ce)=>{const J=L.el=k.el;let{patchFlag:re,dynamicChildren:Q,dirs:Ee}=L;re|=k.patchFlag&16;const fe=k.props||$t,Te=L.props||$t;let Ce;q&&Ys(q,!1),(Ce=Te.onVnodeBeforeUpdate)&&mr(Ce,q,L,k),Ee&&Gs(L,k,q,"beforeUpdate"),q&&Ys(q,!0);const Le=G&&L.type!=="foreignObject";if(Q?b(k.dynamicChildren,Q,J,q,W,Le,ie):ce||$(k,L,J,null,q,W,Le,ie,!1),re>0){if(re&16)y(J,L,fe,Te,q,W,G);else if(re&2&&fe.class!==Te.class&&s(J,"class",null,Te.class,G),re&4&&s(J,"style",fe.style,Te.style,G),re&8){const ue=L.dynamicProps;for(let ve=0;ve<ue.length;ve++){const ee=ue[ve],Ne=fe[ee],B=Te[ee];(B!==Ne||ee==="value")&&s(J,ee,Ne,B,G,k.children,q,W,be)}}re&1&&k.children!==L.children&&d(J,L.children)}else!ce&&Q==null&&y(J,L,fe,Te,q,W,G);((Ce=Te.onVnodeUpdated)||Ee)&&fi(()=>{Ce&&mr(Ce,q,L,k),Ee&&Gs(L,k,q,"updated")},W)},b=(k,L,q,W,G,ie,ce)=>{for(let J=0;J<L.length;J++){const re=k[J],Q=L[J],Ee=re.el&&(re.type===Wi||!fo(re,Q)||re.shapeFlag&70)?u(re.el):q;M(re,Q,Ee,null,W,G,ie,ce,!0)}},y=(k,L,q,W,G,ie,ce)=>{if(q!==W){for(const J in W){if(dh(J))continue;const re=W[J],Q=q[J];re!==Q&&J!=="value"&&s(k,J,Q,re,ce,L.children,G,ie,be)}if(q!==$t)for(const J in q)!dh(J)&&!(J in W)&&s(k,J,q[J],null,ce,L.children,G,ie,be);"value"in W&&s(k,"value",q.value,W.value)}},w=(k,L,q,W,G,ie,ce,J,re)=>{const Q=L.el=k?k.el:a(""),Ee=L.anchor=k?k.anchor:a("");let{patchFlag:fe,dynamicChildren:Te,slotScopeIds:Ce}=L;Ce&&(J=J?J.concat(Ce):Ce),k==null?(i(Q,q,W),i(Ee,q,W),S(L.children,q,Ee,G,ie,ce,J,re)):fe>0&&fe&64&&Te&&k.dynamicChildren?(b(k.dynamicChildren,Te,q,G,ie,ce,J),(L.key!=null||G&&L===G.subTree)&&Sw(k,L,!0)):$(k,L,q,Ee,G,ie,ce,J,re)},A=(k,L,q,W,G,ie,ce,J,re)=>{L.slotScopeIds=J,k==null?L.shapeFlag&512?G.ctx.activate(L,q,W,ce,re):E(L,q,W,G,ie,ce,re):j(k,L,re)},E=(k,L,q,W,G,ie,ce)=>{const J=k.component=yk(k,W,G);if(Pd(k)&&(J.ctx.renderer=we),wk(J),J.asyncDep){if(G&&G.registerDep(J,K),!k.el){const re=J.subTree=Ci(cr);_(null,re,L,q)}return}K(J,k,L,q,G,ie,ce)},j=(k,L,q)=>{const W=L.component=k.component;if(xT(k,L,q))if(W.asyncDep&&!W.asyncResolved){H(W,L,q);return}else W.next=L,vT(W.update),W.update();else L.el=k.el,W.vnode=L},K=(k,L,q,W,G,ie,ce)=>{const J=()=>{if(k.isMounted){let{next:Ee,bu:fe,u:Te,parent:Ce,vnode:Le}=k,ue=Ee,ve;Ys(k,!1),Ee?(Ee.el=Le.el,H(k,Ee,ce)):Ee=Le,fe&&um(fe),(ve=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&mr(ve,Ce,Ee,Le),Ys(k,!0);const ee=hm(k),Ne=k.subTree;k.subTree=ee,M(Ne,ee,u(Ne.el),qe(Ne),k,G,ie),Ee.el=ee.el,ue===null&&CT(k,ee.el),Te&&fi(Te,G),(ve=Ee.props&&Ee.props.onVnodeUpdated)&&fi(()=>mr(ve,Ce,Ee,Le),G)}else{let Ee;const{el:fe,props:Te}=L,{bm:Ce,m:Le,parent:ue}=k,ve=fh(L);if(Ys(k,!1),Ce&&um(Ce),!ve&&(Ee=Te&&Te.onVnodeBeforeMount)&&mr(Ee,ue,L),Ys(k,!0),fe&&lt){const ee=()=>{k.subTree=hm(k),lt(fe,k.subTree,k,G,null)};ve?L.type.__asyncLoader().then(()=>!k.isUnmounted&&ee()):ee()}else{const ee=k.subTree=hm(k);M(null,ee,q,W,k,G,ie),L.el=ee.el}if(Le&&fi(Le,G),!ve&&(Ee=Te&&Te.onVnodeMounted)){const ee=L;fi(()=>mr(Ee,ue,ee),G)}(L.shapeFlag&256||ue&&fh(ue.vnode)&&ue.vnode.shapeFlag&256)&&k.a&&fi(k.a,G),k.isMounted=!0,L=q=W=null}},re=k.effect=new rp(J,()=>J3(Q),k.scope),Q=k.update=()=>re.run();Q.id=k.uid,Ys(k,!0),Q()},H=(k,L,q)=>{L.component=k;const W=k.vnode.props;k.vnode=L,k.next=null,nk(k,L.props,W,q),sk(k,L.children,q),rl(),Ld(void 0,k.update),sl()},$=(k,L,q,W,G,ie,ce,J,re=!1)=>{const Q=k&&k.children,Ee=k?k.shapeFlag:0,fe=L.children,{patchFlag:Te,shapeFlag:Ce}=L;if(Te>0){if(Te&128){I(Q,fe,q,W,G,ie,ce,J,re);return}else if(Te&256){p(Q,fe,q,W,G,ie,ce,J,re);return}}Ce&8?(Ee&16&&be(Q,G,ie),fe!==Q&&d(q,fe)):Ee&16?Ce&16?I(Q,fe,q,W,G,ie,ce,J,re):be(Q,G,ie,!0):(Ee&8&&d(q,""),Ce&16&&S(fe,q,W,G,ie,ce,J,re))},p=(k,L,q,W,G,ie,ce,J,re)=>{k=k||Aa,L=L||Aa;const Q=k.length,Ee=L.length,fe=Math.min(Q,Ee);let Te;for(Te=0;Te<fe;Te++){const Ce=L[Te]=re?bs(L[Te]):wr(L[Te]);M(k[Te],Ce,q,null,G,ie,ce,J,re)}Q>Ee?be(k,G,ie,!0,!1,fe):S(L,q,W,G,ie,ce,J,re,fe)},I=(k,L,q,W,G,ie,ce,J,re)=>{let Q=0;const Ee=L.length;let fe=k.length-1,Te=Ee-1;for(;Q<=fe&&Q<=Te;){const Ce=k[Q],Le=L[Q]=re?bs(L[Q]):wr(L[Q]);if(fo(Ce,Le))M(Ce,Le,q,null,G,ie,ce,J,re);else break;Q++}for(;Q<=fe&&Q<=Te;){const Ce=k[fe],Le=L[Te]=re?bs(L[Te]):wr(L[Te]);if(fo(Ce,Le))M(Ce,Le,q,null,G,ie,ce,J,re);else break;fe--,Te--}if(Q>fe){if(Q<=Te){const Ce=Te+1,Le=Ce<Ee?L[Ce].el:W;for(;Q<=Te;)M(null,L[Q]=re?bs(L[Q]):wr(L[Q]),q,Le,G,ie,ce,J,re),Q++}}else if(Q>Te)for(;Q<=fe;)D(k[Q],G,ie,!0),Q++;else{const Ce=Q,Le=Q,ue=new Map;for(Q=Le;Q<=Te;Q++){const X=L[Q]=re?bs(L[Q]):wr(L[Q]);X.key!=null&&ue.set(X.key,Q)}let ve,ee=0;const Ne=Te-Le+1;let B=!1,U=0;const z=new Array(Ne);for(Q=0;Q<Ne;Q++)z[Q]=0;for(Q=Ce;Q<=fe;Q++){const X=k[Q];if(ee>=Ne){D(X,G,ie,!0);continue}let V;if(X.key!=null)V=ue.get(X.key);else for(ve=Le;ve<=Te;ve++)if(z[ve-Le]===0&&fo(X,L[ve])){V=ve;break}V===void 0?D(X,G,ie,!0):(z[V-Le]=Q+1,V>=U?U=V:B=!0,M(X,L[V],q,null,G,ie,ce,J,re),ee++)}const Y=B?uk(z):Aa;for(ve=Y.length-1,Q=Ne-1;Q>=0;Q--){const X=Le+Q,V=L[X],ne=X+1<Ee?L[X+1].el:W;z[Q]===0?M(null,V,q,ne,G,ie,ce,J,re):B&&(ve<0||Q!==Y[ve]?Z(V,q,ne,2):ve--)}}},Z=(k,L,q,W,G=null)=>{const{el:ie,type:ce,transition:J,children:re,shapeFlag:Q}=k;if(Q&6){Z(k.component.subTree,L,q,W);return}if(Q&128){k.suspense.move(L,q,W);return}if(Q&64){ce.move(k,L,q,we);return}if(ce===Wi){i(ie,L,q);for(let fe=0;fe<re.length;fe++)Z(re[fe],L,q,W);i(k.anchor,L,q);return}if(ce===pm){F(k,L,q);return}if(W!==2&&Q&1&&J)if(W===0)J.beforeEnter(ie),i(ie,L,q),fi(()=>J.enter(ie),G);else{const{leave:fe,delayLeave:Te,afterLeave:Ce}=J,Le=()=>i(ie,L,q),ue=()=>{fe(ie,()=>{Le(),Ce&&Ce()})};Te?Te(ie,Le,ue):ue()}else i(ie,L,q)},D=(k,L,q,W=!1,G=!1)=>{const{type:ie,props:ce,ref:J,children:re,dynamicChildren:Q,shapeFlag:Ee,patchFlag:fe,dirs:Te}=k;if(J!=null&&A1(J,null,q,k,!0),Ee&256){L.ctx.deactivate(k);return}const Ce=Ee&1&&Te,Le=!fh(k);let ue;if(Le&&(ue=ce&&ce.onVnodeBeforeUnmount)&&mr(ue,L,k),Ee&6)xe(k.component,q,W);else{if(Ee&128){k.suspense.unmount(q,W);return}Ce&&Gs(k,null,L,"beforeUnmount"),Ee&64?k.type.remove(k,L,q,G,we,W):Q&&(ie!==Wi||fe>0&&fe&64)?be(Q,L,q,!1,!0):(ie===Wi&&fe&384||!G&&Ee&16)&&be(re,L,q),W&&ye(k)}(Le&&(ue=ce&&ce.onVnodeUnmounted)||Ce)&&fi(()=>{ue&&mr(ue,L,k),Ce&&Gs(k,null,L,"unmounted")},q)},ye=k=>{const{type:L,el:q,anchor:W,transition:G}=k;if(L===Wi){Oe(q,W);return}if(L===pm){O(k);return}const ie=()=>{r(q),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(k.shapeFlag&1&&G&&!G.persisted){const{leave:ce,delayLeave:J}=G,re=()=>ce(q,ie);J?J(k.el,ie,re):re()}else ie()},Oe=(k,L)=>{let q;for(;k!==L;)q=f(k),r(k),k=q;r(L)},xe=(k,L,q)=>{const{bum:W,scope:G,update:ie,subTree:ce,um:J}=k;W&&um(W),G.stop(),ie&&(ie.active=!1,D(ce,k,L,q)),J&&fi(J,L),fi(()=>{k.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},be=(k,L,q,W=!1,G=!1,ie=0)=>{for(let ce=ie;ce<k.length;ce++)D(k[ce],L,q,W,G)},qe=k=>k.shapeFlag&6?qe(k.component.subTree):k.shapeFlag&128?k.suspense.next():f(k.anchor||k.el),Fe=(k,L,q)=>{k==null?L._vnode&&D(L._vnode,null,null,!0):M(L._vnode||null,k,L,null,null,null,q),nw(),L._vnode=k},we={p:M,um:D,m:Z,r:ye,mt:E,mc:S,pc:$,pbc:b,n:qe,o:e};let Ye,lt;return t&&([Ye,lt]=t(we)),{render:Fe,hydrate:Ye,createApp:ak(Fe,Ye)}}function Ys({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Sw(e,t,n=!1){const i=e.children,r=t.children;if(xt(i)&&xt(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=bs(r[s]),a.el=o.el),n||Sw(o,a))}}function uk(e){const t=e.slice(),n=[0];let i,r,s,o,a;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,e[n[a]]<c?s=a+1:o=a;c<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=t[o];return n}const hk=e=>e.__isTeleport,Wi=Symbol(void 0),yp=Symbol(void 0),cr=Symbol(void 0),pm=Symbol(void 0),Zl=[];let or=null;function _i(e=!1){Zl.push(or=e?null:[])}function dk(){Zl.pop(),or=Zl[Zl.length-1]||null}let pc=1;function Bv(e){pc+=e}function Tw(e){return e.dynamicChildren=pc>0?or||Aa:null,dk(),pc>0&&or&&or.push(e),e}function Ki(e,t,n,i,r,s){return Tw(wn(e,t,n,i,r,s,!0))}function kw(e,t,n,i,r){return Tw(Ci(e,t,n,i,r,!0))}function x1(e){return e?e.__v_isVNode===!0:!1}function fo(e,t){return e.type===t.type&&e.key===t.key}const jd="__vInternal",Aw=({key:e})=>e!=null?e:null,ph=({ref:e,ref_key:t,ref_for:n})=>e!=null?Di(e)||ti(e)||yt(e)?{i:Gi,r:e,k:t,f:!!n}:e:null;function wn(e,t=null,n=null,i=0,r=null,s=e===Wi?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Aw(t),ref:t&&ph(t),scopeId:Bd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(bp(l,n),s&128&&e.normalize(l)):n&&(l.shapeFlag|=Di(n)?8:16),pc>0&&!o&&or&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&or.push(l),l}const Ci=fk;function fk(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===KT)&&(e=cr),x1(e)){const a=Ns(e,t,!0);return n&&bp(a,n),pc>0&&!s&&or&&(a.shapeFlag&6?or[or.indexOf(e)]=a:or.push(a)),a.patchFlag|=-2,a}if(Ak(e)&&(e=e.__vccOpts),t){t=mk(t);let{class:a,style:l}=t;a&&!Di(a)&&(t.class=Da(a)),si(l)&&(H3(l)&&!xt(l)&&(l=Li({},l)),t.style=dp(l))}const o=Di(e)?1:IT(e)?128:hk(e)?64:si(e)?4:yt(e)?2:0;return wn(e,t,n,i,r,o,s,!0)}function mk(e){return e?H3(e)||jd in e?Li({},e):e:null}function Ns(e,t,n=!1){const{props:i,ref:r,patchFlag:s,children:o}=e,a=t?gk(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Aw(a),ref:t&&t.ref?n&&r?xt(r)?r.concat(ph(t)):[r,ph(t)]:ph(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Wi?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ns(e.ssContent),ssFallback:e.ssFallback&&Ns(e.ssFallback),el:e.el,anchor:e.anchor}}function pk(e=" ",t=0){return Ci(yp,null,e,t)}function wo(e="",t=!1){return t?(_i(),kw(cr,null,e)):Ci(cr,null,e)}function wr(e){return e==null||typeof e=="boolean"?Ci(cr):xt(e)?Ci(Wi,null,e.slice()):typeof e=="object"?bs(e):Ci(yp,null,String(e))}function bs(e){return e.el===null||e.memo?e:Ns(e)}function bp(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(xt(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),bp(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!(jd in t)?t._ctx=Gi:r===3&&Gi&&(Gi.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else yt(t)?(t={default:t,_ctx:Gi},n=32):(t=String(t),i&64?(n=16,t=[pk(t)]):n=8);e.children=t,e.shapeFlag|=n}function gk(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=Da([t.class,i.class]));else if(r==="style")t.style=dp([t.style,i.style]);else if(fp(r)){const s=t[r],o=i[r];o&&s!==o&&!(xt(s)&&s.includes(o))&&(t[r]=s?[].concat(s,o):o)}else r!==""&&(t[r]=i[r])}return t}function mr(e,t,n,i=null){Xi(e,t,7,[n,i])}const _k=Ew();let vk=0;function yk(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||_k,s={uid:vk++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new TS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vw(i,r),emitsOptions:rw(i,r),emit:null,emitted:null,propsDefaults:$t,inheritAttrs:i.inheritAttrs,ctx:$t,data:$t,props:$t,attrs:$t,slots:$t,refs:$t,setupState:$t,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=wT.bind(null,s),e.ce&&e.ce(s),s}let xn=null;const bk=()=>xn||Gi,Ba=e=>{xn=e,e.scope.on()},Ro=()=>{xn&&xn.scope.off(),xn=null};function xw(e){return e.vnode.shapeFlag&4}let gc=!1;function wk(e,t=!1){gc=t;const{props:n,children:i}=e.vnode,r=xw(e);tk(e,n,r,t),rk(e,i);const s=r?Ek(e,t):void 0;return gc=!1,s}function Ek(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=V3(new Proxy(e.ctx,YT));const{setup:i}=n;if(i){const r=e.setupContext=i.length>1?Tk(e):null;Ba(e),rl();const s=ks(i,e,0,[e.props,r]);if(sl(),Ro(),Y3(s)){if(s.then(Ro,Ro),t)return s.then(o=>{Pv(e,o,t)}).catch(o=>{Fd(o,e,0)});e.asyncDep=s}else Pv(e,s,t)}else Cw(e,t)}function Pv(e,t,n){yt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:si(t)&&(e.setupState=q3(t)),Cw(e,n)}let Uv;function Cw(e,t,n){const i=e.type;if(!e.render){if(!t&&Uv&&!i.render){const r=i.template;if(r){const{isCustomElement:s,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=i,c=Li(Li({isCustomElement:s,delimiters:a},o),l);i.render=Uv(r,c)}}e.render=i.render||xr}Ba(e),rl(),XT(e),sl(),Ro()}function Sk(e){return new Proxy(e.attrs,{get(t,n){return Fi(e,"get","$attrs"),t[n]}})}function Tk(e){const t=i=>{e.exposed=i||{}};let n;return{get attrs(){return n||(n=Sk(e))},slots:e.slots,emit:e.emit,expose:t}}function Hd(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(q3(V3(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Rh)return Rh[n](e)}}))}function kk(e,t=!0){return yt(e)?e.displayName||e.name:e.name||t&&e.__name}function Ak(e){return yt(e)&&"__vccOpts"in e}const xk=(e,t)=>iT(e,t,gc);function Ck(e,t,n){const i=arguments.length;return i===2?si(t)&&!xt(t)?x1(t)?Ci(e,null,[t]):Ci(e,t):Ci(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&x1(n)&&(n=[n]),Ci(e,t,n))}const Ik="3.2.37";function Rk(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const Mk="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ok=Rk(Mk);function Iw(e){return!!e||e===""}function Nk(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=Vd(e[i],t[i]);return n}function Vd(e,t){if(e===t)return!0;let n=jv(e),i=jv(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=Hv(e),i=Hv(t),n||i)return e===t;if(n=Bo(e),i=Bo(t),n||i)return n&&i?Nk(e,t):!1;if(n=Vv(e),i=Vv(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,s=Object.keys(t).length;if(r!==s)return!1;for(const o in e){const a=e.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Vd(e[o],t[o]))return!1}}return String(e)===String(t)}function Fk(e,t){return e.findIndex(n=>Vd(n,t))}const Lk=/^on[^a-z]/,Dk=e=>Lk.test(e),Bk=e=>e.startsWith("onUpdate:"),Rw=Object.assign,Bo=Array.isArray,Mw=e=>Nw(e)==="[object Set]",jv=e=>Nw(e)==="[object Date]",Ow=e=>typeof e=="function",Oh=e=>typeof e=="string",Hv=e=>typeof e=="symbol",Vv=e=>e!==null&&typeof e=="object",Pk=Object.prototype.toString,Nw=e=>Pk.call(e),Fw=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Uk=/\B([A-Z])/g,Lw=Fw(e=>e.replace(Uk,"-$1").toLowerCase()),jk=Fw(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hk=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},C1=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Vk="http://www.w3.org/2000/svg",mo=typeof document!="undefined"?document:null,qv=mo&&mo.createElement("template"),qk={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t?mo.createElementNS(Vk,e):mo.createElement(e,n?{is:n}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>mo.createTextNode(e),createComment:e=>mo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>mo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,i,r,s){const o=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{qv.innerHTML=i?`<svg>${e}</svg>`:e;const a=qv.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function zk(e,t,n){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function $k(e,t,n){const i=e.style,r=Oh(n);if(n&&!r){for(const s in n)I1(i,s,n[s]);if(t&&!Oh(t))for(const s in t)n[s]==null&&I1(i,s,"")}else{const s=i.display;r?t!==n&&(i.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const zv=/\s*!important$/;function I1(e,t,n){if(Bo(n))n.forEach(i=>I1(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=Wk(e,t);zv.test(n)?e.setProperty(Lw(i),n.replace(zv,""),"important"):e[i]=n}}const $v=["Webkit","Moz","ms"],gm={};function Wk(e,t){const n=gm[t];if(n)return n;let i=Ir(t);if(i!=="filter"&&i in e)return gm[t]=i;i=jk(i);for(let r=0;r<$v.length;r++){const s=$v[r]+i;if(s in e)return gm[t]=s}return t}const Wv="http://www.w3.org/1999/xlink";function Kk(e,t,n,i,r){if(i&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(Wv,t.slice(6,t.length)):e.setAttributeNS(Wv,t,n);else{const s=Ok(t);n==null||s&&!Iw(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function Gk(e,t,n,i,r,s,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,r,s),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const l=n==null?"":n;(e.value!==l||e.tagName==="OPTION")&&(e.value=l),n==null&&e.removeAttribute(t);return}let a=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=Iw(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(t)}const[Dw,Yk]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let R1=0;const Xk=Promise.resolve(),Qk=()=>{R1=0},Zk=()=>R1||(Xk.then(Qk),R1=Dw());function po(e,t,n,i){e.addEventListener(t,n,i)}function Jk(e,t,n,i){e.removeEventListener(t,n,i)}function eA(e,t,n,i,r=null){const s=e._vei||(e._vei={}),o=s[t];if(i&&o)o.value=i;else{const[a,l]=tA(t);if(i){const c=s[t]=nA(i,r);po(e,a,c,l)}else o&&(Jk(e,a,o,l),s[t]=void 0)}}const Kv=/(?:Once|Passive|Capture)$/;function tA(e){let t;if(Kv.test(e)){t={};let n;for(;n=e.match(Kv);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Lw(e.slice(2)),t]}function nA(e,t){const n=i=>{const r=i.timeStamp||Dw();(Yk||r>=n.attached-1)&&Xi(iA(i,n.value),t,5,[i])};return n.value=e,n.attached=Zk(),n}function iA(e,t){if(Bo(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const Gv=/^on[a-z]/,rA=(e,t,n,i,r=!1,s,o,a,l)=>{t==="class"?zk(e,i,r):t==="style"?$k(e,n,i):Dk(t)?Bk(t)||eA(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):sA(e,t,i,r))?Gk(e,t,i,s,o,a,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Kk(e,t,i,r))};function sA(e,t,n,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&Gv.test(t)&&Ow(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Gv.test(t)&&Oh(n)?!1:t in e}const oA={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};LT.props;const Nh=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Bo(t)?n=>Hk(t,n):t};function aA(e){e.target.composing=!0}function Yv(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Xv={created(e,{modifiers:{lazy:t,trim:n,number:i}},r){e._assign=Nh(r);const s=i||r.props&&r.props.type==="number";po(e,t?"change":"input",o=>{if(o.target.composing)return;let a=e.value;n&&(a=a.trim()),s&&(a=C1(a)),e._assign(a)}),n&&po(e,"change",()=>{e.value=e.value.trim()}),t||(po(e,"compositionstart",aA),po(e,"compositionend",Yv),po(e,"change",Yv))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:i,number:r}},s){if(e._assign=Nh(s),e.composing||document.activeElement===e&&e.type!=="range"&&(n||i&&e.value.trim()===t||(r||e.type==="number")&&C1(e.value)===t))return;const o=t==null?"":t;e.value!==o&&(e.value=o)}},Bw={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const r=Mw(t);po(e,"change",()=>{const s=Array.prototype.filter.call(e.options,o=>o.selected).map(o=>n?C1(Fh(o)):Fh(o));e._assign(e.multiple?r?new Set(s):s:s[0])}),e._assign=Nh(i)},mounted(e,{value:t}){Qv(e,t)},beforeUpdate(e,t,n){e._assign=Nh(n)},updated(e,{value:t}){Qv(e,t)}};function Qv(e,t){const n=e.multiple;if(!(n&&!Bo(t)&&!Mw(t))){for(let i=0,r=e.options.length;i<r;i++){const s=e.options[i],o=Fh(s);if(n)Bo(t)?s.selected=Fk(t,o)>-1:s.selected=t.has(o);else if(Vd(Fh(s),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Fh(e){return"_value"in e?e._value:e.value}const lA=["ctrl","shift","alt","meta"],cA={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>lA.some(n=>e[`${n}Key`]&&!t.includes(n))},_m=(e,t)=>(n,...i)=>{for(let r=0;r<t.length;r++){const s=cA[t[r]];if(s&&s(n,t))return}return e(n,...i)},uA=Rw({patchProp:rA},qk);let Zv;function hA(){return Zv||(Zv=lk(uA))}const dA=(...e)=>{const t=hA().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=fA(i);if(!r)return;const s=t._component;!Ow(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function fA(e){return Oh(e)?document.querySelector(e):e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue=function(e,t){if(!e)throw ol(t)},ol=function(e){return new Error("Firebase Database ("+Pw.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},mA=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=e[n++],o=e[n++],a=e[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},wp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const s=e[r],o=r+1<e.length,a=o?e[r+1]:0,l=r+2<e.length,c=l?e[r+2]:0,d=s>>2,u=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),i.push(n[d],n[u],n[f],n[m])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Uw(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):mA(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const s=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const c=r<e.length?n[e.charAt(r)]:64;++r;const u=r<e.length?n[e.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw Error();const f=s<<2|a>>4;if(i.push(f),c!==64){const m=a<<4&240|c>>2;if(i.push(m),u!==64){const h=c<<6&192|u;i.push(h)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},pA=function(e){const t=Uw(e);return wp.encodeByteArray(t,!0)},Jv=function(e){try{return wp.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(e){return jw(void 0,e)}function jw(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!_A(n)||(e[n]=jw(e[n],t[n]));return e}function _A(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ep(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qd())}function vA(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Hw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yA(){return qd().indexOf("Electron/")>=0}function bA(){const e=qd();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function wA(){return qd().indexOf("MSAppHost/")>=0}function Vw(){return Pw.NODE_ADMIN===!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA="FirebaseError";class zd extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=EA,Object.setPrototypeOf(this,zd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qw.prototype.create)}}class qw{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?SA(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new zd(r,a,i)}}function SA(e,t){return e.replace(TA,(n,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const TA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(e){return JSON.parse(e)}function Cn(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=_c(Jv(s[0])||""),n=_c(Jv(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:i,signature:r}},kA=function(e){const t=zw(e),n=t.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},AA=function(e){const t=zw(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Pa(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function M1(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Lh(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function O1(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const s=e[r],o=t[r];if(ey(s)&&ey(o)){if(!O1(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function ey(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const i=this.W_;if(typeof t=="string")for(let u=0;u<16;u++)i[u]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let u=0;u<16;u++)i[u]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let u=16;u<80;u++){const f=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=(f<<1|f>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,d;for(let u=0;u<80;u++){u<40?u<20?(c=a^s&(o^a),d=1518500249):(c=s^o^a,d=1859775393):u<60?(c=s&o|a&(s|o),d=2400959708):(c=s^o^a,d=3395469782);const f=(r<<5|r>>>27)+c+l+d+i[u]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,n){if(t==null)return;n===void 0&&(n=t.length);const i=n-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(t,r),r+=this.blockSize;if(typeof t=="string"){for(;r<n;)if(s[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=t[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const t=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)t[i]=this.chain_[r]>>s&255,++i;return t}}function Ua(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,Ue(i<e.length,"Surrogate pair missing trail surrogate.");const o=e.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},$d=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(e){return e&&e._delegate?e._delegate:e}class al{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new Pr;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(OA(t))try{this.getOrInitializeService({instanceIdentifier:lo})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=lo){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=lo){return this.instances.has(t)}getOptions(t=lo){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,n){var i;const r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&t(o,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(!!i)for(const r of i)try{r(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MA(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=lo){return this.component?this.component.multipleInstances?t:lo:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MA(e){return e===lo?void 0:e}function OA(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new RA(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ct||(Ct={}));const FA={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},LA=Ct.INFO,DA={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},BA=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=DA[t];if(r)console[r](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Sp{constructor(t){this.name=t,this._logLevel=LA,this._logHandler=BA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ct))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?FA[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...t),this._logHandler(this,Ct.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...t),this._logHandler(this,Ct.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...t),this._logHandler(this,Ct.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...t),this._logHandler(this,Ct.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...t),this._logHandler(this,Ct.ERROR,...t)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(UA(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function UA(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const N1="@firebase/app",ty="0.7.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=new Sp("@firebase/app"),jA="@firebase/app-compat",HA="@firebase/analytics-compat",VA="@firebase/analytics",qA="@firebase/app-check-compat",zA="@firebase/app-check",$A="@firebase/auth",WA="@firebase/auth-compat",KA="@firebase/database",GA="@firebase/database-compat",YA="@firebase/functions",XA="@firebase/functions-compat",QA="@firebase/installations",ZA="@firebase/installations-compat",JA="@firebase/messaging",ex="@firebase/messaging-compat",tx="@firebase/performance",nx="@firebase/performance-compat",ix="@firebase/remote-config",rx="@firebase/remote-config-compat",sx="@firebase/storage",ox="@firebase/storage-compat",ax="@firebase/firestore",lx="@firebase/firestore-compat",cx="firebase",ux="9.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="[DEFAULT]",hx={[N1]:"fire-core",[jA]:"fire-core-compat",[VA]:"fire-analytics",[HA]:"fire-analytics-compat",[zA]:"fire-app-check",[qA]:"fire-app-check-compat",[$A]:"fire-auth",[WA]:"fire-auth-compat",[KA]:"fire-rtdb",[GA]:"fire-rtdb-compat",[YA]:"fire-fn",[XA]:"fire-fn-compat",[QA]:"fire-iid",[ZA]:"fire-iid-compat",[JA]:"fire-fcm",[ex]:"fire-fcm-compat",[tx]:"fire-perf",[nx]:"fire-perf-compat",[ix]:"fire-rc",[rx]:"fire-rc-compat",[sx]:"fire-gcs",[ox]:"fire-gcs-compat",[ax]:"fire-fst",[lx]:"fire-fst-compat","fire-js":"fire-js",[cx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new Map,F1=new Map;function dx(e,t){try{e.container.addComponent(t)}catch(n){Tp.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Yc(e){const t=e.name;if(F1.has(t))return Tp.debug(`There were multiple attempts to register component ${t}.`),!1;F1.set(t,e);for(const n of Dh.values())dx(n,e);return!0}function kp(e,t){return e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function."},Bh=new qw("app","Firebase",fx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Bh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=ux;function px(e,t={}){typeof t!="object"&&(t={name:t});const n=Object.assign({name:$w,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw Bh.create("bad-app-name",{appName:String(i)});const r=Dh.get(i);if(r){if(O1(e,r.options)&&O1(n,r.config))return r;throw Bh.create("duplicate-app",{appName:i})}const s=new NA(i);for(const a of F1.values())s.addComponent(a);const o=new mx(e,n,s);return Dh.set(i,o),o}function xp(e=$w){const t=Dh.get(e);if(!t)throw Bh.create("no-app",{appName:e});return t}function Cr(e,t,n){var i;let r=(i=hx[e])!==null&&i!==void 0?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${t}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Tp.warn(a.join(" "));return}Yc(new al(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(e){Yc(new al("platform-logger",t=>new PA(t),"PRIVATE")),Cr(N1,ty,e),Cr(N1,ty,"esm2017"),Cr("fire-js","")}gx("");var _x="firebase",vx="9.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cr(_x,vx,"app");const ny="@firebase/database",iy="0.12.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ww="";function yx(e){Ww=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){n==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Cn(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return n==null?null:_c(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){n==null?delete this.cache_[t]:this.cache_[t]=n}get(t){return Nr(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=function(e){try{if(typeof window!="undefined"&&typeof window[e]!="undefined"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new bx(t)}}catch{}return new wx},Eo=Kw("localStorage"),L1=Kw("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=new Sp("@firebase/database"),Ex=function(){let e=1;return function(){return e++}}(),Gw=function(e){const t=IA(e),n=new CA;n.update(t);const i=n.digest();return wp.encodeByteArray(i)},Xc=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=Xc.apply(null,i):typeof i=="object"?t+=Cn(i):t+=i,t+=" "}return t};let Mo=null,ry=!0;const Sx=function(e,t){Ue(!t||e===!0||e===!1,"Can't turn on custom loggers persistently."),e===!0?(xa.logLevel=Ct.VERBOSE,Mo=xa.log.bind(xa),t&&L1.set("logging_enabled",!0)):typeof e=="function"?Mo=e:(Mo=null,L1.remove("logging_enabled"))},On=function(...e){if(ry===!0&&(ry=!1,Mo===null&&L1.get("logging_enabled")===!0&&Sx(!0)),Mo){const t=Xc.apply(null,e);Mo(t)}},Qc=function(e){return function(...t){On(e,...t)}},D1=function(...e){const t="FIREBASE INTERNAL ERROR: "+Xc(...e);xa.error(t)},Po=function(...e){const t=`FIREBASE FATAL ERROR: ${Xc(...e)}`;throw xa.error(t),new Error(t)},wi=function(...e){const t="FIREBASE WARNING: "+Xc(...e);xa.warn(t)},Tx=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&wi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Wd=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},kx=function(e){if(document.readyState==="complete")e();else{let t=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ja="[MIN_NAME]",Uo="[MAX_NAME]",Zo=function(e,t){if(e===t)return 0;if(e===ja||t===Uo)return-1;if(t===ja||e===Uo)return 1;{const n=sy(e),i=sy(t);return n!==null?i!==null?n-i===0?e.length-t.length:n-i:-1:i!==null?1:e<t?-1:1}},Ax=function(e,t){return e===t?0:e<t?-1:1},Al=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Cn(t))},Cp=function(e){if(typeof e!="object"||e===null)return Cn(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)i!==0&&(n+=","),n+=Cn(t[i]),n+=":",n+=Cp(e[t[i]]);return n+="}",n},Yw=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function Wn(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Xw=function(e){Ue(!Wd(e),"Invalid JSON number");const t=11,n=52,i=(1<<t-1)-1;let r,s,o,a,l;e===0?(s=0,o=0,r=1/e===-1/0?1:0):(r=e<0,e=Math.abs(e),e>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),i),s=a+i,o=Math.round(e*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(e/Math.pow(2,1-i-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();const d=c.join("");let u="";for(l=0;l<64;l+=8){let f=parseInt(d.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),u=u+f}return u.toLowerCase()},xx=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Cx=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Ix(e,t){let n="Unknown Error";e==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?n="Client doesn't have permission to access the desired data.":e==="unavailable"&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}const Rx=new RegExp("^-?(0*)\\d{1,10}$"),Mx=-2147483648,Ox=2147483647,sy=function(e){if(Rx.test(e)){const t=Number(e);if(t>=Mx&&t<=Ox)return t}return null},ll=function(e){try{e()}catch(t){setTimeout(()=>{const n=t.stack||"";throw wi("Exception was thrown by user callback.",n),t},Math.floor(0))}},Nx=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Jl=function(e,t){const n=setTimeout(e,t);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(t,n){this.appName_=t,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){wi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(t,n,i){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&n.code==="auth/token-not-initialized"?(On("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',wi(t)}}class B1{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}B1.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="5",Qw="v",Zw="s",Jw="r",e4="f",t4=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,n4="ls",Dx="p",P1="ac",i4="websocket",r4="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(t,n,i,r,s=!1,o="",a=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Eo.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Eo.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${n}`}}function Px(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function s4(e,t,n){Ue(typeof t=="string","typeof type must == string"),Ue(typeof n=="object","typeof params must == object");let i;if(t===i4)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===r4)i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);Px(e)&&(n.ns=e.namespace);const r=[];return Wn(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(){this.counters_={}}incrementCounter(t,n=1){Nr(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return gA(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm={},ym={};function Rp(e){const t=e.toString();return vm[t]||(vm[t]=new Ux),vm[t]}function jx(e,t){const n=e.toString();return ym[n]||(ym[n]=t()),ym[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&ll(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy="start",Vx="close",qx="pLPCommand",zx="pRTLPCB",o4="id",a4="pw",l4="ser",$x="cb",Wx="seg",Kx="ts",Gx="d",Yx="dframe",c4=1870,u4=30,Xx=c4-u4,Qx=25e3,Zx=3e4;class ba{constructor(t,n,i,r,s,o,a){this.connId=t,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qc(t),this.stats_=Rp(n),this.urlFn=l=>(this.appCheckToken&&(l[P1]=this.appCheckToken),s4(n,r4,l))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Hx(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Zx)),kx(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mp((...s)=>{const[o,a,l,c,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===oy)this.id=a,this.password=l;else if(o===Vx)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[oy]="t",i[l4]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[$x]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Qw]=Ip,this.transportSessionId&&(i[Zw]=this.transportSessionId),this.lastSessionId&&(i[n4]=this.lastSessionId),this.applicationId&&(i[Dx]=this.applicationId),this.appCheckToken&&(i[P1]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&t4.test(location.hostname)&&(i[Jw]=e4);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ba.forceAllow_=!0}static forceDisallow(){ba.forceDisallow_=!0}static isAvailable(){return ba.forceAllow_?!0:!ba.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!xx()&&!Cx()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=Cn(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=pA(n),r=Yw(i,Xx);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[Yx]="t",i[o4]=t,i[a4]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=Cn(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Mp{constructor(t,n,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ex(),window[qx+this.uniqueCallbackIdentifier]=t,window[zx+this.uniqueCallbackIdentifier]=n,this.myIFrame=Mp.createIFrame_();let s="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;s='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){On("frame writing exception"),a.stack&&On(a.stack),On(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||On("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[o4]=this.myID,t[a4]=this.myPW,t[l4]=this.currentSerial;let n=this.urlFn(t),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+u4+i.length<=c4;){const o=this.pendingSegs.shift();i=i+"&"+Wx+r+"="+o.seg+"&"+Kx+r+"="+o.ts+"&"+Gx+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(t,n,i){this.pendingSegs.push({seg:t,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(Qx)),s=()=>{clearTimeout(r),i()};this.addTag(t,s)}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{On("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=16384,eC=45e3;let Ph=null;typeof MozWebSocket!="undefined"?Ph=MozWebSocket:typeof WebSocket!="undefined"&&(Ph=WebSocket);class rr{constructor(t,n,i,r,s,o,a){this.connId=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qc(this.connId),this.stats_=Rp(n),this.connURL=rr.connectionURL_(n,o,a,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,i,r){const s={};return s[Qw]=Ip,typeof location!="undefined"&&location.hostname&&t4.test(location.hostname)&&(s[Jw]=e4),n&&(s[Zw]=n),i&&(s[n4]=i),r&&(s[P1]=r),s4(t,i4,s)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Eo.set("previous_websocket_failure",!0);try{if(!Vw()){const i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Ph(this.connURL,[],i)}}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){rr.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Ph!==null&&!rr.forceDisallow_}static previouslyFailed(){return Eo.isInMemoryStorage||Eo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Eo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=_c(n);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(Ue(this.frames===null,"We already have a frame buffer"),t.length<=6){const n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const n=Cn(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=Yw(n,Jx);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(eC))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}rr.responsesRequiredToBeHealthy=2;rr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ba,rr]}initTransports_(t){const n=rr&&rr.isAvailable();let i=n&&!rr.previouslyFailed();if(t.webSocketOnly&&(n||wi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[rr];else{const r=this.transports_=[];for(const s of Op.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=6e4,nC=5e3,iC=10*1024,rC=100*1024,bm="t",ay="d",sC="s",ly="r",oC="e",cy="o",uy="a",hy="n",dy="p",aC="h";class lC{constructor(t,n,i,r,s,o,a,l,c,d){this.id=t,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qc("c:"+this.id+":"),this.transportManager_=new Op(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=Jl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>rC?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>iC?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){const n={t:"d",d:t};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(bm in t){const n=t[bm];n===uy?this.upgradeIfSecondaryHealthy_():n===ly?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===cy&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=Al("t",t),i=Al("d",t);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:dy,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:uy,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:hy,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=Al("t",t),i=Al("d",t);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=Al(bm,t);if(ay in t){const i=t[ay];if(n===aC)this.onHandshake_(i);else if(n===hy){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===sC?this.onConnectionShutdown_(i):n===ly?this.onReset_(i):n===oC?D1("Server Error: "+i):n===cy?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):D1("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,i=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ip!==i&&wi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Jl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(tC))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Jl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(nC))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:dy,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Eo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{put(t,n,i,r){}merge(t,n,i,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,i){}onDisconnectMerge(t,n,i){}onDisconnectCancel(t,n){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(t){this.allowedEvents_=t,this.listeners_={},Ue(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(t,n,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:i});const r=this.getInitialEvent(t);r&&n.apply(i,r)}off(t,n,i){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(t){Ue(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh extends d4{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Ep()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Uh}getInitialEvent(t){return Ue(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy=32,my=768;class Ut{constructor(t,n){if(n===void 0){this.pieces_=t.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(t+="/"+this.pieces_[n]);return t||"/"}}function Rt(){return new Ut("")}function pt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Fs(e){return e.pieces_.length-e.pieceNum_}function Wt(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Ut(e.pieces_,t)}function Np(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function cC(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)e.pieces_[n]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function vc(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function f4(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Ut(t,0)}function dn(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof Ut)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const i=t.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new Ut(n,0)}function gt(e){return e.pieceNum_>=e.pieces_.length}function yi(e,t){const n=pt(e),i=pt(t);if(n===null)return t;if(n===i)return yi(Wt(e),Wt(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function uC(e,t){const n=vc(e,0),i=vc(t,0);for(let r=0;r<n.length&&r<i.length;r++){const s=Zo(n[r],i[r]);if(s!==0)return s}return n.length===i.length?0:n.length<i.length?-1:1}function Fp(e,t){if(Fs(e)!==Fs(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function Yi(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(Fs(e)>Fs(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class hC{constructor(t,n){this.errorPrefix_=n,this.parts_=vc(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=$d(this.parts_[i]);m4(this)}}function dC(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=$d(t),m4(e)}function fC(e){const t=e.parts_.pop();e.byteLength_-=$d(t),e.parts_.length>0&&(e.byteLength_-=1)}function m4(e){if(e.byteLength_>my)throw new Error(e.errorPrefix_+"has a key path longer than "+my+" bytes ("+e.byteLength_+").");if(e.parts_.length>fy)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+fy+") or object contains a cycle "+co(e))}function co(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp extends d4{constructor(){super(["visible"]);let t,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",t="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new Lp}getInitialEvent(t){return Ue(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl=1e3,mC=60*5*1e3,pC=3*1e3,py=30*1e3,gC=1.3,_C=3e4,vC="server_kill",gy=3;class zr extends h4{constructor(t,n,i,r,s,o,a,l){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=zr.nextPersistentConnectionId_++,this.log_=Qc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xl,this.maxReconnectDelay_=mC,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Vw())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Lp.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Uh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){const r=++this.requestNumber_,s={r,a:t,b:n};this.log_(Cn(s)),Ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(t){this.initConnection_();const n=new Pr,i={p:t._path.toString(),q:t._queryObject},r={action:"g",request:i,onComplete:o=>{const a=o.d;o.s==="ok"?(this.onDataUpdate_(i.p,a,!1,null),n.resolve(a)):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const o=this.outstandingGets_[s];o===void 0||r!==o||(delete this.outstandingGets_[s],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),this.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))},pC),this.connected_&&this.sendGet_(s),n.promise}listen(t,n,i,r){this.initConnection_();const s=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),Ue(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ue(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:t,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(t){const n=t.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},o="q";t.tag&&(s.q=n._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;zr.warnOnListenWarnings_(l,n),(this.listens.get(i)&&this.listens.get(i).get(r))===t&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,r),t.onComplete&&t.onComplete(c,l))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Nr(t,"w")){const i=Pa(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();wi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||AA(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=py)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,n=kA(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{const s=r.s,o=r.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const n=t.s,i=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(t,n){const i=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),Ue(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,t._queryObject,n)}sendUnlisten_(t,n,i,r){this.log_("Unlisten on "+t+" for "+n);const s={p:t},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:i})}onDisconnectMerge(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:i})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,i,r){const s={p:n,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(t,n,i,r){this.putInternal("p",t,n,i,r)}merge(t,n,i,r){this.putInternal("m",t,n,i,r)}putInternal(t,n,i,r,s){this.initConnection_();const o={p:n,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(t){const n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(t){if(this.connected_){const n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Cn(t));const n=t.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):D1("Unrecognized action received from server: "+Cn(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){Ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_C&&(this.reconnectDelay_=xl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*gC)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+zr.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(u){Ue(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:l,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?On("getToken() completed but was canceled"):(On("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=f&&f.token,a=new lC(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,m=>{wi(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(vC)},s))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&wi(u),l())}}}interrupt(t){On("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){On("Resuming connection for reason: "+t),delete this.interruptReasons_[t],M1(this.interruptReasons_)&&(this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let i;n?i=n.map(s=>Cp(s)).join("$"):i="default";const r=this.removeListen_(t,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(t,n){const i=new Ut(t).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(t,n){On("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gy&&(this.reconnectDelay_=py,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){On("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gy&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let n="js";t["sdk."+n+"."+Ww.replace(/\./g,"-")]=1,Ep()?t["framework.cordova"]=1:Hw()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Uh.getInstance().currentlyOnline();return M1(this.interruptReasons_)&&t}}zr.nextPersistentConnectionId_=0;zr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new _t(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const i=new _t(ja,t),r=new _t(ja,n);return this.compare(i,r)!==0}minPost(){return _t.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu;class p4 extends Kd{static get __EMPTY_NODE(){return Lu}static set __EMPTY_NODE(t){Lu=t}compare(t,n){return Zo(t.name,n.name)}isDefinedOn(t){throw ol("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return _t.MIN}maxPost(){return new _t(Uo,Lu)}makePost(t,n){return Ue(typeof t=="string","KeyIndex indexValue must always be a string."),new _t(t,Lu)}toString(){return".key"}}const Ca=new p4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(t,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(t=t,o=n?i(t.key,n):1,r&&(o*=-1),o<0)this.isReverse_?t=t.left:t=t.right;else if(o===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(t.key,t.value):n={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class An{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i!=null?i:An.RED,this.left=r!=null?r:bi.EMPTY_NODE,this.right=s!=null?s:bi.EMPTY_NODE}copy(t,n,i,r,s){return new An(t!=null?t:this.key,n!=null?n:this.value,i!=null?i:this.color,r!=null?r:this.left,s!=null?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return bi.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let i,r;if(i=this,n(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(t,i.key)===0){if(i.right.isEmpty())return bi.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}An.RED=!0;An.BLACK=!1;class yC{copy(t,n,i,r,s){return this}insert(t,n,i){return new An(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class bi{constructor(t,n=bi.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new bi(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,An.BLACK,null,null))}remove(t){return new bi(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,An.BLACK,null,null))}get(t){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(t,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(t){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(t,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Du(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new Du(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new Du(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new Du(this.root_,null,this.comparator_,!0,t)}}bi.EMPTY_NODE=new yC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(e,t){return Zo(e.name,t.name)}function Dp(e,t){return Zo(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U1;function wC(e){U1=e}const g4=function(e){return typeof e=="number"?"number:"+Xw(e):"string:"+e},_4=function(e){if(e.isLeafNode()){const t=e.val();Ue(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Nr(t,".sv"),"Priority must be a string or number.")}else Ue(e===U1||e.isEmpty(),"priority of unexpected type.");Ue(e===U1||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _y;class Sn{constructor(t,n=Sn.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Ue(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),_4(this.priorityNode_)}static set __childrenNodeConstructor(t){_y=t}static get __childrenNodeConstructor(){return _y}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Sn(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:Sn.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return gt(t)?this:pt(t)===".priority"?this.priorityNode_:Sn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:Sn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){const i=pt(t);return i===null?n:n.isEmpty()&&i!==".priority"?this:(Ue(i!==".priority"||Fs(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Sn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+g4(this.priorityNode_.val())+":");const n=typeof this.value_;t+=n+":",n==="number"?t+=Xw(this.value_):t+=this.value_,this.lazyHash_=Gw(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Sn.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Sn.__childrenNodeConstructor?-1:(Ue(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,i=typeof this.value_,r=Sn.VALUE_TYPE_ORDER.indexOf(n),s=Sn.VALUE_TYPE_ORDER.indexOf(i);return Ue(r>=0,"Unknown leaf type: "+n),Ue(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Sn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v4,y4;function EC(e){v4=e}function SC(e){y4=e}class TC extends Kd{compare(t,n){const i=t.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Zo(t.name,n.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return _t.MIN}maxPost(){return new _t(Uo,new Sn("[PRIORITY-POST]",y4))}makePost(t,n){const i=v4(t);return new _t(n,new Sn("[PRIORITY-POST]",i))}toString(){return".priority"}}const an=new TC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=Math.log(2);class AC{constructor(t){const n=s=>parseInt(Math.log(s)/kC,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(t+1),this.current_=this.count-1;const r=i(this.count);this.bits_=t+1&r}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const jh=function(e,t,n,i){e.sort(t);const r=function(l,c){const d=c-l;let u,f;if(d===0)return null;if(d===1)return u=e[l],f=n?n(u):u,new An(f,u.node,An.BLACK,null,null);{const m=parseInt(d/2,10)+l,h=r(l,m),R=r(m+1,c);return u=e[m],f=n?n(u):u,new An(f,u.node,An.BLACK,h,R)}},s=function(l){let c=null,d=null,u=e.length;const f=function(h,R){const M=u-h,C=u;u-=h;const _=r(M+1,C),x=e[M],F=n?n(x):x;m(new An(F,x.node,R,null,_))},m=function(h){c?(c.left=h,c=h):(d=h,c=h)};for(let h=0;h<l.count;++h){const R=l.nextBitIsOne(),M=Math.pow(2,l.count-(h+1));R?f(M,An.BLACK):(f(M,An.BLACK),f(M,An.RED))}return d},o=new AC(e.length),a=s(o);return new bi(i||t,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wm;const la={};class jr{constructor(t,n){this.indexes_=t,this.indexSet_=n}static get Default(){return Ue(la&&an,"ChildrenNode.ts has not been loaded"),wm=wm||new jr({".priority":la},{".priority":an}),wm}get(t){const n=Pa(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof bi?n:null}hasIndex(t){return Nr(this.indexSet_,t.toString())}addIndex(t,n){Ue(t!==Ca,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=n.getIterator(_t.Wrap);let o=s.getNext();for(;o;)r=r||t.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=jh(i,t.getCompare()):a=la;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const d=Object.assign({},this.indexes_);return d[l]=a,new jr(d,c)}addToIndexes(t,n){const i=Lh(this.indexes_,(r,s)=>{const o=Pa(this.indexSet_,s);if(Ue(o,"Missing index implementation for "+s),r===la)if(o.isDefinedOn(t.node)){const a=[],l=n.getIterator(_t.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&a.push(c),c=l.getNext();return a.push(t),jh(a,o.getCompare())}else return la;else{const a=n.get(t.name);let l=r;return a&&(l=l.remove(new _t(t.name,a))),l.insert(t,t.node)}});return new jr(i,this.indexSet_)}removeFromIndexes(t,n){const i=Lh(this.indexes_,r=>{if(r===la)return r;{const s=n.get(t.name);return s?r.remove(new _t(t.name,s)):r}});return new jr(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cl;class rt{constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&_4(this.priorityNode_),this.children_.isEmpty()&&Ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Cl||(Cl=new rt(new bi(Dp),null,jr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Cl}updatePriority(t){return this.children_.isEmpty()?this:new rt(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const n=this.children_.get(t);return n===null?Cl:n}}getChild(t){const n=pt(t);return n===null?this:this.getImmediateChild(n).getChild(Wt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if(Ue(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{const i=new _t(t,n);let r,s;n.isEmpty()?(r=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?Cl:this.priorityNode_;return new rt(r,o,s)}}updateChild(t,n){const i=pt(t);if(i===null)return n;{Ue(pt(t)!==".priority"||Fs(t)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(Wt(t),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(an,(o,a)=>{n[o]=a.val(t),i++,s&&rt.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!t&&s&&r<2*i){const o=[];for(const a in n)o[a]=n[a];return o}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+g4(this.getPriority().val())+":"),this.forEachChild(an,(n,i)=>{const r=i.hash();r!==""&&(t+=":"+n+":"+r)}),this.lazyHash_=t===""?"":Gw(t)}return this.lazyHash_}getPredecessorChildName(t,n,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new _t(t,n));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const n=this.getFirstChildName(t);return n?new _t(n,this.children_.get(n)):null}getLastChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const n=this.getLastChildName(t);return n?new _t(n,this.children_.get(n)):null}forEachChild(t,n){const i=this.resolveIndex_(t);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(t,r=>r);{const r=this.children_.getIteratorFrom(t.name,_t.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(t,r=>r);{const r=this.children_.getReverseIteratorFrom(t.name,_t.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)>0;)r.getNext(),s=r.peek();return r}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Zc?-1:0}withIndex(t){if(t===Ca||this.indexMap_.hasIndex(t))return this;{const n=this.indexMap_.addIndex(t,this.children_);return new rt(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===Ca||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(an),r=n.getIterator(an);let s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(t){return t===Ca?null:this.indexMap_.get(t.toString())}}rt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xC extends rt{constructor(){super(new bi(Dp),rt.EMPTY_NODE,jr.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return rt.EMPTY_NODE}isEmpty(){return!1}}const Zc=new xC;Object.defineProperties(_t,{MIN:{value:new _t(ja,rt.EMPTY_NODE)},MAX:{value:new _t(Uo,Zc)}});p4.__EMPTY_NODE=rt.EMPTY_NODE;Sn.__childrenNodeConstructor=rt;wC(Zc);SC(Zc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=!0;function yn(e,t=null){if(e===null)return rt.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),Ue(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const n=e;return new Sn(n,yn(t))}if(!(e instanceof Array)&&CC){const n=[];let i=!1;if(Wn(e,(o,a)=>{if(o.substring(0,1)!=="."){const l=yn(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new _t(o,l)))}}),n.length===0)return rt.EMPTY_NODE;const s=jh(n,bC,o=>o.name,Dp);if(i){const o=jh(n,an.getCompare());return new rt(s,yn(t),new jr({".priority":o},{".priority":an}))}else return new rt(s,yn(t),jr.Default)}else{let n=rt.EMPTY_NODE;return Wn(e,(i,r)=>{if(Nr(e,i)&&i.substring(0,1)!=="."){const s=yn(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(yn(t))}}EC(yn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends Kd{constructor(t){super(),this.indexPath_=t,Ue(!gt(t)&&pt(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const i=this.extractChild(t.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Zo(t.name,n.name):s}makePost(t,n){const i=yn(t),r=rt.EMPTY_NODE.updateChild(this.indexPath_,i);return new _t(n,r)}maxPost(){const t=rt.EMPTY_NODE.updateChild(this.indexPath_,Zc);return new _t(Uo,t)}toString(){return vc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC extends Kd{compare(t,n){const i=t.node.compareTo(n.node);return i===0?Zo(t.name,n.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return _t.MIN}maxPost(){return _t.MAX}makePost(t,n){const i=yn(t);return new _t(n,i)}toString(){return".value"}}const MC=new RC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(e){return{type:"value",snapshotNode:e}}function Ha(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function yc(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function bc(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function OC(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(t){this.index_=t}updateChild(t,n,i,r,s,o){Ue(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?t.hasChild(n)?o.trackChildChange(yc(n,a)):Ue(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ha(n,i)):o.trackChildChange(bc(n,i,a))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(t,n,i){return i!=null&&(t.isLeafNode()||t.forEachChild(an,(r,s)=>{n.hasChild(r)||i.trackChildChange(yc(r,s))}),n.isLeafNode()||n.forEachChild(an,(r,s)=>{if(t.hasChild(r)){const o=t.getImmediateChild(r);o.equals(s)||i.trackChildChange(bc(r,s,o))}else i.trackChildChange(Ha(r,s))})),n.withIndex(this.index_)}updatePriority(t,n){return t.isEmpty()?rt.EMPTY_NODE:t.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(t){this.indexedFilter_=new Bp(t.getIndex()),this.index_=t.getIndex(),this.startPost_=wc.getStartPost_(t),this.endPost_=wc.getEndPost_(t)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0}updateChild(t,n,i,r,s,o){return this.matches(new _t(n,i))||(i=rt.EMPTY_NODE),this.indexedFilter_.updateChild(t,n,i,r,s,o)}updateFullNode(t,n,i){n.isLeafNode()&&(n=rt.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(rt.EMPTY_NODE);const s=this;return n.forEachChild(an,(o,a)=>{s.matches(new _t(o,a))||(r=r.updateImmediateChild(o,rt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,i)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const n=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),n)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const n=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),n)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(t){this.rangedFilter_=new wc(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}updateChild(t,n,i,r,s,o){return this.rangedFilter_.matches(new _t(n,i))||(i=rt.EMPTY_NODE),t.getImmediateChild(n).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,n,i,r,s,o):this.fullLimitUpdateChild_(t,n,i,s,o)}updateFullNode(t,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=rt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=rt.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();let l;if(this.reverse_?l=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:l=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,l)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(rt.EMPTY_NODE);let s,o,a,l;if(this.reverse_){l=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const u=this.index_.getCompare();a=(f,m)=>u(m,f)}else l=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let c=0,d=!1;for(;l.hasNext();){const u=l.getNext();!d&&a(s,u)<=0&&(d=!0),d&&c<this.limit_&&a(u,o)<=0?c++:r=r.updateImmediateChild(u.name,rt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,i)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,i,r,s){let o;if(this.reverse_){const u=this.index_.getCompare();o=(f,m)=>u(m,f)}else o=this.index_.getCompare();const a=t;Ue(a.numChildren()===this.limit_,"");const l=new _t(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(n)){const u=a.getImmediateChild(n);let f=r.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);const m=f==null?1:o(f,l);if(d&&!i.isEmpty()&&m>=0)return s!=null&&s.trackChildChange(bc(n,i,u)),a.updateImmediateChild(n,i);{s!=null&&s.trackChildChange(yc(n,u));const R=a.updateImmediateChild(n,rt.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s!=null&&s.trackChildChange(Ha(f.name,f.node)),R.updateImmediateChild(f.name,f.node)):R}}else return i.isEmpty()?t:d&&o(c,l)>=0?(s!=null&&(s.trackChildChange(yc(c.name,c.node)),s.trackChildChange(Ha(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,rt.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=an}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ja}hasEnd(){return this.endSet_}getIndexEndValue(){return Ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Uo}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===an}copy(){const t=new Pp;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function FC(e){return e.loadsAllData()?new Bp(e.getIndex()):e.hasLimit()?new NC(e):new wc(e)}function vy(e){const t={};if(e.isDefault())return t;let n;return e.index_===an?n="$priority":e.index_===MC?n="$value":e.index_===Ca?n="$key":(Ue(e.index_ instanceof IC,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Cn(n),e.startSet_&&(t.startAt=Cn(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+Cn(e.indexStartName_))),e.endSet_&&(t.endAt=Cn(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+Cn(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function yy(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;n===""&&(e.isViewFromLeft()?n="l":n="r"),t.vf=n}return e.index_!==an&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh extends h4{constructor(t,n,i,r){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Qc("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return n!==void 0?"tag$"+n:(Ue(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,n,i,r){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=Hh.getListenId_(t,i),a={};this.listens_[o]=a;const l=vy(t._queryParams);this.restRequest_(s+".json",l,(c,d)=>{let u=d;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(s,u,!1,i),Pa(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",r(f,null)}})}unlisten(t,n){const i=Hh.getListenId_(t,n);delete this.listens_[i]}get(t){const n=vy(t._queryParams),i=t._path.toString(),r=new Pr;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(t){}restRequest_(t,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+xA(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=_c(a.responseText)}catch{wi("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&wi("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(){this.rootNode_=rt.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(){return{value:null,children:new Map}}function cl(e,t,n){if(gt(t))e.value=n,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,n);else{const i=pt(t);e.children.has(i)||e.children.set(i,Vh());const r=e.children.get(i);t=Wt(t),cl(r,t,n)}}function j1(e,t){if(gt(t))return e.value=null,e.children.clear(),!0;if(e.value!==null){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(an,(i,r)=>{cl(e,new Ut(i),r)}),j1(e,t)}}else if(e.children.size>0){const n=pt(t);return t=Wt(t),e.children.has(n)&&j1(e.children.get(n),t)&&e.children.delete(n),e.children.size===0}else return!0}function H1(e,t,n){e.value!==null?n(t,e.value):DC(e,(i,r)=>{const s=new Ut(t.toString()+"/"+i);H1(r,s,n)})}function DC(e,t){e.children.forEach((n,i)=>{t(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n=Object.assign({},t);return this.last_&&Wn(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by=10*1e3,PC=30*1e3,UC=5*60*1e3;class jC{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new BC(t);const i=by+(PC-by)*Math.random();Jl(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),n={};let i=!1;Wn(t,(r,s)=>{s>0&&Nr(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),Jl(this.reportStats_.bind(this),Math.floor(Math.random()*2*UC))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ar;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ar||(ar={}));function w4(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Up(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function jp(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(t,n,i){this.path=t,this.affectedTree=n,this.revert=i,this.type=ar.ACK_USER_WRITE,this.source=w4()}operationForChild(t){if(gt(this.path)){if(this.affectedTree.value!=null)return Ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ut(t));return new qh(Rt(),n,this.revert)}}else return Ue(pt(this.path)===t,"operationForChild called for unrelated child."),new qh(Wt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(t,n){this.source=t,this.path=n,this.type=ar.LISTEN_COMPLETE}operationForChild(t){return gt(this.path)?new Ec(this.source,Rt()):new Ec(this.source,Wt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(t,n,i){this.source=t,this.path=n,this.snap=i,this.type=ar.OVERWRITE}operationForChild(t){return gt(this.path)?new jo(this.source,Rt(),this.snap.getImmediateChild(t)):new jo(this.source,Wt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(t,n,i){this.source=t,this.path=n,this.children=i,this.type=ar.MERGE}operationForChild(t){if(gt(this.path)){const n=this.children.subtree(new Ut(t));return n.isEmpty()?null:n.value?new jo(this.source,Rt(),n.value):new Sc(this.source,Rt(),n)}else return Ue(pt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Sc(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(t,n,i){this.node_=t,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(gt(t))return this.isFullyInitialized()&&!this.filtered_;const n=pt(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function VC(e,t,n,i){const r=[],s=[];return t.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(OC(o.childName,o.snapshotNode))}),Il(e,r,"child_removed",t,i,n),Il(e,r,"child_added",t,i,n),Il(e,r,"child_moved",s,i,n),Il(e,r,"child_changed",t,i,n),Il(e,r,"value",t,i,n),r}function Il(e,t,n,i,r,s){const o=i.filter(a=>a.type===n);o.sort((a,l)=>zC(e,a,l)),o.forEach(a=>{const l=qC(e,a,s);r.forEach(c=>{c.respondsTo(a.type)&&t.push(c.createEvent(l,e.query_))})})}function qC(e,t,n){return t.type==="value"||t.type==="child_removed"||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function zC(e,t,n){if(t.childName==null||n.childName==null)throw ol("Should only compare child_ events.");const i=new _t(t.childName,t.snapshotNode),r=new _t(n.childName,n.snapshotNode);return e.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(e,t){return{eventCache:e,serverCache:t}}function ec(e,t,n,i){return Gd(new Ho(t,n,i),e.serverCache)}function E4(e,t,n,i){return Gd(e.eventCache,new Ho(t,n,i))}function V1(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Vo(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Em;const $C=()=>(Em||(Em=new bi(Ax)),Em);class Jt{constructor(t,n=$C()){this.value=t,this.children=n}static fromObject(t){let n=new Jt(null);return Wn(t,(i,r)=>{n=n.set(new Ut(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(this.value!=null&&n(this.value))return{path:Rt(),value:this.value};if(gt(t))return null;{const i=pt(t),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(Wt(t),n);return s!=null?{path:dn(new Ut(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(gt(t))return this;{const n=pt(t),i=this.children.get(n);return i!==null?i.subtree(Wt(t)):new Jt(null)}}set(t,n){if(gt(t))return new Jt(n,this.children);{const i=pt(t),s=(this.children.get(i)||new Jt(null)).set(Wt(t),n),o=this.children.insert(i,s);return new Jt(this.value,o)}}remove(t){if(gt(t))return this.children.isEmpty()?new Jt(null):new Jt(null,this.children);{const n=pt(t),i=this.children.get(n);if(i){const r=i.remove(Wt(t));let s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new Jt(null):new Jt(this.value,s)}else return this}}get(t){if(gt(t))return this.value;{const n=pt(t),i=this.children.get(n);return i?i.get(Wt(t)):null}}setTree(t,n){if(gt(t))return n;{const i=pt(t),s=(this.children.get(i)||new Jt(null)).setTree(Wt(t),n);let o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new Jt(this.value,o)}}fold(t){return this.fold_(Rt(),t)}fold_(t,n){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(dn(t,r),n)}),n(t,this.value,i)}findOnPath(t,n){return this.findOnPath_(t,Rt(),n)}findOnPath_(t,n,i){const r=this.value?i(n,this.value):!1;if(r)return r;if(gt(t))return null;{const s=pt(t),o=this.children.get(s);return o?o.findOnPath_(Wt(t),dn(n,s),i):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,Rt(),n)}foreachOnPath_(t,n,i){if(gt(t))return this;{this.value&&i(n,this.value);const r=pt(t),s=this.children.get(r);return s?s.foreachOnPath_(Wt(t),dn(n,r),i):new Jt(null)}}foreach(t){this.foreach_(Rt(),t)}foreach_(t,n){this.children.inorderTraversal((i,r)=>{r.foreach_(dn(t,i),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,i)=>{i.value&&t(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(t){this.writeTree_=t}static empty(){return new ur(new Jt(null))}}function tc(e,t,n){if(gt(t))return new ur(new Jt(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(i!=null){const r=i.path;let s=i.value;const o=yi(r,t);return s=s.updateChild(o,n),new ur(e.writeTree_.set(r,s))}else{const r=new Jt(n),s=e.writeTree_.setTree(t,r);return new ur(s)}}}function wy(e,t,n){let i=e;return Wn(n,(r,s)=>{i=tc(i,dn(t,r),s)}),i}function Ey(e,t){if(gt(t))return ur.empty();{const n=e.writeTree_.setTree(t,new Jt(null));return new ur(n)}}function q1(e,t){return Jo(e,t)!=null}function Jo(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return n!=null?e.writeTree_.get(n.path).getChild(yi(n.path,t)):null}function Sy(e){const t=[],n=e.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(an,(i,r)=>{t.push(new _t(i,r))}):e.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&t.push(new _t(i,r.value))}),t}function As(e,t){if(gt(t))return e;{const n=Jo(e,t);return n!=null?new ur(new Jt(n)):new ur(e.writeTree_.subtree(t))}}function z1(e){return e.writeTree_.isEmpty()}function Va(e,t){return S4(Rt(),e.writeTree_,t)}function S4(e,t,n){if(t.value!=null)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal((r,s)=>{r===".priority"?(Ue(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=S4(dn(e,r),s,n)}),!n.getChild(e).isEmpty()&&i!==null&&(n=n.updateChild(dn(e,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(e,t){return x4(t,e)}function WC(e,t,n,i,r){Ue(i>e.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=tc(e.visibleWrites,t,n)),e.lastWriteId=i}function KC(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}function GC(e,t){const n=e.allWrites.findIndex(a=>a.writeId===t);Ue(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const a=e.allWrites[o];a.visible&&(o>=n&&YC(a,i.path)?r=!1:Yi(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return XC(e),!0;if(i.snap)e.visibleWrites=Ey(e.visibleWrites,i.path);else{const a=i.children;Wn(a,l=>{e.visibleWrites=Ey(e.visibleWrites,dn(i.path,l))})}return!0}else return!1}function YC(e,t){if(e.snap)return Yi(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Yi(dn(e.path,n),t))return!0;return!1}function XC(e){e.visibleWrites=T4(e.allWrites,QC,Rt()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function QC(e){return e.visible}function T4(e,t,n){let i=ur.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const o=s.path;let a;if(s.snap)Yi(n,o)?(a=yi(n,o),i=tc(i,a,s.snap)):Yi(o,n)&&(a=yi(o,n),i=tc(i,Rt(),s.snap.getChild(a)));else if(s.children){if(Yi(n,o))a=yi(n,o),i=wy(i,a,s.children);else if(Yi(o,n))if(a=yi(o,n),gt(a))i=wy(i,Rt(),s.children);else{const l=Pa(s.children,pt(a));if(l){const c=l.getChild(Wt(a));i=tc(i,Rt(),c)}}}else throw ol("WriteRecord should have .snap or .children")}}return i}function k4(e,t,n,i,r){if(!i&&!r){const s=Jo(e.visibleWrites,t);if(s!=null)return s;{const o=As(e.visibleWrites,t);if(z1(o))return n;if(n==null&&!q1(o,Rt()))return null;{const a=n||rt.EMPTY_NODE;return Va(o,a)}}}else{const s=As(e.visibleWrites,t);if(!r&&z1(s))return n;if(!r&&n==null&&!q1(s,Rt()))return null;{const o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(Yi(c.path,t)||Yi(t,c.path))},a=T4(e.allWrites,o,t),l=n||rt.EMPTY_NODE;return Va(a,l)}}}function ZC(e,t,n){let i=rt.EMPTY_NODE;const r=Jo(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(an,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){const s=As(e.visibleWrites,t);return n.forEachChild(an,(o,a)=>{const l=Va(As(s,new Ut(o)),a);i=i.updateImmediateChild(o,l)}),Sy(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const s=As(e.visibleWrites,t);return Sy(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function JC(e,t,n,i,r){Ue(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=dn(t,n);if(q1(e.visibleWrites,s))return null;{const o=As(e.visibleWrites,s);return z1(o)?r.getChild(n):Va(o,r.getChild(n))}}function eI(e,t,n,i){const r=dn(t,n),s=Jo(e.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){const o=As(e.visibleWrites,r);return Va(o,i.getNode().getImmediateChild(n))}else return null}function tI(e,t){return Jo(e.visibleWrites,t)}function nI(e,t,n,i,r,s,o){let a;const l=As(e.visibleWrites,t),c=Jo(l,Rt());if(c!=null)a=c;else if(n!=null)a=Va(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],u=o.getCompare(),f=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let m=f.getNext();for(;m&&d.length<r;)u(m,i)!==0&&d.push(m),m=f.getNext();return d}else return[]}function iI(){return{visibleWrites:ur.empty(),allWrites:[],lastWriteId:-1}}function zh(e,t,n,i){return k4(e.writeTree,e.treePath,t,n,i)}function Vp(e,t){return ZC(e.writeTree,e.treePath,t)}function Ty(e,t,n,i){return JC(e.writeTree,e.treePath,t,n,i)}function $h(e,t){return tI(e.writeTree,dn(e.treePath,t))}function rI(e,t,n,i,r,s){return nI(e.writeTree,e.treePath,t,n,i,r,s)}function qp(e,t,n){return eI(e.writeTree,e.treePath,t,n)}function A4(e,t){return x4(dn(e.treePath,t),e.writeTree)}function x4(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,i=t.childName;Ue(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Ue(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,bc(i,t.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,yc(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Ha(i,t.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,bc(i,t.snapshotNode,r.oldSnap));else throw ol("Illegal combination of changes: "+t+" occurred after "+r)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{getCompleteChild(t){return null}getChildAfterChild(t,n,i){return null}}const C4=new oI;class zp{constructor(t,n,i=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Ho(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return qp(this.writes_,t,i)}}getChildAfterChild(t,n,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Vo(this.viewCache_),s=rI(this.writes_,r,n,1,i,t);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(e){return{filter:e}}function lI(e,t){Ue(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),Ue(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function cI(e,t,n,i,r){const s=new sI;let o,a;if(n.type===ar.OVERWRITE){const c=n;c.source.fromUser?o=$1(e,t,c.path,c.snap,i,r,s):(Ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!gt(c.path),o=Wh(e,t,c.path,c.snap,i,r,a,s))}else if(n.type===ar.MERGE){const c=n;c.source.fromUser?o=hI(e,t,c.path,c.children,i,r,s):(Ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=W1(e,t,c.path,c.children,i,r,a,s))}else if(n.type===ar.ACK_USER_WRITE){const c=n;c.revert?o=mI(e,t,c.path,i,r,s):o=dI(e,t,c.path,c.affectedTree,i,r,s)}else if(n.type===ar.LISTEN_COMPLETE)o=fI(e,t,n.path,i,s);else throw ol("Unknown operation type: "+n.type);const l=s.getChanges();return uI(t,o,l),{viewCache:o,changes:l}}function uI(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=V1(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(b4(V1(t)))}}function I4(e,t,n,i,r,s){const o=t.eventCache;if($h(i,n)!=null)return t;{let a,l;if(gt(n))if(Ue(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=Vo(t),d=c instanceof rt?c:rt.EMPTY_NODE,u=Vp(i,d);a=e.filter.updateFullNode(t.eventCache.getNode(),u,s)}else{const c=zh(i,Vo(t));a=e.filter.updateFullNode(t.eventCache.getNode(),c,s)}else{const c=pt(n);if(c===".priority"){Ue(Fs(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=t.serverCache.getNode();const u=Ty(i,n,d,l);u!=null?a=e.filter.updatePriority(d,u):a=o.getNode()}else{const d=Wt(n);let u;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const f=Ty(i,n,o.getNode(),l);f!=null?u=o.getNode().getImmediateChild(c).updateChild(d,f):u=o.getNode().getImmediateChild(c)}else u=qp(i,c,t.serverCache);u!=null?a=e.filter.updateChild(o.getNode(),c,u,d,r,s):a=o.getNode()}}return ec(t,a,o.isFullyInitialized()||gt(n),e.filter.filtersNodes())}}function Wh(e,t,n,i,r,s,o,a){const l=t.serverCache;let c;const d=o?e.filter:e.filter.getIndexedFilter();if(gt(n))c=d.updateFullNode(l.getNode(),i,null);else if(d.filtersNodes()&&!l.isFiltered()){const m=l.getNode().updateChild(n,i);c=d.updateFullNode(l.getNode(),m,null)}else{const m=pt(n);if(!l.isCompleteForPath(n)&&Fs(n)>1)return t;const h=Wt(n),M=l.getNode().getImmediateChild(m).updateChild(h,i);m===".priority"?c=d.updatePriority(l.getNode(),M):c=d.updateChild(l.getNode(),m,M,h,C4,null)}const u=E4(t,c,l.isFullyInitialized()||gt(n),d.filtersNodes()),f=new zp(r,u,s);return I4(e,u,n,r,f,a)}function $1(e,t,n,i,r,s,o){const a=t.eventCache;let l,c;const d=new zp(r,t,s);if(gt(n))c=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=ec(t,c,!0,e.filter.filtersNodes());else{const u=pt(n);if(u===".priority")c=e.filter.updatePriority(t.eventCache.getNode(),i),l=ec(t,c,a.isFullyInitialized(),a.isFiltered());else{const f=Wt(n),m=a.getNode().getImmediateChild(u);let h;if(gt(f))h=i;else{const R=d.getCompleteChild(u);R!=null?Np(f)===".priority"&&R.getChild(f4(f)).isEmpty()?h=R:h=R.updateChild(f,i):h=rt.EMPTY_NODE}if(m.equals(h))l=t;else{const R=e.filter.updateChild(a.getNode(),u,h,f,d,o);l=ec(t,R,a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function ky(e,t){return e.eventCache.isCompleteForChild(t)}function hI(e,t,n,i,r,s,o){let a=t;return i.foreach((l,c)=>{const d=dn(n,l);ky(t,pt(d))&&(a=$1(e,a,d,c,r,s,o))}),i.foreach((l,c)=>{const d=dn(n,l);ky(t,pt(d))||(a=$1(e,a,d,c,r,s,o))}),a}function Ay(e,t,n){return n.foreach((i,r)=>{t=t.updateChild(i,r)}),t}function W1(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l=t,c;gt(n)?c=i:c=new Jt(null).setTree(n,i);const d=t.serverCache.getNode();return c.children.inorderTraversal((u,f)=>{if(d.hasChild(u)){const m=t.serverCache.getNode().getImmediateChild(u),h=Ay(e,m,f);l=Wh(e,l,new Ut(u),h,r,s,o,a)}}),c.children.inorderTraversal((u,f)=>{const m=!t.serverCache.isCompleteForChild(u)&&f.value===void 0;if(!d.hasChild(u)&&!m){const h=t.serverCache.getNode().getImmediateChild(u),R=Ay(e,h,f);l=Wh(e,l,new Ut(u),R,r,s,o,a)}}),l}function dI(e,t,n,i,r,s,o){if($h(r,n)!=null)return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(i.value!=null){if(gt(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Wh(e,t,n,l.getNode().getChild(n),r,s,a,o);if(gt(n)){let c=new Jt(null);return l.getNode().forEachChild(Ca,(d,u)=>{c=c.set(new Ut(d),u)}),W1(e,t,n,c,r,s,a,o)}else return t}else{let c=new Jt(null);return i.foreach((d,u)=>{const f=dn(n,d);l.isCompleteForPath(f)&&(c=c.set(d,l.getNode().getChild(f)))}),W1(e,t,n,c,r,s,a,o)}}function fI(e,t,n,i,r){const s=t.serverCache,o=E4(t,s.getNode(),s.isFullyInitialized()||gt(n),s.isFiltered());return I4(e,o,n,i,C4,r)}function mI(e,t,n,i,r,s){let o;if($h(i,n)!=null)return t;{const a=new zp(i,t,r),l=t.eventCache.getNode();let c;if(gt(n)||pt(n)===".priority"){let d;if(t.serverCache.isFullyInitialized())d=zh(i,Vo(t));else{const u=t.serverCache.getNode();Ue(u instanceof rt,"serverChildren would be complete if leaf node"),d=Vp(i,u)}d=d,c=e.filter.updateFullNode(l,d,s)}else{const d=pt(n);let u=qp(i,d,t.serverCache);u==null&&t.serverCache.isCompleteForChild(d)&&(u=l.getImmediateChild(d)),u!=null?c=e.filter.updateChild(l,d,u,Wt(n),a,s):t.eventCache.getNode().hasChild(d)?c=e.filter.updateChild(l,d,rt.EMPTY_NODE,Wt(n),a,s):c=l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=zh(i,Vo(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||$h(i,Rt())!=null,ec(t,c,o,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(t,n){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new Bp(i.getIndex()),s=FC(i);this.processor_=aI(s);const o=n.serverCache,a=n.eventCache,l=r.updateFullNode(rt.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(rt.EMPTY_NODE,a.getNode(),null),d=new Ho(l,o.isFullyInitialized(),r.filtersNodes()),u=new Ho(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Gd(u,d),this.eventGenerator_=new HC(this.query_)}get query(){return this.query_}}function gI(e){return e.viewCache_.serverCache.getNode()}function _I(e,t){const n=Vo(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!gt(t)&&!n.getImmediateChild(pt(t)).isEmpty())?n.getChild(t):null}function xy(e){return e.eventRegistrations_.length===0}function vI(e,t){e.eventRegistrations_.push(t)}function Cy(e,t,n){const i=[];if(n){Ue(t==null,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,r);o&&i.push(o)})}if(t){let r=[];for(let s=0;s<e.eventRegistrations_.length;++s){const o=e.eventRegistrations_[s];if(!o.matches(t))r.push(o);else if(t.hasAnyCallback()){r=r.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=r}else e.eventRegistrations_=[];return i}function Iy(e,t,n,i){t.type===ar.MERGE&&t.source.queryId!==null&&(Ue(Vo(e.viewCache_),"We should always have a full cache before handling merges"),Ue(V1(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=cI(e.processor_,r,t,n,i);return lI(e.processor_,s.viewCache),Ue(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,R4(e,s.changes,s.viewCache.eventCache.getNode(),null)}function yI(e,t){const n=e.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(an,(s,o)=>{i.push(Ha(s,o))}),n.isFullyInitialized()&&i.push(b4(n.getNode())),R4(e,i,n.getNode(),t)}function R4(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return VC(e.eventGenerator_,t,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kh;class bI{constructor(){this.views=new Map}}function wI(e){Ue(!Kh,"__referenceConstructor has already been defined"),Kh=e}function EI(){return Ue(Kh,"Reference.ts has not been loaded"),Kh}function SI(e){return e.views.size===0}function $p(e,t,n,i){const r=t.source.queryId;if(r!==null){const s=e.views.get(r);return Ue(s!=null,"SyncTree gave us an op for an invalid query."),Iy(s,t,n,i)}else{let s=[];for(const o of e.views.values())s=s.concat(Iy(o,t,n,i));return s}}function TI(e,t,n,i,r){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let a=zh(n,r?i:null),l=!1;a?l=!0:i instanceof rt?(a=Vp(n,i),l=!1):(a=rt.EMPTY_NODE,l=!1);const c=Gd(new Ho(a,l,!1),new Ho(i,r,!1));return new pI(t,c)}return o}function kI(e,t,n,i,r,s){const o=TI(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),vI(o,n),yI(o,n)}function AI(e,t,n,i){const r=t._queryIdentifier,s=[];let o=[];const a=Ls(e);if(r==="default")for(const[l,c]of e.views.entries())o=o.concat(Cy(c,n,i)),xy(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=e.views.get(r);l&&(o=o.concat(Cy(l,n,i)),xy(l)&&(e.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Ls(e)&&s.push(new(EI())(t._repo,t._path)),{removed:s,events:o}}function M4(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ia(e,t){let n=null;for(const i of e.views.values())n=n||_I(i,t);return n}function O4(e,t){if(t._queryParams.loadsAllData())return Yd(e);{const i=t._queryIdentifier;return e.views.get(i)}}function N4(e,t){return O4(e,t)!=null}function Ls(e){return Yd(e)!=null}function Yd(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gh;function xI(e){Ue(!Gh,"__referenceConstructor has already been defined"),Gh=e}function CI(){return Ue(Gh,"Reference.ts has not been loaded"),Gh}let II=1;class Ry{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Jt(null),this.pendingWriteTree_=iI(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function F4(e,t,n,i,r){return WC(e.pendingWriteTree_,t,n,i,r),r?Jc(e,new jo(w4(),t,n)):[]}function So(e,t,n=!1){const i=KC(e.pendingWriteTree_,t);if(GC(e.pendingWriteTree_,t)){let s=new Jt(null);return i.snap!=null?s=s.set(Rt(),!0):Wn(i.children,o=>{s=s.set(new Ut(o),!0)}),Jc(e,new qh(i.path,s,n))}else return[]}function Xd(e,t,n){return Jc(e,new jo(Up(),t,n))}function RI(e,t,n){const i=Jt.fromObject(n);return Jc(e,new Sc(Up(),t,i))}function MI(e,t){return Jc(e,new Ec(Up(),t))}function OI(e,t,n){const i=Kp(e,n);if(i){const r=Gp(i),s=r.path,o=r.queryId,a=yi(s,t),l=new Ec(jp(o),a);return Yp(e,s,l)}else return[]}function K1(e,t,n,i){const r=t._path,s=e.syncPointTree_.get(r);let o=[];if(s&&(t._queryIdentifier==="default"||N4(s,t))){const a=AI(s,t,n,i);SI(s)&&(e.syncPointTree_=e.syncPointTree_.remove(r));const l=a.removed;o=a.events;const c=l.findIndex(u=>u._queryParams.loadsAllData())!==-1,d=e.syncPointTree_.findOnPath(r,(u,f)=>Ls(f));if(c&&!d){const u=e.syncPointTree_.subtree(r);if(!u.isEmpty()){const f=LI(u);for(let m=0;m<f.length;++m){const h=f[m],R=h.query,M=B4(e,h);e.listenProvider_.startListening(nc(R),Yh(e,R),M.hashFn,M.onComplete)}}}!d&&l.length>0&&!i&&(c?e.listenProvider_.stopListening(nc(t),null):l.forEach(u=>{const f=e.queryToTagMap.get(Qd(u));e.listenProvider_.stopListening(nc(u),f)})),DI(e,l)}return o}function NI(e,t,n,i){const r=Kp(e,i);if(r!=null){const s=Gp(r),o=s.path,a=s.queryId,l=yi(o,t),c=new jo(jp(a),l,n);return Yp(e,o,c)}else return[]}function FI(e,t,n,i){const r=Kp(e,i);if(r){const s=Gp(r),o=s.path,a=s.queryId,l=yi(o,t),c=Jt.fromObject(n),d=new Sc(jp(a),l,c);return Yp(e,o,d)}else return[]}function My(e,t,n){const i=t._path;let r=null,s=!1;e.syncPointTree_.foreachOnPath(i,(u,f)=>{const m=yi(u,i);r=r||Ia(f,m),s=s||Ls(f)});let o=e.syncPointTree_.get(i);o?(s=s||Ls(o),r=r||Ia(o,Rt())):(o=new bI,e.syncPointTree_=e.syncPointTree_.set(i,o));let a;r!=null?a=!0:(a=!1,r=rt.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((f,m)=>{const h=Ia(m,Rt());h&&(r=r.updateImmediateChild(f,h))}));const l=N4(o,t);if(!l&&!t._queryParams.loadsAllData()){const u=Qd(t);Ue(!e.queryToTagMap.has(u),"View does not exist, but we have a tag");const f=BI();e.queryToTagMap.set(u,f),e.tagToQueryMap.set(f,u)}const c=Hp(e.pendingWriteTree_,i);let d=kI(o,t,n,c,r,a);if(!l&&!s){const u=O4(o,t);d=d.concat(PI(e,t,u))}return d}function Wp(e,t,n){const r=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(o,a)=>{const l=yi(o,t),c=Ia(a,l);if(c)return c});return k4(r,t,s,n,!0)}function Jc(e,t){return L4(t,e.syncPointTree_,null,Hp(e.pendingWriteTree_,Rt()))}function L4(e,t,n,i){if(gt(e.path))return D4(e,t,n,i);{const r=t.get(Rt());n==null&&r!=null&&(n=Ia(r,Rt()));let s=[];const o=pt(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,d=A4(i,o);s=s.concat(L4(a,l,c,d))}return r&&(s=s.concat($p(r,e,i,n))),s}}function D4(e,t,n,i){const r=t.get(Rt());n==null&&r!=null&&(n=Ia(r,Rt()));let s=[];return t.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=A4(i,o),d=e.operationForChild(o);d&&(s=s.concat(D4(d,a,l,c)))}),r&&(s=s.concat($p(r,e,i,n))),s}function B4(e,t){const n=t.query,i=Yh(e,n);return{hashFn:()=>(gI(t)||rt.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?OI(e,n._path,i):MI(e,n._path);{const s=Ix(r,n);return K1(e,n,null,s)}}}}function Yh(e,t){const n=Qd(t);return e.queryToTagMap.get(n)}function Qd(e){return e._path.toString()+"$"+e._queryIdentifier}function Kp(e,t){return e.tagToQueryMap.get(t)}function Gp(e){const t=e.indexOf("$");return Ue(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ut(e.substr(0,t))}}function Yp(e,t,n){const i=e.syncPointTree_.get(t);Ue(i,"Missing sync point for query tag that we're tracking");const r=Hp(e.pendingWriteTree_,t);return $p(i,n,r,null)}function LI(e){return e.fold((t,n,i)=>{if(n&&Ls(n))return[Yd(n)];{let r=[];return n&&(r=M4(n)),Wn(i,(s,o)=>{r=r.concat(o)}),r}})}function nc(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(CI())(e._repo,e._path):e}function DI(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const r=Qd(i),s=e.queryToTagMap.get(r);e.queryToTagMap.delete(r),e.tagToQueryMap.delete(s)}}}function BI(){return II++}function PI(e,t,n){const i=t._path,r=Yh(e,t),s=B4(e,n),o=e.listenProvider_.startListening(nc(t),r,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(i);if(r)Ue(!Ls(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,d,u)=>{if(!gt(c)&&d&&Ls(d))return[Yd(d).query];{let f=[];return d&&(f=f.concat(M4(d).map(m=>m.query))),Wn(u,(m,h)=>{f=f.concat(h)}),f}});for(let c=0;c<l.length;++c){const d=l[c];e.listenProvider_.stopListening(nc(d),Yh(e,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new Xp(n)}node(){return this.node_}}class Qp{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=dn(this.path_,t);return new Qp(this.syncTree_,n)}node(){return Wp(this.syncTree_,this.path_)}}const UI=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},Oy=function(e,t,n){if(!e||typeof e!="object")return e;if(Ue(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return jI(e[".sv"],t,n);if(typeof e[".sv"]=="object")return HI(e[".sv"],t);Ue(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},jI=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Ue(!1,"Unexpected server value: "+e)}},HI=function(e,t,n){e.hasOwnProperty("increment")||Ue(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;typeof i!="number"&&Ue(!1,"Unexpected increment value: "+i);const r=t.node();if(Ue(r!==null&&typeof r!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return typeof o!="number"?i:o+i},VI=function(e,t,n,i){return Zp(t,new Qp(n,e),i)},P4=function(e,t,n){return Zp(e,new Xp(t),n)};function Zp(e,t,n){const i=e.getPriority().val(),r=Oy(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const o=e,a=Oy(o.getValue(),t,n);return a!==o.getValue()||r!==o.getPriority().val()?new Sn(a,yn(r)):e}else{const o=e;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new Sn(r))),o.forEachChild(an,(a,l)=>{const c=Zp(l,t.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(t="",n=null,i={children:{},childCount:0}){this.name=t,this.parent=n,this.node=i}}function eg(e,t){let n=t instanceof Ut?t:new Ut(t),i=e,r=pt(n);for(;r!==null;){const s=Pa(i.node.children,r)||{children:{},childCount:0};i=new Jp(r,i,s),n=Wt(n),r=pt(n)}return i}function ul(e){return e.node.value}function U4(e,t){e.node.value=t,G1(e)}function j4(e){return e.node.childCount>0}function qI(e){return ul(e)===void 0&&!j4(e)}function Zd(e,t){Wn(e.node.children,(n,i)=>{t(new Jp(n,e,i))})}function H4(e,t,n,i){n&&!i&&t(e),Zd(e,r=>{H4(r,t,!0,i)}),n&&i&&t(e)}function zI(e,t,n){let i=n?e:e.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function eu(e){return new Ut(e.parent===null?e.name:eu(e.parent)+"/"+e.name)}function G1(e){e.parent!==null&&$I(e.parent,e.name,e)}function $I(e,t,n){const i=qI(n),r=Nr(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,G1(e)):!i&&!r&&(e.node.children[t]=n.node,e.node.childCount++,G1(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=/[\[\].#$\/\u0000-\u001F\u007F]/,KI=/[\[\].#$\u0000-\u001F\u007F]/,Sm=10*1024*1024,tg=function(e){return typeof e=="string"&&e.length!==0&&!WI.test(e)},V4=function(e){return typeof e=="string"&&e.length!==0&&!KI.test(e)},GI=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),V4(e)},q4=function(e){return e===null||typeof e=="string"||typeof e=="number"&&!Wd(e)||e&&typeof e=="object"&&Nr(e,".sv")},Y1=function(e,t,n,i){i&&t===void 0||Jd(Ua(e,"value"),t,n)},Jd=function(e,t,n){const i=n instanceof Ut?new hC(n,e):n;if(t===void 0)throw new Error(e+"contains undefined "+co(i));if(typeof t=="function")throw new Error(e+"contains a function "+co(i)+" with contents = "+t.toString());if(Wd(t))throw new Error(e+"contains "+t.toString()+" "+co(i));if(typeof t=="string"&&t.length>Sm/3&&$d(t)>Sm)throw new Error(e+"contains a string greater than "+Sm+" utf8 bytes "+co(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let r=!1,s=!1;if(Wn(t,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!tg(o)))throw new Error(e+" contains an invalid key ("+o+") "+co(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);dC(i,o),Jd(e,a,i),fC(i)}),r&&s)throw new Error(e+' contains ".value" child '+co(i)+" in addition to actual children.")}},YI=function(e,t){let n,i;for(n=0;n<t.length;n++){i=t[n];const s=vc(i);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!tg(s[o]))throw new Error(e+"contains an invalid key ("+s[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}t.sort(uC);let r=null;for(n=0;n<t.length;n++){if(i=t[n],r!==null&&Yi(r,i))throw new Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},XI=function(e,t,n,i){if(i&&t===void 0)return;const r=Ua(e,"values");if(!(t&&typeof t=="object")||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const s=[];Wn(t,(o,a)=>{const l=new Ut(o);if(Jd(r,a,dn(n,l)),Np(l)===".priority"&&!q4(a))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),YI(r,s)},QI=function(e,t,n){if(!(n&&t===void 0)){if(Wd(t))throw new Error(Ua(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!q4(t))throw new Error(Ua(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},z4=function(e,t,n,i){if(!(i&&n===void 0)&&!V4(n))throw new Error(Ua(e,t)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},ZI=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),z4(e,t,n,i)},jl=function(e,t){if(pt(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},JI=function(e,t){const n=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!tg(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!GI(n))throw new Error(Ua(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ng(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();n!==null&&!Fp(s,n.path)&&(e.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function $4(e,t,n){ng(e,n),W4(e,i=>Fp(i,t))}function Qr(e,t,n){ng(e,n),W4(e,i=>Yi(i,t)||Yi(t,i))}function W4(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){const s=r.path;t(s)?(tR(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function tR(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(n!==null){e.events[t]=null;const i=n.getEventRunner();Mo&&On("event: "+n.toString()),ll(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR="repo_interrupt",iR=25;class rR{constructor(t,n,i,r){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new eR,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Vh(),this.transactionQueueTree_=new Jp,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function sR(e,t,n){if(e.stats_=Rp(e.repoInfo_),e.forceRestClient_||Nx())e.server_=new Hh(e.repoInfo_,(i,r,s,o)=>{Ny(e,i,r,s,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Fy(e,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Cn(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}e.persistentConnection_=new zr(e.repoInfo_,t,(i,r,s,o)=>{Ny(e,i,r,s,o)},i=>{Fy(e,i)},i=>{aR(e,i)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(i=>{e.server_.refreshAuthToken(i)}),e.appCheckProvider_.addTokenChangeListener(i=>{e.server_.refreshAppCheckToken(i.token)}),e.statsReporter_=jx(e.repoInfo_,()=>new jC(e.stats_,e.server_)),e.infoData_=new LC,e.infoSyncTree_=new Ry({startListening:(i,r,s,o)=>{let a=[];const l=e.infoData_.getNode(i._path);return l.isEmpty()||(a=Xd(e.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),rg(e,"connected",!1),e.serverSyncTree_=new Ry({startListening:(i,r,s,o)=>(e.server_.listen(i,s,r,(a,l)=>{const c=o(a,l);Qr(e.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{e.server_.unlisten(i,r)}})}function oR(e){const n=e.infoData_.getNode(new Ut(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ig(e){return UI({timestamp:oR(e)})}function Ny(e,t,n,i,r){e.dataUpdateCount++;const s=new Ut(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const l=Lh(n,c=>yn(c));o=FI(e.serverSyncTree_,s,l,r)}else{const l=yn(n);o=NI(e.serverSyncTree_,s,l,r)}else if(i){const l=Lh(n,c=>yn(c));o=RI(e.serverSyncTree_,s,l)}else{const l=yn(n);o=Xd(e.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=ef(e,s)),Qr(e.eventQueue_,a,o)}function Fy(e,t){rg(e,"connected",t),t===!1&&cR(e)}function aR(e,t){Wn(t,(n,i)=>{rg(e,n,i)})}function rg(e,t,n){const i=new Ut("/.info/"+t),r=yn(n);e.infoData_.updateSnapshot(i,r);const s=Xd(e.infoSyncTree_,i,r);Qr(e.eventQueue_,i,s)}function K4(e){return e.nextWriteId_++}function lR(e,t,n,i,r){sg(e,"set",{path:t.toString(),value:n,priority:i});const s=ig(e),o=yn(n,i),a=Wp(e.serverSyncTree_,t),l=P4(o,a,s),c=K4(e),d=F4(e.serverSyncTree_,t,l,c,!0);ng(e.eventQueue_,d),e.server_.put(t.toString(),o.val(!0),(f,m)=>{const h=f==="ok";h||wi("set at "+t+" failed: "+f);const R=So(e.serverSyncTree_,c,!h);Qr(e.eventQueue_,t,R),qa(e,r,f,m)});const u=Z4(e,t);ef(e,u),Qr(e.eventQueue_,u,[])}function cR(e){sg(e,"onDisconnectEvents");const t=ig(e),n=Vh();H1(e.onDisconnect_,Rt(),(r,s)=>{const o=VI(r,s,e.serverSyncTree_,t);cl(n,r,o)});let i=[];H1(n,Rt(),(r,s)=>{i=i.concat(Xd(e.serverSyncTree_,r,s));const o=Z4(e,r);ef(e,o)}),e.onDisconnect_=Vh(),Qr(e.eventQueue_,Rt(),i)}function uR(e,t,n){e.server_.onDisconnectCancel(t.toString(),(i,r)=>{i==="ok"&&j1(e.onDisconnect_,t),qa(e,n,i,r)})}function Ly(e,t,n,i){const r=yn(n);e.server_.onDisconnectPut(t.toString(),r.val(!0),(s,o)=>{s==="ok"&&cl(e.onDisconnect_,t,r),qa(e,i,s,o)})}function hR(e,t,n,i,r){const s=yn(n,i);e.server_.onDisconnectPut(t.toString(),s.val(!0),(o,a)=>{o==="ok"&&cl(e.onDisconnect_,t,s),qa(e,r,o,a)})}function dR(e,t,n,i){if(M1(n)){On("onDisconnect().update() called with empty data.  Don't do anything."),qa(e,i,"ok",void 0);return}e.server_.onDisconnectMerge(t.toString(),n,(r,s)=>{r==="ok"&&Wn(n,(o,a)=>{const l=yn(a);cl(e.onDisconnect_,dn(t,o),l)}),qa(e,i,r,s)})}function fR(e,t,n){let i;pt(t._path)===".info"?i=My(e.infoSyncTree_,t,n):i=My(e.serverSyncTree_,t,n),$4(e.eventQueue_,t._path,i)}function Dy(e,t,n){let i;pt(t._path)===".info"?i=K1(e.infoSyncTree_,t,n):i=K1(e.serverSyncTree_,t,n),$4(e.eventQueue_,t._path,i)}function mR(e){e.persistentConnection_&&e.persistentConnection_.interrupt(nR)}function sg(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),On(n,...t)}function qa(e,t,n,i){t&&ll(()=>{if(n==="ok")t(null);else{const r=(n||"error").toUpperCase();let s=r;i&&(s+=": "+i);const o=new Error(s);o.code=r,t(o)}})}function G4(e,t,n){return Wp(e.serverSyncTree_,t,n)||rt.EMPTY_NODE}function og(e,t=e.transactionQueueTree_){if(t||tf(e,t),ul(t)){const n=X4(e,t);Ue(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&pR(e,eu(t),n)}else j4(t)&&Zd(t,n=>{og(e,n)})}function pR(e,t,n){const i=n.map(c=>c.currentWriteId),r=G4(e,t,i);let s=r;const o=r.hash();for(let c=0;c<n.length;c++){const d=n[c];Ue(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const u=yi(t,d.path);s=s.updateChild(u,d.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,c=>{sg(e,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){const u=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(So(e.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&u.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();tf(e,eg(e.transactionQueueTree_,t)),og(e,e.transactionQueueTree_),Qr(e.eventQueue_,t,d);for(let f=0;f<u.length;f++)ll(u[f])}else{if(c==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{wi("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=c}ef(e,t)}},o)}function ef(e,t){const n=Y4(e,t),i=eu(n),r=X4(e,n);return gR(e,r,i),i}function gR(e,t,n){if(t.length===0)return;const i=[];let r=[];const o=t.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const l=t[a],c=yi(n,l.path);let d=!1,u;if(Ue(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,u=l.abortReason,r=r.concat(So(e.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=iR)d=!0,u="maxretry",r=r.concat(So(e.serverSyncTree_,l.currentWriteId,!0));else{const f=G4(e,l.path,o);l.currentInputSnapshot=f;const m=t[a].update(f.val());if(m!==void 0){Jd("transaction failed: Data returned ",m,l.path);let h=yn(m);typeof m=="object"&&m!=null&&Nr(m,".priority")||(h=h.updatePriority(f.getPriority()));const M=l.currentWriteId,C=ig(e),_=P4(h,f,C);l.currentOutputSnapshotRaw=h,l.currentOutputSnapshotResolved=_,l.currentWriteId=K4(e),o.splice(o.indexOf(M),1),r=r.concat(F4(e.serverSyncTree_,l.path,_,l.currentWriteId,l.applyLocally)),r=r.concat(So(e.serverSyncTree_,M,!0))}else d=!0,u="nodata",r=r.concat(So(e.serverSyncTree_,l.currentWriteId,!0))}Qr(e.eventQueue_,n,r),r=[],d&&(t[a].status=2,function(f){setTimeout(f,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&(u==="nodata"?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(u),!1,null))))}tf(e,e.transactionQueueTree_);for(let a=0;a<i.length;a++)ll(i[a]);og(e,e.transactionQueueTree_)}function Y4(e,t){let n,i=e.transactionQueueTree_;for(n=pt(t);n!==null&&ul(i)===void 0;)i=eg(i,n),t=Wt(t),n=pt(t);return i}function X4(e,t){const n=[];return Q4(e,t,n),n.sort((i,r)=>i.order-r.order),n}function Q4(e,t,n){const i=ul(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Zd(t,r=>{Q4(e,r,n)})}function tf(e,t){const n=ul(t);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,U4(t,n.length>0?n:void 0)}Zd(t,i=>{tf(e,i)})}function Z4(e,t){const n=eu(Y4(e,t)),i=eg(e.transactionQueueTree_,t);return zI(i,r=>{Tm(e,r)}),Tm(e,i),H4(i,r=>{Tm(e,r)}),n}function Tm(e,t){const n=ul(t);if(n){const i=[];let r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(Ue(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(Ue(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(So(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?U4(t,void 0):n.length=s+1,Qr(e.eventQueue_,eu(t),r);for(let o=0;o<i.length;o++)ll(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}t+="/"+r}return t}function vR(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const n of e.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):wi(`Invalid query segment '${n}' in query '${e}'`)}return t}const By=function(e,t){const n=yR(e),i=n.namespace;n.domain==="firebase.com"&&Po(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Po("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Tx();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Bx(n.host,n.secure,i,t,r,"",i!==n.subdomain),path:new Ut(n.pathString)}},yR=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof e=="string"){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let d=e.indexOf("/");d===-1&&(d=e.length);let u=e.indexOf("?");u===-1&&(u=e.length),t=e.substring(0,Math.min(d,u)),d<u&&(r=_R(e.substring(d,u)));const f=vR(e.substring(Math.min(e.length,u)));c=t.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(t.substring(c+1),10)):c=t.length;const m=t.slice(0,c);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const h=t.indexOf(".");i=t.substring(0,h).toLowerCase(),n=t.substring(h+1),s=i}"ns"in f&&(s=f.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(t,n,i,r){this.eventType=t,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Cn(this.snapshot.exportVal())}}class e5{constructor(t,n,i){this.eventRegistration=t,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(t,n){this.snapshotCallback=t,this.cancelCallback=n}onValue(t,n){this.snapshotCallback.call(null,t,n)}onCancel(t){return Ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(t,n){this._repo=t,this._path=n}cancel(){const t=new Pr;return uR(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){jl("OnDisconnect.remove",this._path);const t=new Pr;return Ly(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){jl("OnDisconnect.set",this._path),Y1("OnDisconnect.set",t,this._path,!1);const n=new Pr;return Ly(this._repo,this._path,t,n.wrapCallback(()=>{})),n.promise}setWithPriority(t,n){jl("OnDisconnect.setWithPriority",this._path),Y1("OnDisconnect.setWithPriority",t,this._path,!1),QI("OnDisconnect.setWithPriority",n,!1);const i=new Pr;return hR(this._repo,this._path,t,n,i.wrapCallback(()=>{})),i.promise}update(t){jl("OnDisconnect.update",this._path),XI("OnDisconnect.update",t,this._path,!1);const n=new Pr;return dR(this._repo,this._path,t,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(t,n,i,r){this._repo=t,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return gt(this._path)?null:Np(this._path)}get ref(){return new ss(this._repo,this._path)}get _queryIdentifier(){const t=yy(this._queryParams),n=Cp(t);return n==="{}"?"default":n}get _queryObject(){return yy(this._queryParams)}isEqual(t){if(t=mn(t),!(t instanceof ag))return!1;const n=this._repo===t._repo,i=Fp(this._path,t._path),r=this._queryIdentifier===t._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+cC(this._path)}}class ss extends ag{constructor(t,n){super(t,n,new Pp,!1)}get parent(){const t=f4(this._path);return t===null?null:new ss(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class Tc{constructor(t,n,i){this._node=t,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const n=new Ut(t),i=Xh(this.ref,t);return new Tc(this._node.getChild(n),i,an)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>t(new Tc(r,Xh(this.ref,i),an)))}hasChild(t){const n=new Ut(t);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function t5(e,t){return e=mn(e),e._checkNotDeleted("ref"),t!==void 0?Xh(e._root,t):e._root}function Xh(e,t){return e=mn(e),pt(e._path)===null?ZI("child","path",t,!1):z4("child","path",t,!1),new ss(e._repo,dn(e._path,t))}function ER(e){return e=mn(e),new wR(e._repo,e._path)}function SR(e,t){e=mn(e),jl("set",e._path),Y1("set",t,e._path,!1);const n=new Pr;return lR(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class lg{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,n){const i=n._queryParams.getIndex();return new J4("value",this,new Tc(t.snapshotNode,new ss(n._repo,n._path),i))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new e5(this,t,n):null}matches(t){return t instanceof lg?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class cg{constructor(t,n){this.eventType=t,this.callbackContext=n}respondsTo(t){let n=t==="children_added"?"child_added":t;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new e5(this,t,n):null}createEvent(t,n){Ue(t.childName!=null,"Child events should have a childName.");const i=Xh(new ss(n._repo,n._path),t.childName),r=n._queryParams.getIndex();return new J4(t.type,this,new Tc(t.snapshotNode,i,r),t.prevName)}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof cg?this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function TR(e,t,n,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){const l=n,c=(d,u)=>{Dy(e._repo,e,a),l(d,u)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new bR(n,s||void 0),a=t==="value"?new lg(o):new cg(t,o);return fR(e._repo,e,a),()=>Dy(e._repo,e,a)}function n5(e,t,n,i){return TR(e,"value",t,n,i)}wI(ss);xI(ss);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="FIREBASE_DATABASE_EMULATOR_HOST",X1={};let AR=!1;function xR(e,t,n,i,r){let s=i||e.options.databaseURL;s===void 0&&(e.options.projectId||Po("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),On("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=By(s,r),a=o.repoInfo,l,c;typeof process!="undefined"&&(c=process.env[kR]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=By(s,r),a=o.repoInfo):l=!o.repoInfo.secure;const d=r&&l?new B1(B1.OWNER):new Lx(e.name,e.options,t);JI("Invalid Firebase Database URL",o),gt(o.path)||Po("Database URL must point to the root of a Firebase Database (not including a child path).");const u=IR(a,e,d,new Fx(e.name,n));return new RR(u,e)}function CR(e,t){const n=X1[t];(!n||n[e.key]!==e)&&Po(`Database ${t}(${e.repoInfo_}) has already been deleted.`),mR(e),delete n[e.key]}function IR(e,t,n,i){let r=X1[t.name];r||(r={},X1[t.name]=r);let s=r[e.toURLString()];return s&&Po("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rR(e,AR,n,i),r[e.toURLString()]=s,s}class RR{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(sR(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ss(this._repo,Rt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(CR(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Po("Cannot call "+t+" on a deleted database.")}}function MR(e=xp(),t){return kp(e,"database").getImmediate({identifier:t})}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(e){yx(Ap),Yc(new al("database",(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return xR(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),Cr(ny,iy,e),Cr(ny,iy,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR={".sv":"timestamp"};function Py(){return NR}zr.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};zr.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};OR();var FR=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ge,ug=ug||{},at=FR||self;function Qh(){}function Q1(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function tu(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function LR(e){return Object.prototype.hasOwnProperty.call(e,km)&&e[km]||(e[km]=++DR)}var km="closure_uid_"+(1e9*Math.random()>>>0),DR=0;function BR(e,t,n){return e.call.apply(e.bind,arguments)}function PR(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function Nn(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Nn=BR:Nn=PR,Nn.apply(null,arguments)}function Bu(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),e.apply(this,i)}}function Dn(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[r].apply(i,o)}}function Hs(){this.s=this.s,this.o=this.o}var UR=0;Hs.prototype.s=!1;Hs.prototype.na=function(){!this.s&&(this.s=!0,this.M(),UR!=0)&&LR(this)};Hs.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const i5=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},r5=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const i=e.length,r=typeof e=="string"?e.split(""):e;for(let s=0;s<i;s++)s in r&&t.call(n,r[s],s,e)};function jR(e){e:{var t=M7;const n=e.length,i=typeof e=="string"?e.split(""):e;for(let r=0;r<n;r++)if(r in i&&t.call(void 0,i[r],r,e)){t=r;break e}t=-1}return 0>t?null:typeof e=="string"?e.charAt(t):e[t]}function Uy(e){return Array.prototype.concat.apply([],arguments)}function hg(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function Zh(e){return/^[\s\xa0]*$/.test(e)}var jy=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Zn(e,t){return e.indexOf(t)!=-1}function Am(e,t){return e<t?-1:e>t?1:0}var Jn;e:{var Hy=at.navigator;if(Hy){var Vy=Hy.userAgent;if(Vy){Jn=Vy;break e}}Jn=""}function dg(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function s5(e){const t={};for(const n in e)t[n]=e[n];return t}var qy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function o5(e,t){let n,i;for(let r=1;r<arguments.length;r++){i=arguments[r];for(n in i)e[n]=i[n];for(let s=0;s<qy.length;s++)n=qy[s],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function fg(e){return fg[" "](e),e}fg[" "]=Qh;function HR(e){var t=zR;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}var VR=Zn(Jn,"Opera"),za=Zn(Jn,"Trident")||Zn(Jn,"MSIE"),a5=Zn(Jn,"Edge"),Z1=a5||za,l5=Zn(Jn,"Gecko")&&!(Zn(Jn.toLowerCase(),"webkit")&&!Zn(Jn,"Edge"))&&!(Zn(Jn,"Trident")||Zn(Jn,"MSIE"))&&!Zn(Jn,"Edge"),qR=Zn(Jn.toLowerCase(),"webkit")&&!Zn(Jn,"Edge");function c5(){var e=at.document;return e?e.documentMode:void 0}var Jh;e:{var xm="",Cm=function(){var e=Jn;if(l5)return/rv:([^\);]+)(\)|;)/.exec(e);if(a5)return/Edge\/([\d\.]+)/.exec(e);if(za)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(qR)return/WebKit\/(\S+)/.exec(e);if(VR)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Cm&&(xm=Cm?Cm[1]:""),za){var Im=c5();if(Im!=null&&Im>parseFloat(xm)){Jh=String(Im);break e}}Jh=xm}var zR={};function $R(){return HR(function(){let e=0;const t=jy(String(Jh)).split("."),n=jy("9").split("."),i=Math.max(t.length,n.length);for(let o=0;e==0&&o<i;o++){var r=t[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r[0].length==0&&s[0].length==0)break;e=Am(r[1].length==0?0:parseInt(r[1],10),s[1].length==0?0:parseInt(s[1],10))||Am(r[2].length==0,s[2].length==0)||Am(r[2],s[2]),r=r[3],s=s[3]}while(e==0)}return 0<=e})}var J1;if(at.document&&za){var zy=c5();J1=zy||parseInt(Jh,10)||void 0}else J1=void 0;var WR=J1,KR=function(){if(!at.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{at.addEventListener("test",Qh,t),at.removeEventListener("test",Qh,t)}catch{}return e}();function zn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}zn.prototype.h=function(){this.defaultPrevented=!0};function kc(e,t){if(zn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(l5){e:{try{fg(t.nodeName);var r=!0;break e}catch{}r=!1}r||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:GR[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&kc.Z.h.call(this)}}Dn(kc,zn);var GR={2:"touch",3:"pen",4:"mouse"};kc.prototype.h=function(){kc.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var nu="closure_listenable_"+(1e6*Math.random()|0),YR=0;function XR(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ia=r,this.key=++YR,this.ca=this.fa=!1}function nf(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function rf(e){this.src=e,this.g={},this.h=0}rf.prototype.add=function(e,t,n,i,r){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var o=t0(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):(t=new XR(t,this.src,s,!!i,r),t.fa=n,e.push(t)),t};function e0(e,t){var n=t.type;if(n in e.g){var i=e.g[n],r=i5(i,t),s;(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(nf(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function t0(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==i)return r}return-1}var mg="closure_lm_"+(1e6*Math.random()|0),Rm={};function u5(e,t,n,i,r){if(i&&i.once)return d5(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)u5(e,t[s],n,i,r);return null}return n=_g(n),e&&e[nu]?e.N(t,n,tu(i)?!!i.capture:!!i,r):h5(e,t,n,!1,i,r)}function h5(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=tu(r)?!!r.capture:!!r,a=gg(e);if(a||(e[mg]=a=new rf(e)),n=a.add(t,n,i,o,s),n.proxy)return n;if(i=QR(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)KR||(r=o),r===void 0&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(m5(t.toString()),i);else if(e.addListener&&e.removeListener)e.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return n}function QR(){function e(n){return t.call(e.src,e.listener,n)}var t=ZR;return e}function d5(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)d5(e,t[s],n,i,r);return null}return n=_g(n),e&&e[nu]?e.O(t,n,tu(i)?!!i.capture:!!i,r):h5(e,t,n,!0,i,r)}function f5(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)f5(e,t[s],n,i,r);else i=tu(i)?!!i.capture:!!i,n=_g(n),e&&e[nu]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],n=t0(s,n,i,r),-1<n&&(nf(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=gg(e))&&(t=e.g[t.toString()],e=-1,t&&(e=t0(t,n,i,r)),(n=-1<e?t[e]:null)&&pg(n))}function pg(e){if(typeof e!="number"&&e&&!e.ca){var t=e.src;if(t&&t[nu])e0(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(m5(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=gg(t))?(e0(n,e),n.h==0&&(n.src=null,t[mg]=null)):nf(e)}}}function m5(e){return e in Rm?Rm[e]:Rm[e]="on"+e}function ZR(e,t){if(e.ca)e=!0;else{t=new kc(t,this);var n=e.listener,i=e.ia||e.src;e.fa&&pg(e),e=n.call(i,t)}return e}function gg(e){return e=e[mg],e instanceof rf?e:null}var Mm="__closure_events_fn_"+(1e9*Math.random()>>>0);function _g(e){return typeof e=="function"?e:(e[Mm]||(e[Mm]=function(t){return e.handleEvent(t)}),e[Mm])}function Rn(){Hs.call(this),this.i=new rf(this),this.P=this,this.I=null}Dn(Rn,Hs);Rn.prototype[nu]=!0;Rn.prototype.removeEventListener=function(e,t,n,i){f5(this,e,t,n,i)};function Fn(e,t){var n,i=e.I;if(i)for(n=[];i;i=i.I)n.push(i);if(e=e.P,i=t.type||t,typeof t=="string")t=new zn(t,e);else if(t instanceof zn)t.target=t.target||e;else{var r=t;t=new zn(i,e),o5(t,r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=Pu(o,i,!0,t)&&r}if(o=t.g=e,r=Pu(o,i,!0,t)&&r,r=Pu(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)o=t.g=n[s],r=Pu(o,i,!1,t)&&r}Rn.prototype.M=function(){if(Rn.Z.M.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)nf(n[i]);delete e.g[t],e.h--}}this.I=null};Rn.prototype.N=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)};Rn.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};function Pu(e,t,n,i){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&e0(e.i,o),r=a.call(l,i)!==!1&&r}}return r&&!i.defaultPrevented}var vg=at.JSON.stringify;function JR(){var e=g5;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class e7{constructor(){this.h=this.g=null}add(t,n){const i=p5.get();i.set(t,n),this.h?this.h.next=i:this.g=i,this.h=i}}var p5=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new t7,e=>e.reset());class t7{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function n7(e){at.setTimeout(()=>{throw e},0)}function yg(e,t){n0||i7(),i0||(n0(),i0=!0),g5.add(e,t)}var n0;function i7(){var e=at.Promise.resolve(void 0);n0=function(){e.then(r7)}}var i0=!1,g5=new e7;function r7(){for(var e;e=JR();){try{e.h.call(e.g)}catch(n){n7(n)}var t=p5;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}i0=!1}function sf(e,t){Rn.call(this),this.h=e||1,this.g=t||at,this.j=Nn(this.kb,this),this.l=Date.now()}Dn(sf,Rn);Ge=sf.prototype;Ge.da=!1;Ge.S=null;Ge.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Fn(this,"tick"),this.da&&(bg(this),this.start()))}};Ge.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function bg(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}Ge.M=function(){sf.Z.M.call(this),bg(this),delete this.g};function wg(e,t,n){if(typeof e=="function")n&&(e=Nn(e,n));else if(e&&typeof e.handleEvent=="function")e=Nn(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:at.setTimeout(e,t||0)}function _5(e){e.g=wg(()=>{e.g=null,e.i&&(e.i=!1,_5(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class s7 extends Hs{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:_5(this)}M(){super.M(),this.g&&(at.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ac(e){Hs.call(this),this.h=e,this.g={}}Dn(Ac,Hs);var $y=[];function v5(e,t,n,i){Array.isArray(n)||(n&&($y[0]=n.toString()),n=$y);for(var r=0;r<n.length;r++){var s=u5(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function y5(e){dg(e.g,function(t,n){this.g.hasOwnProperty(n)&&pg(t)},e),e.g={}}Ac.prototype.M=function(){Ac.Z.M.call(this),y5(this)};Ac.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function of(){this.g=!0}of.prototype.Aa=function(){this.g=!1};function o7(e,t,n,i,r,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");o=2<=u.length&&u[1]=="type"?o+(d+"="+c+"&"):o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+`
`+n+`
`+o})}function a7(e,t,n,i,r,s,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+`
`+n+`
`+s+" "+o})}function wa(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+c7(e,n)+(i?" "+i:"")})}function l7(e,t){e.info(function(){return"TIMEOUT: "+t})}of.prototype.info=function(){};function c7(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return vg(n)}catch{return t}}var ea={},Wy=null;function af(){return Wy=Wy||new Rn}ea.Ma="serverreachability";function b5(e){zn.call(this,ea.Ma,e)}Dn(b5,zn);function xc(e){const t=af();Fn(t,new b5(t))}ea.STAT_EVENT="statevent";function w5(e,t){zn.call(this,ea.STAT_EVENT,e),this.stat=t}Dn(w5,zn);function ni(e){const t=af();Fn(t,new w5(t,e))}ea.Na="timingevent";function E5(e,t){zn.call(this,ea.Na,e),this.size=t}Dn(E5,zn);function iu(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return at.setTimeout(function(){e()},t)}var lf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},S5={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Eg(){}Eg.prototype.h=null;function Ky(e){return e.h||(e.h=e.i())}function T5(){}var ru={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Sg(){zn.call(this,"d")}Dn(Sg,zn);function Tg(){zn.call(this,"c")}Dn(Tg,zn);var r0;function cf(){}Dn(cf,Eg);cf.prototype.g=function(){return new XMLHttpRequest};cf.prototype.i=function(){return{}};r0=new cf;function su(e,t,n,i){this.l=e,this.j=t,this.m=n,this.X=i||1,this.V=new Ac(this),this.P=u7,e=Z1?125:void 0,this.W=new sf(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new k5}function k5(){this.i=null,this.g="",this.h=!1}var u7=45e3,s0={},ed={};Ge=su.prototype;Ge.setTimeout=function(e){this.P=e};function o0(e,t,n){e.K=1,e.v=hf(Zr(t)),e.s=n,e.U=!0,A5(e,null)}function A5(e,t){e.F=Date.now(),ou(e),e.A=Zr(e.v);var n=e.A,i=e.X;Array.isArray(i)||(i=[String(i)]),N5(n.h,"t",i),e.C=0,n=e.l.H,e.h=new k5,e.g=J5(e.l,n?t:null,!e.s),0<e.O&&(e.L=new s7(Nn(e.Ia,e,e.g),e.O)),v5(e.V,e.g,"readystatechange",e.gb),t=e.H?s5(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),xc(),o7(e.j,e.u,e.A,e.m,e.X,e.s)}Ge.gb=function(e){e=e.target;const t=this.L;t&&Hr(e)==3?t.l():this.Ia(e)};Ge.Ia=function(e){try{if(e==this.g)e:{const d=Hr(this.g);var t=this.g.Da();const u=this.g.ba();if(!(3>d)&&(d!=3||Z1||this.g&&(this.h.h||this.g.ga()||Qy(this.g)))){this.I||d!=4||t==7||(t==8||0>=u?xc(3):xc(2)),uf(this);var n=this.g.ba();this.N=n;t:if(x5(this)){var i=Qy(this.g);e="";var r=i.length,s=Hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){To(this),ic(this);var o="";break t}this.h.i=new at.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,a7(this.j,this.u,this.A,this.m,this.X,d,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Zh(a)){var c=a;break t}}c=null}if(n=c)wa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,a0(this,n);else{this.i=!1,this.o=3,ni(12),To(this),ic(this);break e}}this.U?(C5(this,d,o),Z1&&this.i&&d==3&&(v5(this.V,this.W,"tick",this.fb),this.W.start())):(wa(this.j,this.m,o,null),a0(this,o)),d==4&&To(this),this.i&&!this.I&&(d==4?Y5(this.l,this):(this.i=!1,ou(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,ni(12)):(this.o=0,ni(13)),To(this),ic(this)}}}catch{}finally{}};function x5(e){return e.g?e.u=="GET"&&e.K!=2&&e.l.Ba:!1}function C5(e,t,n){let i=!0,r;for(;!e.I&&e.C<n.length;)if(r=h7(e,n),r==ed){t==4&&(e.o=4,ni(14),i=!1),wa(e.j,e.m,null,"[Incomplete Response]");break}else if(r==s0){e.o=4,ni(15),wa(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}else wa(e.j,e.m,r,null),a0(e,r);x5(e)&&r!=ed&&r!=s0&&(e.h.g="",e.C=0),t!=4||n.length!=0||e.h.h||(e.o=1,ni(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,t=e.l,t.g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ng(t),t.L=!0,ni(11))):(wa(e.j,e.m,n,"[Invalid Chunked Response]"),To(e),ic(e))}Ge.fb=function(){if(this.g){var e=Hr(this.g),t=this.g.ga();this.C<t.length&&(uf(this),C5(this,e,t),this.i&&e!=4&&ou(this))}};function h7(e,t){var n=e.C,i=t.indexOf(`
`,n);return i==-1?ed:(n=Number(t.substring(n,i)),isNaN(n)?s0:(i+=1,i+n>t.length?ed:(t=t.substr(i,n),e.C=i+n,t)))}Ge.cancel=function(){this.I=!0,To(this)};function ou(e){e.Y=Date.now()+e.P,I5(e,e.P)}function I5(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=iu(Nn(e.eb,e),t)}function uf(e){e.B&&(at.clearTimeout(e.B),e.B=null)}Ge.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(l7(this.j,this.A),this.K!=2&&(xc(),ni(17)),To(this),this.o=2,ic(this)):I5(this,this.Y-e)};function ic(e){e.l.G==0||e.I||Y5(e.l,e)}function To(e){uf(e);var t=e.L;t&&typeof t.na=="function"&&t.na(),e.L=null,bg(e.W),y5(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function a0(e,t){try{var n=e.l;if(n.G!=0&&(n.g==e||l0(n.i,e))){if(n.I=e.N,!e.J&&l0(n.i,e)&&n.G==3){try{var i=n.Ca.g.parse(t)}catch{i=null}if(Array.isArray(i)&&i.length==3){var r=i;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<e.F)rd(n),mf(n);else break e;Og(n),ni(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&n.A==0&&!n.v&&(n.v=iu(Nn(n.ab,n),6e3));if(1>=D5(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else ko(n,11)}else if((e.J||n.g==e)&&rd(n),!Zh(t))for(r=n.Ca.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const d=c[3];d!=null&&(n.ma=d,n.h.info("VER="+n.ma));const u=c[4];u!=null&&(n.za=u,n.h.info("SVER="+n.za));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(i=1.5*f,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const m=e.g;if(m){const h=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var s=i.i;!s.g&&(Zn(h,"spdy")||Zn(h,"quic")||Zn(h,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(xg(s,s.h),s.h=null))}if(i.D){const R=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(i.sa=R,on(i.F,i.D,R))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms")),i=n;var o=e;if(i.oa=Z5(i,i.H?i.la:null,i.W),o.J){B5(i.i,o);var a=o,l=i.K;l&&a.setTimeout(l),a.B&&(uf(a),ou(a)),i.g=o}else K5(i);0<n.l.length&&pf(n)}else c[0]!="stop"&&c[0]!="close"||ko(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?ko(n,7):Mg(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}xc(4)}catch{}}function d7(e){if(e.R&&typeof e.R=="function")return e.R();if(typeof e=="string")return e.split("");if(Q1(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}t=[],n=0;for(i in e)t[n++]=e[i];return t}function kg(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Q1(e)||typeof e=="string")r5(e,t,void 0);else{if(e.T&&typeof e.T=="function")var n=e.T();else if(e.R&&typeof e.R=="function")n=void 0;else if(Q1(e)||typeof e=="string"){n=[];for(var i=e.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,e)n[i++]=r;i=d7(e),r=i.length;for(var s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}}function hl(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(e)if(e instanceof hl)for(n=e.T(),i=0;i<n.length;i++)this.set(n[i],e.get(n[i]));else for(i in e)this.set(i,e[i])}Ge=hl.prototype;Ge.R=function(){Ag(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e};Ge.T=function(){return Ag(this),this.g.concat()};function Ag(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var i=e.g[t];qo(e.h,i)&&(e.g[n++]=i),t++}e.g.length=n}if(e.i!=e.g.length){var r={};for(n=t=0;t<e.g.length;)i=e.g[t],qo(r,i)||(e.g[n++]=i,r[i]=1),t++;e.g.length=n}}Ge.get=function(e,t){return qo(this.h,e)?this.h[e]:t};Ge.set=function(e,t){qo(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t};Ge.forEach=function(e,t){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);e.call(t,s,r,this)}};function qo(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var R5=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function f7(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function zo(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof zo){this.g=t!==void 0?t:e.g,td(this,e.j),this.s=e.s,nd(this,e.i),id(this,e.m),this.l=e.l,t=e.h;var n=new Cc;n.i=t.i,t.g&&(n.g=new hl(t.g),n.h=t.h),Gy(this,n),this.o=e.o}else e&&(n=String(e).match(R5))?(this.g=!!t,td(this,n[1]||"",!0),this.s=rc(n[2]||""),nd(this,n[3]||"",!0),id(this,n[4]),this.l=rc(n[5]||"",!0),Gy(this,n[6]||"",!0),this.o=rc(n[7]||"")):(this.g=!!t,this.h=new Cc(null,this.g))}zo.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Hl(t,Yy,!0),":");var n=this.i;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Hl(t,Yy,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&e.push("/"),e.push(Hl(n,n.charAt(0)=="/"?v7:_7,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Hl(n,b7)),e.join("")};function Zr(e){return new zo(e)}function td(e,t,n){e.j=n?rc(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nd(e,t,n){e.i=n?rc(t,!0):t}function id(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Gy(e,t,n){t instanceof Cc?(e.h=t,w7(e.h,e.g)):(n||(t=Hl(t,y7)),e.h=new Cc(t,e.g))}function on(e,t,n){e.h.set(t,n)}function hf(e){return on(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function m7(e){return e instanceof zo?Zr(e):new zo(e,void 0)}function p7(e,t,n,i){var r=new zo(null,void 0);return e&&td(r,e),t&&nd(r,t),n&&id(r,n),i&&(r.l=i),r}function rc(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Hl(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,g7),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function g7(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Yy=/[#\/\?@]/g,_7=/[#\?:]/g,v7=/[#\?]/g,y7=/[#\?@]/g,b7=/#/g;function Cc(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Vs(e){e.g||(e.g=new hl,e.h=0,e.i&&f7(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}Ge=Cc.prototype;Ge.add=function(e,t){Vs(this),this.i=null,e=dl(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function M5(e,t){Vs(e),t=dl(e,t),qo(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,e=e.g,qo(e.h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Ag(e)))}function O5(e,t){return Vs(e),t=dl(e,t),qo(e.g.h,t)}Ge.forEach=function(e,t){Vs(this),this.g.forEach(function(n,i){r5(n,function(r){e.call(t,r,i,this)},this)},this)};Ge.T=function(){Vs(this);for(var e=this.g.R(),t=this.g.T(),n=[],i=0;i<t.length;i++)for(var r=e[i],s=0;s<r.length;s++)n.push(t[i]);return n};Ge.R=function(e){Vs(this);var t=[];if(typeof e=="string")O5(this,e)&&(t=Uy(t,this.g.get(dl(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Uy(t,e[n])}return t};Ge.set=function(e,t){return Vs(this),this.i=null,e=dl(this,e),O5(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};Ge.get=function(e,t){return e?(e=this.R(e),0<e.length?String(e[0]):t):t};function N5(e,t,n){M5(e,t),0<n.length&&(e.i=null,e.g.set(dl(e,t),hg(n)),e.h+=n.length)}Ge.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var i=t[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;i[s]!==""&&(o+="="+encodeURIComponent(String(i[s]))),e.push(o)}}return this.i=e.join("&")};function dl(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function w7(e,t){t&&!e.j&&(Vs(e),e.i=null,e.g.forEach(function(n,i){var r=i.toLowerCase();i!=r&&(M5(this,i),N5(this,r,n))},e)),e.j=t}var E7=class{constructor(e,t){this.h=e,this.g=t}};function F5(e){this.l=e||S7,at.PerformanceNavigationTiming?(e=at.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(at.g&&at.g.Ea&&at.g.Ea()&&at.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var S7=10;function L5(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function D5(e){return e.h?1:e.g?e.g.size:0}function l0(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function xg(e,t){e.g?e.g.add(t):e.h=t}function B5(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}F5.prototype.cancel=function(){if(this.i=P5(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function P5(e){if(e.h!=null)return e.i.concat(e.h.D);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return hg(e.i)}function Cg(){}Cg.prototype.stringify=function(e){return at.JSON.stringify(e,void 0)};Cg.prototype.parse=function(e){return at.JSON.parse(e,void 0)};function T7(){this.g=new Cg}function k7(e,t,n){const i=n||"";try{kg(e,function(r,s){let o=r;tu(r)&&(o=vg(r)),t.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function A7(e,t){const n=new of;if(at.Image){const i=new Image;i.onload=Bu(Uu,n,i,"TestLoadImage: loaded",!0,t),i.onerror=Bu(Uu,n,i,"TestLoadImage: error",!1,t),i.onabort=Bu(Uu,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=Bu(Uu,n,i,"TestLoadImage: timeout",!1,t),at.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}function Uu(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch{}}function au(e){this.l=e.$b||null,this.j=e.ib||!1}Dn(au,Eg);au.prototype.g=function(){return new df(this.l,this.j)};au.prototype.i=function(e){return function(){return e}}({});function df(e,t){Rn.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Ig,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Dn(df,Rn);var Ig=0;Ge=df.prototype;Ge.open=function(e,t){if(this.readyState!=Ig)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ic(this)};Ge.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||at).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))};Ge.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,lu(this)),this.readyState=Ig};Ge.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ic(this)),this.g&&(this.readyState=3,Ic(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof at.ReadableStream!="undefined"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;U5(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))};function U5(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}Ge.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?lu(this):Ic(this),this.readyState==3&&U5(this)}};Ge.Ua=function(e){this.g&&(this.response=this.responseText=e,lu(this))};Ge.Ta=function(e){this.g&&(this.response=e,lu(this))};Ge.ha=function(){this.g&&lu(this)};function lu(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ic(e)}Ge.setRequestHeader=function(e,t){this.v.append(e,t)};Ge.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};Ge.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Ic(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(df.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var x7=at.JSON.parse;function bn(e){Rn.call(this),this.headers=new hl,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=j5,this.K=this.L=!1}Dn(bn,Rn);var j5="",C7=/^https?$/i,I7=["POST","PUT"];Ge=bn.prototype;Ge.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():r0.g(),this.C=this.u?Ky(this.u):Ky(r0),this.g.onreadystatechange=Nn(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){Xy(this,s);return}e=n||"";const r=new hl(this.headers);i&&kg(i,function(s,o){r.set(o,s)}),i=jR(r.T()),n=at.FormData&&e instanceof at.FormData,!(0<=i5(I7,t))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(s,o){this.g.setRequestHeader(o,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{q5(this),0<this.B&&((this.K=R7(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Nn(this.pa,this)):this.A=wg(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Xy(this,s)}};function R7(e){return za&&$R()&&typeof e.timeout=="number"&&e.ontimeout!==void 0}function M7(e){return e.toLowerCase()=="content-type"}Ge.pa=function(){typeof ug!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Fn(this,"timeout"),this.abort(8))};function Xy(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,H5(e),ff(e)}function H5(e){e.D||(e.D=!0,Fn(e,"complete"),Fn(e,"error"))}Ge.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Fn(this,"complete"),Fn(this,"abort"),ff(this))};Ge.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ff(this,!0)),bn.Z.M.call(this)};Ge.Fa=function(){this.s||(this.F||this.v||this.l?V5(this):this.cb())};Ge.cb=function(){V5(this)};function V5(e){if(e.h&&typeof ug!="undefined"&&(!e.C[1]||Hr(e)!=4||e.ba()!=2)){if(e.v&&Hr(e)==4)wg(e.Fa,0,e);else if(Fn(e,"readystatechange"),Hr(e)==4){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=a===0){var r=String(e.H).match(R5)[1]||null;if(!r&&at.self&&at.self.location){var s=at.self.location.protocol;r=s.substr(0,s.length-1)}i=!C7.test(r?r.toLowerCase():"")}n=i}if(n)Fn(e,"complete"),Fn(e,"success");else{e.m=6;try{var o=2<Hr(e)?e.g.statusText:""}catch{o=""}e.j=o+" ["+e.ba()+"]",H5(e)}}finally{ff(e)}}}}function ff(e,t){if(e.g){q5(e);const n=e.g,i=e.C[0]?Qh:null;e.g=null,e.C=null,t||Fn(e,"ready");try{n.onreadystatechange=i}catch{}}}function q5(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(at.clearTimeout(e.A),e.A=null)}function Hr(e){return e.g?e.g.readyState:0}Ge.ba=function(){try{return 2<Hr(this)?this.g.status:-1}catch{return-1}};Ge.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};Ge.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),x7(t)}};function Qy(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case j5:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}Ge.Da=function(){return this.m};Ge.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function O7(e){let t="";return dg(e,function(n,i){t+=i,t+=":",t+=n,t+=`\r
`}),t}function Rg(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=O7(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):on(e,t,n))}function Rl(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function z5(e){this.za=0,this.l=[],this.h=new of,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Rl("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Rl("baseRetryDelayMs",5e3,e),this.$a=Rl("retryDelaySeedMs",1e4,e),this.Ya=Rl("forwardChannelMaxRetries",2,e),this.ra=Rl("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new F5(e&&e.concurrentRequestLimit),this.Ca=new T7,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||e.Xb!==!1}Ge=z5.prototype;Ge.ma=8;Ge.G=1;function Mg(e){if($5(e),e.G==3){var t=e.V++,n=Zr(e.F);on(n,"SID",e.J),on(n,"RID",t),on(n,"TYPE","terminate"),cu(e,n),t=new su(e,e.h,t,void 0),t.K=2,t.v=hf(Zr(n)),n=!1,at.navigator&&at.navigator.sendBeacon&&(n=at.navigator.sendBeacon(t.v.toString(),"")),!n&&at.Image&&(new Image().src=t.v,n=!0),n||(t.g=J5(t.l,null),t.g.ea(t.v)),t.F=Date.now(),ou(t)}Q5(e)}Ge.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}};function mf(e){e.g&&(Ng(e),e.g.cancel(),e.g=null)}function $5(e){mf(e),e.u&&(at.clearTimeout(e.u),e.u=null),rd(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&at.clearTimeout(e.m),e.m=null)}function Om(e,t){e.l.push(new E7(e.Za++,t)),e.G==3&&pf(e)}function pf(e){L5(e.i)||e.m||(e.m=!0,yg(e.Ha,e),e.C=0)}function N7(e,t){return D5(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.l=t.D.concat(e.l),!0):e.G==1||e.G==2||e.C>=(e.Xa?0:e.Ya)?!1:(e.m=iu(Nn(e.Ha,e,t),X5(e,e.C)),e.C++,!0)}Ge.Ha=function(e){if(this.m)if(this.m=null,this.G==1){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const r=new su(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=s5(s),o5(s,this.P)):s=this.P),this.o===null&&(r.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){t:{var i=this.l[n];if("__data__"in i.g&&(i=i.g.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(t+=i,4096<t){t=n;break e}if(t===4096||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=W5(this,r,t),n=Zr(this.F),on(n,"RID",e),on(n,"CVER",22),this.D&&on(n,"X-HTTP-Session-Id",this.D),cu(this,n),this.o&&s&&Rg(n,this.o,s),xg(this.i,r),this.Ra&&on(n,"TYPE","init"),this.ja?(on(n,"$req",t),on(n,"SID","null"),r.$=!0,o0(r,n,null)):o0(r,n,t),this.G=2}}else this.G==3&&(e?Zy(this,e):this.l.length==0||L5(this.i)||Zy(this))};function Zy(e,t){var n;t?n=t.m:n=e.V++;const i=Zr(e.F);on(i,"SID",e.J),on(i,"RID",n),on(i,"AID",e.U),cu(e,i),e.o&&e.s&&Rg(i,e.o,e.s),n=new su(e,e.h,n,e.C+1),e.o===null&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=W5(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),xg(e.i,n),o0(n,i,t)}function cu(e,t){e.j&&kg({},function(n,i){on(t,i,n)})}function W5(e,t,n){n=Math.min(e.l.length,n);var i=e.j?Nn(e.j.Oa,e.j,e):null;e:{var r=e.l;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=r[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=r[l].h;const d=r[l].g;if(c-=s,0>c)s=Math.max(0,r[l].h-100),a=!1;else try{k7(d,o,"req"+c+"_")}catch{i&&i(d)}}if(a){i=o.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,i}function K5(e){e.g||e.u||(e.Y=1,yg(e.Ga,e),e.A=0)}function Og(e){return e.g||e.u||3<=e.A?!1:(e.Y++,e.u=iu(Nn(e.Ga,e),X5(e,e.A)),e.A++,!0)}Ge.Ga=function(){if(this.u=null,G5(this),this.$&&!(this.L||this.g==null||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=iu(Nn(this.bb,this),e)}};Ge.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ni(10),mf(this),G5(this))};function Ng(e){e.B!=null&&(at.clearTimeout(e.B),e.B=null)}function G5(e){e.g=new su(e,e.h,"rpc",e.Y),e.o===null&&(e.g.H=e.s),e.g.O=0;var t=Zr(e.oa);on(t,"RID","rpc"),on(t,"SID",e.J),on(t,"CI",e.N?"0":"1"),on(t,"AID",e.U),cu(e,t),on(t,"TYPE","xmlhttp"),e.o&&e.s&&Rg(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=hf(Zr(t)),n.s=null,n.U=!0,A5(n,e)}Ge.ab=function(){this.v!=null&&(this.v=null,mf(this),Og(this),ni(19))};function rd(e){e.v!=null&&(at.clearTimeout(e.v),e.v=null)}function Y5(e,t){var n=null;if(e.g==t){rd(e),Ng(e),e.g=null;var i=2}else if(l0(e.i,t))n=t.D,B5(e.i,t),i=1;else return;if(e.I=t.N,e.G!=0){if(t.i)if(i==1){n=t.s?t.s.length:0,t=Date.now()-t.F;var r=e.C;i=af(),Fn(i,new E5(i,n)),pf(e)}else K5(e);else if(r=t.o,r==3||r==0&&0<e.I||!(i==1&&N7(e,t)||i==2&&Og(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:ko(e,5);break;case 4:ko(e,10);break;case 3:ko(e,6);break;default:ko(e,2)}}}function X5(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function ko(e,t){if(e.h.info("Error code "+t),t==2){var n=null;e.j&&(n=null);var i=Nn(e.jb,e);n||(n=new zo("//www.google.com/images/cleardot.gif"),at.location&&at.location.protocol=="http"||td(n,"https"),hf(n)),A7(n.toString(),i)}else ni(2);e.G=0,e.j&&e.j.va(t),Q5(e),$5(e)}Ge.jb=function(e){e?(this.h.info("Successfully pinged google.com"),ni(2)):(this.h.info("Failed to ping google.com"),ni(1))};function Q5(e){e.G=0,e.I=-1,e.j&&((P5(e.i).length!=0||e.l.length!=0)&&(e.i.i.length=0,hg(e.l),e.l.length=0),e.j.ua())}function Z5(e,t,n){let i=m7(n);if(i.i!="")t&&nd(i,t+"."+i.i),id(i,i.m);else{const r=at.location;i=p7(r.protocol,t?t+"."+r.hostname:r.hostname,+r.port,n)}return e.aa&&dg(e.aa,function(r,s){on(i,s,r)}),t=e.D,n=e.sa,t&&n&&on(i,t,n),on(i,"VER",e.ma),cu(e,i),i}function J5(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return t=n&&e.Ba&&!e.qa?new bn(new au({ib:!0})):new bn(e.qa),t.L=e.H,t}function e9(){}Ge=e9.prototype;Ge.xa=function(){};Ge.wa=function(){};Ge.va=function(){};Ge.ua=function(){};Ge.Oa=function(){};function sd(){if(za&&!(10<=Number(WR)))throw Error("Environmental error: no available transport.")}sd.prototype.g=function(e,t){return new Bi(e,t)};function Bi(e,t){Rn.call(this),this.g=new z5(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Zh(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Zh(t)&&(this.g.D=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new fl(this)}Dn(Bi,Rn);Bi.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),yg(Nn(e.hb,e,t))),ni(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Z5(e,null,e.W),pf(e)};Bi.prototype.close=function(){Mg(this.g)};Bi.prototype.u=function(e){if(typeof e=="string"){var t={};t.__data__=e,Om(this.g,t)}else this.v?(t={},t.__data__=vg(e),Om(this.g,t)):Om(this.g,e)};Bi.prototype.M=function(){this.g.j=null,delete this.j,Mg(this.g),delete this.g,Bi.Z.M.call(this)};function t9(e){Sg.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}Dn(t9,Sg);function n9(){Tg.call(this),this.status=1}Dn(n9,Tg);function fl(e){this.g=e}Dn(fl,e9);fl.prototype.xa=function(){Fn(this.g,"a")};fl.prototype.wa=function(e){Fn(this.g,new t9(e))};fl.prototype.va=function(e){Fn(this.g,new n9)};fl.prototype.ua=function(){Fn(this.g,"b")};sd.prototype.createWebChannel=sd.prototype.g;Bi.prototype.send=Bi.prototype.u;Bi.prototype.open=Bi.prototype.m;Bi.prototype.close=Bi.prototype.close;lf.NO_ERROR=0;lf.TIMEOUT=8;lf.HTTP_ERROR=6;S5.COMPLETE="complete";T5.EventType=ru;ru.OPEN="a";ru.CLOSE="b";ru.ERROR="c";ru.MESSAGE="d";Rn.prototype.listen=Rn.prototype.N;bn.prototype.listenOnce=bn.prototype.O;bn.prototype.getLastError=bn.prototype.La;bn.prototype.getLastErrorCode=bn.prototype.Da;bn.prototype.getStatus=bn.prototype.ba;bn.prototype.getResponseJson=bn.prototype.Qa;bn.prototype.getResponseText=bn.prototype.ga;bn.prototype.send=bn.prototype.ea;var F7=function(){return new sd},L7=function(){return af()},Nm=lf,D7=S5,B7=ea,Jy={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},P7=au,ju=T5,U7=bn;const e2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}pi.UNAUTHENTICATED=new pi(null),pi.GOOGLE_CREDENTIALS=new pi("google-credentials-uid"),pi.FIRST_PARTY=new pi("first-party-uid"),pi.MOCK_USER=new pi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ml="9.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o=new Sp("@firebase/firestore");function t2(){return $o.logLevel}function tt(e,...t){if($o.logLevel<=Ct.DEBUG){const n=t.map(Fg);$o.debug(`Firestore (${ml}): ${e}`,...n)}}function Ds(e,...t){if($o.logLevel<=Ct.ERROR){const n=t.map(Fg);$o.error(`Firestore (${ml}): ${e}`,...n)}}function n2(e,...t){if($o.logLevel<=Ct.WARN){const n=t.map(Fg);$o.warn(`Firestore (${ml}): ${e}`,...n)}}function Fg(e){if(typeof e=="string")return e;try{return t=e,JSON.stringify(t)}catch{return e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(e="Unexpected state"){const t=`FIRESTORE (${ml}) INTERNAL ASSERTION FAILED: `+e;throw Ds(t),new Error(t)}function Qt(e,t){e||dt()}function ft(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Error{constructor(t,n){super(n),this.code=t,this.message=n,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(t,n){this.user=n,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${t}`}}class H7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(pi.UNAUTHENTICATED))}shutdown(){}}class V7{constructor(t){this.t=t,this.currentUser=pi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let i=this.i;const r=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let s=new $r;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new $r,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{tt("FirebaseCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(tt("FirebaseCredentialsProvider","Auth not yet detected"),s.resolve(),s=new $r)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(tt("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Qt(typeof i.accessToken=="string"),new j7(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Qt(t===null||typeof t=="string"),new pi(t)}}class q7{constructor(t,n,i){this.h=t,this.l=n,this.m=i,this.type="FirstParty",this.user=pi.FIRST_PARTY}get authHeaders(){const t={"X-Goog-AuthUser":this.l},n=this.h.auth.getAuthHeaderValueForFirstParty([]);return n&&(t.Authorization=n),this.m&&(t["X-Goog-Iam-Authorization-Token"]=this.m),t}}class z7{constructor(t,n,i){this.h=t,this.l=n,this.m=i}getToken(){return Promise.resolve(new q7(this.h,this.l,this.m))}start(t,n){t.enqueueRetryable(()=>n(pi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.g(i),this.p=i=>n.writeSequenceNumber(i))}g(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.p&&this.p(t),t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $7(e){const t=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lg.T=-1;class i9{static I(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const r=$7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=t.charAt(r[s]%t.length))}return i}}function Dt(e,t){return e<t?-1:e>t?1:0}function $a(e,t,n){return e.length===t.length&&e.every((i,r)=>n(i,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new $e(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $e(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new $e(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new $e(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Mi.fromMillis(Date.now())}static fromDate(t){return Mi.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*n));return new Mi(n,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Dt(this.nanoseconds,t.nanoseconds):Dt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Nt(t)}static min(){return new Nt(new Mi(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ta(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function r9(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(t,n,i){n===void 0?n=0:n>t.length&&dt(),i===void 0?i=t.length-n:i>t.length-n&&dt(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Rc.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Rc?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let r=0;r<i;r++){const s=t.get(r),o=n.get(r);if(s<o)return-1;if(s>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}}class en extends Rc{construct(t,n,i){return new en(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new $e(Ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new en(n)}static emptyPath(){return new en([])}}const W7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vi extends Rc{construct(t,n,i){return new vi(t,n,i)}static isValidIdentifier(t){return W7.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vi.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new vi(["__name__"])}static fromServerFormat(t){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new $e(Ae.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new $e(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $e(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new $e(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new vi(n)}static emptyPath(){return new vi([])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(t){this.fields=t,t.sort(vi.comparator)}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return $a(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(t){this.binaryString=t}static fromBase64String(t){const n=atob(t);return new Kn(n)}static fromUint8Array(t){const n=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(t);return new Kn(n)}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Dt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Kn.EMPTY_BYTE_STRING=new Kn("");const K7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(e){if(Qt(!!e),typeof e=="string"){let t=0;const n=K7.exec(e);if(Qt(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:vn(e.seconds),nanos:vn(e.nanos)}}function vn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Wa(e){return typeof e=="string"?Kn.fromBase64String(e):Kn.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function s9(e){const t=e.mapValue.fields.__previous_value__;return Dg(t)?s9(t):t}function Oc(e){const t=Bs(e.mapValue.fields.__local_write_time__.timestampValue);return new Mi(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(e){return e==null}function od(e){return e===0&&1/e==-1/0}function G7(e){return typeof e=="number"&&Number.isInteger(e)&&!od(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(t){this.path=t}static fromPath(t){return new nt(en.fromString(t))}static fromName(t){return new nt(en.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return t!==null&&en.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return en.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new nt(new en(t.slice()))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Dg(e)?4:10:dt()}function Rr(e,t){const n=Wo(e);if(n!==Wo(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Oc(e).isEqual(Oc(t));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=Bs(i.timestampValue),o=Bs(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,r){return Wa(i.bytesValue).isEqual(Wa(r.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,r){return vn(i.geoPointValue.latitude)===vn(r.geoPointValue.latitude)&&vn(i.geoPointValue.longitude)===vn(r.geoPointValue.longitude)}(e,t);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return vn(i.integerValue)===vn(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=vn(i.doubleValue),o=vn(r.doubleValue);return s===o?od(s)===od(o):isNaN(s)&&isNaN(o)}return!1}(e,t);case 9:return $a(e.arrayValue.values||[],t.arrayValue.values||[],Rr);case 10:return function(i,r){const s=i.mapValue.fields||{},o=r.mapValue.fields||{};if(i2(s)!==i2(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!Rr(s[a],o[a])))return!1;return!0}(e,t);default:return dt()}}function Nc(e,t){return(e.values||[]).find(n=>Rr(n,t))!==void 0}function Ka(e,t){const n=Wo(e),i=Wo(t);if(n!==i)return Dt(n,i);switch(n){case 0:return 0;case 1:return Dt(e.booleanValue,t.booleanValue);case 2:return function(r,s){const o=vn(r.integerValue||r.doubleValue),a=vn(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(e,t);case 3:return r2(e.timestampValue,t.timestampValue);case 4:return r2(Oc(e),Oc(t));case 5:return Dt(e.stringValue,t.stringValue);case 6:return function(r,s){const o=Wa(r),a=Wa(s);return o.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(r,s){const o=r.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=Dt(o[l],a[l]);if(c!==0)return c}return Dt(o.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(r,s){const o=Dt(vn(r.latitude),vn(s.latitude));return o!==0?o:Dt(vn(r.longitude),vn(s.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(r,s){const o=r.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=Ka(o[l],a[l]);if(c)return c}return Dt(o.length,a.length)}(e.arrayValue,t.arrayValue);case 10:return function(r,s){const o=r.fields||{},a=Object.keys(o),l=s.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let d=0;d<a.length&&d<c.length;++d){const u=Dt(a[d],c[d]);if(u!==0)return u;const f=Ka(o[a[d]],l[c[d]]);if(f!==0)return f}return Dt(a.length,c.length)}(e.mapValue,t.mapValue);default:throw dt()}}function r2(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Dt(e,t);const n=Bs(e),i=Bs(t),r=Dt(n.seconds,i.seconds);return r!==0?r:Dt(n.nanos,i.nanos)}function Bg(e){return c0(e)}function c0(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(i){const r=Bs(i);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Wa(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,nt.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(i){let r="[",s=!0;for(const o of i.values||[])s?s=!1:r+=",",r+=c0(o);return r+"]"}(e.arrayValue):"mapValue"in e?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${c0(i.fields[a])}`;return s+"}"}(e.mapValue):dt();var t,n}function ad(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function u0(e){return!!e&&"integerValue"in e}function Pg(e){return!!e&&"arrayValue"in e}function s2(e){return!!e&&"nullValue"in e}function o2(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function gh(e){return!!e&&"mapValue"in e}function sc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ta(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=sc(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=sc(e.arrayValue.values[n]);return t}return Object.assign({},e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(t){this.value=t}static empty(){return new Ai({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!gh(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=sc(n)}setAll(t){let n=vi.emptyPath(),i={},r=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=sc(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(t){const n=this.field(t.popLast());gh(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Rr(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=n.mapValue.fields[t.get(i)];gh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(t,n,i){ta(n,(r,s)=>t[r]=s);for(const r of i)delete t[r]}clone(){return new Ai(sc(this.value))}}function o9(e){const t=[];return ta(e.fields,(n,i)=>{const r=new vi([n]);if(gh(i)){const s=o9(i.mapValue).fields;if(s.length===0)t.push(r);else for(const o of s)t.push(r.child(o))}else t.push(r)}),new Mc(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(t,n,i,r,s){this.key=t,this.documentType=n,this.version=i,this.data=r,this.documentState=s}static newInvalidDocument(t){return new jn(t,0,Nt.min(),Ai.empty(),0)}static newFoundDocument(t,n,i){return new jn(t,1,n,i,0)}static newNoDocument(t,n){return new jn(t,2,n,Ai.empty(),0)}static newUnknownDocument(t,n){return new jn(t,3,n,Ai.empty(),2)}convertToFoundDocument(t,n){return this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ai.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof jn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}clone(){return new jn(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(t,n=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.A=null}}function a2(e,t=null,n=[],i=[],r=null,s=null,o=null){return new Y7(e,t,n,i,r,s,o)}function Ug(e){const t=ft(e);if(t.A===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>Q7(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),pl(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=ld(t.startAt)),t.endAt&&(n+="|ub:",n+=ld(t.endAt)),t.A=n}return t.A}function X7(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>{return`${(i=n).field.canonicalString()} ${i.op} ${Bg(i.value)}`;var i}).join(", ")}]`),pl(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(n)).join(", ")}]`),e.startAt&&(t+=", startAt: "+ld(e.startAt)),e.endAt&&(t+=", endAt: "+ld(e.endAt)),`Target(${t})`}function jg(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!sM(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(n=e.filters[r],i=t.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Rr(n.value,i.value))return!1;var n,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!c2(e.startAt,t.startAt)&&c2(e.endAt,t.endAt)}function h0(e){return nt.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}class ii extends class{}{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.R(t,n,i):new Z7(t,n,i):n==="array-contains"?new tM(t,i):n==="in"?new nM(t,i):n==="not-in"?new iM(t,i):n==="array-contains-any"?new rM(t,i):new ii(t,n,i)}static R(t,n,i){return n==="in"?new J7(t,i):new eM(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.P(Ka(n,this.value)):n!==null&&Wo(this.value)===Wo(n)&&this.P(Ka(n,this.value))}P(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return dt()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}function Q7(e){return e.field.canonicalString()+e.op.toString()+Bg(e.value)}class Z7 extends ii{constructor(t,n,i){super(t,n,i),this.key=nt.fromName(i.referenceValue)}matches(t){const n=nt.comparator(t.key,this.key);return this.P(n)}}class J7 extends ii{constructor(t,n){super(t,"in",n),this.keys=a9("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class eM extends ii{constructor(t,n){super(t,"not-in",n),this.keys=a9("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function a9(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>nt.fromName(i.referenceValue))}class tM extends ii{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Pg(n)&&Nc(n.arrayValue,this.value)}}class nM extends ii{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Nc(this.value.arrayValue,n)}}class iM extends ii{constructor(t,n){super(t,"not-in",n)}matches(t){if(Nc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Nc(this.value.arrayValue,n)}}class rM extends ii{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Pg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Nc(this.value.arrayValue,i))}}class Fc{constructor(t,n){this.position=t,this.before=n}}function ld(e){return`${e.before?"b":"a"}:${e.position.map(t=>Bg(t)).join(",")}`}class Ra{constructor(t,n="asc"){this.field=t,this.dir=n}}function sM(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function l2(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(s.field.isKeyField()?i=nt.comparator(nt.fromName(o.referenceValue),n.key):i=Ka(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return e.before?i<=0:i<0}function c2(e,t){if(e===null)return t===null;if(t===null||e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Rr(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(t,n=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.V=null,this.S=null,this.startAt,this.endAt}}function oM(e,t,n,i,r,s,o,a){return new qs(e,t,n,i,r,s,o,a)}function gf(e){return new qs(e)}function _h(e){return!pl(e.limit)&&e.limitType==="F"}function cd(e){return!pl(e.limit)&&e.limitType==="L"}function Hg(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Vg(e){for(const t of e.filters)if(t.v())return t.field;return null}function qg(e){return e.collectionGroup!==null}function Ga(e){const t=ft(e);if(t.V===null){t.V=[];const n=Vg(t),i=Hg(t);if(n!==null&&i===null)n.isKeyField()||t.V.push(new Ra(n)),t.V.push(new Ra(vi.keyField(),"asc"));else{let r=!1;for(const s of t.explicitOrderBy)t.V.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.V.push(new Ra(vi.keyField(),s))}}}return t.V}function Ko(e){const t=ft(e);if(!t.S)if(t.limitType==="F")t.S=a2(t.path,t.collectionGroup,Ga(t),t.filters,t.limit,t.startAt,t.endAt);else{const n=[];for(const s of Ga(t)){const o=s.dir==="desc"?"asc":"desc";n.push(new Ra(s.field,o))}const i=t.endAt?new Fc(t.endAt.position,!t.endAt.before):null,r=t.startAt?new Fc(t.startAt.position,!t.startAt.before):null;t.S=a2(t.path,t.collectionGroup,n,t.filters,t.limit,i,r)}return t.S}function l9(e,t,n){return new qs(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function _f(e,t){return jg(Ko(e),Ko(t))&&e.limitType===t.limitType}function c9(e){return`${Ug(Ko(e))}|lt:${e.limitType}`}function d0(e){return`Query(target=${X7(Ko(e))}; limitType=${e.limitType})`}function vf(e,t){return t.isFoundDocument()&&function(n,i){const r=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):nt.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(e,t)&&function(n,i){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const r of n.filters)if(!r.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!l2(n.startAt,Ga(n),i)||n.endAt&&l2(n.endAt,Ga(n),i))}(e,t)}function u9(e){return(t,n)=>{let i=!1;for(const r of Ga(e)){const s=aM(r,t,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function aM(e,t,n){const i=e.field.isKeyField()?nt.comparator(t.key,n.key):function(r,s,o){const a=s.data.field(r),l=o.data.field(r);return a!==null&&l!==null?Ka(a,l):dt()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(e,t){if(e.D){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:od(t)?"-0":t}}function d9(e){return{integerValue:""+e}}function lM(e,t){return G7(t)?d9(t):h9(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(){this._=void 0}}function cM(e,t,n){return e instanceof ud?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(n,t):e instanceof Ya?m9(e,t):e instanceof Xa?p9(e,t):function(i,r){const s=f9(i,r),o=u2(s)+u2(i.C);return u0(s)&&u0(i.C)?d9(o):h9(i.N,o)}(e,t)}function uM(e,t,n){return e instanceof Ya?m9(e,t):e instanceof Xa?p9(e,t):n}function f9(e,t){return e instanceof hd?u0(n=t)||function(i){return!!i&&"doubleValue"in i}(n)?t:{integerValue:0}:null;var n}class ud extends yf{}class Ya extends yf{constructor(t){super(),this.elements=t}}function m9(e,t){const n=g9(t);for(const i of e.elements)n.some(r=>Rr(r,i))||n.push(i);return{arrayValue:{values:n}}}class Xa extends yf{constructor(t){super(),this.elements=t}}function p9(e,t){let n=g9(t);for(const i of e.elements)n=n.filter(r=>!Rr(r,i));return{arrayValue:{values:n}}}class hd extends yf{constructor(t,n){super(),this.N=t,this.C=n}}function u2(e){return vn(e.integerValue||e.doubleValue)}function g9(e){return Pg(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(t,n){this.field=t,this.transform=n}}function hM(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof Ya&&i instanceof Ya||n instanceof Xa&&i instanceof Xa?$a(n.elements,i.elements,Rr):n instanceof hd&&i instanceof hd?Rr(n.C,i.C):n instanceof ud&&i instanceof ud}(e.transform,t.transform)}class dM{constructor(t,n){this.version=t,this.transformResults=n}}class Wr{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Wr}static exists(t){return new Wr(void 0,t)}static updateTime(t){return new Wr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function vh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class bf{}function fM(e,t,n){e instanceof wf?function(i,r,s){const o=i.value.clone(),a=f2(i.fieldTransforms,r,s.transformResults);o.setAll(a),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(e,t,n):e instanceof na?function(i,r,s){if(!vh(i.precondition,r))return void r.convertToUnknownDocument(s.version);const o=f2(i.fieldTransforms,r,s.transformResults),a=r.data;a.setAll(v9(i)),a.setAll(o),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(e,t,n):function(i,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,t,n)}function f0(e,t,n){e instanceof wf?function(i,r,s){if(!vh(i.precondition,r))return;const o=i.value.clone(),a=m2(i.fieldTransforms,s,r);o.setAll(a),r.convertToFoundDocument(d2(r),o).setHasLocalMutations()}(e,t,n):e instanceof na?function(i,r,s){if(!vh(i.precondition,r))return;const o=m2(i.fieldTransforms,s,r),a=r.data;a.setAll(v9(i)),a.setAll(o),r.convertToFoundDocument(d2(r),a).setHasLocalMutations()}(e,t,n):function(i,r){vh(i.precondition,r)&&r.convertToNoDocument(Nt.min())}(e,t)}function mM(e,t){let n=null;for(const i of e.fieldTransforms){const r=t.data.field(i.field),s=f9(i.transform,r||null);s!=null&&(n==null&&(n=Ai.empty()),n.set(i.field,s))}return n||null}function h2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&$a(n,i,(r,s)=>hM(r,s))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function d2(e){return e.isFoundDocument()?e.version:Nt.min()}class wf extends bf{constructor(t,n,i,r=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}}class na extends bf{constructor(t,n,i,r,s=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}}function v9(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function f2(e,t,n){const i=new Map;Qt(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,uM(o,a,n[r]))}return i}function m2(e,t,n){const i=new Map;for(const r of e){const s=r.transform,o=n.data.field(r.field);i.set(r.field,cM(s,o,t))}return i}class y9 extends bf{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}}class pM extends bf{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(t){this.count=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _n,Et;function _M(e){switch(e){default:return dt();case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0}}function b9(e){if(e===void 0)return Ds("GRPC error has no .code"),Ae.UNKNOWN;switch(e){case _n.OK:return Ae.OK;case _n.CANCELLED:return Ae.CANCELLED;case _n.UNKNOWN:return Ae.UNKNOWN;case _n.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case _n.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case _n.INTERNAL:return Ae.INTERNAL;case _n.UNAVAILABLE:return Ae.UNAVAILABLE;case _n.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case _n.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case _n.NOT_FOUND:return Ae.NOT_FOUND;case _n.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case _n.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case _n.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case _n.ABORTED:return Ae.ABORTED;case _n.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case _n.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case _n.DATA_LOSS:return Ae.DATA_LOSS;default:return dt()}}(Et=_n||(_n={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(t,n){this.comparator=t,this.root=n||Mn.EMPTY}insert(t,n){return new Gn(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Mn.BLACK,null,null))}remove(t){return new Gn(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Mn.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Hu(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Hu(this.root,t,this.comparator,!1)}getReverseIterator(){return new Hu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Hu(this.root,t,this.comparator,!0)}}class Hu{constructor(t,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?i(t.key,n):1,r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Mn{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i!=null?i:Mn.RED,this.left=r!=null?r:Mn.EMPTY,this.right=s!=null?s:Mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,r,s){return new Mn(t!=null?t:this.key,n!=null?n:this.value,i!=null?i:this.color,r!=null?r:this.left,s!=null?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Mn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,r=this;if(n(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(t,r.key)===0){if(r.right.isEmpty())return Mn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const t=this.left.check();if(t!==this.right.check())throw dt();return t+(this.isRed()?0:1)}}Mn.EMPTY=null,Mn.RED=!0,Mn.BLACK=!1;Mn.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(e,t,n,i,r){return this}insert(e,t,n){return new Mn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(t){this.comparator=t,this.data=new Gn(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;n(r.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new p2(this.data.getIterator())}getIteratorFrom(t){return new p2(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof Ln)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ln(this.comparator);return n.data=t,n}}class p2{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM=new Gn(nt.comparator);function Go(){return vM}const yM=new Gn(nt.comparator);function m0(){return yM}const bM=new Gn(nt.comparator);function wM(){return bM}const EM=new Ln(nt.comparator);function tn(...e){let t=EM;for(const n of e)t=t.add(n);return t}const SM=new Ln(Dt);function w9(){return SM}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(t,n,i,r,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n){const i=new Map;return i.set(t,uu.createSynthesizedTargetChangeForCurrentChange(t,n)),new Ef(Nt.min(),i,w9(),Go(),tn())}}class uu{constructor(t,n,i,r,s){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n){return new uu(Kn.EMPTY_BYTE_STRING,n,tn(),tn(),tn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(t,n,i,r){this.k=t,this.removedTargetIds=n,this.key=i,this.$=r}}class E9{constructor(t,n){this.targetId=t,this.O=n}}class S9{constructor(t,n,i=Kn.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=r}}class g2{constructor(){this.F=0,this.M=v2(),this.L=Kn.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return this.F!==0}get K(){return this.U}j(t){t.approximateByteSize()>0&&(this.U=!0,this.L=t)}W(){let t=tn(),n=tn(),i=tn();return this.M.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:dt()}}),new uu(this.L,this.B,t,n,i)}G(){this.U=!1,this.M=v2()}H(t,n){this.U=!0,this.M=this.M.insert(t,n)}J(t){this.U=!0,this.M=this.M.remove(t)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class TM{constructor(t){this.tt=t,this.et=new Map,this.nt=Go(),this.st=_2(),this.it=new Ln(Dt)}rt(t){for(const n of t.k)t.$&&t.$.isFoundDocument()?this.ot(n,t.$):this.ct(n,t.key,t.$);for(const n of t.removedTargetIds)this.ct(n,t.key,t.$)}at(t){this.forEachTarget(t,n=>{const i=this.ut(n);switch(t.state){case 0:this.ht(n)&&i.j(t.resumeToken);break;case 1:i.X(),i.q||i.G(),i.j(t.resumeToken);break;case 2:i.X(),i.q||this.removeTarget(n);break;case 3:this.ht(n)&&(i.Z(),i.j(t.resumeToken));break;case 4:this.ht(n)&&(this.lt(n),i.j(t.resumeToken));break;default:dt()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.et.forEach((i,r)=>{this.ht(r)&&n(r)})}ft(t){const n=t.targetId,i=t.O.count,r=this.dt(n);if(r){const s=r.target;if(h0(s))if(i===0){const o=new nt(s.path);this.ct(n,o,jn.newNoDocument(o,Nt.min()))}else Qt(i===1);else this.wt(n)!==i&&(this.lt(n),this.it=this.it.add(n))}}_t(t){const n=new Map;this.et.forEach((s,o)=>{const a=this.dt(o);if(a){if(s.current&&h0(a.target)){const l=new nt(a.target.path);this.nt.get(l)!==null||this.gt(o,l)||this.ct(o,l,jn.newNoDocument(l,t))}s.K&&(n.set(o,s.W()),s.G())}});let i=tn();this.st.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.dt(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(i=i.add(s))});const r=new Ef(t,n,this.it,this.nt,i);return this.nt=Go(),this.st=_2(),this.it=new Ln(Dt),r}ot(t,n){if(!this.ht(t))return;const i=this.gt(t,n.key)?2:0;this.ut(t).H(n.key,i),this.nt=this.nt.insert(n.key,n),this.st=this.st.insert(n.key,this.yt(n.key).add(t))}ct(t,n,i){if(!this.ht(t))return;const r=this.ut(t);this.gt(t,n)?r.H(n,1):r.J(n),this.st=this.st.insert(n,this.yt(n).delete(t)),i&&(this.nt=this.nt.insert(n,i))}removeTarget(t){this.et.delete(t)}wt(t){const n=this.ut(t).W();return this.tt.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Y(t){this.ut(t).Y()}ut(t){let n=this.et.get(t);return n||(n=new g2,this.et.set(t,n)),n}yt(t){let n=this.st.get(t);return n||(n=new Ln(Dt),this.st=this.st.insert(t,n)),n}ht(t){const n=this.dt(t)!==null;return n||tt("WatchChangeAggregator","Detected inactive target",t),n}dt(t){const n=this.et.get(t);return n&&n.q?null:this.tt.Tt(t)}lt(t){this.et.set(t,new g2),this.tt.getRemoteKeysForTarget(t).forEach(n=>{this.ct(t,n,null)})}gt(t,n){return this.tt.getRemoteKeysForTarget(t).has(n)}}function _2(){return new Gn(nt.comparator)}function v2(){return new Gn(nt.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),AM=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class xM{constructor(t,n){this.databaseId=t,this.D=n}}function dd(e,t){return e.D?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function T9(e,t){return e.D?t.toBase64():t.toUint8Array()}function CM(e,t){return dd(e,t.toTimestamp())}function Kr(e){return Qt(!!e),Nt.fromTimestamp(function(t){const n=Bs(t);return new Mi(n.seconds,n.nanos)}(e))}function zg(e,t){return function(n){return new en(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function k9(e){const t=en.fromString(e);return Qt(C9(t)),t}function p0(e,t){return zg(e.databaseId,t.path)}function Fm(e,t){const n=k9(t);if(n.get(1)!==e.databaseId.projectId)throw new $e(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new $e(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new nt(A9(n))}function g0(e,t){return zg(e.databaseId,t)}function IM(e){const t=k9(e);return t.length===4?en.emptyPath():A9(t)}function _0(e){return new en(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function A9(e){return Qt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function y2(e,t,n){return{name:p0(e,t),fields:n.value.mapValue.fields}}function RM(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:dt()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(l,c){return l.D?(Qt(c===void 0||typeof c=="string"),Kn.fromBase64String(c||"")):(Qt(c===void 0||c instanceof Uint8Array),Kn.fromUint8Array(c||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(l){const c=l.code===void 0?Ae.UNKNOWN:b9(l.code);return new $e(c,l.message||"")}(o);n=new S9(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Fm(e,i.document.name),s=Kr(i.document.updateTime),o=new Ai({mapValue:{fields:i.document.fields}}),a=jn.newFoundDocument(r,s,o),l=i.targetIds||[],c=i.removedTargetIds||[];n=new yh(l,c,a.key,a)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Fm(e,i.document),s=i.readTime?Kr(i.readTime):Nt.min(),o=jn.newNoDocument(r,s),a=i.removedTargetIds||[];n=new yh([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Fm(e,i.document),s=i.removedTargetIds||[];n=new yh([],s,r,null)}else{if(!("filter"in t))return dt();{t.filter;const i=t.filter;i.targetId;const r=i.count||0,s=new gM(r),o=i.targetId;n=new E9(o,s)}}return n}function MM(e,t){let n;if(t instanceof wf)n={update:y2(e,t.key,t.value)};else if(t instanceof y9)n={delete:p0(e,t.key)};else if(t instanceof na)n={update:y2(e,t.key,t.data),updateMask:HM(t.fieldMask)};else{if(!(t instanceof pM))return dt();n={verify:p0(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(r,s){const o=s.transform;if(o instanceof ud)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ya)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Xa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof hd)return{fieldPath:s.field.canonicalString(),increment:o.C};throw dt()}(0,i))),t.precondition.isNone||(n.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:CM(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:dt()}(e,t.precondition)),n}function OM(e,t){return e&&e.length>0?(Qt(t!==void 0),e.map(n=>function(i,r){let s=i.updateTime?Kr(i.updateTime):Kr(r);return s.isEqual(Nt.min())&&(s=Kr(r)),new dM(s,i.transformResults||[])}(n,t))):[]}function NM(e,t){return{documents:[g0(e,t.path)]}}function FM(e,t){const n={structuredQuery:{}},i=t.path;t.collectionGroup!==null?(n.parent=g0(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=g0(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(a){if(a.length===0)return;const l=a.map(c=>function(d){if(d.op==="=="){if(o2(d.value))return{unaryFilter:{field:ca(d.field),op:"IS_NAN"}};if(s2(d.value))return{unaryFilter:{field:ca(d.field),op:"IS_NULL"}}}else if(d.op==="!="){if(o2(d.value))return{unaryFilter:{field:ca(d.field),op:"IS_NOT_NAN"}};if(s2(d.value))return{unaryFilter:{field:ca(d.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ca(d.field),op:PM(d.op),value:d.value}}}(c));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(t.filters);r&&(n.structuredQuery.where=r);const s=function(a){if(a.length!==0)return a.map(l=>function(c){return{field:ca(c.field),direction:BM(c.dir)}}(l))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(a,l){return a.D||pl(l)?l:{value:l}}(e,t.limit);return o!==null&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=b2(t.startAt)),t.endAt&&(n.structuredQuery.endAt=b2(t.endAt)),n}function LM(e){let t=IM(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Qt(i===1);const d=n.from[0];d.allDescendants?r=d.collectionId:t=t.child(d.collectionId)}let s=[];n.where&&(s=x9(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(d=>function(u){return new Ra(Ea(u.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(u.direction))}(d)));let a=null;n.limit&&(a=function(d){let u;return u=typeof d=="object"?d.value:d,pl(u)?null:u}(n.limit));let l=null;n.startAt&&(l=w2(n.startAt));let c=null;return n.endAt&&(c=w2(n.endAt)),oM(t,r,o,s,a,"F",l,c)}function DM(e,t){const n=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return dt()}}(0,t.purpose);return n==null?null:{"goog-listen-tags":n}}function x9(e){return e?e.unaryFilter!==void 0?[jM(e)]:e.fieldFilter!==void 0?[UM(e)]:e.compositeFilter!==void 0?e.compositeFilter.filters.map(t=>x9(t)).reduce((t,n)=>t.concat(n)):dt():[]}function b2(e){return{before:e.before,values:e.position}}function w2(e){const t=!!e.before,n=e.values||[];return new Fc(n,t)}function BM(e){return kM[e]}function PM(e){return AM[e]}function ca(e){return{fieldPath:e.canonicalString()}}function Ea(e){return vi.fromServerFormat(e.fieldPath)}function UM(e){return ii.create(Ea(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(e.fieldFilter.op),e.fieldFilter.value)}function jM(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ea(e.unaryFilter.field);return ii.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ea(e.unaryFilter.field);return ii.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ea(e.unaryFilter.field);return ii.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Ea(e.unaryFilter.field);return ii.create(r,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}function HM(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function C9(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}const VM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new Ke((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof Ke?n:Ke.resolve(n)}catch(n){return Ke.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):Ke.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):Ke.reject(n)}static resolve(t){return new Ke((n,i)=>{n(t)})}static reject(t){return new Ke((n,i)=>{i(t)})}static waitFor(t){return new Ke((n,i)=>{let r=0,s=0,o=!1;t.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},l=>i(l))}),o=!0,s===r&&n()})}static or(t){let n=Ke.resolve(!1);for(const i of t)n=n.next(r=>r?Ke.resolve(r):i());return n}static forEach(t,n){const i=[];return t.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}}function hu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(t,n,i,r){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&fM(s,t,i[r])}}applyToLocalView(t){for(const n of this.baseMutations)n.key.isEqual(t.key)&&f0(n,t,this.localWriteTime);for(const n of this.mutations)n.key.isEqual(t.key)&&f0(n,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach(n=>{const i=t.get(n.key),r=i;this.applyToLocalView(r),i.isValidDocument()||r.convertToNoDocument(Nt.min())})}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),tn())}isEqual(t){return this.batchId===t.batchId&&$a(this.mutations,t.mutations,(n,i)=>h2(n,i))&&$a(this.baseMutations,t.baseMutations,(n,i)=>h2(n,i))}}class $g{constructor(t,n,i,r){this.batch=t,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(t,n,i){Qt(t.mutations.length===i.length);let r=wM();const s=t.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new $g(t,n,i,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(t,n,i,r,s=Nt.min(),o=Nt.min(),a=Kn.EMPTY_BYTE_STRING){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(t){return new Oo(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,n){return new Oo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(t){this.Wt=t}}function WM(e){const t=LM({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?l9(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(){this.Gt=new GM}addToCollectionParentIndex(t,n){return this.Gt.add(n),Ke.resolve()}getCollectionParents(t,n){return Ke.resolve(this.Gt.getEntries(n))}}class GM{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n]||new Ln(en.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Ln(en.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(t){this.ne=t}next(){return this.ne+=2,this.ne}static se(){return new Qa(0)}static ie(){return new Qa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function du(e){if(e.code!==Ae.FAILED_PRECONDITION||e.message!==VM)throw e;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={}}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),r=this.inner[i];if(r!==void 0){for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,n]);r.push([t,n])}else this.inner[i]=[[t,n]]}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[n]:i.splice(r,1),!0;return!1}forEach(t){ta(this.inner,(n,i)=>{for(const[r,s]of i)t(r,s)})}isEmpty(){return r9(this.inner)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.changes=new fu(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}getReadTime(t){const n=this.changes.get(t);return n?n.readTime:Nt.min()}addEntry(t,n){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:n})}removeEntry(t,n=null){this.assertNotApplied(),this.changes.set(t,{document:jn.newInvalidDocument(t),readTime:n})}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Ke.resolve(i.document):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(t,n,i){this.He=t,this.In=n,this.Ht=i}An(t,n){return this.In.getAllMutationBatchesAffectingDocumentKey(t,n).next(i=>this.Rn(t,n,i))}Rn(t,n,i){return this.He.getEntry(t,n).next(r=>{for(const s of i)s.applyToLocalView(r);return r})}bn(t,n){t.forEach((i,r)=>{for(const s of n)s.applyToLocalView(r)})}Pn(t,n){return this.He.getEntries(t,n).next(i=>this.vn(t,i).next(()=>i))}vn(t,n){return this.In.getAllMutationBatchesAffectingDocumentKeys(t,n).next(i=>this.bn(n,i))}getDocumentsMatchingQuery(t,n,i){return function(r){return nt.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.Vn(t,n.path):qg(n)?this.Sn(t,n,i):this.Dn(t,n,i)}Vn(t,n){return this.An(t,new nt(n)).next(i=>{let r=m0();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}Sn(t,n,i){const r=n.collectionGroup;let s=m0();return this.Ht.getCollectionParents(t,r).next(o=>Ke.forEach(o,a=>{const l=function(c,d){return new qs(d,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(r));return this.Dn(t,l,i).next(c=>{c.forEach((d,u)=>{s=s.insert(d,u)})})}).next(()=>s))}Dn(t,n,i){let r,s;return this.He.getDocumentsMatchingQuery(t,n,i).next(o=>(r=o,this.In.getAllMutationBatchesAffectingQuery(t,n))).next(o=>(s=o,this.Cn(t,s,r).next(a=>{r=a;for(const l of s)for(const c of l.mutations){const d=c.key;let u=r.get(d);u==null&&(u=jn.newInvalidDocument(d),r=r.insert(d,u)),f0(c,u,l.localWriteTime),u.isFoundDocument()||(r=r.remove(d))}}))).next(()=>(r.forEach((o,a)=>{vf(n,a)||(r=r.remove(o))}),r))}Cn(t,n,i){let r=tn();for(const o of n)for(const a of o.mutations)a instanceof na&&i.get(a.key)===null&&(r=r.add(a.key));let s=i;return this.He.getEntries(t,r).next(o=>(o.forEach((a,l)=>{l.isFoundDocument()&&(s=s.insert(a,l))}),s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(t,n,i,r){this.targetId=t,this.fromCache=n,this.Nn=i,this.xn=r}static kn(t,n){let i=tn(),r=tn();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Wg(t,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{$n(t){this.On=t}getDocumentsMatchingQuery(t,n,i,r){return function(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}(n)||i.isEqual(Nt.min())?this.Fn(t,n):this.On.Pn(t,r).next(s=>{const o=this.Mn(n,s);return(_h(n)||cd(n))&&this.Ln(n.limitType,o,r,i)?this.Fn(t,n):(t2()<=Ct.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),d0(n)),this.On.getDocumentsMatchingQuery(t,n,i).next(a=>(o.forEach(l=>{a=a.insert(l.key,l)}),a)))})}Mn(t,n){let i=new Ln(u9(t));return n.forEach((r,s)=>{vf(t,s)&&(i=i.add(s))}),i}Ln(t,n,i,r){if(i.size!==n.size)return!0;const s=t==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Fn(t,n){return t2()<=Ct.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",d0(n)),this.On.getDocumentsMatchingQuery(t,n,Nt.min())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(t,n,i,r){this.persistence=t,this.Bn=n,this.N=r,this.Un=new Gn(Dt),this.qn=new fu(s=>Ug(s),jg),this.Kn=Nt.min(),this.In=t.getMutationQueue(i),this.jn=t.getRemoteDocumentCache(),this.ze=t.getTargetCache(),this.Qn=new I9(this.jn,this.In,this.persistence.getIndexManager()),this.Je=t.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Un))}}function ZM(e,t,n,i){return new QM(e,t,n,i)}async function R9(e,t){const n=ft(e);let i=n.In,r=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",o=>{let a;return n.In.getAllMutationBatches(o).next(l=>(a=l,i=n.persistence.getMutationQueue(t),r=new I9(n.jn,i,n.persistence.getIndexManager()),i.getAllMutationBatches(o))).next(l=>{const c=[],d=[];let u=tn();for(const f of a){c.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}for(const f of l){d.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}return r.Pn(o,u).next(f=>({Wn:f,removedBatchIds:c,addedBatchIds:d}))})});return n.In=i,n.Qn=r,n.Bn.$n(n.Qn),s}function JM(e,t){const n=ft(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),s=n.jn.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const d=l.batch,u=d.keys();let f=Ke.resolve();return u.forEach(m=>{f=f.next(()=>c.getEntry(a,m)).next(h=>{const R=l.docVersions.get(m);Qt(R!==null),h.version.compareTo(R)<0&&(d.applyToRemoteDocument(h,l),h.isValidDocument()&&c.addEntry(h,l.commitVersion))})}),f.next(()=>o.In.removeMutationBatch(a,d))}(n,i,t,s).next(()=>s.apply(i)).next(()=>n.In.performConsistencyCheck(i)).next(()=>n.Qn.Pn(i,r))})}function M9(e){const t=ft(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.ze.getLastRemoteSnapshotVersion(n))}function eO(e,t){const n=ft(e),i=t.snapshotVersion;let r=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.jn.newChangeBuffer({trackRemovals:!0});r=n.Un;const a=[];t.targetChanges.forEach((c,d)=>{const u=r.get(d);if(!u)return;a.push(n.ze.removeMatchingKeys(s,c.removedDocuments,d).next(()=>n.ze.addMatchingKeys(s,c.addedDocuments,d)));const f=c.resumeToken;if(f.approximateByteSize()>0){const m=u.withResumeToken(f,i).withSequenceNumber(s.currentSequenceNumber);r=r.insert(d,m),function(h,R,M){return Qt(R.resumeToken.approximateByteSize()>0),h.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(u,m,c)&&a.push(n.ze.updateTargetData(s,m))}});let l=Go();if(t.documentUpdates.forEach((c,d)=>{t.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,c))}),a.push(tO(s,o,t.documentUpdates,i,void 0).next(c=>{l=c})),!i.isEqual(Nt.min())){const c=n.ze.getLastRemoteSnapshotVersion(s).next(d=>n.ze.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(c)}return Ke.waitFor(a).next(()=>o.apply(s)).next(()=>n.Qn.vn(s,l)).next(()=>l)}).then(s=>(n.Un=r,s))}function tO(e,t,n,i,r){let s=tn();return n.forEach(o=>s=s.add(o)),t.getEntries(e,s).next(o=>{let a=Go();return n.forEach((l,c)=>{const d=o.get(l),u=(r==null?void 0:r.get(l))||i;c.isNoDocument()&&c.version.isEqual(Nt.min())?(t.removeEntry(l,u),a=a.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(c,u),a=a.insert(l,c)):tt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),a})}function nO(e,t){const n=ft(e);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),n.In.getNextMutationBatchAfterBatchId(i,t)))}function iO(e,t){const n=ft(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.ze.getTargetData(i,t).next(s=>s?(r=s,Ke.resolve(r)):n.ze.allocateTargetId(i).next(o=>(r=new Oo(t,o,0,i.currentSequenceNumber),n.ze.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.Un.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(i.targetId,i),n.qn.set(t,i.targetId)),i})}async function v0(e,t,n){const i=ft(e),r=i.Un.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!hu(o))throw o;tt("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}i.Un=i.Un.remove(t),i.qn.delete(r.target)}function E2(e,t,n){const i=ft(e);let r=Nt.min(),s=tn();return i.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const d=ft(a),u=d.qn.get(c);return u!==void 0?Ke.resolve(d.Un.get(u)):d.ze.getTargetData(l,c)}(i,o,Ko(t)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.ze.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.Bn.getDocumentsMatchingQuery(o,t,n?r:Nt.min(),n?s:tn())).next(a=>({documents:a,Gn:s})))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(t){this.N=t,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(t,n){return Ke.resolve(this.Yn.get(n))}saveBundleMetadata(t,n){var i;return this.Yn.set(n.id,{id:(i=n).id,version:i.version,createTime:Kr(i.createTime)}),Ke.resolve()}getNamedQuery(t,n){return Ke.resolve(this.Xn.get(n))}saveNamedQuery(t,n){return this.Xn.set(n.name,function(i){return{name:i.name,query:WM(i.bundledQuery),readTime:Kr(i.readTime)}}(n)),Ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(){this.Zn=new Ln(Tn.ts),this.es=new Ln(Tn.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,n){const i=new Tn(t,n);this.Zn=this.Zn.add(i),this.es=this.es.add(i)}ss(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.rs(new Tn(t,n))}os(t,n){t.forEach(i=>this.removeReference(i,n))}cs(t){const n=new nt(new en([])),i=new Tn(n,t),r=new Tn(n,t+1),s=[];return this.es.forEachInRange([i,r],o=>{this.rs(o),s.push(o.key)}),s}us(){this.Zn.forEach(t=>this.rs(t))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const n=new nt(new en([])),i=new Tn(n,t),r=new Tn(n,t+1);let s=tn();return this.es.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new Tn(t,0),i=this.Zn.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class Tn{constructor(t,n){this.key=t,this.ls=n}static ts(t,n){return nt.comparator(t.key,n.key)||Dt(t.ls,n.ls)}static ns(t,n){return Dt(t.ls,n.ls)||nt.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(t,n){this.Ht=t,this.referenceDelegate=n,this.In=[],this.fs=1,this.ds=new Ln(Tn.ts)}checkEmpty(t){return Ke.resolve(this.In.length===0)}addMutationBatch(t,n,i,r){const s=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const o=new zM(s,n,i,r);this.In.push(o);for(const a of r)this.ds=this.ds.add(new Tn(a.key,s)),this.Ht.addToCollectionParentIndex(t,a.key.path.popLast());return Ke.resolve(o)}lookupMutationBatch(t,n){return Ke.resolve(this.ws(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,r=this._s(i),s=r<0?0:r;return Ke.resolve(this.In.length>s?this.In[s]:null)}getHighestUnacknowledgedBatchId(){return Ke.resolve(this.In.length===0?-1:this.fs-1)}getAllMutationBatches(t){return Ke.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new Tn(n,0),r=new Tn(n,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([i,r],o=>{const a=this.ws(o.ls);s.push(a)}),Ke.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new Ln(Dt);return n.forEach(r=>{const s=new Tn(r,0),o=new Tn(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,o],a=>{i=i.add(a.ls)})}),Ke.resolve(this.gs(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,r=i.length+1;let s=i;nt.isDocumentKey(s)||(s=s.child(""));const o=new Tn(new nt(s),0);let a=new Ln(Dt);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.ls)),!0)},o),Ke.resolve(this.gs(a))}gs(t){const n=[];return t.forEach(i=>{const r=this.ws(i);r!==null&&n.push(r)}),n}removeMutationBatch(t,n){Qt(this.ys(n.batchId,"removed")===0),this.In.shift();let i=this.ds;return Ke.forEach(n.mutations,r=>{const s=new Tn(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.ds=i})}te(t){}containsKey(t,n){const i=new Tn(n,0),r=this.ds.firstAfterOrEqual(i);return Ke.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(t){return this.In.length,Ke.resolve()}ys(t,n){return this._s(t)}_s(t){return this.In.length===0?0:t-this.In[0].batchId}ws(t){const n=this._s(t);return n<0||n>=this.In.length?null:this.In[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(t,n){this.Ht=t,this.ps=n,this.docs=new Gn(nt.comparator),this.size=0}addEntry(t,n,i){const r=n.key,s=this.docs.get(r),o=s?s.size:0,a=this.ps(n);return this.docs=this.docs.insert(r,{document:n.clone(),size:a,readTime:i}),this.size+=a-o,this.Ht.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return Ke.resolve(i?i.document.clone():jn.newInvalidDocument(n))}getEntries(t,n){let i=Go();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.clone():jn.newInvalidDocument(r))}),Ke.resolve(i)}getDocumentsMatchingQuery(t,n,i){let r=Go();const s=new nt(n.path.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:a,value:{document:l,readTime:c}}=o.getNext();if(!n.path.isPrefixOf(a.path))break;c.compareTo(i)<=0||vf(n,l)&&(r=r.insert(l.key,l.clone()))}return Ke.resolve(r)}Ts(t,n){return Ke.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new aO(this)}getSize(t){return Ke.resolve(this.size)}}class aO extends YM{constructor(t){super(),this.Se=t}applyChanges(t){const n=[];return this.changes.forEach((i,r)=>{r.document.isValidDocument()?n.push(this.Se.addEntry(t,r.document,this.getReadTime(i))):this.Se.removeEntry(i)}),Ke.waitFor(n)}getFromCache(t,n){return this.Se.getEntry(t,n)}getAllFromCache(t,n){return this.Se.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(t){this.persistence=t,this.Es=new fu(n=>Ug(n),jg),this.lastRemoteSnapshotVersion=Nt.min(),this.highestTargetId=0,this.Is=0,this.As=new Kg,this.targetCount=0,this.Rs=Qa.se()}forEachTarget(t,n){return this.Es.forEach((i,r)=>n(r)),Ke.resolve()}getLastRemoteSnapshotVersion(t){return Ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ke.resolve(this.Is)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),Ke.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.Is&&(this.Is=n),Ke.resolve()}ce(t){this.Es.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Rs=new Qa(n),this.highestTargetId=n),t.sequenceNumber>this.Is&&(this.Is=t.sequenceNumber)}addTargetData(t,n){return this.ce(n),this.targetCount+=1,Ke.resolve()}updateTargetData(t,n){return this.ce(n),Ke.resolve()}removeTargetData(t,n){return this.Es.delete(n.target),this.As.cs(n.targetId),this.targetCount-=1,Ke.resolve()}removeTargets(t,n,i){let r=0;const s=[];return this.Es.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Es.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)}),Ke.waitFor(s).next(()=>r)}getTargetCount(t){return Ke.resolve(this.targetCount)}getTargetData(t,n){const i=this.Es.get(n)||null;return Ke.resolve(i)}addMatchingKeys(t,n,i){return this.As.ss(n,i),Ke.resolve()}removeMatchingKeys(t,n,i){this.As.os(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(t,o))}),Ke.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.As.cs(n),Ke.resolve()}getMatchingKeysForTargetId(t,n){const i=this.As.hs(n);return Ke.resolve(i)}containsKey(t,n){return Ke.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(t,n){this.bs={},this.Le=new Lg(0),this.Be=!1,this.Be=!0,this.referenceDelegate=t(this),this.ze=new lO(this),this.Ht=new KM,this.He=function(i,r){return new oO(i,r)}(this.Ht,i=>this.referenceDelegate.Ps(i)),this.N=new $M(n),this.Je=new rO(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(t){let n=this.bs[t.toKey()];return n||(n=new sO(this.Ht,this.referenceDelegate),this.bs[t.toKey()]=n),n}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(t,n,i){tt("MemoryPersistence","Starting transaction:",t);const r=new uO(this.Le.next());return this.referenceDelegate.vs(),i(r).next(s=>this.referenceDelegate.Vs(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ss(t,n){return Ke.or(Object.values(this.bs).map(i=>()=>i.containsKey(t,n)))}}class uO extends qM{constructor(t){super(),this.currentSequenceNumber=t}}class Gg{constructor(t){this.persistence=t,this.Ds=new Kg,this.Cs=null}static Ns(t){return new Gg(t)}get xs(){if(this.Cs)return this.Cs;throw dt()}addReference(t,n,i){return this.Ds.addReference(i,n),this.xs.delete(i.toString()),Ke.resolve()}removeReference(t,n,i){return this.Ds.removeReference(i,n),this.xs.add(i.toString()),Ke.resolve()}markPotentiallyOrphaned(t,n){return this.xs.add(n.toString()),Ke.resolve()}removeTarget(t,n){this.Ds.cs(n.targetId).forEach(r=>this.xs.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(r=>{r.forEach(s=>this.xs.add(s.toString()))}).next(()=>i.removeTargetData(t,n))}vs(){this.Cs=new Set}Vs(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ke.forEach(this.xs,i=>{const r=nt.fromPath(i);return this.ks(t,r).next(s=>{s||n.removeEntry(r)})}).next(()=>(this.Cs=null,n.apply(t)))}updateLimboDocument(t,n){return this.ks(t,n).next(i=>{i?this.xs.delete(n.toString()):this.xs.add(n.toString())})}Ps(t){return 0}ks(t,n){return Ke.or([()=>Ke.resolve(this.Ds.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ss(t,n)])}}class S2{constructor(){this.activeTargetIds=w9()}Fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ms(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Os(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class hO{constructor(){this.yi=new S2,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t){return this.yi.Fs(t),this.pi[t]||"not-current"}updateQueryState(t,n,i){this.pi[t]=n}removeLocalQueryTarget(t){this.yi.Ms(t)}isLocalQueryTarget(t){return this.yi.activeTargetIds.has(t)}clearQueryState(t){delete this.pi[t]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(t){return this.yi.activeTargetIds.has(t)}start(){return this.yi=new S2,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{Ti(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(){this.Ei=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ti(t){this.bi.push(t)}shutdown(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ai)}Ii(){tt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.bi)t(0)}Ri(){tt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.bi)t(1)}static bt(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(t){this.vi=t.vi,this.Vi=t.Vi}Si(t){this.Di=t}Ci(t){this.Ni=t}onMessage(t){this.xi=t}close(){this.Vi()}send(t){this.vi(t)}ki(){this.Di()}$i(t){this.Ni(t)}Oi(t){this.xi(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http";this.Fi=n+"://"+t.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(t,n,i,r){const s=this.Bi(t,n);tt("RestConnection","Sending: ",s,i);const o={};return this.Ui(o,r),this.qi(t,s,o,i).then(a=>(tt("RestConnection","Received: ",a),a),a=>{throw n2("RestConnection",`${t} failed with error: `,a,"url: ",s,"request:",i),a})}Ki(t,n,i,r){return this.Li(t,n,i,r)}Ui(t,n){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+ml,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n)for(const i in n.authHeaders)n.authHeaders.hasOwnProperty(i)&&(t[i]=n.authHeaders[i])}Bi(t,n){const i=fO[t];return`${this.Fi}/v1/${n}:${i}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}qi(t,n,i,r){return new Promise((s,o)=>{const a=new U7;a.listenOnce(D7.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Nm.NO_ERROR:const c=a.getResponseJson();tt("Connection","XHR received:",JSON.stringify(c)),s(c);break;case Nm.TIMEOUT:tt("Connection",'RPC "'+t+'" timed out'),o(new $e(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case Nm.HTTP_ERROR:const d=a.getStatus();if(tt("Connection",'RPC "'+t+'" failed with status:',d,"response text:",a.getResponseText()),d>0){const u=a.getResponseJson().error;if(u&&u.status&&u.message){const f=function(m){const h=m.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(h)>=0?h:Ae.UNKNOWN}(u.status);o(new $e(f,u.message))}else o(new $e(Ae.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new $e(Ae.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{tt("Connection",'RPC "'+t+'" completed.')}});const l=JSON.stringify(r);a.send(n,"POST",l,i,15)})}ji(t,n){const i=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=F7(),s=L7(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new P7({})),this.Ui(o.initMessageHeaders,n),Ep()||Hw()||yA()||bA()||wA()||vA()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=i.join("");tt("Connection","Creating WebChannel: "+a,o);const l=r.createWebChannel(a,o);let c=!1,d=!1;const u=new mO({vi:m=>{d?tt("Connection","Not sending because WebChannel is closed:",m):(c||(tt("Connection","Opening WebChannel transport."),l.open(),c=!0),tt("Connection","WebChannel sending:",m),l.send(m))},Vi:()=>l.close()}),f=(m,h,R)=>{m.listen(h,M=>{try{R(M)}catch(C){setTimeout(()=>{throw C},0)}})};return f(l,ju.EventType.OPEN,()=>{d||tt("Connection","WebChannel transport opened.")}),f(l,ju.EventType.CLOSE,()=>{d||(d=!0,tt("Connection","WebChannel transport closed"),u.$i())}),f(l,ju.EventType.ERROR,m=>{d||(d=!0,n2("Connection","WebChannel transport errored:",m),u.$i(new $e(Ae.UNAVAILABLE,"The operation could not be completed")))}),f(l,ju.EventType.MESSAGE,m=>{var h;if(!d){const R=m.data[0];Qt(!!R);const M=R,C=M.error||((h=M[0])===null||h===void 0?void 0:h.error);if(C){tt("Connection","WebChannel received error:",C);const _=C.status;let x=function(O){const N=_n[O];if(N!==void 0)return b9(N)}(_),F=C.message;x===void 0&&(x=Ae.INTERNAL,F="Unknown error status: "+_+" with message "+C.message),d=!0,u.$i(new $e(x,F)),l.close()}else tt("Connection","WebChannel received:",R),u.Oi(R)}}),f(s,B7.STAT_EVENT,m=>{m.stat===Jy.PROXY?tt("Connection","Detected buffering proxy"):m.stat===Jy.NOPROXY&&tt("Connection","Detected no buffering proxy")}),setTimeout(()=>{u.ki()},0),u}}function Lm(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(e){return new xM(e,!0)}class O9{constructor(t,n,i=1e3,r=1.5,s=6e4){this.Oe=t,this.timerId=n,this.Qi=i,this.Wi=r,this.Gi=s,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(t){this.cancel();const n=Math.floor(this.zi+this.Zi()),i=Math.max(0,Date.now()-this.Ji),r=Math.max(0,n-i);r>0&&tt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zi} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,r,()=>(this.Ji=Date.now(),t())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){this.Hi!==null&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){this.Hi!==null&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N9{constructor(t,n,i,r,s,o,a){this.Oe=t,this.er=i,this.nr=r,this.sr=s,this.credentialsProvider=o,this.listener=a,this.state=0,this.ir=0,this.rr=null,this.cr=null,this.stream=null,this.ar=new O9(t,n)}ur(){return this.state===1||this.state===5||this.hr()}hr(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.lr()}async stop(){this.ur()&&await this.close(0)}dr(){this.state=0,this.ar.reset()}wr(){this.hr()&&this.rr===null&&(this.rr=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this._r()))}mr(t){this.gr(),this.stream.send(t)}async _r(){if(this.hr())return this.close(0)}gr(){this.rr&&(this.rr.cancel(),this.rr=null)}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}async close(t,n){this.gr(),this.yr(),this.ar.cancel(),this.ir++,t!==4?this.ar.reset():n&&n.code===Ae.RESOURCE_EXHAUSTED?(Ds(n.toString()),Ds("Using maximum backoff delay to prevent overloading the backend."),this.ar.Yi()):n&&n.code===Ae.UNAUTHENTICATED&&this.state!==3&&this.credentialsProvider.invalidateToken(),this.stream!==null&&(this.pr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ci(n)}pr(){}auth(){this.state=1;const t=this.Tr(this.ir),n=this.ir;this.credentialsProvider.getToken().then(i=>{this.ir===n&&this.Er(i)},i=>{t(()=>{const r=new $e(Ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Ir(r)})})}Er(t){const n=this.Tr(this.ir);this.stream=this.Ar(t),this.stream.Si(()=>{n(()=>(this.state=2,this.cr=this.Oe.enqueueAfterDelay(this.nr,1e4,()=>(this.hr()&&(this.state=3),Promise.resolve())),this.listener.Si()))}),this.stream.Ci(i=>{n(()=>this.Ir(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}lr(){this.state=5,this.ar.Xi(async()=>{this.state=0,this.start()})}Ir(t){return tt("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Tr(t){return n=>{this.Oe.enqueueAndForget(()=>this.ir===t?n():(tt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gO extends N9{constructor(t,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s),this.N=r}Ar(t){return this.sr.ji("Listen",t)}onMessage(t){this.ar.reset();const n=RM(this.N,t),i=function(r){if(!("targetChange"in r))return Nt.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?Nt.min():s.readTime?Kr(s.readTime):Nt.min()}(t);return this.listener.Rr(n,i)}br(t){const n={};n.database=_0(this.N),n.addTarget=function(r,s){let o;const a=s.target;return o=h0(a)?{documents:NM(r,a)}:{query:FM(r,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=T9(r,s.resumeToken):s.snapshotVersion.compareTo(Nt.min())>0&&(o.readTime=dd(r,s.snapshotVersion.toTimestamp())),o}(this.N,t);const i=DM(this.N,t);i&&(n.labels=i),this.mr(n)}Pr(t){const n={};n.database=_0(this.N),n.removeTarget=t,this.mr(n)}}class _O extends N9{constructor(t,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,s),this.N=r,this.vr=!1}get Vr(){return this.vr}start(){this.vr=!1,this.lastStreamToken=void 0,super.start()}pr(){this.vr&&this.Sr([])}Ar(t){return this.sr.ji("Write",t)}onMessage(t){if(Qt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.vr){this.ar.reset();const n=OM(t.writeResults,t.commitTime),i=Kr(t.commitTime);return this.listener.Dr(i,n)}return Qt(!t.writeResults||t.writeResults.length===0),this.vr=!0,this.listener.Cr()}Nr(){const t={};t.database=_0(this.N),this.mr(t)}Sr(t){const n={streamToken:this.lastStreamToken,writes:t.map(i=>MM(this.N,i))};this.mr(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO extends class{}{constructor(t,n,i){super(),this.credentials=t,this.sr=n,this.N=i,this.kr=!1}$r(){if(this.kr)throw new $e(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}Li(t,n,i){return this.$r(),this.credentials.getToken().then(r=>this.sr.Li(t,n,i,r)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Ae.UNAUTHENTICATED&&this.credentials.invalidateToken(),r):new $e(Ae.UNKNOWN,r.toString())})}Ki(t,n,i){return this.$r(),this.credentials.getToken().then(r=>this.sr.Ki(t,n,i,r)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Ae.UNAUTHENTICATED&&this.credentials.invalidateToken(),r):new $e(Ae.UNKNOWN,r.toString())})}terminate(){this.kr=!0}}class yO{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.Or=0,this.Fr=null,this.Mr=!0}Lr(){this.Or===0&&(this.Br("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.Fr=null,this.Ur("Backend didn't respond within 10 seconds."),this.Br("Offline"),Promise.resolve())))}qr(t){this.state==="Online"?this.Br("Unknown"):(this.Or++,this.Or>=1&&(this.Kr(),this.Ur(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Br("Offline")))}set(t){this.Kr(),this.Or=0,t==="Online"&&(this.Mr=!1),this.Br(t)}Br(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Ur(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Mr?(Ds(n),this.Mr=!1):tt("OnlineStateTracker",n)}Kr(){this.Fr!==null&&(this.Fr.cancel(),this.Fr=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(t,n,i,r,s){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.jr=[],this.Qr=new Map,this.Wr=new Set,this.Gr=[],this.zr=s,this.zr.Ti(o=>{i.enqueueAndForget(async()=>{ia(this)&&(tt("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=ft(a);l.Wr.add(4),await mu(l),l.Hr.set("Unknown"),l.Wr.delete(4),await Tf(l)}(this))})}),this.Hr=new yO(i,r)}}async function Tf(e){if(ia(e))for(const t of e.Gr)await t(!0)}async function mu(e){for(const t of e.Gr)await t(!1)}function F9(e,t){const n=ft(e);n.Qr.has(t.targetId)||(n.Qr.set(t.targetId,t),Qg(n)?Xg(n):gl(n).hr()&&Yg(n,t))}function L9(e,t){const n=ft(e),i=gl(n);n.Qr.delete(t),i.hr()&&D9(n,t),n.Qr.size===0&&(i.hr()?i.wr():ia(n)&&n.Hr.set("Unknown"))}function Yg(e,t){e.Jr.Y(t.targetId),gl(e).br(t)}function D9(e,t){e.Jr.Y(t),gl(e).Pr(t)}function Xg(e){e.Jr=new TM({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Tt:t=>e.Qr.get(t)||null}),gl(e).start(),e.Hr.Lr()}function Qg(e){return ia(e)&&!gl(e).ur()&&e.Qr.size>0}function ia(e){return ft(e).Wr.size===0}function B9(e){e.Jr=void 0}async function wO(e){e.Qr.forEach((t,n)=>{Yg(e,t)})}async function EO(e,t){B9(e),Qg(e)?(e.Hr.qr(t),Xg(e)):e.Hr.set("Unknown")}async function SO(e,t,n){if(e.Hr.set("Online"),t instanceof S9&&t.state===2&&t.cause)try{await async function(i,r){const s=r.cause;for(const o of r.targetIds)i.Qr.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Qr.delete(o),i.Jr.removeTarget(o))}(e,t)}catch(i){tt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await fd(e,i)}else if(t instanceof yh?e.Jr.rt(t):t instanceof E9?e.Jr.ft(t):e.Jr.at(t),!n.isEqual(Nt.min()))try{const i=await M9(e.localStore);n.compareTo(i)>=0&&await function(r,s){const o=r.Jr._t(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=r.Qr.get(l);c&&r.Qr.set(l,c.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const l=r.Qr.get(a);if(!l)return;r.Qr.set(a,l.withResumeToken(Kn.EMPTY_BYTE_STRING,l.snapshotVersion)),D9(r,a);const c=new Oo(l.target,a,1,l.sequenceNumber);Yg(r,c)}),r.remoteSyncer.applyRemoteEvent(o)}(e,n)}catch(i){tt("RemoteStore","Failed to raise snapshot:",i),await fd(e,i)}}async function fd(e,t,n){if(!hu(t))throw t;e.Wr.add(1),await mu(e),e.Hr.set("Offline"),n||(n=()=>M9(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{tt("RemoteStore","Retrying IndexedDB access"),await n(),e.Wr.delete(1),await Tf(e)})}function P9(e,t){return t().catch(n=>fd(e,n,t))}async function kf(e){const t=ft(e),n=Ps(t);let i=t.jr.length>0?t.jr[t.jr.length-1].batchId:-1;for(;TO(t);)try{const r=await nO(t.localStore,i);if(r===null){t.jr.length===0&&n.wr();break}i=r.batchId,kO(t,r)}catch(r){await fd(t,r)}U9(t)&&j9(t)}function TO(e){return ia(e)&&e.jr.length<10}function kO(e,t){e.jr.push(t);const n=Ps(e);n.hr()&&n.Vr&&n.Sr(t.mutations)}function U9(e){return ia(e)&&!Ps(e).ur()&&e.jr.length>0}function j9(e){Ps(e).start()}async function AO(e){Ps(e).Nr()}async function xO(e){const t=Ps(e);for(const n of e.jr)t.Sr(n.mutations)}async function CO(e,t,n){const i=e.jr.shift(),r=$g.from(i,t,n);await P9(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await kf(e)}async function IO(e,t){t&&Ps(e).Vr&&await async function(n,i){if(r=i.code,_M(r)&&r!==Ae.ABORTED){const s=n.jr.shift();Ps(n).dr(),await P9(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await kf(n)}var r}(e,t),U9(e)&&j9(e)}async function RO(e,t){const n=ft(e);t?(n.Wr.delete(2),await Tf(n)):t||(n.Wr.add(2),await mu(n),n.Hr.set("Unknown"))}function gl(e){return e.Yr||(e.Yr=function(t,n,i){const r=ft(t);return r.$r(),new gO(n,r.sr,r.credentials,r.N,i)}(e.datastore,e.asyncQueue,{Si:wO.bind(null,e),Ci:EO.bind(null,e),Rr:SO.bind(null,e)}),e.Gr.push(async t=>{t?(e.Yr.dr(),Qg(e)?Xg(e):e.Hr.set("Unknown")):(await e.Yr.stop(),B9(e))})),e.Yr}function Ps(e){return e.Xr||(e.Xr=function(t,n,i){const r=ft(t);return r.$r(),new _O(n,r.sr,r.credentials,r.N,i)}(e.datastore,e.asyncQueue,{Si:AO.bind(null,e),Ci:IO.bind(null,e),Cr:xO.bind(null,e),Dr:CO.bind(null,e)}),e.Gr.push(async t=>{t?(e.Xr.dr(),await kf(e)):(await e.Xr.stop(),e.jr.length>0&&(tt("RemoteStore",`Stopping write stream with ${e.jr.length} pending writes`),e.jr=[]))})),e.Xr}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(t,n,i,r,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new $r,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,n,i,r,s){const o=Date.now()+i,a=new Zg(t,n,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ae.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jg(e,t){if(Ds("AsyncQueue",`${t}: ${e}`),hu(e))return new $e(Ae.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(t){this.comparator=t?(n,i)=>t(n,i)||nt.comparator(n.key,i.key):(n,i)=>nt.comparator(n.key,i.key),this.keyedMap=m0(),this.sortedSet=new Gn(this.comparator)}static emptySet(t){return new Ma(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Ma)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Ma;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(){this.Zr=new Gn(nt.comparator)}track(t){const n=t.doc.key,i=this.Zr.get(n);i?t.type!==0&&i.type===3?this.Zr=this.Zr.insert(n,t):t.type===3&&i.type!==1?this.Zr=this.Zr.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Zr=this.Zr.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Zr=this.Zr.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Zr=this.Zr.remove(n):t.type===1&&i.type===2?this.Zr=this.Zr.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Zr=this.Zr.insert(n,{type:2,doc:t.doc}):dt():this.Zr=this.Zr.insert(n,t)}eo(){const t=[];return this.Zr.inorderTraversal((n,i)=>{t.push(i)}),t}}class Za{constructor(t,n,i,r,s,o,a,l){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(t,n,i,r){const s=[];return n.forEach(o=>{s.push({type:0,doc:o})}),new Za(t,n,Ma.emptySet(n),s,i,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_f(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(){this.no=void 0,this.listeners=[]}}class OO{constructor(){this.queries=new fu(t=>c9(t),_f),this.onlineState="Unknown",this.so=new Set}}async function e_(e,t){const n=ft(e),i=t.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new MO),r)try{s.no=await n.onListen(i)}catch(o){const a=Jg(o,`Initialization of query '${d0(t.query)}' failed`);return void t.onError(a)}n.queries.set(i,s),s.listeners.push(t),t.io(n.onlineState),s.no&&t.ro(s.no)&&n_(n)}async function t_(e,t){const n=ft(e),i=t.query;let r=!1;const s=n.queries.get(i);if(s){const o=s.listeners.indexOf(t);o>=0&&(s.listeners.splice(o,1),r=s.listeners.length===0)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function NO(e,t){const n=ft(e);let i=!1;for(const r of t){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.ro(r)&&(i=!0);o.no=r}}i&&n_(n)}function FO(e,t,n){const i=ft(e),r=i.queries.get(t);if(r)for(const s of r.listeners)s.onError(n);i.queries.delete(t)}function n_(e){e.so.forEach(t=>{t.next()})}class i_{constructor(t,n,i){this.query=t,this.oo=n,this.co=!1,this.ao=null,this.onlineState="Unknown",this.options=i||{}}ro(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new Za(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let n=!1;return this.co?this.uo(t)&&(this.oo.next(t),n=!0):this.ho(t,this.onlineState)&&(this.lo(t),n=!0),this.ao=t,n}onError(t){this.oo.error(t)}io(t){this.onlineState=t;let n=!1;return this.ao&&!this.co&&this.ho(this.ao,t)&&(this.lo(this.ao),n=!0),n}ho(t,n){if(!t.fromCache)return!0;const i=n!=="Offline";return(!this.options.fo||!i)&&(!t.docs.isEmpty()||n==="Offline")}uo(t){if(t.docChanges.length>0)return!0;const n=this.ao&&this.ao.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}lo(t){t=Za.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.co=!0,this.oo.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(t){this.key=t}}class V9{constructor(t){this.key=t}}class LO{constructor(t,n){this.query=t,this.po=n,this.To=null,this.current=!1,this.Eo=tn(),this.mutatedKeys=tn(),this.Io=u9(t),this.Ao=new Ma(this.Io)}get Ro(){return this.po}bo(t,n){const i=n?n.Po:new k2,r=n?n.Ao:this.Ao;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=_h(this.query)&&r.size===this.query.limit?r.last():null,c=cd(this.query)&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((d,u)=>{const f=r.get(d),m=vf(this.query,u)?u:null,h=!!f&&this.mutatedKeys.has(f.key),R=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let M=!1;f&&m?f.data.isEqual(m.data)?h!==R&&(i.track({type:3,doc:m}),M=!0):this.vo(f,m)||(i.track({type:2,doc:m}),M=!0,(l&&this.Io(m,l)>0||c&&this.Io(m,c)<0)&&(a=!0)):!f&&m?(i.track({type:0,doc:m}),M=!0):f&&!m&&(i.track({type:1,doc:f}),M=!0,(l||c)&&(a=!0)),M&&(m?(o=o.add(m),s=R?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),_h(this.query)||cd(this.query))for(;o.size>this.query.limit;){const d=_h(this.query)?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{Ao:o,Po:i,Ln:a,mutatedKeys:s}}vo(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i){const r=this.Ao;this.Ao=t.Ao,this.mutatedKeys=t.mutatedKeys;const s=t.Po.eo();s.sort((c,d)=>function(u,f){const m=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return m(u)-m(f)}(c.type,d.type)||this.Io(c.doc,d.doc)),this.Vo(i);const o=n?this.So():[],a=this.Eo.size===0&&this.current?1:0,l=a!==this.To;return this.To=a,s.length!==0||l?{snapshot:new Za(this.query,t.Ao,r,s,t.mutatedKeys,a===0,l,!1),Do:o}:{Do:o}}io(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ao:this.Ao,Po:new k2,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{Do:[]}}Co(t){return!this.po.has(t)&&!!this.Ao.has(t)&&!this.Ao.get(t).hasLocalMutations}Vo(t){t&&(t.addedDocuments.forEach(n=>this.po=this.po.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.po=this.po.delete(n)),this.current=t.current)}So(){if(!this.current)return[];const t=this.Eo;this.Eo=tn(),this.Ao.forEach(i=>{this.Co(i.key)&&(this.Eo=this.Eo.add(i.key))});const n=[];return t.forEach(i=>{this.Eo.has(i)||n.push(new V9(i))}),this.Eo.forEach(i=>{t.has(i)||n.push(new H9(i))}),n}No(t){this.po=t.Gn,this.Eo=tn();const n=this.bo(t.documents);return this.applyChanges(n,!0)}xo(){return Za.fromInitialDocuments(this.query,this.Ao,this.mutatedKeys,this.To===0)}}class DO{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class BO{constructor(t){this.key=t,this.ko=!1}}class PO{constructor(t,n,i,r,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.$o={},this.Oo=new fu(a=>c9(a),_f),this.Fo=new Map,this.Mo=new Set,this.Lo=new Gn(nt.comparator),this.Bo=new Map,this.Uo=new Kg,this.qo={},this.Ko=new Map,this.jo=Qa.ie(),this.onlineState="Unknown",this.Qo=void 0}get isPrimaryClient(){return this.Qo===!0}}async function UO(e,t){const n=YO(e);let i,r;const s=n.Oo.get(t);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.xo();else{const o=await iO(n.localStore,Ko(t)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,r=await jO(n,t,i,a==="current"),n.isPrimaryClient&&F9(n.remoteStore,o)}return r}async function jO(e,t,n,i){e.Wo=(d,u,f)=>async function(m,h,R,M){let C=h.view.bo(R);C.Ln&&(C=await E2(m.localStore,h.query,!1).then(({documents:F})=>h.view.bo(F,C)));const _=M&&M.targetChanges.get(h.targetId),x=h.view.applyChanges(C,m.isPrimaryClient,_);return x2(m,h.targetId,x.Do),x.snapshot}(e,d,u,f);const r=await E2(e.localStore,t,!0),s=new LO(t,r.Gn),o=s.bo(r.documents),a=uu.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline"),l=s.applyChanges(o,e.isPrimaryClient,a);x2(e,n,l.Do);const c=new DO(t,n,s);return e.Oo.set(t,c),e.Fo.has(n)?e.Fo.get(n).push(t):e.Fo.set(n,[t]),l.snapshot}async function HO(e,t){const n=ft(e),i=n.Oo.get(t),r=n.Fo.get(i.targetId);if(r.length>1)return n.Fo.set(i.targetId,r.filter(s=>!_f(s,t))),void n.Oo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await v0(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),L9(n.remoteStore,i.targetId),y0(n,i.targetId)}).catch(du)):(y0(n,i.targetId),await v0(n.localStore,i.targetId,!0))}async function VO(e,t,n){const i=XO(e);try{const r=await function(s,o){const a=ft(s),l=Mi.now(),c=o.reduce((u,f)=>u.add(f.key),tn());let d;return a.persistence.runTransaction("Locally write mutations","readwrite",u=>a.Qn.Pn(u,c).next(f=>{d=f;const m=[];for(const h of o){const R=mM(h,d.get(h.key));R!=null&&m.push(new na(h.key,R,o9(R.value.mapValue),Wr.exists(!0)))}return a.In.addMutationBatch(u,l,m,o)})).then(u=>(u.applyToLocalDocumentSet(d),{batchId:u.batchId,changes:d}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(s,o,a){let l=s.qo[s.currentUser.toKey()];l||(l=new Gn(Dt)),l=l.insert(o,a),s.qo[s.currentUser.toKey()]=l}(i,r.batchId,n),await pu(i,r.changes),await kf(i.remoteStore)}catch(r){const s=Jg(r,"Failed to persist write");n.reject(s)}}async function q9(e,t){const n=ft(e);try{const i=await eO(n.localStore,t);t.targetChanges.forEach((r,s)=>{const o=n.Bo.get(s);o&&(Qt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.ko=!0:r.modifiedDocuments.size>0?Qt(o.ko):r.removedDocuments.size>0&&(Qt(o.ko),o.ko=!1))}),await pu(n,i,t)}catch(i){await du(i)}}function A2(e,t,n){const i=ft(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.Oo.forEach((s,o)=>{const a=o.view.io(t);a.snapshot&&r.push(a.snapshot)}),function(s,o){const a=ft(s);a.onlineState=o;let l=!1;a.queries.forEach((c,d)=>{for(const u of d.listeners)u.io(o)&&(l=!0)}),l&&n_(a)}(i.eventManager,t),r.length&&i.$o.Rr(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function qO(e,t,n){const i=ft(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Bo.get(t),s=r&&r.key;if(s){let o=new Gn(nt.comparator);o=o.insert(s,jn.newNoDocument(s,Nt.min()));const a=tn().add(s),l=new Ef(Nt.min(),new Map,new Ln(Dt),o,a);await q9(i,l),i.Lo=i.Lo.remove(s),i.Bo.delete(t),r_(i)}else await v0(i.localStore,t,!1).then(()=>y0(i,t,n)).catch(du)}async function zO(e,t){const n=ft(e),i=t.batch.batchId;try{const r=await JM(n.localStore,t);$9(n,i,null),z9(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await pu(n,r)}catch(r){await du(r)}}async function $O(e,t,n){const i=ft(e);try{const r=await function(s,o){const a=ft(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.In.lookupMutationBatch(l,o).next(d=>(Qt(d!==null),c=d.keys(),a.In.removeMutationBatch(l,d))).next(()=>a.In.performConsistencyCheck(l)).next(()=>a.Qn.Pn(l,c))})}(i.localStore,t);$9(i,t,n),z9(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await pu(i,r)}catch(r){await du(r)}}function z9(e,t){(e.Ko.get(t)||[]).forEach(n=>{n.resolve()}),e.Ko.delete(t)}function $9(e,t,n){const i=ft(e);let r=i.qo[i.currentUser.toKey()];if(r){const s=r.get(t);s&&(n?s.reject(n):s.resolve(),r=r.remove(t)),i.qo[i.currentUser.toKey()]=r}}function y0(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Fo.get(t))e.Oo.delete(i),n&&e.$o.Go(i,n);e.Fo.delete(t),e.isPrimaryClient&&e.Uo.cs(t).forEach(i=>{e.Uo.containsKey(i)||W9(e,i)})}function W9(e,t){e.Mo.delete(t.path.canonicalString());const n=e.Lo.get(t);n!==null&&(L9(e.remoteStore,n),e.Lo=e.Lo.remove(t),e.Bo.delete(n),r_(e))}function x2(e,t,n){for(const i of n)i instanceof H9?(e.Uo.addReference(i.key,t),WO(e,i)):i instanceof V9?(tt("SyncEngine","Document no longer in limbo: "+i.key),e.Uo.removeReference(i.key,t),e.Uo.containsKey(i.key)||W9(e,i.key)):dt()}function WO(e,t){const n=t.key,i=n.path.canonicalString();e.Lo.get(n)||e.Mo.has(i)||(tt("SyncEngine","New document in limbo: "+n),e.Mo.add(i),r_(e))}function r_(e){for(;e.Mo.size>0&&e.Lo.size<e.maxConcurrentLimboResolutions;){const t=e.Mo.values().next().value;e.Mo.delete(t);const n=new nt(en.fromString(t)),i=e.jo.next();e.Bo.set(i,new BO(n)),e.Lo=e.Lo.insert(n,i),F9(e.remoteStore,new Oo(Ko(gf(n.path)),i,2,Lg.T))}}async function pu(e,t,n){const i=ft(e),r=[],s=[],o=[];i.Oo.isEmpty()||(i.Oo.forEach((a,l)=>{o.push(i.Wo(l,t,n).then(c=>{if(c){i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),r.push(c);const d=Wg.kn(l.targetId,c);s.push(d)}}))}),await Promise.all(o),i.$o.Rr(r),await async function(a,l){const c=ft(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>Ke.forEach(l,u=>Ke.forEach(u.Nn,f=>c.persistence.referenceDelegate.addReference(d,u.targetId,f)).next(()=>Ke.forEach(u.xn,f=>c.persistence.referenceDelegate.removeReference(d,u.targetId,f)))))}catch(d){if(!hu(d))throw d;tt("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const u=d.targetId;if(!d.fromCache){const f=c.Un.get(u),m=f.snapshotVersion,h=f.withLastLimboFreeSnapshotVersion(m);c.Un=c.Un.insert(u,h)}}}(i.localStore,s))}async function KO(e,t){const n=ft(e);if(!n.currentUser.isEqual(t)){tt("SyncEngine","User change. New user:",t.toKey());const i=await R9(n.localStore,t);n.currentUser=t,function(r,s){r.Ko.forEach(o=>{o.forEach(a=>{a.reject(new $e(Ae.CANCELLED,s))})}),r.Ko.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await pu(n,i.Wn)}}function GO(e,t){const n=ft(e),i=n.Bo.get(t);if(i&&i.ko)return tn().add(i.key);{let r=tn();const s=n.Fo.get(t);if(!s)return r;for(const o of s){const a=n.Oo.get(o);r=r.unionWith(a.view.Ro)}return r}}function YO(e){const t=ft(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=q9.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=GO.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qO.bind(null,t),t.$o.Rr=NO.bind(null,t.eventManager),t.$o.Go=FO.bind(null,t.eventManager),t}function XO(e){const t=ft(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=zO.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=$O.bind(null,t),t}class QO{constructor(){this.synchronizeTabs=!1}async initialize(t){this.N=Sf(t.databaseInfo.databaseId),this.sharedClientState=this.Ho(t),this.persistence=this.Jo(t),await this.persistence.start(),this.gcScheduler=this.Yo(t),this.localStore=this.Xo(t)}Yo(t){return null}Xo(t){return ZM(this.persistence,new XM,t.initialUser,this.N)}Jo(t){return new cO(Gg.Ns,this.N)}Ho(t){return new hO}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ZO{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>A2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=KO.bind(null,this.syncEngine),await RO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new OO}createDatastore(t){const n=Sf(t.databaseInfo.databaseId),i=(r=t.databaseInfo,new pO(r));var r;return function(s,o,a){return new vO(s,o,a)}(t.credentials,i,n)}createRemoteStore(t){return n=this.localStore,i=this.datastore,r=t.asyncQueue,s=a=>A2(this.syncEngine,a,0),o=T2.bt()?new T2:new dO,new bO(n,i,r,s,o);var n,i,r,s,o}createSyncEngine(t,n){return function(i,r,s,o,a,l,c){const d=new PO(i,r,s,o,a,l);return c&&(d.Qo=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return async function(t){const n=ft(t);tt("RemoteStore","RemoteStore shutting down."),n.Wr.add(5),await mu(n),n.zr.shutdown(),n.Hr.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.tc(this.observer.next,t)}error(t){this.observer.error?this.tc(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}ec(){this.muted=!0}tc(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(t,n,i){this.credentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=pi.UNAUTHENTICATED,this.clientId=i9.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(n,async r=>{tt("FirestoreClient","Received user=",r.uid),await this.credentialListener(r),this.user=r})}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.credentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $e(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new $r;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),t.resolve()}catch(n){const i=Jg(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function eN(e,t){e.asyncQueue.verifyOperationInProgress(),tt("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async r=>{i.isEqual(r)||(await R9(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}async function tN(e,t){e.asyncQueue.verifyOperationInProgress();const n=await nN(e);tt("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener(r=>async function(s,o){const a=ft(s);a.asyncQueue.verifyOperationInProgress(),tt("RemoteStore","RemoteStore received new credentials");const l=ia(a);a.Wr.add(3),await mu(a),l&&a.Hr.set("Unknown"),await a.remoteSyncer.handleCredentialChange(o),a.Wr.delete(3),await Tf(a)}(t.remoteStore,r)),e.onlineComponents=t}async function nN(e){return e.offlineComponents||(tt("FirestoreClient","Using default OfflineComponentProvider"),await eN(e,new QO)),e.offlineComponents}async function K9(e){return e.onlineComponents||(tt("FirestoreClient","Using default OnlineComponentProvider"),await tN(e,new ZO)),e.onlineComponents}function iN(e){return K9(e).then(t=>t.syncEngine)}async function md(e){const t=await K9(e),n=t.eventManager;return n.onListen=UO.bind(null,t.syncEngine),n.onUnlisten=HO.bind(null,t.syncEngine),n}function rN(e,t,n={}){const i=new $r;return e.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new s_({next:u=>{s.enqueueAndForget(()=>t_(r,d));const f=u.docs.has(o);!f&&u.fromCache?l.reject(new $e(Ae.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&u.fromCache&&a&&a.source==="server"?l.reject(new $e(Ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(u)},error:u=>l.reject(u)}),d=new i_(gf(o.path),c,{includeMetadataChanges:!0,fo:!0});return e_(r,d)}(await md(e),e.asyncQueue,t,n,i)),i.promise}function sN(e,t,n={}){const i=new $r;return e.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new s_({next:u=>{s.enqueueAndForget(()=>t_(r,d)),u.fromCache&&a.source==="server"?l.reject(new $e(Ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(u)},error:u=>l.reject(u)}),d=new i_(o,c,{includeMetadataChanges:!0,fo:!0});return e_(r,d)}(await md(e),e.asyncQueue,t,n,i)),i.promise}class oN{constructor(t,n,i,r,s,o,a,l){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Lc{constructor(t,n){this.projectId=t,this.database=n||"(default)"}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Lc&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G9(e,t,n){if(!n)throw new $e(Ae.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function aN(e,t,n,i){if(t===!0&&i===!0)throw new $e(Ae.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function I2(e){if(!nt.isDocumentKey(e))throw new $e(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function R2(e){if(nt.isDocumentKey(e))throw new $e(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Af(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":dt()}function Oi(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new $e(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Af(e);throw new $e(Ae.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function lN(e,t){if(t<=0)throw new $e(Ae.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(t){var n;if(t.host===void 0){if(t.ssl!==void 0)throw new $e(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new $e(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,aN("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(t,n){this._credentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new M2({}),this._settingsFrozen=!1,t instanceof Lc?this._databaseId=t:(this._app=t,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new $e(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lc(i.options.projectId)}(t))}get app(){if(!this._app)throw new $e(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new $e(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new M2(t),t.credentials!==void 0&&(this._credentials=function(n){if(!n)return new H7;switch(n.type){case"gapi":const i=n.client;return Qt(!(typeof i!="object"||i===null||!i.auth||!i.auth.getAuthHeaderValueForFirstParty)),new z7(i,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new $e(Ae.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=C2.get(t);n&&(tt("ComponentProvider","Removing Datastore"),C2.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new $n(this.firestore,t,this._key)}}class Fr{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Fr(this.firestore,t,this._query)}}class xs extends Fr{constructor(t,n,i){super(t,n,gf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new $n(this.firestore,null,new nt(t))}withConverter(t){return new xs(this.firestore,t,this._path)}}function a_(e,t,...n){if(e=mn(e),G9("collection","path",t),e instanceof o_){const i=en.fromString(t,...n);return R2(i),new xs(e,null,i)}{if(!(e instanceof $n||e instanceof xs))throw new $e(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(en.fromString(t,...n));return R2(i),new xs(e.firestore,null,i)}}function _l(e,t,...n){if(e=mn(e),arguments.length===1&&(t=i9.I()),G9("doc","path",t),e instanceof o_){const i=en.fromString(t,...n);return I2(i),new $n(e,null,new nt(i))}{if(!(e instanceof $n||e instanceof xs))throw new $e(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(en.fromString(t,...n));return I2(i),new $n(e.firestore,e instanceof xs?e.converter:null,new nt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this._c=Promise.resolve(),this.mc=[],this.gc=!1,this.yc=[],this.Tc=null,this.Ec=!1,this.Ic=!1,this.Ac=[],this.ar=new O9(this,"async_queue_retry"),this.Rc=()=>{const n=Lm();n&&tt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.ar.tr()};const t=Lm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Rc)}get isShuttingDown(){return this.gc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.bc(),this.Pc(t)}enterRestrictedMode(t){if(!this.gc){this.gc=!0,this.Ic=t||!1;const n=Lm();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Rc)}}enqueue(t){if(this.bc(),this.gc)return new Promise(()=>{});const n=new $r;return this.Pc(()=>this.gc&&this.Ic?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.mc.push(t),this.vc()))}async vc(){if(this.mc.length!==0){try{await this.mc[0](),this.mc.shift(),this.ar.reset()}catch(t){if(!hu(t))throw t;tt("AsyncQueue","Operation failed with retryable error: "+t)}this.mc.length>0&&this.ar.Xi(()=>this.vc())}}Pc(t){const n=this._c.then(()=>(this.Ec=!0,t().catch(i=>{this.Tc=i,this.Ec=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(i);throw Ds("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Ec=!1,i))));return this._c=n,n}enqueueAfterDelay(t,n,i){this.bc(),this.Ac.indexOf(t)>-1&&(n=0);const r=Zg.createAndSchedule(this,t,n,i,s=>this.Vc(s));return this.yc.push(r),r}bc(){this.Tc&&dt()}verifyOperationInProgress(){}async Sc(){let t;do t=this._c,await t;while(t!==this._c)}Dc(t){for(const n of this.yc)if(n.timerId===t)return!0;return!1}Cc(t){return this.Sc().then(()=>{this.yc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.yc)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Sc()})}Nc(t){this.Ac.push(t)}Vc(t){const n=this.yc.indexOf(t);this.yc.splice(n,1)}}function O2(e){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const r of n)if(r in i&&typeof i[r]=="function")return!0;return!1}(e,["next","error","complete"])}class Jr extends o_{constructor(t,n){super(t,n),this.type="firestore",this._queue=new cN,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Y9(this),this._firestoreClient.terminate()}}function uN(e=xp()){return kp(e,"firestore").getImmediate()}function xf(e){return e._firestoreClient||Y9(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Y9(e){var t;const n=e._freezeSettings(),i=function(r,s,o,a){return new oN(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new JO(e._credentials,e._queue,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new $e(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vi(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ja(Kn.fromBase64String(t))}catch(n){throw new $e(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ja(Kn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new $e(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new $e(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Dt(this._lat,t._lat)||Dt(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=/^__.*__$/;class dN{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new na(t,this.data,this.fieldMask,n,this.fieldTransforms):new wf(t,this.data,n,this.fieldTransforms)}}class X9{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new na(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function Q9(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class If{constructor(t,n,i,r,s,o){this.settings=t,this.databaseId=n,this.N=i,this.ignoreUndefinedProperties=r,s===void 0&&this.xc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get kc(){return this.settings.kc}$c(t){return new If(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Oc(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.$c({path:i,Fc:!1});return r.Mc(t),r}Lc(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.$c({path:i,Fc:!1});return r.xc(),r}Bc(t){return this.$c({path:void 0,Fc:!0})}Uc(t){return pd(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Kc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}xc(){if(this.path)for(let t=0;t<this.path.length;t++)this.Mc(this.path.get(t))}Mc(t){if(t.length===0)throw this.Uc("Document fields must not be empty");if(Q9(this.kc)&&hN.test(t))throw this.Uc('Document fields cannot begin and end with "__"')}}class fN{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.N=i||Sf(t)}jc(t,n,i,r=!1){return new If({kc:t,methodName:n,Kc:i,path:vi.emptyPath(),Fc:!1,qc:r},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function _u(e){const t=e._freezeSettings(),n=Sf(e._databaseId);return new fN(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Z9(e,t,n,i,r,s={}){const o=e.jc(s.merge||s.mergeFields?2:0,t,n,r);c_("Data must be an object, but it was:",o,i);const a=tE(i,o);let l,c;if(s.merge)l=new Mc(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const u of s.mergeFields){const f=b0(t,u,n);if(!o.contains(f))throw new $e(Ae.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);iE(d,f)||d.push(f)}l=new Mc(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new dN(new Ai(a),l,c)}class vu extends gu{_toFieldTransform(t){if(t.kc!==2)throw t.kc===1?t.Uc(`${this._methodName}() can only appear at the top level of your update data`):t.Uc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof vu}}function J9(e,t,n){return new If({kc:3,Kc:t.settings.Kc,methodName:e._methodName,Fc:n},t.databaseId,t.N,t.ignoreUndefinedProperties)}class mN extends gu{constructor(t,n){super(t),this.Qc=n}_toFieldTransform(t){const n=J9(this,t,!0),i=this.Qc.map(s=>ra(s,n)),r=new Ya(i);return new _9(t.path,r)}isEqual(t){return this===t}}class pN extends gu{constructor(t,n){super(t),this.Qc=n}_toFieldTransform(t){const n=J9(this,t,!0),i=this.Qc.map(s=>ra(s,n)),r=new Xa(i);return new _9(t.path,r)}isEqual(t){return this===t}}function gN(e,t,n,i){const r=e.jc(1,t,n);c_("Data must be an object, but it was:",r,i);const s=[],o=Ai.empty();ta(i,(l,c)=>{const d=u_(t,l,n);c=mn(c);const u=r.Lc(d);if(c instanceof vu)s.push(d);else{const f=ra(c,u);f!=null&&(s.push(d),o.set(d,f))}});const a=new Mc(s);return new X9(o,a,r.fieldTransforms)}function _N(e,t,n,i,r,s){const o=e.jc(1,t,n),a=[b0(t,i,n)],l=[r];if(s.length%2!=0)throw new $e(Ae.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(b0(t,s[f])),l.push(s[f+1]);const c=[],d=Ai.empty();for(let f=a.length-1;f>=0;--f)if(!iE(c,a[f])){const m=a[f];let h=l[f];h=mn(h);const R=o.Lc(m);if(h instanceof vu)c.push(m);else{const M=ra(h,R);M!=null&&(c.push(m),d.set(m,M))}}const u=new Mc(c);return new X9(d,u,o.fieldTransforms)}function eE(e,t,n,i=!1){return ra(n,e.jc(i?4:3,t))}function ra(e,t){if(nE(e=mn(e)))return c_("Unsupported field value:",t,e),tE(e,t);if(e instanceof gu)return function(n,i){if(!Q9(i.kc))throw i.Uc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Uc(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&t.kc!==4)throw t.Uc("Nested arrays are not supported");return function(n,i){const r=[];let s=0;for(const o of n){let a=ra(o,i.Bc(s));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(e,t)}return function(n,i){if((n=mn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return lM(i.N,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Mi.fromDate(n);return{timestampValue:dd(i.N,r)}}if(n instanceof Mi){const r=new Mi(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:dd(i.N,r)}}if(n instanceof l_)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ja)return{bytesValue:T9(i.N,n._byteString)};if(n instanceof $n){const r=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(r))throw i.Uc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:zg(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Uc(`Unsupported field value: ${Af(n)}`)}(e,t)}function tE(e,t){const n={};return r9(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ta(e,(i,r)=>{const s=ra(r,t.Oc(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function nE(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Mi||e instanceof l_||e instanceof Ja||e instanceof $n||e instanceof gu)}function c_(e,t,n){if(!nE(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const i=Af(n);throw i==="an object"?t.Uc(e+" a custom object"):t.Uc(e+" "+i)}}function b0(e,t,n){if((t=mn(t))instanceof Cf)return t._internalPath;if(typeof t=="string")return u_(e,t);throw pd("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const vN=new RegExp("[~\\*/\\[\\]]");function u_(e,t,n){if(t.search(vN)>=0)throw pd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Cf(...t.split("."))._internalPath}catch{throw pd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function pd(e,t,n,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new $e(Ae.INVALID_ARGUMENT,a+e+l)}function iE(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(t,n,i,r,s){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new yN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Rf("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class yN extends h_{data(){return super.data()}}function Rf(e,t){return typeof t=="string"?u_(e,t):t instanceof Cf?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class rE extends h_{constructor(t,n,i,r,s,o){super(t,n,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new bh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Rf("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class bh extends rE{data(t={}){return super.data(t)}}class sE{constructor(t,n,i,r){this._firestore=t,this._userDataWriter=n,this._snapshot=r,this.metadata=new Vl(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new bh(this._firestore,this._userDataWriter,i.key,i,new Vl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $e(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>({type:"added",doc:new bh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Vl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new bh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Vl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,c=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),c=s.indexOf(o.doc.key)),{type:bN(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function bN(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(e){if(cd(e)&&e.explicitOrderBy.length===0)throw new $e(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yu{}function Ii(e,...t){for(const n of t)e=n._apply(e);return e}class wN extends yu{constructor(t,n,i){super(),this.Gc=t,this.zc=n,this.Hc=i,this.type="where"}_apply(t){const n=_u(t.firestore),i=function(r,s,o,a,l,c,d){let u;if(l.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new $e(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on FieldPath.documentId().`);if(c==="in"||c==="not-in"){D2(d,c);const m=[];for(const h of d)m.push(L2(a,r,h));u={arrayValue:{values:m}}}else u=L2(a,r,d)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||D2(d,c),u=eE(o,s,d,c==="in"||c==="not-in");const f=ii.create(l,c,u);return function(m,h){if(h.v()){const M=Vg(m);if(M!==null&&!M.isEqual(h.field))throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${M.toString()}' and '${h.field.toString()}'`);const C=Hg(m);C!==null&&uE(m,h.field,C)}const R=function(M,C){for(const _ of M.filters)if(C.indexOf(_.op)>=0)return _.op;return null}(m,function(M){switch(M){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(h.op));if(R!==null)throw R===h.op?new $e(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${h.op.toString()}' filter.`):new $e(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${h.op.toString()}' filters with '${R.toString()}' filters.`)}(r,f),f}(t._query,"where",n,t.firestore._databaseId,this.Gc,this.zc,this.Hc);return new Fr(t.firestore,t.converter,function(r,s){const o=r.filters.concat([s]);return new qs(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(t._query,i))}}function w0(e,t,n){const i=t,r=Rf("where",e);return new wN(r,i,n)}class EN extends yu{constructor(t,n){super(),this.Gc=t,this.Jc=n,this.type="orderBy"}_apply(t){const n=function(i,r,s){if(i.startAt!==null)throw new $e(Ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new $e(Ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ra(r,s);return function(a,l){if(Hg(a)===null){const c=Vg(a);c!==null&&uE(a,c,l.field)}}(i,o),o}(t._query,this.Gc,this.Jc);return new Fr(t.firestore,t.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new qs(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function Vr(e,t="asc"){const n=t,i=Rf("orderBy",e);return new EN(i,n)}class SN extends yu{constructor(t,n,i){super(),this.type=t,this.Yc=n,this.Xc=i}_apply(t){return new Fr(t.firestore,t.converter,l9(t._query,this.Yc,this.Xc))}}function Dc(e){return lN("limit",e),new SN("limit",e,"F")}class aE extends yu{constructor(t,n,i){super(),this.type=t,this.Zc=n,this.ta=i}_apply(t){const n=cE(t,this.type,this.Zc,this.ta);return new Fr(t.firestore,t.converter,function(i,r){return new qs(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)}(t._query,n))}}function N2(...e){return new aE("startAt",e,!0)}function lE(...e){return new aE("startAfter",e,!1)}class TN extends yu{constructor(t,n,i){super(),this.type=t,this.Zc=n,this.ta=i}_apply(t){const n=cE(t,this.type,this.Zc,this.ta);return new Fr(t.firestore,t.converter,function(i,r){return new qs(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)}(t._query,n))}}function F2(...e){return new TN("endAt",e,!1)}function cE(e,t,n,i){if(n[0]=mn(n[0]),n[0]instanceof h_)return function(r,s,o,a,l){if(!a)throw new $e(Ae.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const c=[];for(const d of Ga(r))if(d.field.isKeyField())c.push(ad(s,a.key));else{const u=a.data.field(d.field);if(Dg(u))throw new $e(Ae.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(u===null){const f=d.field.canonicalString();throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}c.push(u)}return new Fc(c,l)}(e._query,e.firestore._databaseId,t,n[0]._document,i);{const r=_u(e.firestore);return function(s,o,a,l,c,d){const u=s.explicitOrderBy;if(c.length>u.length)throw new $e(Ae.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let m=0;m<c.length;m++){const h=c[m];if(u[m].field.isKeyField()){if(typeof h!="string")throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof h}`);if(!qg(s)&&h.indexOf("/")!==-1)throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${l}() must be a plain document ID, but '${h}' contains a slash.`);const R=s.path.child(en.fromString(h));if(!nt.isDocumentKey(R))throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);const M=new nt(R);f.push(ad(o,M))}else{const R=eE(a,l,h);f.push(R)}}return new Fc(f,d)}(e._query,e.firestore._databaseId,r,t,n,i)}}function L2(e,t,n){if(typeof(n=mn(n))=="string"){if(n==="")throw new $e(Ae.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qg(t)&&n.indexOf("/")!==-1)throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(en.fromString(n));if(!nt.isDocumentKey(i))throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return ad(e,new nt(i))}if(n instanceof $n)return ad(e,n._key);throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Af(n)}.`)}function D2(e,t){if(!Array.isArray(e)||e.length===0)throw new $e(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new $e(Ae.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function uE(e,t,n){if(!n.isEqual(t))throw new $e(Ae.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{convertValue(t,n="none"){switch(Wo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Wa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw dt()}}convertObject(t,n){const i={};return ta(t.fields,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertGeoPoint(t){return new l_(vn(t.latitude),vn(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=s9(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Oc(t));default:return null}}convertTimestamp(t){const n=Bs(t);return new Mi(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=en.fromString(t);Qt(C9(i));const r=new Lc(i.get(1),i.get(3)),s=new nt(i.popFirst(5));return r.isEqual(n)||Ds(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hE(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(e){e=Oi(e,$n);const t=Oi(e.firestore,Jr);return rN(xf(t),e._key).then(n=>dE(t,e,n))}class d_ extends kN{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ja(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new $n(this.firestore,null,n)}}function xN(e){e=Oi(e,Fr);const t=Oi(e.firestore,Jr),n=xf(t),i=new d_(t);return oE(e._query),sN(n,e._query).then(r=>new sE(t,i,e,r))}function CN(e,t,n){e=Oi(e,$n);const i=Oi(e.firestore,Jr),r=hE(e.converter,t,n);return Mf(i,[Z9(_u(i),"setDoc",e._key,r,e.converter!==null,n).toMutation(e._key,Wr.none())])}function IN(e,t,n,...i){e=Oi(e,$n);const r=Oi(e.firestore,Jr),s=_u(r);let o;return o=typeof(t=mn(t))=="string"||t instanceof Cf?_N(s,"updateDoc",e._key,t,n,i):gN(s,"updateDoc",e._key,t),Mf(r,[o.toMutation(e._key,Wr.exists(!0))])}function RN(e){return Mf(Oi(e.firestore,Jr),[new y9(e._key,Wr.none())])}function MN(e,t){const n=Oi(e.firestore,Jr),i=_l(e),r=hE(e.converter,t);return Mf(n,[Z9(_u(e.firestore),"addDoc",i._key,r,e.converter!==null,{}).toMutation(i._key,Wr.exists(!1))]).then(()=>i)}function ON(e,...t){var n,i,r;e=mn(e);let s={includeMetadataChanges:!1},o=0;typeof t[o]!="object"||O2(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(O2(t[o])){const u=t[o];t[o]=(n=u.next)===null||n===void 0?void 0:n.bind(u),t[o+1]=(i=u.error)===null||i===void 0?void 0:i.bind(u),t[o+2]=(r=u.complete)===null||r===void 0?void 0:r.bind(u)}let l,c,d;if(e instanceof $n)c=Oi(e.firestore,Jr),d=gf(e._key.path),l={next:u=>{t[o]&&t[o](dE(c,e,u))},error:t[o+1],complete:t[o+2]};else{const u=Oi(e,Fr);c=Oi(u.firestore,Jr),d=u._query;const f=new d_(c);l={next:m=>{t[o]&&t[o](new sE(c,f,u,m))},error:t[o+1],complete:t[o+2]},oE(e._query)}return function(u,f,m,h){const R=new s_(h),M=new i_(f,R,m);return u.asyncQueue.enqueueAndForget(async()=>e_(await md(u),M)),()=>{R.ec(),u.asyncQueue.enqueueAndForget(async()=>t_(await md(u),M))}}(xf(c),d,a,l)}function Mf(e,t){return function(n,i){const r=new $r;return n.asyncQueue.enqueueAndForget(async()=>VO(await iN(n),i,r)),r.promise}(xf(e),t)}function dE(e,t,n){const i=n.docs.get(t._key),r=new d_(e);return new rE(e,r,t._key,i,new Vl(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(){return new vu("deleteField")}function f_(...e){return new mN("arrayUnion",e)}function m_(...e){return new pN("arrayRemove",e)}(function(e,t=!0){(function(n){ml=n})(Ap),Yc(new al("firestore",(n,{options:i})=>{const r=n.getProvider("app").getImmediate(),s=new Jr(r,new V7(n.getProvider("auth-internal")));return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s},"PUBLIC")),Cr(e2,"3.3.0",e),Cr(e2,"3.3.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE="firebasestorage.googleapis.com",mE="storageBucket",FN=2*60*1e3,LN=10*60*1e3;class un extends zd{constructor(t,n){super(Dm(t),`Firebase Storage: ${n} (${Dm(t)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,un.prototype)}_codeEquals(t){return Dm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function Dm(e){return"storage/"+e}function p_(){const e="An unknown error occurred, please check the error payload for server response.";return new un("unknown",e)}function DN(e){return new un("object-not-found","Object '"+e+"' does not exist.")}function BN(e){return new un("quota-exceeded","Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function PN(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new un("unauthenticated",e)}function UN(){return new un("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function jN(e){return new un("unauthorized","User does not have permission to access '"+e+"'.")}function HN(){return new un("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function pE(){return new un("canceled","User canceled the upload/download.")}function VN(e){return new un("invalid-url","Invalid URL '"+e+"'.")}function qN(e){return new un("invalid-default-bucket","Invalid default bucket '"+e+"'.")}function zN(){return new un("no-default-bucket","No default bucket found. Did you set the '"+mE+"' property when initializing the app?")}function gE(){return new un("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function $N(){return new un("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function WN(){return new un("no-download-url","The given file does not have any download URLs.")}function E0(e){return new un("invalid-argument",e)}function _E(){return new un("app-deleted","The Firebase app was deleted.")}function KN(e){return new un("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function oc(e,t){return new un("invalid-format","String does not match format '"+e+"': "+t)}function Vu(e){throw new un("internal-error","Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=Ri.makeFromUrl(t,n)}catch{return new Ri(t,"")}if(i.path==="")return i;throw qN(t)}static makeFromUrl(t,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(F){F.path_=decodeURIComponent(F.path)}const d="v[A-Za-z0-9_]+",u=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${u}/${d}/b/${r}/o${f}`,"i"),h={bucket:1,path:3},R=n===fE?"(?:storage.googleapis.com|storage.cloud.google.com)":n,M="([^?#]*)",C=new RegExp(`^https?://${R}/${r}/${M}`,"i"),x=[{regex:a,indices:l,postModify:s},{regex:m,indices:h,postModify:c},{regex:C,indices:{bucket:1,path:2},postModify:c}];for(let F=0;F<x.length;F++){const O=x[F],N=O.regex.exec(t);if(N){const v=N[O.indices.bucket];let T=N[O.indices.path];T||(T=""),i=new Ri(v,T),O.postModify(i);break}}if(i==null)throw VN(t);return i}}class GN{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(e,t,n){let i=1,r=null,s=!1,o=0;function a(){return o===2}let l=!1;function c(...h){l||(l=!0,t.apply(null,h))}function d(h){r=setTimeout(()=>{r=null,e(u,a())},h)}function u(h,...R){if(l)return;if(h){c.call(null,h,...R);return}if(a()||s){c.call(null,h,...R);return}i<64&&(i*=2);let C;o===1?(o=2,C=0):C=(i+Math.random())*1e3,d(C)}let f=!1;function m(h){f||(f=!0,!l&&(r!==null?(h||(o=2),clearTimeout(r),d(0)):h||(o=1)))}return d(0),setTimeout(()=>{s=!0,m(!0)},n),m}function XN(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QN(e){return e!==void 0}function ZN(e){return typeof e=="function"}function JN(e){return typeof e=="object"&&!Array.isArray(e)}function Of(e){return typeof e=="string"||e instanceof String}function B2(e){return g_()&&e instanceof Blob}function g_(){return typeof Blob!="undefined"}function P2(e,t,n,i){if(i<t)throw E0(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw E0(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function vE(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const r=t(i)+"="+t(e[i]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var No;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(No||(No={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(t,n,i,r,s,o,a,l,c,d,u){this.url_=t,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,m)=>{this.resolve_=f,this.reject_=m,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new qu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===No.NO_ERROR,l=s.getStatus();if(!a||this.isRetryStatusCode_(l)){const d=s.getErrorCode()===No.ABORT;i(!1,new qu(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new qu(c,s))})},n=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponseText());QN(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=p_();l.serverResponse=a.getResponseText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?_E():pE();o(l)}else{const l=HN();o(l)}};this.canceled_?n(!1,new qu(!1,null,!0)):this.backoffId_=YN(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&XN(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(t){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,s=this.additionalRetryCodes_.indexOf(t)!==-1;return n||r||s}}class qu{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function tF(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function nF(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t!=null?t:"AppManager")}function iF(e,t){t&&(e["X-Firebase-GMPID"]=t)}function rF(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function sF(e,t,n,i,r,s){const o=vE(e.urlParams),a=e.url+o,l=Object.assign({},e.headers);return iF(l,t),tF(l,n),nF(l,s),rF(l,i),new eF(a,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function aF(...e){const t=oF();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(g_())return new Blob(e);throw new un("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function lF(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(e){return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Bm{constructor(t,n){this.data=t,this.contentType=n||null}}function uF(e,t){switch(e){case kr.RAW:return new Bm(yE(t));case kr.BASE64:case kr.BASE64URL:return new Bm(bE(e,t));case kr.DATA_URL:return new Bm(dF(t),fF(t))}throw p_()}function yE(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const s=i,o=e.charCodeAt(++n);i=65536|(s&1023)<<10|o&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function hF(e){let t;try{t=decodeURIComponent(e)}catch{throw oc(kr.DATA_URL,"Malformed data URL.")}return yE(t)}function bE(e,t){switch(e){case kr.BASE64:{const r=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(r||s)throw oc(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case kr.BASE64URL:{const r=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(r||s)throw oc(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=cF(t)}catch{throw oc(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class wE{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw oc(kr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=mF(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function dF(e){const t=new wE(e);return t.base64?bE(kr.BASE64,t.rest):hF(t.rest)}function fF(e){return new wE(e).contentType}function mF(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(t,n){let i=0,r="";B2(t)?(this.data_=t,i=t.size,r=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(t,n){if(B2(this.data_)){const i=this.data_,r=lF(i,t,n);return r===null?null:new Es(r)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new Es(i,!0)}}static getBlob(...t){if(g_()){const n=t.map(i=>i instanceof Es?i.data_:i);return new Es(aF.apply(null,n))}else{const n=t.map(o=>Of(o)?uF(kr.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new Es(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(e){let t;try{t=JSON.parse(e)}catch{return null}return JN(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function gF(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function SE(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(e,t){return t}class Yn{constructor(t,n,i,r){this.server=t,this.local=n||t,this.writable=!!i,this.xform=r||_F}}let zu=null;function vF(e){return!Of(e)||e.length<2?e:SE(e)}function TE(){if(zu)return zu;const e=[];e.push(new Yn("bucket")),e.push(new Yn("generation")),e.push(new Yn("metageneration")),e.push(new Yn("name","fullPath",!0));function t(s,o){return vF(o)}const n=new Yn("name");n.xform=t,e.push(n);function i(s,o){return o!==void 0?Number(o):o}const r=new Yn("size");return r.xform=i,e.push(r),e.push(new Yn("timeCreated")),e.push(new Yn("updated")),e.push(new Yn("md5Hash",null,!0)),e.push(new Yn("cacheControl",null,!0)),e.push(new Yn("contentDisposition",null,!0)),e.push(new Yn("contentEncoding",null,!0)),e.push(new Yn("contentLanguage",null,!0)),e.push(new Yn("contentType",null,!0)),e.push(new Yn("metadata","customMetadata",!0)),zu=e,zu}function yF(e,t){function n(){const i=e.bucket,r=e.fullPath,s=new Ri(i,r);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:n})}function bF(e,t,n){const i={};i.type="file";const r=n.length;for(let s=0;s<r;s++){const o=n[s];i[o.local]=o.xform(i,t[o.server])}return yF(i,e),i}function kE(e,t,n){const i=EE(t);return i===null?null:bF(e,i,n)}function wF(e,t,n,i){const r=EE(t);if(r===null||!Of(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const d=e.bucket,u=e.fullPath,f="/b/"+o(d)+"/o/"+o(u),m=vl(f,n,i),h=vE({alt:"media",token:c});return m+h})[0]}function AE(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const s=t[r];s.writable&&(n[s.server]=e[s.local])}return JSON.stringify(n)}class sa{constructor(t,n,i,r){this.url=t,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(e){if(!e)throw p_()}function __(e,t){function n(i,r){const s=kE(e,r,t);return Gr(s!==null),s}return n}function EF(e,t){function n(i,r){const s=kE(e,r,t);return Gr(s!==null),wF(s,r,e.host,e._protocol)}return n}function bu(e){function t(n,i){let r;return n.getStatus()===401?n.getResponseText().includes("Firebase App Check token is invalid")?r=UN():r=PN():n.getStatus()===402?r=BN(e.bucket):n.getStatus()===403?r=jN(e.path):r=i,r.serverResponse=i.serverResponse,r}return t}function v_(e){const t=bu(e);function n(i,r){let s=t(i,r);return i.getStatus()===404&&(s=DN(e.path)),s.serverResponse=r.serverResponse,s}return n}function SF(e,t,n){const i=t.fullServerUrl(),r=vl(i,e.host,e._protocol),s="GET",o=e.maxOperationRetryTime,a=new sa(r,s,__(e,n),o);return a.errorHandler=v_(t),a}function TF(e,t,n){const i=t.fullServerUrl(),r=vl(i,e.host,e._protocol),s="GET",o=e.maxOperationRetryTime,a=new sa(r,s,EF(e,n),o);return a.errorHandler=v_(t),a}function kF(e,t){const n=t.fullServerUrl(),i=vl(n,e.host,e._protocol),r="DELETE",s=e.maxOperationRetryTime;function o(l,c){}const a=new sa(i,r,o,s);return a.successCodes=[200,204],a.errorHandler=v_(t),a}function AF(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function xE(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=AF(null,t)),i}function xF(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let x="";for(let F=0;F<2;F++)x=x+Math.random().toString().slice(2);return x}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=xE(t,i,r),d=AE(c,n),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",m=Es.getBlob(u,i,f);if(m===null)throw gE();const h={name:c.fullPath},R=vl(s,e.host,e._protocol),M="POST",C=e.maxUploadRetryTime,_=new sa(R,M,__(e,n),C);return _.urlParams=h,_.headers=o,_.body=m.uploadData(),_.errorHandler=bu(t),_}class gd{constructor(t,n,i,r){this.current=t,this.total=n,this.finalized=!!i,this.metadata=r||null}}function y_(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch{Gr(!1)}return Gr(!!n&&(t||["active"]).indexOf(n)!==-1),n}function CF(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o=xE(t,i,r),a={name:o.fullPath},l=vl(s,e.host,e._protocol),c="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},u=AE(o,n),f=e.maxUploadRetryTime;function m(R){y_(R);let M;try{M=R.getResponseHeader("X-Goog-Upload-URL")}catch{Gr(!1)}return Gr(Of(M)),M}const h=new sa(l,c,m,f);return h.urlParams=a,h.headers=d,h.body=u,h.errorHandler=bu(t),h}function IF(e,t,n,i){const r={"X-Goog-Upload-Command":"query"};function s(c){const d=y_(c,["active","final"]);let u=null;try{u=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Gr(!1)}u||Gr(!1);const f=Number(u);return Gr(!isNaN(f)),new gd(f,i.size(),d==="final")}const o="POST",a=e.maxUploadRetryTime,l=new sa(n,o,s,a);return l.headers=r,l.errorHandler=bu(t),l}const U2=256*1024;function RF(e,t,n,i,r,s,o,a){const l=new gd(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw $N();const c=l.total-l.current;let d=c;r>0&&(d=Math.min(d,r));const u=l.current,f=u+d,h={"X-Goog-Upload-Command":d===c?"upload, finalize":"upload","X-Goog-Upload-Offset":`${l.current}`},R=i.slice(u,f);if(R===null)throw gE();function M(F,O){const N=y_(F,["active","final"]),v=l.current+d,T=i.size();let S;return N==="final"?S=__(t,s)(F,O):S=null,new gd(v,T,N==="final",S)}const C="POST",_=t.maxUploadRetryTime,x=new sa(n,C,M,_);return x.headers=h,x.body=R.uploadData(),x.progressCallback=a||null,x.errorHandler=bu(e),x}const gi={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Pm(e){switch(e){case"running":case"pausing":case"canceling":return gi.RUNNING;case"paused":return gi.PAUSED;case"success":return gi.SUCCESS;case"canceled":return gi.CANCELED;case"error":return gi.ERROR;default:return gi.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(t,n,i){if(ZN(t)||n!=null||i!=null)this.next=t,this.error=n!=null?n:void 0,this.complete=i!=null?i:void 0;else{const s=t;this.next=s.next,this.error=s.error,this.complete=s.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}class OF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=No.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=No.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=No.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,r){if(this.sent_)throw Vu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),r!==void 0)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Vu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Vu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponseText(){if(!this.sent_)throw Vu("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}function go(){return new OF}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(t,n,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=n,this._metadata=i,this._mappings=TE(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,s)=>{this._resolve=r,this._reject=s,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const t=this._transferred;return n=>this._updateProgress(t+n)}_shouldDoResumable(t){return t.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,i])=>{switch(this._state){case"running":t(n,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((t,n)=>{const i=CF(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,go,t,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((n,i)=>{const r=IF(this._ref.storage,this._ref._location,t,this._blob),s=this._ref.storage._makeRequest(r,go,n,i);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=U2*this._chunkMultiplier,n=new gd(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=RF(this._ref._location,this._ref.storage,i,this._blob,t,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,go,r,s);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){U2*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,n)=>{const i=SF(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(i,go,t,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,n)=>{const i=xF(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,go,t,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const n=this._transferred;this._transferred=t,this._transferred!==n&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":this._state=t,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=t,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=t,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=pE(),this._state=t,this._notifyObservers();break;case"error":this._state=t,this._notifyObservers();break;case"success":this._state=t,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const t=Pm(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,n,i,r){const s=new MF(n||void 0,i||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(t,n){return this._promise.then(t,n)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const n=this._observers.indexOf(t);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let t=!0;switch(Pm(this._state)){case gi.SUCCESS:ua(this._resolve.bind(null,this.snapshot))();break;case gi.CANCELED:case gi.ERROR:const n=this._reject;ua(n.bind(null,this._error))();break;default:t=!1;break}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Pm(this._state)){case gi.RUNNING:case gi.PAUSED:t.next&&ua(t.next.bind(t,this.snapshot))();break;case gi.SUCCESS:t.complete&&ua(t.complete.bind(t))();break;case gi.CANCELED:case gi.ERROR:t.error&&ua(t.error.bind(t,this._error))();break;default:t.error&&ua(t.error.bind(t,this._error))()}}resume(){const t=this._state==="paused"||this._state==="pausing";return t&&this._transition("running"),t}pause(){const t=this._state==="running";return t&&this._transition("pausing"),t}cancel(){const t=this._state==="running"||this._state==="pausing";return t&&this._transition("canceling"),t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(t,n){this._service=t,n instanceof Ri?this._location=n:this._location=Ri.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Yo(t,n)}get root(){const t=new Ri(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return SE(this._location.path)}get storage(){return this._service}get parent(){const t=pF(this._location.path);if(t===null)return null;const n=new Ri(this._location.bucket,t);return new Yo(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw KN(t)}}function FF(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new NF(e,new Es(t),n)}function LF(e){e._throwIfRoot("getDownloadURL");const t=TF(e.storage,e._location,TE());return e.storage.makeRequestWithTokens(t,go).then(n=>{if(n===null)throw WN();return n})}function DF(e){e._throwIfRoot("deleteObject");const t=kF(e.storage,e._location);return e.storage.makeRequestWithTokens(t,go)}function BF(e,t){const n=gF(e._location.path,t),i=new Ri(e._location.bucket,n);return new Yo(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PF(e){return/^[A-Za-z]+:\/\//.test(e)}function UF(e,t){return new Yo(e,t)}function CE(e,t){if(e instanceof b_){const n=e;if(n._bucket==null)throw zN();const i=new Yo(n,n._bucket);return t!=null?CE(i,t):i}else return t!==void 0?BF(e,t):e}function jF(e,t){if(t&&PF(t)){if(e instanceof b_)return UF(e,t);throw E0("To use ref(service, url), the first argument must be a Storage instance.")}else return CE(e,t)}function j2(e,t){const n=t==null?void 0:t[mE];return n==null?null:Ri.makeFromBucketSpec(n,e)}class b_{constructor(t,n,i,r,s){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=fE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=FN,this._maxUploadRetryTime=LN,this._requests=new Set,r!=null?this._bucket=Ri.makeFromBucketSpec(r,this._host):this._bucket=j2(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Ri.makeFromBucketSpec(this._url,t):this._bucket=j2(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){P2("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){P2("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Yo(this,t)}_makeRequest(t,n,i,r){if(this._deleted)return new GN(_E());{const s=sF(t,this._appId,i,r,n,this._firebaseVersion);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(t,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,r).getPromise()}}const H2="@firebase/storage",V2="0.8.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="storage";function HF(e,t,n){return e=mn(e),FF(e,t,n)}function VF(e){return e=mn(e),LF(e)}function qF(e){return e=mn(e),DF(e)}function zF(e,t){return e=mn(e),jF(e,t)}function $F(e=xp(),t){return e=mn(e),kp(e,IE).getImmediate({identifier:t})}function WF(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new b_(n,i,r,t,Ap)}function KF(){Yc(new al(IE,WF,"PUBLIC").setMultipleInstances(!0)),Cr(H2,V2,""),Cr(H2,V2,"esm2017")}KF();const GF=JSON.parse('{"apiKey": "AIzaSyAp_VqNngNGQMRMDSag10xqGTap-G6FM9E","authDomain": "sandbox-226704.firebaseapp.com","databaseURL": "https://sandbox-226704.firebaseio.com","projectId": "sandbox-226704","storageBucket": "sandbox-226704.appspot.com","messagingSenderId": "1015649565816","appId": "1:1015649565816:web:1a79587b436517599cc18d"}');px(GF);const zs=uN(),RE=MR(),YF=$F(),Xo="users",Nf="chatRooms",XF="messages",w_=e=>`${Nf}/${e}/${XF}`,Ao="timestamp",q2="lastUpdated",QF="typingUsers",ZF="reactions",ME="users",E_=ON,JF=NN(),Fo=e=>xN(e).then(t=>({data:Ff(t),docs:t.docs})),OE=e=>AN(e).then(t=>PE(t)),S_=(e,t)=>MN(e,t),eL=(e,t,n)=>CN(_l(zs,e,t),n),T_=(e,t)=>IN(e,t),k_=(e,t)=>RN(_l(zs,e,t)),NE=a_(zs,Xo),FE=e=>_l(zs,Xo,e),tL=()=>Fo(Ii(NE)),nL=e=>OE(FE(e)),z2=e=>S_(NE,e),Um=(e,t)=>eL(Xo,e,t),$2=(e,t)=>T_(FE(e),t),iL=e=>k_(Xo,e),Bc=a_(zs,Nf),rL=e=>_l(zs,Nf,e),sL=(e,t,n)=>n?Ii(Bc,w0(Xo,"array-contains",e),Vr(q2,"desc"),Dc(t),lE(n)):Ii(Bc,w0(Xo,"array-contains",e),Vr(q2,"desc"),Dc(t)),oL=()=>Fo(Ii(Bc)),aL=e=>Fo(e),Sa=e=>S_(Bc,e),Pc=(e,t)=>T_(rL(e),t),LE=e=>k_(Nf,e),W2=(e,t)=>Fo(Ii(Bc,w0(Xo,"==",[e,t]))),lL=(e,t)=>Pc(e,{[ME]:f_(t)}),cL=(e,t)=>Pc(e,{[ME]:m_(t)}),uL=(e,t,n)=>{const i=n==="add"?f_(t):m_(t);return Pc(e,{[QF]:i})},qr=e=>a_(zs,w_(e)),DE=(e,t)=>_l(zs,w_(e),t),S0=(e,t,n)=>Fo(n?Ii(qr(e),Vr(Ao,"desc"),Dc(t),lE(n)):t?Ii(qr(e),Vr(Ao,"desc"),Dc(t)):qr(e)),hL=(e,t)=>OE(DE(e,t)),dL=(e,t)=>S_(qr(e),t),ql=(e,t,n)=>T_(DE(e,t),n),BE=(e,t)=>k_(w_(e),t),fL=(e,t)=>E_(e,n=>{t(Ff(n))}),mL=(e,t,n)=>t&&n?Ii(qr(e),Vr(Ao),N2(t),F2(n)):t?Ii(qr(e),Vr(Ao),N2(t)):n?Ii(qr(e),Vr(Ao),F2(n)):Ii(qr(e),Vr(Ao)),pL=(e,t,n,i)=>E_(mL(e,t,n),r=>{i(Ff(r))}),PE=e=>({...e.data(),id:e.id}),Ff=e=>{const t=[];return e.forEach(n=>{t.push(PE(n))}),t},gL=e=>Ii(qr(e),Vr(Ao,"desc"),Dc(1)),_L=(e,t)=>E_(Ii(gL(e)),n=>{t(Ff(n))}),vL=(e,t,n,i,r)=>{const s=r==="add"?f_(n):m_(n);return ql(e,t,{[`${ZF}.${i}`]:s})},yL="files",UE=(e,t,n)=>zF(YF,`${yL}/${e}/${t}/${n}`),T0=(e,t,n)=>qF(UE(e,t,`${n.name}.${n.extension||n.type}`)),bL=e=>VF(e),wL=(e,t,n,i)=>{const r=UE(e,t,`${n.name}.${i}`);return HF(r,n.blob,{contentType:i})},EL=(e,t,n,i,r,s,o)=>{const a=wL(e,t,n,i);a.on("state_changed",l=>{const c=Math.round(l.bytesTransferred/l.totalBytes*100);r(c)},l=>{s(l)},async()=>{const l=await bL(a.snapshot.ref);o(l)})},SL=n5,k0=e=>t5(RE,"/status/"+e),TL=e=>{const t={state:"offline",lastChanged:Py()},n={state:"online",lastChanged:Py()},i=t5(RE,".info/connected");n5(i,r=>{r.val()===!0&&ER(k0(e)).set(t).then(()=>{SR(k0(e),n)})})},$u=(e,t)=>String(e).padStart(t,"0"),kL=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),A0=(e,t="")=>{if(!e)return;const n=e.seconds?new Date(e.seconds*1e3):e;if(t==="HH:mm")return`${$u(n.getHours(),2)}:${$u(n.getMinutes(),2)}`;if(t==="DD MMMM YYYY"){const i={month:"long",year:"numeric",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",i).format(n)}`}else if(t==="DD/MM/YY"){const i={month:"numeric",year:"numeric",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",i).format(n)}`}else if(t==="DD MMMM, HH:mm"){const i={month:"long",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",i).format(n)}, ${$u(n.getHours(),2)}:${$u(n.getMinutes(),2)}`}return n},jm=(e,t)=>{const n=kL(e,new Date)?"HH:mm":"DD/MM/YY",i=A0(t,n);return n==="HH:mm"?`Today, ${i}`:i};var AL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQYAAADjCAMAAABQFUqLAAAAilBMVEX///9BuIM0SV5xyqJnd4bz+/dNvIug28FZwZPP7eDn9u9AsYE1UGC35NCJ07I2V2M3ZWc/qn4+nHo7gXHb8ujD6dis4Ml9zqo8jnXy9PWU17llxZo5c2ycprBBVGjJztQ/o3w7h3M6em44bGrm6OuFkp89lXdNYHI2XmWzusJ0gpFaa3zZ3eFrnZOT9yJ3AAAFzElEQVR42szaCVLbQBCF4e6xZOMFzGIWAbZYJIQN3P96MSSTraZcea2o532H0F/TTzIy+ChAlZjVBehjhJvIRHEPAbQWsyJglmowlfJIcU8B1IjRNoBeFHctIseKmy8CZic2VRcwp2owk72R4h4DqBaTdQA9KG4in6ZqsAyYN7FoAuheceNSvpwo7tzlK7kLmMVcccfyXTlW3GnAbCqB1QH0qLiRRJZongVQK7A3n1j+ZInmBRzNwWN5rrgT+eXSI5oFGsuNQyzHM4mM0bwZOJptAJ2ZYxmt1OA1YLphY/mkuKNS/nBLF83CI5aXEvWI5jMczQFjedMrltGVJZqL4aLZBcyrGqwk8o3mO/CY8I1lNLVEc4lGc6hYPtseE5F3NLdEsbySlJk6PC26Sv7BewBdWGIpSUT3OPjyNu/3mOgfzXs0mg1tLCOXe1zLdHlLu/OIZk0Ry1tJ4rnHNRvHy1vateJe/nM0W8/LW9os/z2u9ojlnST53uPWBDPVQflHLKeZ6qD8I1a1yRjLKP+I5ThTHbbyiGbHdHn7W/4Ra5c/lgT3ON+ZiiGaLcNM9Tuee5zv5S0t/4jlM1OVclD+Ect5pkrzv8clYpnt8hblH7GcZiqA0z2uIrq8fSEYsXxnKqpo1kSXt738I1aWmSriucfBl7deMxVdNCuCmeoHghHLd6YijGYje1vGWPre4xhmqk/5Ryyay1vOEYthpiK4x20JZiohGLEYZiqCexzV5S3biMUxUxHc4xx/EE8jGbGYLm8JDj+V88xU37i1YxuGgRgIgnAFguHMdiL1X6QaUMbj/y7ZxAGzBIwmdyzXRCxSpvKM5hGUN6THETIVwONQ8paPWAPGstvjuPL2fF/EaCYzFdfjUPK2MGKh5e35fvtHM5ip2B6HkrdFEYuaqdij2TCW3IhFyFQNHvc3y1syYs0ZS4DHVTPVjNFkjGXJ48zy1hux+JmK6HHHCzKWJY+7zPLGiVjJTCX2uDdoLGsRy5ipWKO5Xd4YEevcLm8Ej4s+iG8fzc+csaxFLGOmwowmcSxrHmeWt2DEMstbMmIZMxXB40jyFoxYxky13+NY8haMWMZM1eFxZnkLRiy1vAWfyo2ZqmM054xlKWIZM1XHaM4Zy5LHGTNVh8eZ5S0YseaMZc3jzPKWjFjGTNXgcWZ5WxexLrS8BT3OmKk6PM4sb8mIZcxUDaM5Zyzvcs0dN2IYhoKFC1kG7Go/QNykyv2PmIq7kCPTPypYcuYSA77htYjlMVM1kKbn5c0yYnnMVA32OI+ZqoU048jy2h7neXkzjFgeM1WLPc7z8ma3x/14Xt4sI5bHTNVgj3O9vBlGLI+ZqoU0PS9vhhHLY6Zqscd99oP4v0WsOLK8FrE8ZqoG0owjy2t7nOflzTJieV7eDPc4j5mqxR7neXmzi1jfHjNVA2kGkuWFiOU0U1lL0/nyZrTHBZPl2adyt5nKVJrhZHnqtAh1TGxLEyTLE3uc80xldVoEOyZ0adJkeXSPC7O8XYpYATLVEWniZHkoYoVa3k7vcUEy1U5pMmW5O2KFyVS7pEmV5Z/TAndMVKSJWt7W9ji0LIvTAnlMLKWJlqUw4Ja3YxErXKbakiZblsKIW97qzJRMpZPhshSelEylM8BlKSTa8rZrjwvxIH6GES5LoaMeEyUZLkthoi1vaxGLekyUJLYsX/S05a3OHZOpdDq2LIUbJlPpTLTlbW2PY8tSeGAylU7PlqWQscdESceWpTDglrc6CXtMLKTJlqUw4pa3OjMlU+lkuCyFJyVTbe1x8R7Ez5DYsnxHLEqm0hnhshQ66jFRknHLW52Jkqm2TgvqMVGS2LJ80dOWtzp3TKbS6diyFG645a3OFyVTbUmTLUvhgclUOj1blkLGLW91nrTlrc4Al6WQsMfEQppsWQojbnmrM1OPiZIMl6Uw0Za3tYhFyVQ6iS3Ld8SiZCqdEbe81enYshRumEylM32ALH8BfJbP09a3ElQAAAAASUVORK5CYII=";function xL(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const CL=()=>{},IL=Object.assign,RL=Object.prototype.hasOwnProperty,Lf=(e,t)=>RL.call(e,t),Cs=Array.isArray,wh=e=>jE(e)==="[object Map]",ML=e=>typeof e=="function",OL=e=>typeof e=="string",A_=e=>typeof e=="symbol",Df=e=>e!==null&&typeof e=="object",NL=Object.prototype.toString,jE=e=>NL.call(e),FL=e=>jE(e).slice(8,-1),x_=e=>OL(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,HE=(e,t)=>!Object.is(e,t),LL=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let yr;class DL{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&yr&&(this.parent=yr,this.index=(yr.scopes||(yr.scopes=[])).push(this)-1)}run(t){if(this.active){const n=yr;try{return yr=this,t()}finally{yr=n}}}on(){yr=this}off(){yr=this.parent}stop(t){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function BL(e,t=yr){t&&t.active&&t.effects.push(e)}const C_=e=>{const t=new Set(e);return t.w=0,t.n=0,t},VE=e=>(e.w&Us)>0,qE=e=>(e.n&Us)>0,PL=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Us},UL=e=>{const{deps:t}=e;if(t.length){let n=0;for(let i=0;i<t.length;i++){const r=t[i];VE(r)&&!qE(r)?r.delete(e):t[n++]=r,r.w&=~Us,r.n&=~Us}t.length=n}},x0=new WeakMap;let zl=0,Us=1;const C0=30;let sr;const Lo=Symbol(""),I0=Symbol("");class I_{constructor(t,n=null,i){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,BL(this,i)}run(){if(!this.active)return this.fn();let t=sr,n=Is;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=sr,sr=this,Is=!0,Us=1<<++zl,zl<=C0?PL(this):K2(this),this.fn()}finally{zl<=C0&&UL(this),Us=1<<--zl,sr=this.parent,Is=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){sr===this?this.deferStop=!0:this.active&&(K2(this),this.onStop&&this.onStop(),this.active=!1)}}function K2(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Is=!0;const zE=[];function yl(){zE.push(Is),Is=!1}function bl(){const e=zE.pop();Is=e===void 0?!0:e}function Pi(e,t,n){if(Is&&sr){let i=x0.get(e);i||x0.set(e,i=new Map);let r=i.get(n);r||i.set(n,r=C_()),$E(r)}}function $E(e,t){let n=!1;zl<=C0?qE(e)||(e.n|=Us,n=!VE(e)):n=!e.has(sr),n&&(e.add(sr),sr.deps.push(e))}function es(e,t,n,i,r,s){const o=x0.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(n==="length"&&Cs(e))o.forEach((l,c)=>{(c==="length"||c>=i)&&a.push(l)});else switch(n!==void 0&&a.push(o.get(n)),t){case"add":Cs(e)?x_(n)&&a.push(o.get("length")):(a.push(o.get(Lo)),wh(e)&&a.push(o.get(I0)));break;case"delete":Cs(e)||(a.push(o.get(Lo)),wh(e)&&a.push(o.get(I0)));break;case"set":wh(e)&&a.push(o.get(Lo));break}if(a.length===1)a[0]&&R0(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);R0(C_(l))}}function R0(e,t){const n=Cs(e)?e:[...e];for(const i of n)i.computed&&G2(i);for(const i of n)i.computed||G2(i)}function G2(e,t){(e!==sr||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const jL=xL("__proto__,__v_isRef,__isVue"),WE=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(A_)),HL=R_(),VL=R_(!1,!0),qL=R_(!0),Y2=zL();function zL(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const i=Ft(this);for(let s=0,o=this.length;s<o;s++)Pi(i,"get",s+"");const r=i[t](...n);return r===-1||r===!1?i[t](...n.map(Ft)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){yl();const i=Ft(this)[t].apply(this,n);return bl(),i}}),e}function R_(e=!1,t=!1){return function(i,r,s){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&s===(e?t?oD:QE:t?XE:YE).get(i))return i;const o=Cs(i);if(!e&&o&&Lf(Y2,r))return Reflect.get(Y2,r,s);const a=Reflect.get(i,r,s);return(A_(r)?WE.has(r):jL(r))||(e||Pi(i,"get",r),t)?a:ri(a)?o&&x_(r)?a:a.value:Df(a)?e?ZE(a):N_(a):a}}const $L=KE(),WL=KE(!0);function KE(e=!1){return function(n,i,r,s){let o=n[i];if(Uc(o)&&ri(o)&&!ri(r))return!1;if(!e&&!Uc(r)&&(M0(r)||(r=Ft(r),o=Ft(o)),!Cs(n)&&ri(o)&&!ri(r)))return o.value=r,!0;const a=Cs(n)&&x_(i)?Number(i)<n.length:Lf(n,i),l=Reflect.set(n,i,r,s);return n===Ft(s)&&(a?HE(r,o)&&es(n,"set",i,r):es(n,"add",i,r)),l}}function KL(e,t){const n=Lf(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&es(e,"delete",t,void 0),i}function GL(e,t){const n=Reflect.has(e,t);return(!A_(t)||!WE.has(t))&&Pi(e,"has",t),n}function YL(e){return Pi(e,"iterate",Cs(e)?"length":Lo),Reflect.ownKeys(e)}const GE={get:HL,set:$L,deleteProperty:KL,has:GL,ownKeys:YL},XL={get:qL,set(e,t){return!0},deleteProperty(e,t){return!0}},QL=IL({},GE,{get:VL,set:WL}),M_=e=>e,Bf=e=>Reflect.getPrototypeOf(e);function Wu(e,t,n=!1,i=!1){e=e.__v_raw;const r=Ft(e),s=Ft(t);n||(t!==s&&Pi(r,"get",t),Pi(r,"get",s));const{has:o}=Bf(r),a=i?M_:n?D_:L_;if(o.call(r,t))return a(e.get(t));if(o.call(r,s))return a(e.get(s));e!==r&&e.get(t)}function Ku(e,t=!1){const n=this.__v_raw,i=Ft(n),r=Ft(e);return t||(e!==r&&Pi(i,"has",e),Pi(i,"has",r)),e===r?n.has(e):n.has(e)||n.has(r)}function Gu(e,t=!1){return e=e.__v_raw,!t&&Pi(Ft(e),"iterate",Lo),Reflect.get(e,"size",e)}function X2(e){e=Ft(e);const t=Ft(this);return Bf(t).has.call(t,e)||(t.add(e),es(t,"add",e,e)),this}function Q2(e,t){t=Ft(t);const n=Ft(this),{has:i,get:r}=Bf(n);let s=i.call(n,e);s||(e=Ft(e),s=i.call(n,e));const o=r.call(n,e);return n.set(e,t),s?HE(t,o)&&es(n,"set",e,t):es(n,"add",e,t),this}function Z2(e){const t=Ft(this),{has:n,get:i}=Bf(t);let r=n.call(t,e);r||(e=Ft(e),r=n.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return r&&es(t,"delete",e,void 0),s}function J2(){const e=Ft(this),t=e.size!==0,n=e.clear();return t&&es(e,"clear",void 0,void 0),n}function Yu(e,t){return function(i,r){const s=this,o=s.__v_raw,a=Ft(o),l=t?M_:e?D_:L_;return!e&&Pi(a,"iterate",Lo),o.forEach((c,d)=>i.call(r,l(c),l(d),s))}}function Xu(e,t,n){return function(...i){const r=this.__v_raw,s=Ft(r),o=wh(s),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=r[e](...i),d=n?M_:t?D_:L_;return!t&&Pi(s,"iterate",l?I0:Lo),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[d(u[0]),d(u[1])]:d(u),done:f}},[Symbol.iterator](){return this}}}}function us(e){return function(...t){return e==="delete"?!1:this}}function ZL(){const e={get(s){return Wu(this,s)},get size(){return Gu(this)},has:Ku,add:X2,set:Q2,delete:Z2,clear:J2,forEach:Yu(!1,!1)},t={get(s){return Wu(this,s,!1,!0)},get size(){return Gu(this)},has:Ku,add:X2,set:Q2,delete:Z2,clear:J2,forEach:Yu(!1,!0)},n={get(s){return Wu(this,s,!0)},get size(){return Gu(this,!0)},has(s){return Ku.call(this,s,!0)},add:us("add"),set:us("set"),delete:us("delete"),clear:us("clear"),forEach:Yu(!0,!1)},i={get(s){return Wu(this,s,!0,!0)},get size(){return Gu(this,!0)},has(s){return Ku.call(this,s,!0)},add:us("add"),set:us("set"),delete:us("delete"),clear:us("clear"),forEach:Yu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Xu(s,!1,!1),n[s]=Xu(s,!0,!1),t[s]=Xu(s,!1,!0),i[s]=Xu(s,!0,!0)}),[e,n,t,i]}const[JL,eD,tD,nD]=ZL();function O_(e,t){const n=t?e?nD:tD:e?eD:JL;return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Lf(n,r)&&r in i?n:i,r,s)}const iD={get:O_(!1,!1)},rD={get:O_(!1,!0)},sD={get:O_(!0,!1)},YE=new WeakMap,XE=new WeakMap,QE=new WeakMap,oD=new WeakMap;function aD(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lD(e){return e.__v_skip||!Object.isExtensible(e)?0:aD(FL(e))}function N_(e){return Uc(e)?e:F_(e,!1,GE,iD,YE)}function cD(e){return F_(e,!1,QL,rD,XE)}function ZE(e){return F_(e,!0,XL,sD,QE)}function F_(e,t,n,i,r){if(!Df(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=r.get(e);if(s)return s;const o=lD(e);if(o===0)return e;const a=new Proxy(e,o===2?i:n);return r.set(e,a),a}function Oa(e){return Uc(e)?Oa(e.__v_raw):!!(e&&e.__v_isReactive)}function Uc(e){return!!(e&&e.__v_isReadonly)}function M0(e){return!!(e&&e.__v_isShallow)}function JE(e){return Oa(e)||Uc(e)}function Ft(e){const t=e&&e.__v_raw;return t?Ft(t):e}function e6(e){return LL(e,"__v_skip",!0),e}const L_=e=>Df(e)?N_(e):e,D_=e=>Df(e)?ZE(e):e;function uD(e){Is&&sr&&(e=Ft(e),$E(e.dep||(e.dep=C_())))}function hD(e,t){e=Ft(e),e.dep&&R0(e.dep)}function ri(e){return!!(e&&e.__v_isRef===!0)}function dD(e){return ri(e)?e.value:e}const fD={get:(e,t,n)=>dD(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return ri(r)&&!ri(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function t6(e){return Oa(e)?e:new Proxy(e,fD)}class mD{constructor(t,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new I_(t,()=>{this._dirty||(this._dirty=!0,hD(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=Ft(this);return uD(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function pD(e,t,n=!1){let i,r;const s=ML(e);return s?(i=e,r=CL):(i=e.get,r=e.set),new mD(i,r,s||!r,n)}function gD(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}function Zt(e){if(kt(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=oi(i)?yD(i):Zt(i);if(r)for(const s in r)t[s]=r[s]}return t}else{if(oi(e))return e;if(ai(e))return e}}const _D=/;(?![^(]*\))/g,vD=/:(.+)/;function yD(e){const t={};return e.split(_D).forEach(n=>{if(n){const i=n.split(vD);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function mt(e){let t="";if(oi(e))t=e;else if(kt(e))for(let n=0;n<e.length;n++){const i=mt(e[n]);i&&(t+=i+" ")}else if(ai(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function Ht(e){if(!e)return null;let{class:t,style:n}=e;return t&&!oi(t)&&(e.class=mt(t)),n&&(e.style=Zt(n)),e}const ot=e=>oi(e)?e:e==null?"":kt(e)||ai(e)&&(e.toString===a6||!vt(e.toString))?JSON.stringify(e,n6,2):String(e),n6=(e,t)=>t&&t.__v_isRef?n6(e,t.value):r6(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:s6(t)?{[`Set(${t.size})`]:[...t.values()]}:ai(t)&&!kt(t)&&!l6(t)?String(t):t,Kt={},Na=[],Yr=()=>{},bD=()=>!1,wD=/^on[^a-z]/,B_=e=>wD.test(e),i6=e=>e.startsWith("onUpdate:"),Ui=Object.assign,P_=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},ED=Object.prototype.hasOwnProperty,Ot=(e,t)=>ED.call(e,t),kt=Array.isArray,r6=e=>U_(e)==="[object Map]",s6=e=>U_(e)==="[object Set]",vt=e=>typeof e=="function",oi=e=>typeof e=="string",ai=e=>e!==null&&typeof e=="object",o6=e=>ai(e)&&vt(e.then)&&vt(e.catch),a6=Object.prototype.toString,U_=e=>a6.call(e),l6=e=>U_(e)==="[object Object]",Eh=gD(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Pf=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},SD=/-(\w)/g,Mr=Pf(e=>e.replace(SD,(t,n)=>n?n.toUpperCase():"")),TD=/\B([A-Z])/g,Uf=Pf(e=>e.replace(TD,"-$1").toLowerCase()),j_=Pf(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hm=Pf(e=>e?`on${j_(e)}`:""),eb=(e,t)=>!Object.is(e,t),Vm=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},O0=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},kD=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let tb;const AD=()=>tb||(tb=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Rs(e,t,n,i){let r;try{r=i?e(...i):e()}catch(s){jf(s,t,n)}return r}function Qi(e,t,n,i){if(vt(e)){const s=Rs(e,t,n,i);return s&&o6(s)&&s.catch(o=>{jf(o,t,n)}),s}const r=[];for(let s=0;s<e.length;s++)r.push(Qi(e[s],t,n,i));return r}function jf(e,t,n,i=!0){const r=t?t.vnode:null;if(t){let s=t.parent;const o=t.proxy,a=n;for(;s;){const c=s.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,o,a)===!1)return}s=s.parent}const l=t.appContext.config.errorHandler;if(l){Rs(l,null,10,[e,o,a]);return}}xD(e,n,r,i)}function xD(e,t,n,i=!0){console.error(e)}let _d=!1,N0=!1;const xi=[];let Ur=0;const ac=[];let $l=null,_a=0;const lc=[];let vs=null,va=0;const c6=Promise.resolve();let H_=null,F0=null;function u6(e){const t=H_||c6;return e?t.then(this?e.bind(this):e):t}function CD(e){let t=Ur+1,n=xi.length;for(;t<n;){const i=t+n>>>1;jc(xi[i])<e?t=i+1:n=i}return t}function h6(e){(!xi.length||!xi.includes(e,_d&&e.allowRecurse?Ur+1:Ur))&&e!==F0&&(e.id==null?xi.push(e):xi.splice(CD(e.id),0,e),d6())}function d6(){!_d&&!N0&&(N0=!0,H_=c6.then(p6))}function ID(e){const t=xi.indexOf(e);t>Ur&&xi.splice(t,1)}function f6(e,t,n,i){kt(e)?n.push(...e):(!t||!t.includes(e,e.allowRecurse?i+1:i))&&n.push(e),d6()}function RD(e){f6(e,$l,ac,_a)}function MD(e){f6(e,vs,lc,va)}function Hf(e,t=null){if(ac.length){for(F0=t,$l=[...new Set(ac)],ac.length=0,_a=0;_a<$l.length;_a++)$l[_a]();$l=null,_a=0,F0=null,Hf(e,t)}}function m6(e){if(Hf(),lc.length){const t=[...new Set(lc)];if(lc.length=0,vs){vs.push(...t);return}for(vs=t,vs.sort((n,i)=>jc(n)-jc(i)),va=0;va<vs.length;va++)vs[va]();vs=null,va=0}}const jc=e=>e.id==null?1/0:e.id;function p6(e){N0=!1,_d=!0,Hf(e),xi.sort((t,n)=>jc(t)-jc(n));try{for(Ur=0;Ur<xi.length;Ur++){const t=xi[Ur];t&&t.active!==!1&&Rs(t,null,14)}}finally{Ur=0,xi.length=0,m6(),_d=!1,H_=null,(xi.length||ac.length||lc.length)&&p6(e)}}function OD(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||Kt;let r=n;const s=t.startsWith("update:"),o=s&&t.slice(7);if(o&&o in i){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:f}=i[d]||Kt;f&&(r=n.map(m=>m.trim())),u&&(r=n.map(kD))}let a,l=i[a=Hm(t)]||i[a=Hm(Mr(t))];!l&&s&&(l=i[a=Hm(Uf(t))]),l&&Qi(l,e,6,r);const c=i[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Qi(c,e,6,r)}}function g6(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let o={},a=!1;if(!vt(e)){const l=c=>{const d=g6(c,t,!0);d&&(a=!0,Ui(o,d))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!a?(i.set(e,null),null):(kt(s)?s.forEach(l=>o[l]=null):Ui(o,s),i.set(e,o),o)}function Vf(e,t){return!e||!B_(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ot(e,t[0].toLowerCase()+t.slice(1))||Ot(e,Uf(t))||Ot(e,t))}let Vn=null,_6=null;function vd(e){const t=Vn;return Vn=e,_6=e&&e.type.__scopeId||null,t}function Je(e,t=Vn,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&db(-1);const s=vd(t),o=e(...r);return vd(s),i._d&&db(1),o};return i._n=!0,i._c=!0,i._d=!0,i}function qm(e){const{type:t,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:d,renderCache:u,data:f,setupState:m,ctx:h,inheritAttrs:R}=e;let M,C;const _=vd(e);try{if(n.shapeFlag&4){const F=r||i;M=Er(d.call(F,F,u,s,m,f,h)),C=l}else{const F=t;M=Er(F.length>1?F(s,{attrs:l,slots:a,emit:c}):F(s,null)),C=t.props?l:ND(l)}}catch(F){uc.length=0,jf(F,e,1),M=Ve(Zi)}let x=M;if(C&&R!==!1){const F=Object.keys(C),{shapeFlag:O}=x;F.length&&O&7&&(o&&F.some(i6)&&(C=FD(C,o)),x=js(x,C))}return n.dirs&&(x=js(x),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&(x.transition=n.transition),M=x,vd(_),M}const ND=e=>{let t;for(const n in e)(n==="class"||n==="style"||B_(n))&&((t||(t={}))[n]=e[n]);return t},FD=(e,t)=>{const n={};for(const i in e)(!i6(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function LD(e,t,n){const{props:i,children:r,component:s}=e,{props:o,children:a,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?nb(i,o,c):!!o;if(l&8){const d=t.dynamicProps;for(let u=0;u<d.length;u++){const f=d[u];if(o[f]!==i[f]&&!Vf(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?nb(i,o,c):!0:!!o;return!1}function nb(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!Vf(n,s))return!0}return!1}function DD({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const BD=e=>e.__isSuspense;function PD(e,t){t&&t.pendingBranch?kt(e)?t.effects.push(...e):t.effects.push(e):MD(e)}function UD(e,t){if(In){let n=In.provides;const i=In.parent&&In.parent.provides;i===n&&(n=In.provides=Object.create(i)),n[e]=t}}function zm(e,t,n=!1){const i=In||Vn;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return n&&vt(t)?t.call(i.proxy):t}}const ib={};function $m(e,t,n){return v6(e,t,n)}function v6(e,t,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:o}=Kt){const a=In;let l,c=!1,d=!1;if(ri(e)?(l=()=>e.value,c=M0(e)):Oa(e)?(l=()=>e,i=!0):kt(e)?(d=!0,c=e.some(C=>Oa(C)||M0(C)),l=()=>e.map(C=>{if(ri(C))return C.value;if(Oa(C))return xo(C);if(vt(C))return Rs(C,a,2)})):vt(e)?t?l=()=>Rs(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),Qi(e,a,3,[f])}:l=Yr,t&&i){const C=l;l=()=>xo(C())}let u,f=C=>{u=M.onStop=()=>{Rs(C,a,4)}};if(zc)return f=Yr,t?n&&Qi(t,a,3,[l(),d?[]:void 0,f]):l(),Yr;let m=d?[]:ib;const h=()=>{if(!!M.active)if(t){const C=M.run();(i||c||(d?C.some((_,x)=>eb(_,m[x])):eb(C,m)))&&(u&&u(),Qi(t,a,3,[C,m===ib?void 0:m,f]),m=C)}else M.run()};h.allowRecurse=!!t;let R;r==="sync"?R=h:r==="post"?R=()=>mi(h,a&&a.suspense):R=()=>RD(h);const M=new I_(l,R);return t?n?h():m=M.run():r==="post"?mi(M.run.bind(M),a&&a.suspense):M.run(),()=>{M.stop(),a&&a.scope&&P_(a.scope.effects,M)}}function jD(e,t,n){const i=this.proxy,r=oi(e)?e.includes(".")?y6(i,e):()=>i[e]:e.bind(i,i);let s;vt(t)?s=t:(s=t.handler,n=t);const o=In;el(this);const a=v6(r,s.bind(i),n);return o?el(o):Do(),a}function y6(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function xo(e,t){if(!ai(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ri(e))xo(e.value,t);else if(kt(e))for(let n=0;n<e.length;n++)xo(e[n],t);else if(s6(e)||r6(e))e.forEach(n=>{xo(n,t)});else if(l6(e))for(const n in e)xo(e[n],t);return e}function b6(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return T6(()=>{e.isMounted=!0}),A6(()=>{e.isUnmounting=!0}),e}const Vi=[Function,Array],HD={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Vi,onEnter:Vi,onAfterEnter:Vi,onEnterCancelled:Vi,onBeforeLeave:Vi,onLeave:Vi,onAfterLeave:Vi,onLeaveCancelled:Vi,onBeforeAppear:Vi,onAppear:Vi,onAfterAppear:Vi,onAppearCancelled:Vi},setup(e,{slots:t}){const n=H6(),i=b6();let r;return()=>{const s=t.default&&V_(t.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const R of s)if(R.type!==Zi){o=R;break}}const a=Ft(e),{mode:l}=a;if(i.isLeaving)return Wm(o);const c=rb(o);if(!c)return Wm(o);const d=Hc(c,a,i,n);Vc(c,d);const u=n.subTree,f=u&&rb(u);let m=!1;const{getTransitionKey:h}=c.type;if(h){const R=h();r===void 0?r=R:R!==r&&(r=R,m=!0)}if(f&&f.type!==Zi&&(!_o(c,f)||m)){const R=Hc(f,a,i,n);if(Vc(f,R),l==="out-in")return i.isLeaving=!0,R.afterLeave=()=>{i.isLeaving=!1,n.update()},Wm(o);l==="in-out"&&c.type!==Zi&&(R.delayLeave=(M,C,_)=>{const x=E6(i,f);x[String(f.key)]=f,M._leaveCb=()=>{C(),M._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=_})}return o}}},w6=HD;function E6(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function Hc(e,t,n,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:f,onAfterLeave:m,onLeaveCancelled:h,onBeforeAppear:R,onAppear:M,onAfterAppear:C,onAppearCancelled:_}=t,x=String(e.key),F=E6(n,e),O=(T,S)=>{T&&Qi(T,i,9,S)},N=(T,S)=>{const g=S[1];O(T,S),kt(T)?T.every(b=>b.length<=1)&&g():T.length<=1&&g()},v={mode:s,persisted:o,beforeEnter(T){let S=a;if(!n.isMounted)if(r)S=R||a;else return;T._leaveCb&&T._leaveCb(!0);const g=F[x];g&&_o(e,g)&&g.el._leaveCb&&g.el._leaveCb(),O(S,[T])},enter(T){let S=l,g=c,b=d;if(!n.isMounted)if(r)S=M||l,g=C||c,b=_||d;else return;let y=!1;const w=T._enterCb=A=>{y||(y=!0,A?O(b,[T]):O(g,[T]),v.delayedLeave&&v.delayedLeave(),T._enterCb=void 0)};S?N(S,[T,w]):w()},leave(T,S){const g=String(e.key);if(T._enterCb&&T._enterCb(!0),n.isUnmounting)return S();O(u,[T]);let b=!1;const y=T._leaveCb=w=>{b||(b=!0,S(),w?O(h,[T]):O(m,[T]),T._leaveCb=void 0,F[g]===e&&delete F[g])};F[g]=e,f?N(f,[T,y]):y()},clone(T){return Hc(T,t,n,i)}};return v}function Wm(e){if(qf(e))return e=js(e),e.children=null,e}function rb(e){return qf(e)?e.children?e.children[0]:void 0:e}function Vc(e,t){e.shapeFlag&6&&e.component?Vc(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function V_(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let o=e[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===wt?(o.patchFlag&128&&r++,i=i.concat(V_(o.children,t,a))):(t||o.type!==Zi)&&i.push(a!=null?js(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function VD(e){return vt(e)?{setup:e,name:e.name}:e}const cc=e=>!!e.type.__asyncLoader,qf=e=>e.type.__isKeepAlive;function qD(e,t){S6(e,"a",t)}function zD(e,t){S6(e,"da",t)}function S6(e,t,n=In){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(zf(t,i,n),n){let r=n.parent;for(;r&&r.parent;)qf(r.parent.vnode)&&$D(i,t,n,r),r=r.parent}}function $D(e,t,n,i){const r=zf(t,e,i,!0);x6(()=>{P_(i[t],r)},n)}function zf(e,t,n=In,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;yl(),el(n);const a=Qi(t,n,e,o);return Do(),bl(),a});return i?r.unshift(s):r.push(s),s}}const os=e=>(t,n=In)=>(!zc||e==="sp")&&zf(e,t,n),WD=os("bm"),T6=os("m"),KD=os("bu"),k6=os("u"),A6=os("bum"),x6=os("um"),GD=os("sp"),YD=os("rtg"),XD=os("rtc");function QD(e,t=In){zf("ec",e,t)}function ts(e,t){const n=Vn;if(n===null)return e;const i=Kf(n)||n.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[o,a,l,c=Kt]=t[s];vt(o)&&(o={mounted:o,updated:o}),o.deep&&xo(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:c})}return e}function Xs(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(yl(),Qi(l,n,8,[e.el,a,e,t]),bl())}}const q_="components",ZD="directives";function Ze(e,t){return z_(q_,e,!0,t)||e}const C6=Symbol();function JD(e){return oi(e)?z_(q_,e,!1)||e:e||C6}function $f(e){return z_(ZD,e)}function z_(e,t,n=!0,i=!1){const r=Vn||In;if(r){const s=r.type;if(e===q_){const a=AB(s,!1);if(a&&(a===t||a===Mr(t)||a===j_(Mr(t))))return s}const o=sb(r[e]||s[e],t)||sb(r.appContext[e],t);return!o&&i?s:o}}function sb(e,t){return e&&(e[t]||e[Mr(t)]||e[j_(Mr(t))])}function ht(e,t,n,i){let r;const s=n&&n[i];if(kt(e)||oi(e)){r=new Array(e.length);for(let o=0,a=e.length;o<a;o++)r[o]=t(e[o],o,void 0,s&&s[o])}else if(typeof e=="number"){r=new Array(e);for(let o=0;o<e;o++)r[o]=t(o+1,o,void 0,s&&s[o])}else if(ai(e))if(e[Symbol.iterator])r=Array.from(e,(o,a)=>t(o,a,void 0,s&&s[a]));else{const o=Object.keys(e);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];r[a]=t(e[c],c,a,s&&s[a])}}else r=[];return n&&(n[i]=r),r}function Vt(e,t){for(let n=0;n<t.length;n++){const i=t[n];if(kt(i))for(let r=0;r<i.length;r++)e[i[r].name]=i[r].fn;else i&&(e[i.name]=i.fn)}return e}function Pe(e,t,n={},i,r){if(Vn.isCE||Vn.parent&&cc(Vn.parent)&&Vn.parent.isCE)return Ve("slot",t==="default"?null:{name:t},i&&i());let s=e[t];s&&s._c&&(s._d=!1),ae();const o=s&&I6(s(n)),a=Lt(wt,{key:n.key||`_${t}`},o||(i?i():[]),o&&e._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function I6(e){return e.some(t=>wd(t)?!(t.type===Zi||t.type===wt&&!I6(t.children)):!0)?e:null}const L0=e=>e?V6(e)?Kf(e)||e.proxy:L0(e.parent):null,yd=Ui(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>L0(e.parent),$root:e=>L0(e.root),$emit:e=>e.emit,$options:e=>M6(e),$forceUpdate:e=>e.f||(e.f=()=>h6(e.update)),$nextTick:e=>e.n||(e.n=u6.bind(e.proxy)),$watch:e=>jD.bind(e)}),eB={get({_:e},t){const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const m=o[t];if(m!==void 0)switch(m){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(i!==Kt&&Ot(i,t))return o[t]=1,i[t];if(r!==Kt&&Ot(r,t))return o[t]=2,r[t];if((c=e.propsOptions[0])&&Ot(c,t))return o[t]=3,s[t];if(n!==Kt&&Ot(n,t))return o[t]=4,n[t];D0&&(o[t]=0)}}const d=yd[t];let u,f;if(d)return t==="$attrs"&&Pi(e,"get",t),d(e);if((u=a.__cssModules)&&(u=u[t]))return u;if(n!==Kt&&Ot(n,t))return o[t]=4,n[t];if(f=l.config.globalProperties,Ot(f,t))return f[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return r!==Kt&&Ot(r,t)?(r[t]=n,!0):i!==Kt&&Ot(i,t)?(i[t]=n,!0):Ot(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||e!==Kt&&Ot(e,o)||t!==Kt&&Ot(t,o)||(a=s[0])&&Ot(a,o)||Ot(i,o)||Ot(yd,o)||Ot(r.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Ot(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let D0=!0;function tB(e){const t=M6(e),n=e.proxy,i=e.ctx;D0=!1,t.beforeCreate&&ob(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:u,mounted:f,beforeUpdate:m,updated:h,activated:R,deactivated:M,beforeDestroy:C,beforeUnmount:_,destroyed:x,unmounted:F,render:O,renderTracked:N,renderTriggered:v,errorCaptured:T,serverPrefetch:S,expose:g,inheritAttrs:b,components:y,directives:w,filters:A}=t;if(c&&nB(c,i,null,e.appContext.config.unwrapInjectedRef),o)for(const K in o){const H=o[K];vt(H)&&(i[K]=H.bind(n))}if(r){const K=r.call(n,n);ai(K)&&(e.data=N_(K))}if(D0=!0,s)for(const K in s){const H=s[K],$=vt(H)?H.bind(n,n):vt(H.get)?H.get.bind(n,n):Yr,p=!vt(H)&&vt(H.set)?H.set.bind(n):Yr,I=CB({get:$,set:p});Object.defineProperty(i,K,{enumerable:!0,configurable:!0,get:()=>I.value,set:Z=>I.value=Z})}if(a)for(const K in a)R6(a[K],i,n,K);if(l){const K=vt(l)?l.call(n):l;Reflect.ownKeys(K).forEach(H=>{UD(H,K[H])})}d&&ob(d,e,"c");function j(K,H){kt(H)?H.forEach($=>K($.bind(n))):H&&K(H.bind(n))}if(j(WD,u),j(T6,f),j(KD,m),j(k6,h),j(qD,R),j(zD,M),j(QD,T),j(XD,N),j(YD,v),j(A6,_),j(x6,F),j(GD,S),kt(g))if(g.length){const K=e.exposed||(e.exposed={});g.forEach(H=>{Object.defineProperty(K,H,{get:()=>n[H],set:$=>n[H]=$})})}else e.exposed||(e.exposed={});O&&e.render===Yr&&(e.render=O),b!=null&&(e.inheritAttrs=b),y&&(e.components=y),w&&(e.directives=w)}function nB(e,t,n=Yr,i=!1){kt(e)&&(e=B0(e));for(const r in e){const s=e[r];let o;ai(s)?"default"in s?o=zm(s.from||r,s.default,!0):o=zm(s.from||r):o=zm(s),ri(o)&&i?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):t[r]=o}}function ob(e,t,n){Qi(kt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function R6(e,t,n,i){const r=i.includes(".")?y6(n,i):()=>n[i];if(oi(e)){const s=t[e];vt(s)&&$m(r,s)}else if(vt(e))$m(r,e.bind(n));else if(ai(e))if(kt(e))e.forEach(s=>R6(s,t,n,i));else{const s=vt(e.handler)?e.handler.bind(n):t[e.handler];vt(s)&&$m(r,s,e)}}function M6(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,a=s.get(t);let l;return a?l=a:!r.length&&!n&&!i?l=t:(l={},r.length&&r.forEach(c=>bd(l,c,o,!0)),bd(l,t,o)),s.set(t,l),l}function bd(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&bd(e,s,n,!0),r&&r.forEach(o=>bd(e,o,n,!0));for(const o in t)if(!(i&&o==="expose")){const a=iB[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const iB={data:ab,props:uo,emits:uo,methods:uo,computed:uo,beforeCreate:Qn,created:Qn,beforeMount:Qn,mounted:Qn,beforeUpdate:Qn,updated:Qn,beforeDestroy:Qn,beforeUnmount:Qn,destroyed:Qn,unmounted:Qn,activated:Qn,deactivated:Qn,errorCaptured:Qn,serverPrefetch:Qn,components:uo,directives:uo,watch:sB,provide:ab,inject:rB};function ab(e,t){return t?e?function(){return Ui(vt(e)?e.call(this,this):e,vt(t)?t.call(this,this):t)}:t:e}function rB(e,t){return uo(B0(e),B0(t))}function B0(e){if(kt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Qn(e,t){return e?[...new Set([].concat(e,t))]:t}function uo(e,t){return e?Ui(Ui(Object.create(null),e),t):t}function sB(e,t){if(!e)return t;if(!t)return e;const n=Ui(Object.create(null),e);for(const i in t)n[i]=Qn(e[i],t[i]);return n}function oB(e,t,n,i=!1){const r={},s={};O0(s,Wf,1),e.propsDefaults=Object.create(null),O6(e,t,r,s);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);n?e.props=i?r:cD(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function aB(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=e,a=Ft(r),[l]=e.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const d=e.vnode.dynamicProps;for(let u=0;u<d.length;u++){let f=d[u];if(Vf(e.emitsOptions,f))continue;const m=t[f];if(l)if(Ot(s,f))m!==s[f]&&(s[f]=m,c=!0);else{const h=Mr(f);r[h]=P0(l,a,h,m,e,!1)}else m!==s[f]&&(s[f]=m,c=!0)}}}else{O6(e,t,r,s)&&(c=!0);let d;for(const u in a)(!t||!Ot(t,u)&&((d=Uf(u))===u||!Ot(t,d)))&&(l?n&&(n[u]!==void 0||n[d]!==void 0)&&(r[u]=P0(l,a,u,void 0,e,!0)):delete r[u]);if(s!==a)for(const u in s)(!t||!Ot(t,u)&&!0)&&(delete s[u],c=!0)}c&&es(e,"set","$attrs")}function O6(e,t,n,i){const[r,s]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(Eh(l))continue;const c=t[l];let d;r&&Ot(r,d=Mr(l))?!s||!s.includes(d)?n[d]=c:(a||(a={}))[d]=c:Vf(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=Ft(n),c=a||Kt;for(let d=0;d<s.length;d++){const u=s[d];n[u]=P0(r,l,u,c[u],e,!Ot(c,u))}}return o}function P0(e,t,n,i,r,s){const o=e[n];if(o!=null){const a=Ot(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&vt(l)){const{propsDefaults:c}=r;n in c?i=c[n]:(el(r),i=c[n]=l.call(null,t),Do())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===Uf(n))&&(i=!0))}return i}function N6(e,t,n=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const s=e.props,o={},a=[];let l=!1;if(!vt(e)){const d=u=>{l=!0;const[f,m]=N6(u,t,!0);Ui(o,f),m&&a.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!s&&!l)return i.set(e,Na),Na;if(kt(s))for(let d=0;d<s.length;d++){const u=Mr(s[d]);lb(u)&&(o[u]=Kt)}else if(s)for(const d in s){const u=Mr(d);if(lb(u)){const f=s[d],m=o[u]=kt(f)||vt(f)?{type:f}:f;if(m){const h=hb(Boolean,m.type),R=hb(String,m.type);m[0]=h>-1,m[1]=R<0||h<R,(h>-1||Ot(m,"default"))&&a.push(u)}}}const c=[o,a];return i.set(e,c),c}function lb(e){return e[0]!=="$"}function cb(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function ub(e,t){return cb(e)===cb(t)}function hb(e,t){return kt(t)?t.findIndex(n=>ub(n,e)):vt(t)&&ub(t,e)?0:-1}const F6=e=>e[0]==="_"||e==="$stable",$_=e=>kt(e)?e.map(Er):[Er(e)],lB=(e,t,n)=>{if(t._n)return t;const i=Je((...r)=>$_(t(...r)),n);return i._c=!1,i},L6=(e,t,n)=>{const i=e._ctx;for(const r in e){if(F6(r))continue;const s=e[r];if(vt(s))t[r]=lB(r,s,i);else if(s!=null){const o=$_(s);t[r]=()=>o}}},D6=(e,t)=>{const n=$_(t);e.slots.default=()=>n},cB=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=Ft(t),O0(t,"_",n)):L6(t,e.slots={})}else e.slots={},t&&D6(e,t);O0(e.slots,Wf,1)},uB=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,o=Kt;if(i.shapeFlag&32){const a=t._;a?n&&a===1?s=!1:(Ui(r,t),!n&&a===1&&delete r._):(s=!t.$stable,L6(t,r)),o=t}else t&&(D6(e,t),o={default:1});if(s)for(const a in r)!F6(a)&&!(a in o)&&delete r[a]};function B6(){return{app:null,config:{isNativeTag:bD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hB=0;function dB(e,t){return function(i,r=null){vt(i)||(i=Object.assign({},i)),r!=null&&!ai(r)&&(r=null);const s=B6(),o=new Set;let a=!1;const l=s.app={_uid:hB++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:RB,get config(){return s.config},set config(c){},use(c,...d){return o.has(c)||(c&&vt(c.install)?(o.add(c),c.install(l,...d)):vt(c)&&(o.add(c),c(l,...d))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,d){return d?(s.components[c]=d,l):s.components[c]},directive(c,d){return d?(s.directives[c]=d,l):s.directives[c]},mount(c,d,u){if(!a){const f=Ve(i,r);return f.appContext=s,d&&t?t(f,c):e(f,c,u),a=!0,l._container=c,c.__vue_app__=l,Kf(f.component)||f.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,d){return s.provides[c]=d,l}};return l}}function U0(e,t,n,i,r=!1){if(kt(e)){e.forEach((f,m)=>U0(f,t&&(kt(t)?t[m]:t),n,i,r));return}if(cc(i)&&!r)return;const s=i.shapeFlag&4?Kf(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=e,c=t&&t.r,d=a.refs===Kt?a.refs={}:a.refs,u=a.setupState;if(c!=null&&c!==l&&(oi(c)?(d[c]=null,Ot(u,c)&&(u[c]=null)):ri(c)&&(c.value=null)),vt(l))Rs(l,a,12,[o,d]);else{const f=oi(l),m=ri(l);if(f||m){const h=()=>{if(e.f){const R=f?d[l]:l.value;r?kt(R)&&P_(R,s):kt(R)?R.includes(s)||R.push(s):f?(d[l]=[s],Ot(u,l)&&(u[l]=d[l])):(l.value=[s],e.k&&(d[e.k]=l.value))}else f?(d[l]=o,Ot(u,l)&&(u[l]=o)):m&&(l.value=o,e.k&&(d[e.k]=o))};o?(h.id=-1,mi(h,n)):h()}}}const mi=PD;function fB(e){return mB(e)}function mB(e,t){const n=AD();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:f,setScopeId:m=Yr,cloneNode:h,insertStaticContent:R}=e,M=(k,L,q,W=null,G=null,ie=null,ce=!1,J=null,re=!!L.dynamicChildren)=>{if(k===L)return;k&&!_o(k,L)&&(W=qe(k),D(k,G,ie,!0),k=null),L.patchFlag===-2&&(re=!1,L.dynamicChildren=null);const{type:Q,ref:Ee,shapeFlag:fe}=L;switch(Q){case W_:C(k,L,q,W);break;case Zi:_(k,L,q,W);break;case Km:k==null&&x(L,q,W,ce);break;case wt:w(k,L,q,W,G,ie,ce,J,re);break;default:fe&1?N(k,L,q,W,G,ie,ce,J,re):fe&6?A(k,L,q,W,G,ie,ce,J,re):(fe&64||fe&128)&&Q.process(k,L,q,W,G,ie,ce,J,re,we)}Ee!=null&&G&&U0(Ee,k&&k.ref,ie,L||k,!L)},C=(k,L,q,W)=>{if(k==null)i(L.el=a(L.children),q,W);else{const G=L.el=k.el;L.children!==k.children&&c(G,L.children)}},_=(k,L,q,W)=>{k==null?i(L.el=l(L.children||""),q,W):L.el=k.el},x=(k,L,q,W)=>{[k.el,k.anchor]=R(k.children,L,q,W,k.el,k.anchor)},F=({el:k,anchor:L},q,W)=>{let G;for(;k&&k!==L;)G=f(k),i(k,q,W),k=G;i(L,q,W)},O=({el:k,anchor:L})=>{let q;for(;k&&k!==L;)q=f(k),r(k),k=q;r(L)},N=(k,L,q,W,G,ie,ce,J,re)=>{ce=ce||L.type==="svg",k==null?v(L,q,W,G,ie,ce,J,re):g(k,L,G,ie,ce,J,re)},v=(k,L,q,W,G,ie,ce,J)=>{let re,Q;const{type:Ee,props:fe,shapeFlag:Te,transition:Ce,patchFlag:Le,dirs:ue}=k;if(k.el&&h!==void 0&&Le===-1)re=k.el=h(k.el);else{if(re=k.el=o(k.type,ie,fe&&fe.is,fe),Te&8?d(re,k.children):Te&16&&S(k.children,re,null,W,G,ie&&Ee!=="foreignObject",ce,J),ue&&Xs(k,null,W,"created"),fe){for(const ee in fe)ee!=="value"&&!Eh(ee)&&s(re,ee,null,fe[ee],ie,k.children,W,G,be);"value"in fe&&s(re,"value",null,fe.value),(Q=fe.onVnodeBeforeMount)&&pr(Q,W,k)}T(re,k,k.scopeId,ce,W)}ue&&Xs(k,null,W,"beforeMount");const ve=(!G||G&&!G.pendingBranch)&&Ce&&!Ce.persisted;ve&&Ce.beforeEnter(re),i(re,L,q),((Q=fe&&fe.onVnodeMounted)||ve||ue)&&mi(()=>{Q&&pr(Q,W,k),ve&&Ce.enter(re),ue&&Xs(k,null,W,"mounted")},G)},T=(k,L,q,W,G)=>{if(q&&m(k,q),W)for(let ie=0;ie<W.length;ie++)m(k,W[ie]);if(G){let ie=G.subTree;if(L===ie){const ce=G.vnode;T(k,ce,ce.scopeId,ce.slotScopeIds,G.parent)}}},S=(k,L,q,W,G,ie,ce,J,re=0)=>{for(let Q=re;Q<k.length;Q++){const Ee=k[Q]=J?ws(k[Q]):Er(k[Q]);M(null,Ee,L,q,W,G,ie,ce,J)}},g=(k,L,q,W,G,ie,ce)=>{const J=L.el=k.el;let{patchFlag:re,dynamicChildren:Q,dirs:Ee}=L;re|=k.patchFlag&16;const fe=k.props||Kt,Te=L.props||Kt;let Ce;q&&Qs(q,!1),(Ce=Te.onVnodeBeforeUpdate)&&pr(Ce,q,L,k),Ee&&Xs(L,k,q,"beforeUpdate"),q&&Qs(q,!0);const Le=G&&L.type!=="foreignObject";if(Q?b(k.dynamicChildren,Q,J,q,W,Le,ie):ce||$(k,L,J,null,q,W,Le,ie,!1),re>0){if(re&16)y(J,L,fe,Te,q,W,G);else if(re&2&&fe.class!==Te.class&&s(J,"class",null,Te.class,G),re&4&&s(J,"style",fe.style,Te.style,G),re&8){const ue=L.dynamicProps;for(let ve=0;ve<ue.length;ve++){const ee=ue[ve],Ne=fe[ee],B=Te[ee];(B!==Ne||ee==="value")&&s(J,ee,Ne,B,G,k.children,q,W,be)}}re&1&&k.children!==L.children&&d(J,L.children)}else!ce&&Q==null&&y(J,L,fe,Te,q,W,G);((Ce=Te.onVnodeUpdated)||Ee)&&mi(()=>{Ce&&pr(Ce,q,L,k),Ee&&Xs(L,k,q,"updated")},W)},b=(k,L,q,W,G,ie,ce)=>{for(let J=0;J<L.length;J++){const re=k[J],Q=L[J],Ee=re.el&&(re.type===wt||!_o(re,Q)||re.shapeFlag&70)?u(re.el):q;M(re,Q,Ee,null,W,G,ie,ce,!0)}},y=(k,L,q,W,G,ie,ce)=>{if(q!==W){for(const J in W){if(Eh(J))continue;const re=W[J],Q=q[J];re!==Q&&J!=="value"&&s(k,J,Q,re,ce,L.children,G,ie,be)}if(q!==Kt)for(const J in q)!Eh(J)&&!(J in W)&&s(k,J,q[J],null,ce,L.children,G,ie,be);"value"in W&&s(k,"value",q.value,W.value)}},w=(k,L,q,W,G,ie,ce,J,re)=>{const Q=L.el=k?k.el:a(""),Ee=L.anchor=k?k.anchor:a("");let{patchFlag:fe,dynamicChildren:Te,slotScopeIds:Ce}=L;Ce&&(J=J?J.concat(Ce):Ce),k==null?(i(Q,q,W),i(Ee,q,W),S(L.children,q,Ee,G,ie,ce,J,re)):fe>0&&fe&64&&Te&&k.dynamicChildren?(b(k.dynamicChildren,Te,q,G,ie,ce,J),(L.key!=null||G&&L===G.subTree)&&P6(k,L,!0)):$(k,L,q,Ee,G,ie,ce,J,re)},A=(k,L,q,W,G,ie,ce,J,re)=>{L.slotScopeIds=J,k==null?L.shapeFlag&512?G.ctx.activate(L,q,W,ce,re):E(L,q,W,G,ie,ce,re):j(k,L,re)},E=(k,L,q,W,G,ie,ce)=>{const J=k.component=wB(k,W,G);if(qf(k)&&(J.ctx.renderer=we),EB(J),J.asyncDep){if(G&&G.registerDep(J,K),!k.el){const re=J.subTree=Ve(Zi);_(null,re,L,q)}return}K(J,k,L,q,G,ie,ce)},j=(k,L,q)=>{const W=L.component=k.component;if(LD(k,L,q))if(W.asyncDep&&!W.asyncResolved){H(W,L,q);return}else W.next=L,ID(W.update),W.update();else L.el=k.el,W.vnode=L},K=(k,L,q,W,G,ie,ce)=>{const J=()=>{if(k.isMounted){let{next:Ee,bu:fe,u:Te,parent:Ce,vnode:Le}=k,ue=Ee,ve;Qs(k,!1),Ee?(Ee.el=Le.el,H(k,Ee,ce)):Ee=Le,fe&&Vm(fe),(ve=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&pr(ve,Ce,Ee,Le),Qs(k,!0);const ee=qm(k),Ne=k.subTree;k.subTree=ee,M(Ne,ee,u(Ne.el),qe(Ne),k,G,ie),Ee.el=ee.el,ue===null&&DD(k,ee.el),Te&&mi(Te,G),(ve=Ee.props&&Ee.props.onVnodeUpdated)&&mi(()=>pr(ve,Ce,Ee,Le),G)}else{let Ee;const{el:fe,props:Te}=L,{bm:Ce,m:Le,parent:ue}=k,ve=cc(L);if(Qs(k,!1),Ce&&Vm(Ce),!ve&&(Ee=Te&&Te.onVnodeBeforeMount)&&pr(Ee,ue,L),Qs(k,!0),fe&&lt){const ee=()=>{k.subTree=qm(k),lt(fe,k.subTree,k,G,null)};ve?L.type.__asyncLoader().then(()=>!k.isUnmounted&&ee()):ee()}else{const ee=k.subTree=qm(k);M(null,ee,q,W,k,G,ie),L.el=ee.el}if(Le&&mi(Le,G),!ve&&(Ee=Te&&Te.onVnodeMounted)){const ee=L;mi(()=>pr(Ee,ue,ee),G)}(L.shapeFlag&256||ue&&cc(ue.vnode)&&ue.vnode.shapeFlag&256)&&k.a&&mi(k.a,G),k.isMounted=!0,L=q=W=null}},re=k.effect=new I_(J,()=>h6(Q),k.scope),Q=k.update=()=>re.run();Q.id=k.uid,Qs(k,!0),Q()},H=(k,L,q)=>{L.component=k;const W=k.vnode.props;k.vnode=L,k.next=null,aB(k,L.props,W,q),uB(k,L.children,q),yl(),Hf(void 0,k.update),bl()},$=(k,L,q,W,G,ie,ce,J,re=!1)=>{const Q=k&&k.children,Ee=k?k.shapeFlag:0,fe=L.children,{patchFlag:Te,shapeFlag:Ce}=L;if(Te>0){if(Te&128){I(Q,fe,q,W,G,ie,ce,J,re);return}else if(Te&256){p(Q,fe,q,W,G,ie,ce,J,re);return}}Ce&8?(Ee&16&&be(Q,G,ie),fe!==Q&&d(q,fe)):Ee&16?Ce&16?I(Q,fe,q,W,G,ie,ce,J,re):be(Q,G,ie,!0):(Ee&8&&d(q,""),Ce&16&&S(fe,q,W,G,ie,ce,J,re))},p=(k,L,q,W,G,ie,ce,J,re)=>{k=k||Na,L=L||Na;const Q=k.length,Ee=L.length,fe=Math.min(Q,Ee);let Te;for(Te=0;Te<fe;Te++){const Ce=L[Te]=re?ws(L[Te]):Er(L[Te]);M(k[Te],Ce,q,null,G,ie,ce,J,re)}Q>Ee?be(k,G,ie,!0,!1,fe):S(L,q,W,G,ie,ce,J,re,fe)},I=(k,L,q,W,G,ie,ce,J,re)=>{let Q=0;const Ee=L.length;let fe=k.length-1,Te=Ee-1;for(;Q<=fe&&Q<=Te;){const Ce=k[Q],Le=L[Q]=re?ws(L[Q]):Er(L[Q]);if(_o(Ce,Le))M(Ce,Le,q,null,G,ie,ce,J,re);else break;Q++}for(;Q<=fe&&Q<=Te;){const Ce=k[fe],Le=L[Te]=re?ws(L[Te]):Er(L[Te]);if(_o(Ce,Le))M(Ce,Le,q,null,G,ie,ce,J,re);else break;fe--,Te--}if(Q>fe){if(Q<=Te){const Ce=Te+1,Le=Ce<Ee?L[Ce].el:W;for(;Q<=Te;)M(null,L[Q]=re?ws(L[Q]):Er(L[Q]),q,Le,G,ie,ce,J,re),Q++}}else if(Q>Te)for(;Q<=fe;)D(k[Q],G,ie,!0),Q++;else{const Ce=Q,Le=Q,ue=new Map;for(Q=Le;Q<=Te;Q++){const X=L[Q]=re?ws(L[Q]):Er(L[Q]);X.key!=null&&ue.set(X.key,Q)}let ve,ee=0;const Ne=Te-Le+1;let B=!1,U=0;const z=new Array(Ne);for(Q=0;Q<Ne;Q++)z[Q]=0;for(Q=Ce;Q<=fe;Q++){const X=k[Q];if(ee>=Ne){D(X,G,ie,!0);continue}let V;if(X.key!=null)V=ue.get(X.key);else for(ve=Le;ve<=Te;ve++)if(z[ve-Le]===0&&_o(X,L[ve])){V=ve;break}V===void 0?D(X,G,ie,!0):(z[V-Le]=Q+1,V>=U?U=V:B=!0,M(X,L[V],q,null,G,ie,ce,J,re),ee++)}const Y=B?pB(z):Na;for(ve=Y.length-1,Q=Ne-1;Q>=0;Q--){const X=Le+Q,V=L[X],ne=X+1<Ee?L[X+1].el:W;z[Q]===0?M(null,V,q,ne,G,ie,ce,J,re):B&&(ve<0||Q!==Y[ve]?Z(V,q,ne,2):ve--)}}},Z=(k,L,q,W,G=null)=>{const{el:ie,type:ce,transition:J,children:re,shapeFlag:Q}=k;if(Q&6){Z(k.component.subTree,L,q,W);return}if(Q&128){k.suspense.move(L,q,W);return}if(Q&64){ce.move(k,L,q,we);return}if(ce===wt){i(ie,L,q);for(let fe=0;fe<re.length;fe++)Z(re[fe],L,q,W);i(k.anchor,L,q);return}if(ce===Km){F(k,L,q);return}if(W!==2&&Q&1&&J)if(W===0)J.beforeEnter(ie),i(ie,L,q),mi(()=>J.enter(ie),G);else{const{leave:fe,delayLeave:Te,afterLeave:Ce}=J,Le=()=>i(ie,L,q),ue=()=>{fe(ie,()=>{Le(),Ce&&Ce()})};Te?Te(ie,Le,ue):ue()}else i(ie,L,q)},D=(k,L,q,W=!1,G=!1)=>{const{type:ie,props:ce,ref:J,children:re,dynamicChildren:Q,shapeFlag:Ee,patchFlag:fe,dirs:Te}=k;if(J!=null&&U0(J,null,q,k,!0),Ee&256){L.ctx.deactivate(k);return}const Ce=Ee&1&&Te,Le=!cc(k);let ue;if(Le&&(ue=ce&&ce.onVnodeBeforeUnmount)&&pr(ue,L,k),Ee&6)xe(k.component,q,W);else{if(Ee&128){k.suspense.unmount(q,W);return}Ce&&Xs(k,null,L,"beforeUnmount"),Ee&64?k.type.remove(k,L,q,G,we,W):Q&&(ie!==wt||fe>0&&fe&64)?be(Q,L,q,!1,!0):(ie===wt&&fe&384||!G&&Ee&16)&&be(re,L,q),W&&ye(k)}(Le&&(ue=ce&&ce.onVnodeUnmounted)||Ce)&&mi(()=>{ue&&pr(ue,L,k),Ce&&Xs(k,null,L,"unmounted")},q)},ye=k=>{const{type:L,el:q,anchor:W,transition:G}=k;if(L===wt){Oe(q,W);return}if(L===Km){O(k);return}const ie=()=>{r(q),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(k.shapeFlag&1&&G&&!G.persisted){const{leave:ce,delayLeave:J}=G,re=()=>ce(q,ie);J?J(k.el,ie,re):re()}else ie()},Oe=(k,L)=>{let q;for(;k!==L;)q=f(k),r(k),k=q;r(L)},xe=(k,L,q)=>{const{bum:W,scope:G,update:ie,subTree:ce,um:J}=k;W&&Vm(W),G.stop(),ie&&(ie.active=!1,D(ce,k,L,q)),J&&mi(J,L),mi(()=>{k.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},be=(k,L,q,W=!1,G=!1,ie=0)=>{for(let ce=ie;ce<k.length;ce++)D(k[ce],L,q,W,G)},qe=k=>k.shapeFlag&6?qe(k.component.subTree):k.shapeFlag&128?k.suspense.next():f(k.anchor||k.el),Fe=(k,L,q)=>{k==null?L._vnode&&D(L._vnode,null,null,!0):M(L._vnode||null,k,L,null,null,null,q),m6(),L._vnode=k},we={p:M,um:D,m:Z,r:ye,mt:E,mc:S,pc:$,pbc:b,n:qe,o:e};let Ye,lt;return t&&([Ye,lt]=t(we)),{render:Fe,hydrate:Ye,createApp:dB(Fe,Ye)}}function Qs({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function P6(e,t,n=!1){const i=e.children,r=t.children;if(kt(i)&&kt(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=ws(r[s]),a.el=o.el),n||P6(o,a))}}function pB(e){const t=e.slice(),n=[0];let i,r,s,o,a;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,e[n[a]]<c?s=a+1:o=a;c<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=t[o];return n}const gB=e=>e.__isTeleport,wt=Symbol(void 0),W_=Symbol(void 0),Zi=Symbol(void 0),Km=Symbol(void 0),uc=[];let lr=null;function ae(e=!1){uc.push(lr=e?null:[])}function _B(){uc.pop(),lr=uc[uc.length-1]||null}let qc=1;function db(e){qc+=e}function U6(e){return e.dynamicChildren=qc>0?lr||Na:null,_B(),qc>0&&lr&&lr.push(e),e}function _e(e,t,n,i,r,s){return U6(Me(e,t,n,i,r,s,!0))}function Lt(e,t,n,i,r){return U6(Ve(e,t,n,i,r,!0))}function wd(e){return e?e.__v_isVNode===!0:!1}function _o(e,t){return e.type===t.type&&e.key===t.key}const Wf="__vInternal",j6=({key:e})=>e!=null?e:null,Sh=({ref:e,ref_key:t,ref_for:n})=>e!=null?oi(e)||ri(e)||vt(e)?{i:Vn,r:e,k:t,f:!!n}:e:null;function Me(e,t=null,n=null,i=0,r=null,s=e===wt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&j6(t),ref:t&&Sh(t),scopeId:_6,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(K_(l,n),s&128&&e.normalize(l)):n&&(l.shapeFlag|=oi(n)?8:16),qc>0&&!o&&lr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&lr.push(l),l}const Ve=vB;function vB(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===C6)&&(e=Zi),wd(e)){const a=js(e,t,!0);return n&&K_(a,n),qc>0&&!s&&lr&&(a.shapeFlag&6?lr[lr.indexOf(e)]=a:lr.push(a)),a.patchFlag|=-2,a}if(xB(e)&&(e=e.__vccOpts),t){t=Bt(t);let{class:a,style:l}=t;a&&!oi(a)&&(t.class=mt(a)),ai(l)&&(JE(l)&&!kt(l)&&(l=Ui({},l)),t.style=Zt(l))}const o=oi(e)?1:BD(e)?128:gB(e)?64:ai(e)?4:vt(e)?2:0;return Me(e,t,n,i,r,o,s,!0)}function Bt(e){return e?JE(e)||Wf in e?Ui({},e):e:null}function js(e,t,n=!1){const{props:i,ref:r,patchFlag:s,children:o}=e,a=t?G_(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&j6(a),ref:t&&t.ref?n&&r?kt(r)?r.concat(Sh(t)):[r,Sh(t)]:Sh(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==wt?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&js(e.ssContent),ssFallback:e.ssFallback&&js(e.ssFallback),el:e.el,anchor:e.anchor}}function ns(e=" ",t=0){return Ve(W_,null,e,t)}function Be(e="",t=!1){return t?(ae(),Lt(Zi,null,e)):Ve(Zi,null,e)}function Er(e){return e==null||typeof e=="boolean"?Ve(Zi):kt(e)?Ve(wt,null,e.slice()):typeof e=="object"?ws(e):Ve(W_,null,String(e))}function ws(e){return e.el===null||e.memo?e:js(e)}function K_(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(kt(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),K_(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!(Wf in t)?t._ctx=Vn:r===3&&Vn&&(Vn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else vt(t)?(t={default:t,_ctx:Vn},n=32):(t=String(t),i&64?(n=16,t=[ns(t)]):n=8);e.children=t,e.shapeFlag|=n}function G_(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=mt([t.class,i.class]));else if(r==="style")t.style=Zt([t.style,i.style]);else if(B_(r)){const s=t[r],o=i[r];o&&s!==o&&!(kt(s)&&s.includes(o))&&(t[r]=s?[].concat(s,o):o)}else r!==""&&(t[r]=i[r])}return t}function pr(e,t,n,i=null){Qi(e,t,7,[n,i])}const yB=B6();let bB=0;function wB(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||yB,s={uid:bB++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new DL(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:N6(i,r),emitsOptions:g6(i,r),emit:null,emitted:null,propsDefaults:Kt,inheritAttrs:i.inheritAttrs,ctx:Kt,data:Kt,props:Kt,attrs:Kt,slots:Kt,refs:Kt,setupState:Kt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=OD.bind(null,s),e.ce&&e.ce(s),s}let In=null;const H6=()=>In||Vn,el=e=>{In=e,e.scope.on()},Do=()=>{In&&In.scope.off(),In=null};function V6(e){return e.vnode.shapeFlag&4}let zc=!1;function EB(e,t=!1){zc=t;const{props:n,children:i}=e.vnode,r=V6(e);oB(e,n,r,t),cB(e,i);const s=r?SB(e,t):void 0;return zc=!1,s}function SB(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=e6(new Proxy(e.ctx,eB));const{setup:i}=n;if(i){const r=e.setupContext=i.length>1?kB(e):null;el(e),yl();const s=Rs(i,e,0,[e.props,r]);if(bl(),Do(),o6(s)){if(s.then(Do,Do),t)return s.then(o=>{fb(e,o,t)}).catch(o=>{jf(o,e,0)});e.asyncDep=s}else fb(e,s,t)}else q6(e,t)}function fb(e,t,n){vt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ai(t)&&(e.setupState=t6(t)),q6(e,n)}let mb;function q6(e,t,n){const i=e.type;if(!e.render){if(!t&&mb&&!i.render){const r=i.template;if(r){const{isCustomElement:s,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=i,c=Ui(Ui({isCustomElement:s,delimiters:a},o),l);i.render=mb(r,c)}}e.render=i.render||Yr}el(e),yl(),tB(e),bl(),Do()}function TB(e){return new Proxy(e.attrs,{get(t,n){return Pi(e,"get","$attrs"),t[n]}})}function kB(e){const t=i=>{e.exposed=i||{}};let n;return{get attrs(){return n||(n=TB(e))},slots:e.slots,emit:e.emit,expose:t}}function Kf(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(t6(e6(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in yd)return yd[n](e)}}))}function AB(e,t=!0){return vt(e)?e.displayName||e.name:e.name||t&&e.__name}function xB(e){return vt(e)&&"__vccOpts"in e}const CB=(e,t)=>pD(e,t,zc);function IB(e,t,n){const i=arguments.length;return i===2?ai(t)&&!kt(t)?wd(t)?Ve(e,null,[t]):Ve(e,t):Ve(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&wd(n)&&(n=[n]),Ve(e,t,n))}const RB="3.2.37";function MB(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const OB="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",NB=MB(OB);function z6(e){return!!e||e===""}const FB=/^on[^a-z]/,LB=e=>FB.test(e),DB=e=>e.startsWith("onUpdate:"),wu=Object.assign,Eu=Array.isArray,BB=e=>typeof e=="function",j0=e=>typeof e=="string",PB=e=>e!==null&&typeof e=="object",Y_=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},UB=/-(\w)/g,pb=Y_(e=>e.replace(UB,(t,n)=>n?n.toUpperCase():"")),jB=/\B([A-Z])/g,Fa=Y_(e=>e.replace(jB,"-$1").toLowerCase()),HB=Y_(e=>e.charAt(0).toUpperCase()+e.slice(1)),H0=e=>{const t=parseFloat(e);return isNaN(t)?e:t},VB="http://www.w3.org/2000/svg",vo=typeof document!="undefined"?document:null,gb=vo&&vo.createElement("template"),qB={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t?vo.createElementNS(VB,e):vo.createElement(e,n?{is:n}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>vo.createTextNode(e),createComment:e=>vo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>vo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,i,r,s){const o=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{gb.innerHTML=i?`<svg>${e}</svg>`:e;const a=gb.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function zB(e,t,n){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function $B(e,t,n){const i=e.style,r=j0(n);if(n&&!r){for(const s in n)V0(i,s,n[s]);if(t&&!j0(t))for(const s in t)n[s]==null&&V0(i,s,"")}else{const s=i.display;r?t!==n&&(i.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const _b=/\s*!important$/;function V0(e,t,n){if(Eu(n))n.forEach(i=>V0(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=WB(e,t);_b.test(n)?e.setProperty(Fa(i),n.replace(_b,""),"important"):e[i]=n}}const vb=["Webkit","Moz","ms"],Gm={};function WB(e,t){const n=Gm[t];if(n)return n;let i=Mr(t);if(i!=="filter"&&i in e)return Gm[t]=i;i=HB(i);for(let r=0;r<vb.length;r++){const s=vb[r]+i;if(s in e)return Gm[t]=s}return t}const yb="http://www.w3.org/1999/xlink";function KB(e,t,n,i,r){if(i&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(yb,t.slice(6,t.length)):e.setAttributeNS(yb,t,n);else{const s=NB(t);n==null||s&&!z6(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function GB(e,t,n,i,r,s,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,r,s),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const l=n==null?"":n;(e.value!==l||e.tagName==="OPTION")&&(e.value=l),n==null&&e.removeAttribute(t);return}let a=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=z6(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(t)}const[$6,YB]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let q0=0;const XB=Promise.resolve(),QB=()=>{q0=0},ZB=()=>q0||(XB.then(QB),q0=$6());function JB(e,t,n,i){e.addEventListener(t,n,i)}function eP(e,t,n,i){e.removeEventListener(t,n,i)}function tP(e,t,n,i,r=null){const s=e._vei||(e._vei={}),o=s[t];if(i&&o)o.value=i;else{const[a,l]=nP(t);if(i){const c=s[t]=iP(i,r);JB(e,a,c,l)}else o&&(eP(e,a,o,l),s[t]=void 0)}}const bb=/(?:Once|Passive|Capture)$/;function nP(e){let t;if(bb.test(e)){t={};let n;for(;n=e.match(bb);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Fa(e.slice(2)),t]}function iP(e,t){const n=i=>{const r=i.timeStamp||$6();(YB||r>=n.attached-1)&&Qi(rP(i,n.value),t,5,[i])};return n.value=e,n.attached=ZB(),n}function rP(e,t){if(Eu(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const wb=/^on[a-z]/,sP=(e,t,n,i,r=!1,s,o,a,l)=>{t==="class"?zB(e,i,r):t==="style"?$B(e,n,i):LB(t)?DB(t)||tP(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):oP(e,t,i,r))?GB(e,t,i,s,o,a,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),KB(e,t,i,r))};function oP(e,t,n,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&wb.test(t)&&BB(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||wb.test(t)&&j0(n)?!1:t in e}function aP(e,t){const n=VD(e);class i extends X_{constructor(s){super(n,s,t)}}return i.def=n,i}const lP=typeof HTMLElement!="undefined"?HTMLElement:class{};class X_ extends lP{constructor(t,n={},i){super(),this._def=t,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&i?i(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,u6(()=>{this._connected||(Cb(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}).observe(this,{attributes:!0});const t=i=>{const{props:r,styles:s}=i,o=!Eu(r),a=r?o?Object.keys(r):r:[];let l;if(o)for(const c in this._props){const d=r[c];(d===Number||d&&d.type===Number)&&(this._props[c]=H0(this._props[c]),(l||(l=Object.create(null)))[c]=!0)}this._numberProps=l;for(const c of Object.keys(this))c[0]!=="_"&&this._setProp(c,this[c],!0,!1);for(const c of a.map(pb))Object.defineProperty(this,c,{get(){return this._getProp(c)},set(d){this._setProp(c,d)}});this._applyStyles(s),this._update()},n=this._def.__asyncLoader;n?n().then(t):t(this._def)}_setAttr(t){let n=this.getAttribute(t);this._numberProps&&this._numberProps[t]&&(n=H0(n)),this._setProp(pb(t),n,!1)}_getProp(t){return this._props[t]}_setProp(t,n,i=!0,r=!0){n!==this._props[t]&&(this._props[t]=n,r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(Fa(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Fa(t),n+""):n||this.removeAttribute(Fa(t))))}_update(){Cb(this._createVNode(),this.shadowRoot)}_createVNode(){const t=Ve(this._def,wu({},this._props));return this._instance||(t.ce=n=>{this._instance=n,n.isCE=!0,n.emit=(r,...s)=>{this.dispatchEvent(new CustomEvent(r,{detail:s}))};let i=this;for(;i=i&&(i.parentNode||i.host);)if(i instanceof X_){n.parent=i._instance;break}}),t}_applyStyles(t){t&&t.forEach(n=>{const i=document.createElement("style");i.textContent=n,this.shadowRoot.appendChild(i)})}}const hs="transition",Ml="animation",fn=(e,{slots:t})=>IB(w6,K6(e),t);fn.displayName="Transition";const W6={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},cP=fn.props=wu({},w6.props,W6),Zs=(e,t=[])=>{Eu(e)?e.forEach(n=>n(...t)):e&&e(...t)},Eb=e=>e?Eu(e)?e.some(t=>t.length>1):e.length>1:!1;function K6(e){const t={};for(const y in e)y in W6||(t[y]=e[y]);if(e.css===!1)return t;const{name:n="v",type:i,duration:r,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:d=a,leaveFromClass:u=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=e,h=uP(r),R=h&&h[0],M=h&&h[1],{onBeforeEnter:C,onEnter:_,onEnterCancelled:x,onLeave:F,onLeaveCancelled:O,onBeforeAppear:N=C,onAppear:v=_,onAppearCancelled:T=x}=t,S=(y,w,A)=>{ys(y,w?d:a),ys(y,w?c:o),A&&A()},g=(y,w)=>{y._isLeaving=!1,ys(y,u),ys(y,m),ys(y,f),w&&w()},b=y=>(w,A)=>{const E=y?v:_,j=()=>S(w,y,A);Zs(E,[w,j]),Sb(()=>{ys(w,y?l:s),Dr(w,y?d:a),Eb(E)||Tb(w,i,R,j)})};return wu(t,{onBeforeEnter(y){Zs(C,[y]),Dr(y,s),Dr(y,o)},onBeforeAppear(y){Zs(N,[y]),Dr(y,l),Dr(y,c)},onEnter:b(!1),onAppear:b(!0),onLeave(y,w){y._isLeaving=!0;const A=()=>g(y,w);Dr(y,u),Y6(),Dr(y,f),Sb(()=>{!y._isLeaving||(ys(y,u),Dr(y,m),Eb(F)||Tb(y,i,M,A))}),Zs(F,[y,A])},onEnterCancelled(y){S(y,!1),Zs(x,[y])},onAppearCancelled(y){S(y,!0),Zs(T,[y])},onLeaveCancelled(y){g(y),Zs(O,[y])}})}function uP(e){if(e==null)return null;if(PB(e))return[Ym(e.enter),Ym(e.leave)];{const t=Ym(e);return[t,t]}}function Ym(e){return H0(e)}function Dr(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function ys(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function Sb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let hP=0;function Tb(e,t,n,i){const r=e._endId=++hP,s=()=>{r===e._endId&&i()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:l}=G6(e,t);if(!o)return i();const c=o+"end";let d=0;const u=()=>{e.removeEventListener(c,f),s()},f=m=>{m.target===e&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},a+1),e.addEventListener(c,f)}function G6(e,t){const n=window.getComputedStyle(e),i=h=>(n[h]||"").split(", "),r=i(hs+"Delay"),s=i(hs+"Duration"),o=kb(r,s),a=i(Ml+"Delay"),l=i(Ml+"Duration"),c=kb(a,l);let d=null,u=0,f=0;t===hs?o>0&&(d=hs,u=o,f=s.length):t===Ml?c>0&&(d=Ml,u=c,f=l.length):(u=Math.max(o,c),d=u>0?o>c?hs:Ml:null,f=d?d===hs?s.length:l.length:0);const m=d===hs&&/\b(transform|all)(,|$)/.test(n[hs+"Property"]);return{type:d,timeout:u,propCount:f,hasTransform:m}}function kb(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>Ab(n)+Ab(e[i])))}function Ab(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Y6(){return document.body.offsetHeight}const X6=new WeakMap,Q6=new WeakMap,dP={name:"TransitionGroup",props:wu({},cP,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=H6(),i=b6();let r,s;return k6(()=>{if(!r.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!gP(r[0].el,n.vnode.el,o))return;r.forEach(fP),r.forEach(mP);const a=r.filter(pP);Y6(),a.forEach(l=>{const c=l.el,d=c.style;Dr(c,o),d.transform=d.webkitTransform=d.transitionDuration="";const u=c._moveCb=f=>{f&&f.target!==c||(!f||/transform$/.test(f.propertyName))&&(c.removeEventListener("transitionend",u),c._moveCb=null,ys(c,o))};c.addEventListener("transitionend",u)})}),()=>{const o=Ft(e),a=K6(o);let l=o.tag||wt;r=s,s=t.default?V_(t.default()):[];for(let c=0;c<s.length;c++){const d=s[c];d.key!=null&&Vc(d,Hc(d,a,i,n))}if(r)for(let c=0;c<r.length;c++){const d=r[c];Vc(d,Hc(d,a,i,n)),X6.set(d,d.el.getBoundingClientRect())}return Ve(l,null,s)}}},Q_=dP;function fP(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function mP(e){Q6.set(e,e.el.getBoundingClientRect())}function pP(e){const t=X6.get(e),n=Q6.get(e),i=t.left-n.left,r=t.top-n.top;if(i||r){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${i}px,${r}px)`,s.transitionDuration="0s",e}}function gP(e,t,n){const i=e.cloneNode();e._vtc&&e._vtc.forEach(o=>{o.split(/\s+/).forEach(a=>a&&i.classList.remove(a))}),n.split(/\s+/).forEach(o=>o&&i.classList.add(o)),i.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(i);const{hasTransform:s}=G6(i);return r.removeChild(i),s}const _P=["ctrl","shift","alt","meta"],vP={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>_P.some(n=>e[`${n}Key`]&&!t.includes(n))},Ar=(e,t)=>(n,...i)=>{for(let r=0;r<t.length;r++){const s=vP[t[r]];if(s&&s(n,t))return}return e(n,...i)},yP={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ho=(e,t)=>n=>{if(!("key"in n))return;const i=Fa(n.key);if(t.some(r=>r===i||yP[r]===i))return e(n)},Gf={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Ol(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!=!n&&(i?t?(i.beforeEnter(e),Ol(e,!0),i.enter(e)):i.leave(e,()=>{Ol(e,!1)}):Ol(e,t))},beforeUnmount(e,{value:t}){Ol(e,t)}};function Ol(e,t){e.style.display=t?e._vod:"none"}const bP=wu({patchProp:sP},qB);let xb;function wP(){return xb||(xb=fB(bP))}const Cb=(...e)=>{wP().render(...e)};var Yt=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n};const EP={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},SP=Me("div",{id:"vac-circle"},null,-1),TP=Me("div",{id:"vac-circle"},null,-1),kP=Me("div",{id:"vac-circle"},null,-1),AP=Me("div",{id:"vac-circle"},null,-1),xP=Me("div",{id:"vac-circle"},null,-1),CP=Me("div",{id:"vac-circle"},null,-1);function IP(e,t,n,i,r,s){return ae(),Lt(fn,{name:"vac-fade-spinner",appear:""},{default:Je(()=>[n.show?(ae(),_e("div",{key:0,class:mt(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},[n.type==="rooms"?Pe(e.$slots,"spinner-icon-rooms",{key:0},()=>[SP]):Be("",!0),n.type==="infinite-rooms"?Pe(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[TP]):Be("",!0),n.type==="message-file"?Pe(e.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},()=>[kP]):Be("",!0),n.type==="room-file"?Pe(e.$slots,"spinner-icon-room-file",{key:3},()=>[AP]):Be("",!0),n.type==="messages"?Pe(e.$slots,"spinner-icon-messages",{key:4},()=>[xP]):Be("",!0),n.type==="infinite-messages"?Pe(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[CP]):Be("",!0)],2)):Be("",!0)]),_:3})}var Yf=Yt(EP,[["render",IP]]);const RP={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return e.size==="large"?512:e.size==="medium"?48:24}}},MP=["viewBox"],OP=["id","d"],NP=["id","d"];function FP(e,t,n,i,r,s){return ae(),_e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${s.size} ${s.size}`},[Me("path",{id:s.svgId,d:r.svgItem[n.name].path},null,8,OP),r.svgItem[n.name].path2?(ae(),_e("path",{key:0,id:s.svgId,d:r.svgItem[n.name].path2},null,8,NP)):Be("",!0)],8,MP)}var Bn=Yt(RP,[["render",FP]]);const LP={name:"RoomsSearch",components:{SvgIcon:Bn},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},DP={key:0,class:"vac-icon-search"},BP=["placeholder"];function PP(e,t,n,i,r,s){const o=Ze("svg-icon");return ae(),_e("div",{class:mt({"vac-box-search":s.showSearchBar,"vac-box-empty":!s.showSearchBar})},[n.showSearch?(ae(),_e(wt,{key:0},[!n.loadingRooms&&n.rooms.length?(ae(),_e("div",DP,[Pe(e.$slots,"search-icon",{},()=>[Ve(o,{name:"search"})])])):Be("",!0),!n.loadingRooms&&n.rooms.length?(ae(),_e("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=a=>e.$emit("search-room",a))},null,40,BP)):Be("",!0)],64)):Be("",!0),n.showAddRoom?(ae(),_e("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=a=>e.$emit("add-room"))},[Pe(e.$slots,"add-icon",{},()=>[Ve(o,{name:"add"})])])):Be("",!0)],2)}var UP=Yt(LP,[["render",PP]]);const Ib=document.createElement("i");function Z6(e){const t="&"+e+";";Ib.innerHTML=t;const n=Ib.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Ni(e,t,n,i){const r=e.length;let s=0,o;if(t<0?t=-t>r?0:r+t:t=t>r?r:t,n=n>0?n:0,i.length<1e4)o=Array.from(i),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);s<i.length;)o=i.slice(s,s+1e4),o.unshift(t,0),e.splice(...o),s+=1e4,t+=1e4}function Hn(e,t){return e.length>0?(Ni(e,e.length,0,t),e):t}const z0={}.hasOwnProperty;function J6(e){const t={};let n=-1;for(;++n<e.length;)jP(t,e[n]);return t}function jP(e,t){let n;for(n in t){const r=(z0.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let o;if(s)for(o in s){z0.call(r,o)||(r[o]=[]);const a=s[o];HP(r[o],Array.isArray(a)?a:a?[a]:[])}}}function HP(e,t){let n=-1;const i=[];for(;++n<t.length;)(t[n].add==="after"?e:i).push(t[n]);Ni(e,0,0,i)}function e8(e){const t={};let n=-1;for(;++n<e.length;)VP(t,e[n]);return t}function VP(e,t){let n;for(n in t){const r=(z0.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let o;if(s)for(o in s)r[o]=s[o]}}function qP(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"\uFFFD":String.fromCharCode(n)}const zP={'"':"quot","&":"amp","<":"lt",">":"gt"};function t8(e){return e.replace(/["&<>]/g,t);function t(n){return"&"+zP[n]+";"}}function Or(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const $P=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,ei=$s(/[A-Za-z]/),qn=$s(/[\dA-Za-z]/),WP=$s(/[#-'*+\--9=?A-Z^-~]/);function Ed(e){return e!==null&&(e<32||e===127)}const $0=$s(/\d/),KP=$s(/[\dA-Fa-f]/),GP=$s(/[!-/:-@[-`{-~]/);function et(e){return e!==null&&e<-2}function Gt(e){return e!==null&&(e<0||e===32)}function bt(e){return e===-2||e===-1||e===32}const Z_=$s($P),tl=$s(/\s/);function $s(e){return t;function t(n){return n!==null&&e.test(String.fromCharCode(n))}}function Co(e,t){const n=t8(YP(e||""));if(!t)return n;const i=n.indexOf(":"),r=n.indexOf("?"),s=n.indexOf("#"),o=n.indexOf("/");return i<0||o>-1&&i>o||r>-1&&i>r||s>-1&&i>s||t.test(n.slice(0,i))?n:""}function YP(e){const t=[];let n=-1,i=0,r=0;for(;++n<e.length;){const s=e.charCodeAt(n);let o="";if(s===37&&qn(e.charCodeAt(n+1))&&qn(e.charCodeAt(n+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const a=e.charCodeAt(n+1);s<56320&&a>56319&&a<57344?(o=String.fromCharCode(s,a),r=1):o="\uFFFD"}else o=String.fromCharCode(s);o&&(t.push(e.slice(i,n),encodeURIComponent(o)),i=n+r+1,o=""),r&&(n+=r,r=0)}return t.join("")+e.slice(i)}const Rb={}.hasOwnProperty,Mb=/^(https?|ircs?|mailto|xmpp)$/i,XP=/^https?$/i;function QP(e){const t=e||{};let n=!0;const i={},r=[[]],s=[],o=[],l=e8([{enter:{blockQuote:A,codeFenced:H,codeFencedFenceInfo:M,codeFencedFenceMeta:M,codeIndented:I,codeText:Y,content:ce,definition:k,definitionDestinationString:q,definitionLabelString:M,definitionTitleString:M,emphasis:U,htmlFlow:ee,htmlText:B,image:D,label:M,link:ye,listItemMarker:g,listItemValue:S,listOrdered:v,listUnordered:T,paragraph:j,reference:M,resource:qe,resourceDestinationString:Fe,resourceTitleString:M,setextHeading:re,strong:z},exit:{atxHeading:Ee,atxHeadingSequence:J,autolinkEmail:ge,autolinkProtocol:le,blockQuote:E,characterEscapeValue:Ce,characterReferenceMarkerHexadecimal:te,characterReferenceMarkerNumeric:te,characterReferenceValue:pe,codeFenced:Z,codeFencedFence:p,codeFencedFenceInfo:$,codeFencedFenceMeta:C,codeFlowValue:ue,codeIndented:Z,codeText:X,codeTextData:Ce,data:Ce,definition:ie,definitionDestinationString:W,definitionLabelString:L,definitionTitleString:G,emphasis:V,hardBreakEscape:ve,hardBreakTrailing:ve,htmlFlow:Ne,htmlFlowData:Ce,htmlText:Ne,htmlTextData:Ce,image:lt,label:xe,labelText:Oe,lineEnding:Le,link:lt,listOrdered:b,listUnordered:y,paragraph:K,reference:C,referenceString:be,resource:C,resourceDestinationString:we,resourceTitleString:Ye,setextHeading:Te,setextHeadingLineSequence:fe,setextHeadingText:Q,strong:ne,thematicBreak:oe}}].concat(t.htmlExtensions||[])),c={tightStack:o,definitions:i},d={lineEndingIfNeeded:O,options:t,encode:N,raw:x,tag:_,buffer:M,resume:C,setData:h,getData:R};let u=t.defaultLineEnding;return f;function f(se){let ke=-1,Se=0;const We=[];let he=[],je=[];for(;++ke<se.length;)!u&&(se[ke][1].type==="lineEnding"||se[ke][1].type==="lineEndingBlank")&&(u=se[ke][2].sliceSerialize(se[ke][1])),(se[ke][1].type==="listOrdered"||se[ke][1].type==="listUnordered")&&(se[ke][0]==="enter"?We.push(ke):m(se.slice(We.pop(),ke))),se[ke][1].type==="definition"&&(se[ke][0]==="enter"?(je=Hn(je,se.slice(Se,ke)),Se=ke):(he=Hn(he,se.slice(Se,ke+1)),Se=ke+1));he=Hn(he,je),he=Hn(he,se.slice(Se)),ke=-1;const Qe=he;for(l.enter.null&&l.enter.null.call(d);++ke<se.length;){const Ie=l[Qe[ke][0]],ze=Qe[ke][1].type,Re=Ie[ze];Rb.call(Ie,ze)&&Re&&Re.call(Object.assign({sliceSerialize:Qe[ke][2].sliceSerialize},d),Qe[ke][1])}return l.exit.null&&l.exit.null.call(d),r[0].join("")}function m(se){const ke=se.length;let Se=0,We=0,he=!1,je;for(;++Se<ke;){const Qe=se[Se];if(Qe[1]._container)je=void 0,Qe[0]==="enter"?We++:We--;else switch(Qe[1].type){case"listItemPrefix":{Qe[0]==="exit"&&(je=!0);break}case"linePrefix":break;case"lineEndingBlank":{Qe[0]==="enter"&&!We&&(je?je=void 0:he=!0);break}default:je=void 0}}se[0][1]._loose=he}function h(se,ke){c[se]=ke}function R(se){return c[se]}function M(){r.push([])}function C(){return r.pop().join("")}function _(se){!n||(h("lastWasTag",!0),r[r.length-1].push(se))}function x(se){h("lastWasTag"),r[r.length-1].push(se)}function F(){x(u||`
`)}function O(){const se=r[r.length-1],ke=se[se.length-1],Se=ke?ke.charCodeAt(ke.length-1):null;Se===10||Se===13||Se===null||F()}function N(se){return R("ignoreEncode")?se:t8(se)}function v(se){o.push(!se._loose),O(),_("<ol"),h("expectFirstItem",!0)}function T(se){o.push(!se._loose),O(),_("<ul"),h("expectFirstItem",!0)}function S(se){if(R("expectFirstItem")){const ke=Number.parseInt(this.sliceSerialize(se),10);ke!==1&&_(' start="'+N(String(ke))+'"')}}function g(){R("expectFirstItem")?_(">"):w(),O(),_("<li>"),h("expectFirstItem"),h("lastWasTag")}function b(){w(),o.pop(),F(),_("</ol>")}function y(){w(),o.pop(),F(),_("</ul>")}function w(){R("lastWasTag")&&!R("slurpAllLineEndings")&&O(),_("</li>"),h("slurpAllLineEndings")}function A(){o.push(!1),O(),_("<blockquote>")}function E(){o.pop(),O(),_("</blockquote>"),h("slurpAllLineEndings")}function j(){o[o.length-1]||(O(),_("<p>")),h("slurpAllLineEndings")}function K(){o[o.length-1]?h("slurpAllLineEndings",!0):_("</p>")}function H(){O(),_("<pre><code"),h("fencesCount",0)}function $(){const se=C();_(' class="language-'+se+'"')}function p(){const se=R("fencesCount")||0;se||(_(">"),h("slurpOneLineEnding",!0)),h("fencesCount",se+1)}function I(){O(),_("<pre><code>")}function Z(){const se=R("fencesCount");se!==void 0&&se<2&&c.tightStack.length>0&&!R("lastWasTag")&&F(),R("flowCodeSeenData")&&O(),_("</code></pre>"),se!==void 0&&se<2&&O(),h("flowCodeSeenData"),h("fencesCount"),h("slurpOneLineEnding")}function D(){s.push({image:!0}),n=void 0}function ye(){s.push({})}function Oe(se){s[s.length-1].labelId=this.sliceSerialize(se)}function xe(){s[s.length-1].label=C()}function be(se){s[s.length-1].referenceId=this.sliceSerialize(se)}function qe(){M(),s[s.length-1].destination=""}function Fe(){M(),h("ignoreEncode",!0)}function we(){s[s.length-1].destination=C(),h("ignoreEncode")}function Ye(){s[s.length-1].title=C()}function lt(){let se=s.length-1;const ke=s[se],Se=ke.referenceId||ke.labelId,We=ke.destination===void 0?i[Or(Se)]:ke;for(n=!0;se--;)if(s[se].image){n=void 0;break}ke.image?(_('<img src="'+Co(We.destination,t.allowDangerousProtocol?void 0:XP)+'" alt="'),x(ke.label),_('"')):_('<a href="'+Co(We.destination,t.allowDangerousProtocol?void 0:Mb)+'"'),_(We.title?' title="'+We.title+'"':""),ke.image?_(" />"):(_(">"),x(ke.label),_("</a>")),s.pop()}function k(){M(),s.push({})}function L(se){C(),s[s.length-1].labelId=this.sliceSerialize(se)}function q(){M(),h("ignoreEncode",!0)}function W(){s[s.length-1].destination=C(),h("ignoreEncode")}function G(){s[s.length-1].title=C()}function ie(){const se=s[s.length-1],ke=Or(se.labelId);C(),Rb.call(i,ke)||(i[ke]=s[s.length-1]),s.pop()}function ce(){h("slurpAllLineEndings",!0)}function J(se){R("headingRank")||(h("headingRank",this.sliceSerialize(se).length),O(),_("<h"+R("headingRank")+">"))}function re(){M(),h("slurpAllLineEndings")}function Q(){h("slurpAllLineEndings",!0)}function Ee(){_("</h"+R("headingRank")+">"),h("headingRank")}function fe(se){h("headingRank",this.sliceSerialize(se).charCodeAt(0)===61?1:2)}function Te(){const se=C();O(),_("<h"+R("headingRank")+">"),x(se),_("</h"+R("headingRank")+">"),h("slurpAllLineEndings"),h("headingRank")}function Ce(se){x(N(this.sliceSerialize(se)))}function Le(se){if(!R("slurpAllLineEndings")){if(R("slurpOneLineEnding")){h("slurpOneLineEnding");return}if(R("inCodeText")){x(" ");return}x(N(this.sliceSerialize(se)))}}function ue(se){x(N(this.sliceSerialize(se))),h("flowCodeSeenData",!0)}function ve(){_("<br />")}function ee(){O(),B()}function Ne(){h("ignoreEncode")}function B(){t.allowDangerousHtml&&h("ignoreEncode",!0)}function U(){_("<em>")}function z(){_("<strong>")}function Y(){h("inCodeText",!0),_("<code>")}function X(){h("inCodeText"),_("</code>")}function V(){_("</em>")}function ne(){_("</strong>")}function oe(){O(),_("<hr />")}function te(se){h("characterReferenceType",se.type)}function pe(se){let ke=this.sliceSerialize(se);ke=R("characterReferenceType")?qP(ke,R("characterReferenceType")==="characterReferenceMarkerNumeric"?10:16):Z6(ke),x(N(ke)),h("characterReferenceType")}function le(se){const ke=this.sliceSerialize(se);_('<a href="'+Co(ke,t.allowDangerousProtocol?void 0:Mb)+'">'),x(N(ke)),_("</a>")}function ge(se){const ke=this.sliceSerialize(se);_('<a href="'+Co("mailto:"+ke)+'">'),x(N(ke)),_("</a>")}}function Tt(e,t,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(l){return bt(l)?(e.enter(n),a(l)):t(l)}function a(l){return bt(l)&&s++<r?(e.consume(l),a):(e.exit(n),t(l))}}const ZP={tokenize:JP};function JP(e){const t=e.attempt(this.parser.constructs.contentInitial,i,r);let n;return t;function i(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),Tt(e,t,"linePrefix")}function r(a){return e.enter("paragraph"),s(a)}function s(a){const l=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,o(a)}function o(a){if(a===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(a);return}return et(a)?(e.consume(a),e.exit("chunkText"),s):(e.consume(a),o)}}const eU={tokenize:tU},Ob={tokenize:nU};function tU(e){const t=this,n=[];let i=0,r,s,o;return a;function a(x){if(i<n.length){const F=n[i];return t.containerState=F[1],e.attempt(F[0].continuation,l,c)(x)}return c(x)}function l(x){if(i++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&_();const F=t.events.length;let O=F,N;for(;O--;)if(t.events[O][0]==="exit"&&t.events[O][1].type==="chunkFlow"){N=t.events[O][1].end;break}C(i);let v=F;for(;v<t.events.length;)t.events[v][1].end=Object.assign({},N),v++;return Ni(t.events,O+1,0,t.events.slice(F)),t.events.length=v,c(x)}return a(x)}function c(x){if(i===n.length){if(!r)return f(x);if(r.currentConstruct&&r.currentConstruct.concrete)return h(x);t.interrupt=Boolean(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Ob,d,u)(x)}function d(x){return r&&_(),C(i),f(x)}function u(x){return t.parser.lazy[t.now().line]=i!==n.length,o=t.now().offset,h(x)}function f(x){return t.containerState={},e.attempt(Ob,m,h)(x)}function m(x){return i++,n.push([t.currentConstruct,t.containerState]),f(x)}function h(x){if(x===null){r&&_(),C(0),e.consume(x);return}return r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:s,_tokenizer:r}),R(x)}function R(x){if(x===null){M(e.exit("chunkFlow"),!0),C(0),e.consume(x);return}return et(x)?(e.consume(x),M(e.exit("chunkFlow")),i=0,t.interrupt=void 0,a):(e.consume(x),R)}function M(x,F){const O=t.sliceStream(x);if(F&&O.push(null),x.previous=s,s&&(s.next=x),s=x,r.defineSkip(x.start),r.write(O),t.parser.lazy[x.start.line]){let N=r.events.length;for(;N--;)if(r.events[N][1].start.offset<o&&(!r.events[N][1].end||r.events[N][1].end.offset>o))return;const v=t.events.length;let T=v,S,g;for(;T--;)if(t.events[T][0]==="exit"&&t.events[T][1].type==="chunkFlow"){if(S){g=t.events[T][1].end;break}S=!0}for(C(i),N=v;N<t.events.length;)t.events[N][1].end=Object.assign({},g),N++;Ni(t.events,T+1,0,t.events.slice(v)),t.events.length=N}}function C(x){let F=n.length;for(;F-- >x;){const O=n[F];t.containerState=O[1],O[0].exit.call(t,e)}n.length=x}function _(){r.write([null]),s=void 0,r=void 0,t.containerState._closeFlow=void 0}}function nU(e,t,n){return Tt(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Sd(e){if(e===null||Gt(e)||tl(e))return 1;if(Z_(e))return 2}function Xf(e,t,n){const i=[];let r=-1;for(;++r<e.length;){const s=e[r].resolveAll;s&&!i.includes(s)&&(t=s(t,n),i.push(s))}return t}const W0={name:"attention",tokenize:rU,resolveAll:iU};function iU(e,t){let n=-1,i,r,s,o,a,l,c,d;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(i=n;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&t.sliceSerialize(e[i][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[i][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;l=e[i][1].end.offset-e[i][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const u=Object.assign({},e[i][1].end),f=Object.assign({},e[n][1].start);Nb(u,-l),Nb(f,l),o={type:l>1?"strongSequence":"emphasisSequence",start:u,end:Object.assign({},e[i][1].end)},a={type:l>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[n][1].start),end:f},s={type:l>1?"strongText":"emphasisText",start:Object.assign({},e[i][1].end),end:Object.assign({},e[n][1].start)},r={type:l>1?"strong":"emphasis",start:Object.assign({},o.start),end:Object.assign({},a.end)},e[i][1].end=Object.assign({},o.start),e[n][1].start=Object.assign({},a.end),c=[],e[i][1].end.offset-e[i][1].start.offset&&(c=Hn(c,[["enter",e[i][1],t],["exit",e[i][1],t]])),c=Hn(c,[["enter",r,t],["enter",o,t],["exit",o,t],["enter",s,t]]),c=Hn(c,Xf(t.parser.constructs.insideSpan.null,e.slice(i+1,n),t)),c=Hn(c,[["exit",s,t],["enter",a,t],["exit",a,t],["exit",r,t]]),e[n][1].end.offset-e[n][1].start.offset?(d=2,c=Hn(c,[["enter",e[n][1],t],["exit",e[n][1],t]])):d=0,Ni(e,i-1,n-i+3,c),n=i+c.length-d-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function rU(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=Sd(i);let s;return o;function o(l){return s=l,e.enter("attentionSequence"),a(l)}function a(l){if(l===s)return e.consume(l),a;const c=e.exit("attentionSequence"),d=Sd(l),u=!d||d===2&&r||n.includes(l),f=!r||r===2&&d||n.includes(i);return c._open=Boolean(s===42?u:u&&(r||!f)),c._close=Boolean(s===42?f:f&&(d||!u)),t(l)}}function Nb(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const sU={name:"autolink",tokenize:oU};function oU(e,t,n){let i=0;return r;function r(m){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(m){return ei(m)?(e.consume(m),o):c(m)}function o(m){return m===43||m===45||m===46||qn(m)?(i=1,a(m)):c(m)}function a(m){return m===58?(e.consume(m),i=0,l):(m===43||m===45||m===46||qn(m))&&i++<32?(e.consume(m),a):(i=0,c(m))}function l(m){return m===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):m===null||m===32||m===60||Ed(m)?n(m):(e.consume(m),l)}function c(m){return m===64?(e.consume(m),d):WP(m)?(e.consume(m),c):n(m)}function d(m){return qn(m)?u(m):n(m)}function u(m){return m===46?(e.consume(m),i=0,d):m===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):f(m)}function f(m){if((m===45||qn(m))&&i++<63){const h=m===45?f:u;return e.consume(m),h}return n(m)}}const Su={tokenize:aU,partial:!0};function aU(e,t,n){return i;function i(s){return bt(s)?Tt(e,r,"linePrefix")(s):r(s)}function r(s){return s===null||et(s)?t(s):n(s)}}const n8={name:"blockQuote",tokenize:lU,continuation:{tokenize:cU},exit:uU};function lU(e,t,n){const i=this;return r;function r(o){if(o===62){const a=i.containerState;return a.open||(e.enter("blockQuote",{_container:!0}),a.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),s}return n(o)}function s(o){return bt(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function cU(e,t,n){const i=this;return r;function r(o){return bt(o)?Tt(e,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return e.attempt(n8,t,n)(o)}}function uU(e){e.exit("blockQuote")}const i8={name:"characterEscape",tokenize:hU};function hU(e,t,n){return i;function i(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),r}function r(s){return GP(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(s)}}const r8={name:"characterReference",tokenize:dU};function dU(e,t,n){const i=this;let r=0,s,o;return a;function a(u){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),l}function l(u){return u===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(u),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),s=31,o=qn,d(u))}function c(u){return u===88||u===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(u),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,o=KP,d):(e.enter("characterReferenceValue"),s=7,o=$0,d(u))}function d(u){if(u===59&&r){const f=e.exit("characterReferenceValue");return o===qn&&!Z6(i.sliceSerialize(f))?n(u):(e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(u)&&r++<s?(e.consume(u),d):n(u)}}const Fb={tokenize:mU,partial:!0},Lb={name:"codeFenced",tokenize:fU,concrete:!0};function fU(e,t,n){const i=this,r={tokenize:O,partial:!0};let s=0,o=0,a;return l;function l(N){return c(N)}function c(N){const v=i.events[i.events.length-1];return s=v&&v[1].type==="linePrefix"?v[2].sliceSerialize(v[1],!0).length:0,a=N,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(N)}function d(N){return N===a?(o++,e.consume(N),d):o<3?n(N):(e.exit("codeFencedFenceSequence"),bt(N)?Tt(e,u,"whitespace")(N):u(N))}function u(N){return N===null||et(N)?(e.exit("codeFencedFence"),i.interrupt?t(N):e.check(Fb,R,F)(N)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(N))}function f(N){return N===null||et(N)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(N)):bt(N)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Tt(e,m,"whitespace")(N)):N===96&&N===a?n(N):(e.consume(N),f)}function m(N){return N===null||et(N)?u(N):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(N))}function h(N){return N===null||et(N)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(N)):N===96&&N===a?n(N):(e.consume(N),h)}function R(N){return e.attempt(r,F,M)(N)}function M(N){return e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),C}function C(N){return s>0&&bt(N)?Tt(e,_,"linePrefix",s+1)(N):_(N)}function _(N){return N===null||et(N)?e.check(Fb,R,F)(N):(e.enter("codeFlowValue"),x(N))}function x(N){return N===null||et(N)?(e.exit("codeFlowValue"),_(N)):(e.consume(N),x)}function F(N){return e.exit("codeFenced"),t(N)}function O(N,v,T){let S=0;return g;function g(E){return N.enter("lineEnding"),N.consume(E),N.exit("lineEnding"),b}function b(E){return N.enter("codeFencedFence"),bt(E)?Tt(N,y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):y(E)}function y(E){return E===a?(N.enter("codeFencedFenceSequence"),w(E)):T(E)}function w(E){return E===a?(S++,N.consume(E),w):S>=o?(N.exit("codeFencedFenceSequence"),bt(E)?Tt(N,A,"whitespace")(E):A(E)):T(E)}function A(E){return E===null||et(E)?(N.exit("codeFencedFence"),v(E)):T(E)}}}function mU(e,t,n){const i=this;return r;function r(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s)}function s(o){return i.parser.lazy[i.now().line]?n(o):t(o)}}const Xm={name:"codeIndented",tokenize:gU},pU={tokenize:_U,partial:!0};function gU(e,t,n){const i=this;return r;function r(c){return e.enter("codeIndented"),Tt(e,s,"linePrefix",4+1)(c)}function s(c){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(c):n(c)}function o(c){return c===null?l(c):et(c)?e.attempt(pU,o,l)(c):(e.enter("codeFlowValue"),a(c))}function a(c){return c===null||et(c)?(e.exit("codeFlowValue"),o(c)):(e.consume(c),a)}function l(c){return e.exit("codeIndented"),t(c)}}function _U(e,t,n){const i=this;return r;function r(o){return i.parser.lazy[i.now().line]?n(o):et(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),r):Tt(e,s,"linePrefix",4+1)(o)}function s(o){const a=i.events[i.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?t(o):et(o)?r(o):n(o)}}const vU={name:"codeText",tokenize:wU,resolve:yU,previous:bU};function yU(e){let t=e.length-4,n=3,i,r;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(i=n;++i<t;)if(e[i][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(i=n-1,t++;++i<=t;)r===void 0?i!==t&&e[i][1].type!=="lineEnding"&&(r=i):(i===t||e[i][1].type==="lineEnding")&&(e[r][1].type="codeTextData",i!==r+2&&(e[r][1].end=e[i-1][1].end,e.splice(r+2,i-r-2),t-=i-r-2,i=r+2),r=void 0);return e}function bU(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function wU(e,t,n){let i=0,r,s;return o;function o(u){return e.enter("codeText"),e.enter("codeTextSequence"),a(u)}function a(u){return u===96?(e.consume(u),i++,a):(e.exit("codeTextSequence"),l(u))}function l(u){return u===null?n(u):u===32?(e.enter("space"),e.consume(u),e.exit("space"),l):u===96?(s=e.enter("codeTextSequence"),r=0,d(u)):et(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(u))}function c(u){return u===null||u===32||u===96||et(u)?(e.exit("codeTextData"),l(u)):(e.consume(u),c)}function d(u){return u===96?(e.consume(u),r++,d):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(u)):(s.type="codeTextData",c(u))}}function s8(e){const t={};let n=-1,i,r,s,o,a,l,c;for(;++n<e.length;){for(;n in t;)n=t[n];if(i=e[n],n&&i[1].type==="chunkFlow"&&e[n-1][1].type==="listItemPrefix"&&(l=i[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(t,EU(e,n)),n=t[n],c=!0);else if(i[1]._container){for(s=n,r=void 0;s--&&(o=e[s],o[1].type==="lineEnding"||o[1].type==="lineEndingBlank");)o[0]==="enter"&&(r&&(e[r][1].type="lineEndingBlank"),o[1].type="lineEnding",r=s);r&&(i[1].end=Object.assign({},e[r][1].start),a=e.slice(r,n),a.unshift(i),Ni(e,r,n-r+1,a))}}return!c}function EU(e,t){const n=e[t][1],i=e[t][2];let r=t-1;const s=[],o=n._tokenizer||i.parser[n.contentType](n.start),a=o.events,l=[],c={};let d,u,f=-1,m=n,h=0,R=0;const M=[R];for(;m;){for(;e[++r][1]!==m;);s.push(r),m._tokenizer||(d=i.sliceStream(m),m.next||d.push(null),u&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),u=m,m=m.next}for(m=n;++f<a.length;)a[f][0]==="exit"&&a[f-1][0]==="enter"&&a[f][1].type===a[f-1][1].type&&a[f][1].start.line!==a[f][1].end.line&&(R=f+1,M.push(R),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):M.pop(),f=M.length;f--;){const C=a.slice(M[f],M[f+1]),_=s.pop();l.unshift([_,_+C.length-1]),Ni(e,_,2,C)}for(f=-1;++f<l.length;)c[h+l[f][0]]=h+l[f][1],h+=l[f][1]-l[f][0]-1;return c}const SU={tokenize:AU,resolve:kU},TU={tokenize:xU,partial:!0};function kU(e){return s8(e),e}function AU(e,t){let n;return i;function i(a){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(a)}function r(a){return a===null?s(a):et(a)?e.check(TU,o,s)(a):(e.consume(a),r)}function s(a){return e.exit("chunkContent"),e.exit("content"),t(a)}function o(a){return e.consume(a),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}function xU(e,t,n){const i=this;return r;function r(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Tt(e,s,"linePrefix")}function s(o){if(o===null||et(o))return n(o);const a=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?t(o):e.interrupt(i.parser.constructs.flow,n,t)(o)}}function o8(e,t,n,i,r,s,o,a,l){const c=l||Number.POSITIVE_INFINITY;let d=0;return u;function u(C){return C===60?(e.enter(i),e.enter(r),e.enter(s),e.consume(C),e.exit(s),f):C===null||C===32||C===41||Ed(C)?n(C):(e.enter(i),e.enter(o),e.enter(a),e.enter("chunkString",{contentType:"string"}),R(C))}function f(C){return C===62?(e.enter(s),e.consume(C),e.exit(s),e.exit(r),e.exit(i),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),m(C))}function m(C){return C===62?(e.exit("chunkString"),e.exit(a),f(C)):C===null||C===60||et(C)?n(C):(e.consume(C),C===92?h:m)}function h(C){return C===60||C===62||C===92?(e.consume(C),m):m(C)}function R(C){return!d&&(C===null||C===41||Gt(C))?(e.exit("chunkString"),e.exit(a),e.exit(o),e.exit(i),t(C)):d<c&&C===40?(e.consume(C),d++,R):C===41?(e.consume(C),d--,R):C===null||C===32||C===40||Ed(C)?n(C):(e.consume(C),C===92?M:R)}function M(C){return C===40||C===41||C===92?(e.consume(C),R):R(C)}}function a8(e,t,n,i,r,s){const o=this;let a=0,l;return c;function c(m){return e.enter(i),e.enter(r),e.consume(m),e.exit(r),e.enter(s),d}function d(m){return a>999||m===null||m===91||m===93&&!l||m===94&&!a&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(e.exit(s),e.enter(r),e.consume(m),e.exit(r),e.exit(i),t):et(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),u(m))}function u(m){return m===null||m===91||m===93||et(m)||a++>999?(e.exit("chunkString"),d(m)):(e.consume(m),l||(l=!bt(m)),m===92?f:u)}function f(m){return m===91||m===92||m===93?(e.consume(m),a++,u):u(m)}}function l8(e,t,n,i,r,s){let o;return a;function a(f){return f===34||f===39||f===40?(e.enter(i),e.enter(r),e.consume(f),e.exit(r),o=f===40?41:f,l):n(f)}function l(f){return f===o?(e.enter(r),e.consume(f),e.exit(r),e.exit(i),t):(e.enter(s),c(f))}function c(f){return f===o?(e.exit(s),l(o)):f===null?n(f):et(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Tt(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||et(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?u:d)}function u(f){return f===o||f===92?(e.consume(f),d):d(f)}}function hc(e,t){let n;return i;function i(r){return et(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),n=!0,i):bt(r)?Tt(e,i,n?"linePrefix":"lineSuffix")(r):t(r)}}const CU={name:"definition",tokenize:RU},IU={tokenize:MU,partial:!0};function RU(e,t,n){const i=this;let r;return s;function s(m){return e.enter("definition"),o(m)}function o(m){return a8.call(i,e,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function a(m){return r=Or(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),l):n(m)}function l(m){return Gt(m)?hc(e,c)(m):c(m)}function c(m){return o8(e,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return e.attempt(IU,u,u)(m)}function u(m){return bt(m)?Tt(e,f,"whitespace")(m):f(m)}function f(m){return m===null||et(m)?(e.exit("definition"),i.parser.defined.push(r),t(m)):n(m)}}function MU(e,t,n){return i;function i(a){return Gt(a)?hc(e,r)(a):n(a)}function r(a){return l8(e,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function s(a){return bt(a)?Tt(e,o,"whitespace")(a):o(a)}function o(a){return a===null||et(a)?t(a):n(a)}}const OU={name:"hardBreakEscape",tokenize:NU};function NU(e,t,n){return i;function i(s){return e.enter("hardBreakEscape"),e.consume(s),r}function r(s){return et(s)?(e.exit("hardBreakEscape"),t(s)):n(s)}}const FU={name:"headingAtx",tokenize:DU,resolve:LU};function LU(e,t){let n=e.length-2,i=3,r,s;return e[i][1].type==="whitespace"&&(i+=2),n-2>i&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&e[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(r={type:"atxHeadingText",start:e[i][1].start,end:e[n][1].end},s={type:"chunkText",start:e[i][1].start,end:e[n][1].end,contentType:"text"},Ni(e,i,n-i+1,[["enter",r,t],["enter",s,t],["exit",s,t],["exit",r,t]])),e}function DU(e,t,n){let i=0;return r;function r(d){return e.enter("atxHeading"),s(d)}function s(d){return e.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&i++<6?(e.consume(d),o):d===null||Gt(d)?(e.exit("atxHeadingSequence"),a(d)):n(d)}function a(d){return d===35?(e.enter("atxHeadingSequence"),l(d)):d===null||et(d)?(e.exit("atxHeading"),t(d)):bt(d)?Tt(e,a,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function l(d){return d===35?(e.consume(d),l):(e.exit("atxHeadingSequence"),a(d))}function c(d){return d===null||d===35||Gt(d)?(e.exit("atxHeadingText"),a(d)):(e.consume(d),c)}}const BU=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Db=["pre","script","style","textarea"],PU={name:"htmlFlow",tokenize:VU,resolveTo:HU,concrete:!0},UU={tokenize:zU,partial:!0},jU={tokenize:qU,partial:!0};function HU(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function VU(e,t,n){const i=this;let r,s,o,a,l;return c;function c(D){return d(D)}function d(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),u}function u(D){return D===33?(e.consume(D),f):D===47?(e.consume(D),s=!0,R):D===63?(e.consume(D),r=3,i.interrupt?t:p):ei(D)?(e.consume(D),o=String.fromCharCode(D),M):n(D)}function f(D){return D===45?(e.consume(D),r=2,m):D===91?(e.consume(D),r=5,a=0,h):ei(D)?(e.consume(D),r=4,i.interrupt?t:p):n(D)}function m(D){return D===45?(e.consume(D),i.interrupt?t:p):n(D)}function h(D){const ye="CDATA[";return D===ye.charCodeAt(a++)?(e.consume(D),a===ye.length?i.interrupt?t:y:h):n(D)}function R(D){return ei(D)?(e.consume(D),o=String.fromCharCode(D),M):n(D)}function M(D){if(D===null||D===47||D===62||Gt(D)){const ye=D===47,Oe=o.toLowerCase();return!ye&&!s&&Db.includes(Oe)?(r=1,i.interrupt?t(D):y(D)):BU.includes(o.toLowerCase())?(r=6,ye?(e.consume(D),C):i.interrupt?t(D):y(D)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(D):s?_(D):x(D))}return D===45||qn(D)?(e.consume(D),o+=String.fromCharCode(D),M):n(D)}function C(D){return D===62?(e.consume(D),i.interrupt?t:y):n(D)}function _(D){return bt(D)?(e.consume(D),_):g(D)}function x(D){return D===47?(e.consume(D),g):D===58||D===95||ei(D)?(e.consume(D),F):bt(D)?(e.consume(D),x):g(D)}function F(D){return D===45||D===46||D===58||D===95||qn(D)?(e.consume(D),F):O(D)}function O(D){return D===61?(e.consume(D),N):bt(D)?(e.consume(D),O):x(D)}function N(D){return D===null||D===60||D===61||D===62||D===96?n(D):D===34||D===39?(e.consume(D),l=D,v):bt(D)?(e.consume(D),N):T(D)}function v(D){return D===l?(e.consume(D),l=null,S):D===null||et(D)?n(D):(e.consume(D),v)}function T(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||Gt(D)?O(D):(e.consume(D),T)}function S(D){return D===47||D===62||bt(D)?x(D):n(D)}function g(D){return D===62?(e.consume(D),b):n(D)}function b(D){return D===null||et(D)?y(D):bt(D)?(e.consume(D),b):n(D)}function y(D){return D===45&&r===2?(e.consume(D),j):D===60&&r===1?(e.consume(D),K):D===62&&r===4?(e.consume(D),I):D===63&&r===3?(e.consume(D),p):D===93&&r===5?(e.consume(D),$):et(D)&&(r===6||r===7)?(e.exit("htmlFlowData"),e.check(UU,Z,w)(D)):D===null||et(D)?(e.exit("htmlFlowData"),w(D)):(e.consume(D),y)}function w(D){return e.check(jU,A,Z)(D)}function A(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),E}function E(D){return D===null||et(D)?w(D):(e.enter("htmlFlowData"),y(D))}function j(D){return D===45?(e.consume(D),p):y(D)}function K(D){return D===47?(e.consume(D),o="",H):y(D)}function H(D){if(D===62){const ye=o.toLowerCase();return Db.includes(ye)?(e.consume(D),I):y(D)}return ei(D)&&o.length<8?(e.consume(D),o+=String.fromCharCode(D),H):y(D)}function $(D){return D===93?(e.consume(D),p):y(D)}function p(D){return D===62?(e.consume(D),I):D===45&&r===2?(e.consume(D),p):y(D)}function I(D){return D===null||et(D)?(e.exit("htmlFlowData"),Z(D)):(e.consume(D),I)}function Z(D){return e.exit("htmlFlow"),t(D)}}function qU(e,t,n){const i=this;return r;function r(o){return et(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s):n(o)}function s(o){return i.parser.lazy[i.now().line]?n(o):t(o)}}function zU(e,t,n){return i;function i(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(Su,t,n)}}const $U={name:"htmlText",tokenize:WU};function WU(e,t,n){const i=this;let r,s,o;return a;function a(p){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(p),l}function l(p){return p===33?(e.consume(p),c):p===47?(e.consume(p),O):p===63?(e.consume(p),x):ei(p)?(e.consume(p),T):n(p)}function c(p){return p===45?(e.consume(p),d):p===91?(e.consume(p),s=0,h):ei(p)?(e.consume(p),_):n(p)}function d(p){return p===45?(e.consume(p),m):n(p)}function u(p){return p===null?n(p):p===45?(e.consume(p),f):et(p)?(o=u,K(p)):(e.consume(p),u)}function f(p){return p===45?(e.consume(p),m):u(p)}function m(p){return p===62?j(p):p===45?f(p):u(p)}function h(p){const I="CDATA[";return p===I.charCodeAt(s++)?(e.consume(p),s===I.length?R:h):n(p)}function R(p){return p===null?n(p):p===93?(e.consume(p),M):et(p)?(o=R,K(p)):(e.consume(p),R)}function M(p){return p===93?(e.consume(p),C):R(p)}function C(p){return p===62?j(p):p===93?(e.consume(p),C):R(p)}function _(p){return p===null||p===62?j(p):et(p)?(o=_,K(p)):(e.consume(p),_)}function x(p){return p===null?n(p):p===63?(e.consume(p),F):et(p)?(o=x,K(p)):(e.consume(p),x)}function F(p){return p===62?j(p):x(p)}function O(p){return ei(p)?(e.consume(p),N):n(p)}function N(p){return p===45||qn(p)?(e.consume(p),N):v(p)}function v(p){return et(p)?(o=v,K(p)):bt(p)?(e.consume(p),v):j(p)}function T(p){return p===45||qn(p)?(e.consume(p),T):p===47||p===62||Gt(p)?S(p):n(p)}function S(p){return p===47?(e.consume(p),j):p===58||p===95||ei(p)?(e.consume(p),g):et(p)?(o=S,K(p)):bt(p)?(e.consume(p),S):j(p)}function g(p){return p===45||p===46||p===58||p===95||qn(p)?(e.consume(p),g):b(p)}function b(p){return p===61?(e.consume(p),y):et(p)?(o=b,K(p)):bt(p)?(e.consume(p),b):S(p)}function y(p){return p===null||p===60||p===61||p===62||p===96?n(p):p===34||p===39?(e.consume(p),r=p,w):et(p)?(o=y,K(p)):bt(p)?(e.consume(p),y):(e.consume(p),A)}function w(p){return p===r?(e.consume(p),r=void 0,E):p===null?n(p):et(p)?(o=w,K(p)):(e.consume(p),w)}function A(p){return p===null||p===34||p===39||p===60||p===61||p===96?n(p):p===47||p===62||Gt(p)?S(p):(e.consume(p),A)}function E(p){return p===47||p===62||Gt(p)?S(p):n(p)}function j(p){return p===62?(e.consume(p),e.exit("htmlTextData"),e.exit("htmlText"),t):n(p)}function K(p){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),H}function H(p){return bt(p)?Tt(e,$,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(p):$(p)}function $(p){return e.enter("htmlTextData"),o(p)}}const J_={name:"labelEnd",tokenize:ZU,resolveTo:QU,resolveAll:XU},KU={tokenize:JU},GU={tokenize:ej},YU={tokenize:tj};function XU(e){let t=-1;for(;++t<e.length;){const n=e[t][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(e.splice(t+1,n.type==="labelImage"?4:2),n.type="data",t++)}return e}function QU(e,t){let n=e.length,i=0,r,s,o,a;for(;n--;)if(r=e[n][1],s){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;e[n][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(s=n,r.type!=="labelLink")){i=2;break}}else r.type==="labelEnd"&&(o=n);const l={type:e[s][1].type==="labelLink"?"link":"image",start:Object.assign({},e[s][1].start),end:Object.assign({},e[e.length-1][1].end)},c={type:"label",start:Object.assign({},e[s][1].start),end:Object.assign({},e[o][1].end)},d={type:"labelText",start:Object.assign({},e[s+i+2][1].end),end:Object.assign({},e[o-2][1].start)};return a=[["enter",l,t],["enter",c,t]],a=Hn(a,e.slice(s+1,s+i+3)),a=Hn(a,[["enter",d,t]]),a=Hn(a,Xf(t.parser.constructs.insideSpan.null,e.slice(s+i+4,o-3),t)),a=Hn(a,[["exit",d,t],e[o-2],e[o-1],["exit",c,t]]),a=Hn(a,e.slice(o+1)),a=Hn(a,[["exit",l,t]]),Ni(e,s,e.length,a),e}function ZU(e,t,n){const i=this;let r=i.events.length,s,o;for(;r--;)if((i.events[r][1].type==="labelImage"||i.events[r][1].type==="labelLink")&&!i.events[r][1]._balanced){s=i.events[r][1];break}return a;function a(f){return s?s._inactive?u(f):(o=i.parser.defined.includes(Or(i.sliceSerialize({start:s.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),l):n(f)}function l(f){return f===40?e.attempt(KU,d,o?d:u)(f):f===91?e.attempt(GU,d,o?c:u)(f):o?d(f):u(f)}function c(f){return e.attempt(YU,d,u)(f)}function d(f){return t(f)}function u(f){return s._balanced=!0,n(f)}}function JU(e,t,n){return i;function i(u){return e.enter("resource"),e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),r}function r(u){return Gt(u)?hc(e,s)(u):s(u)}function s(u){return u===41?d(u):o8(e,o,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(u)}function o(u){return Gt(u)?hc(e,l)(u):d(u)}function a(u){return n(u)}function l(u){return u===34||u===39||u===40?l8(e,c,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(u):d(u)}function c(u){return Gt(u)?hc(e,d)(u):d(u)}function d(u){return u===41?(e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),e.exit("resource"),t):n(u)}}function ej(e,t,n){const i=this;return r;function r(a){return a8.call(i,e,s,o,"reference","referenceMarker","referenceString")(a)}function s(a){return i.parser.defined.includes(Or(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(a):n(a)}function o(a){return n(a)}}function tj(e,t,n){return i;function i(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),r}function r(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):n(s)}}const nj={name:"labelStartImage",tokenize:ij,resolveAll:J_.resolveAll};function ij(e,t,n){const i=this;return r;function r(a){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(a),e.exit("labelImageMarker"),s}function s(a){return a===91?(e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelImage"),o):n(a)}function o(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(a):t(a)}}const rj={name:"labelStartLink",tokenize:sj,resolveAll:J_.resolveAll};function sj(e,t,n){const i=this;return r;function r(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(o):t(o)}}const Qm={name:"lineEnding",tokenize:oj};function oj(e,t){return n;function n(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),Tt(e,t,"linePrefix")}}const Th={name:"thematicBreak",tokenize:aj};function aj(e,t,n){let i=0,r;return s;function s(c){return e.enter("thematicBreak"),o(c)}function o(c){return r=c,a(c)}function a(c){return c===r?(e.enter("thematicBreakSequence"),l(c)):i>=3&&(c===null||et(c))?(e.exit("thematicBreak"),t(c)):n(c)}function l(c){return c===r?(e.consume(c),i++,l):(e.exit("thematicBreakSequence"),bt(c)?Tt(e,a,"whitespace")(c):a(c))}}const di={name:"list",tokenize:uj,continuation:{tokenize:hj},exit:fj},lj={tokenize:mj,partial:!0},cj={tokenize:dj,partial:!0};function uj(e,t,n){const i=this,r=i.events[i.events.length-1];let s=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,o=0;return a;function a(m){const h=i.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(h==="listUnordered"?!i.containerState.marker||m===i.containerState.marker:$0(m)){if(i.containerState.type||(i.containerState.type=h,e.enter(h,{_container:!0})),h==="listUnordered")return e.enter("listItemPrefix"),m===42||m===45?e.check(Th,n,c)(m):c(m);if(!i.interrupt||m===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(m)}return n(m)}function l(m){return $0(m)&&++o<10?(e.consume(m),l):(!i.interrupt||o<2)&&(i.containerState.marker?m===i.containerState.marker:m===41||m===46)?(e.exit("listItemValue"),c(m)):n(m)}function c(m){return e.enter("listItemMarker"),e.consume(m),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||m,e.check(Su,i.interrupt?n:d,e.attempt(lj,f,u))}function d(m){return i.containerState.initialBlankLine=!0,s++,f(m)}function u(m){return bt(m)?(e.enter("listItemPrefixWhitespace"),e.consume(m),e.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return i.containerState.size=s+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(m)}}function hj(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check(Su,r,s);function r(a){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,Tt(e,t,"listItemIndent",i.containerState.size+1)(a)}function s(a){return i.containerState.furtherBlankLines||!bt(a)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,o(a)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(cj,t,o)(a))}function o(a){return i.containerState._closeFlow=!0,i.interrupt=void 0,Tt(e,e.attempt(di,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function dj(e,t,n){const i=this;return Tt(e,r,"listItemIndent",i.containerState.size+1);function r(s){const o=i.events[i.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===i.containerState.size?t(s):n(s)}}function fj(e){e.exit(this.containerState.type)}function mj(e,t,n){const i=this;return Tt(e,r,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function r(s){const o=i.events[i.events.length-1];return!bt(s)&&o&&o[1].type==="listItemPrefixWhitespace"?t(s):n(s)}}const Bb={name:"setextUnderline",tokenize:gj,resolveTo:pj};function pj(e,t){let n=e.length,i,r,s;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){i=n;break}e[n][1].type==="paragraph"&&(r=n)}else e[n][1].type==="content"&&e.splice(n,1),!s&&e[n][1].type==="definition"&&(s=n);const o={type:"setextHeading",start:Object.assign({},e[r][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[r][1].type="setextHeadingText",s?(e.splice(r,0,["enter",o,t]),e.splice(s+1,0,["exit",e[i][1],t]),e[i][1].end=Object.assign({},e[s][1].end)):e[i][1]=o,e.push(["exit",o,t]),e}function gj(e,t,n){const i=this;let r;return s;function s(c){let d=i.events.length,u;for(;d--;)if(i.events[d][1].type!=="lineEnding"&&i.events[d][1].type!=="linePrefix"&&i.events[d][1].type!=="content"){u=i.events[d][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||u)?(e.enter("setextHeadingLine"),r=c,o(c)):n(c)}function o(c){return e.enter("setextHeadingLineSequence"),a(c)}function a(c){return c===r?(e.consume(c),a):(e.exit("setextHeadingLineSequence"),bt(c)?Tt(e,l,"lineSuffix")(c):l(c))}function l(c){return c===null||et(c)?(e.exit("setextHeadingLine"),t(c)):n(c)}}const _j={tokenize:vj};function vj(e){const t=this,n=e.attempt(Su,i,e.attempt(this.parser.constructs.flowInitial,r,Tt(e,e.attempt(this.parser.constructs.flow,r,e.attempt(SU,r)),"linePrefix")));return n;function i(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function r(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const yj={resolveAll:u8()},bj=c8("string"),wj=c8("text");function c8(e){return{tokenize:t,resolveAll:u8(e==="text"?Ej:void 0)};function t(n){const i=this,r=this.parser.constructs[e],s=n.attempt(r,o,a);return o;function o(d){return c(d)?s(d):a(d)}function a(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),l}function l(d){return c(d)?(n.exit("data"),s(d)):(n.consume(d),l)}function c(d){if(d===null)return!0;const u=r[d];let f=-1;if(u)for(;++f<u.length;){const m=u[f];if(!m.previous||m.previous.call(i,i.previous))return!0}return!1}}}function u8(e){return t;function t(n,i){let r=-1,s;for(;++r<=n.length;)s===void 0?n[r]&&n[r][1].type==="data"&&(s=r,r++):(!n[r]||n[r][1].type!=="data")&&(r!==s+2&&(n[s][1].end=n[r-1][1].end,n.splice(s+2,r-s-2),r=s+2),s=void 0);return e?e(n,i):n}}function Ej(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const i=e[n-1][1],r=t.sliceStream(i);let s=r.length,o=-1,a=0,l;for(;s--;){const c=r[s];if(typeof c=="string"){for(o=c.length;c.charCodeAt(o-1)===32;)a++,o--;if(o)break;o=-1}else if(c===-2)l=!0,a++;else if(c!==-1){s++;break}}if(a){const c={type:n===e.length||l||a<2?"lineSuffix":"hardBreakTrailing",start:{line:i.end.line,column:i.end.column-a,offset:i.end.offset-a,_index:i.start._index+s,_bufferIndex:s?o:i.start._bufferIndex+o},end:Object.assign({},i.end)};i.end=Object.assign({},c.start),i.start.offset===i.end.offset?Object.assign(i,c):(e.splice(n,0,["enter",c,t],["exit",c,t]),n+=2)}n++}return e}function Sj(e,t,n){let i=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const r={},s=[];let o=[],a=[];const l={consume:_,enter:x,exit:F,attempt:v(O),check:v(N),interrupt:v(N,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:m,sliceSerialize:f,now:h,defineSkip:R,write:u};let d=t.tokenize.call(c,l);return t.resolveAll&&s.push(t),c;function u(b){return o=Hn(o,b),M(),o[o.length-1]!==null?[]:(T(t,0),c.events=Xf(s,c.events,c),c.events)}function f(b,y){return kj(m(b),y)}function m(b){return Tj(o,b)}function h(){const{line:b,column:y,offset:w,_index:A,_bufferIndex:E}=i;return{line:b,column:y,offset:w,_index:A,_bufferIndex:E}}function R(b){r[b.line]=b.column,g()}function M(){let b;for(;i._index<o.length;){const y=o[i._index];if(typeof y=="string")for(b=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===b&&i._bufferIndex<y.length;)C(y.charCodeAt(i._bufferIndex));else C(y)}}function C(b){d=d(b)}function _(b){et(b)?(i.line++,i.column=1,i.offset+=b===-3?2:1,g()):b!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===o[i._index].length&&(i._bufferIndex=-1,i._index++)),c.previous=b}function x(b,y){const w=y||{};return w.type=b,w.start=h(),c.events.push(["enter",w,c]),a.push(w),w}function F(b){const y=a.pop();return y.end=h(),c.events.push(["exit",y,c]),y}function O(b,y){T(b,y.from)}function N(b,y){y.restore()}function v(b,y){return w;function w(A,E,j){let K,H,$,p;return Array.isArray(A)?Z(A):"tokenize"in A?Z([A]):I(A);function I(xe){return be;function be(qe){const Fe=qe!==null&&xe[qe],we=qe!==null&&xe.null,Ye=[...Array.isArray(Fe)?Fe:Fe?[Fe]:[],...Array.isArray(we)?we:we?[we]:[]];return Z(Ye)(qe)}}function Z(xe){return K=xe,H=0,xe.length===0?j:D(xe[H])}function D(xe){return be;function be(qe){return p=S(),$=xe,xe.partial||(c.currentConstruct=xe),xe.name&&c.parser.constructs.disable.null.includes(xe.name)?Oe():xe.tokenize.call(y?Object.assign(Object.create(c),y):c,l,ye,Oe)(qe)}}function ye(xe){return b($,p),E}function Oe(xe){return p.restore(),++H<K.length?D(K[H]):j}}}function T(b,y){b.resolveAll&&!s.includes(b)&&s.push(b),b.resolve&&Ni(c.events,y,c.events.length-y,b.resolve(c.events.slice(y),c)),b.resolveTo&&(c.events=b.resolveTo(c.events,c))}function S(){const b=h(),y=c.previous,w=c.currentConstruct,A=c.events.length,E=Array.from(a);return{restore:j,from:A};function j(){i=b,c.previous=y,c.currentConstruct=w,c.events.length=A,a=E,g()}}function g(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function Tj(e,t){const n=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;let o;if(n===r)o=[e[n].slice(i,s)];else{if(o=e.slice(n,r),i>-1){const a=o[0];typeof a=="string"?o[0]=a.slice(i):o.shift()}s>0&&o.push(e[r].slice(0,s))}return o}function kj(e,t){let n=-1;const i=[];let r;for(;++n<e.length;){const s=e[n];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&r)continue;o=" ";break}default:o=String.fromCharCode(s)}r=s===-2,i.push(o)}return i.join("")}const Aj={[42]:di,[43]:di,[45]:di,[48]:di,[49]:di,[50]:di,[51]:di,[52]:di,[53]:di,[54]:di,[55]:di,[56]:di,[57]:di,[62]:n8},xj={[91]:CU},Cj={[-2]:Xm,[-1]:Xm,[32]:Xm},Ij={[35]:FU,[42]:Th,[45]:[Bb,Th],[60]:PU,[61]:Bb,[95]:Th,[96]:Lb,[126]:Lb},Rj={[38]:r8,[92]:i8},Mj={[-5]:Qm,[-4]:Qm,[-3]:Qm,[33]:nj,[38]:r8,[42]:W0,[60]:[sU,$U],[91]:rj,[92]:[OU,i8],[93]:J_,[95]:W0,[96]:vU},Oj={null:[W0,yj]},Nj={null:[42,95]},Fj={null:[]};var Lj=Object.freeze(Object.defineProperty({__proto__:null,document:Aj,contentInitial:xj,flowInitial:Cj,flow:Ij,string:Rj,text:Mj,insideSpan:Oj,attentionMarkers:Nj,disable:Fj},Symbol.toStringTag,{value:"Module"}));function Dj(e){const n=J6([Lj,...(e||{}).extensions||[]]),i={defined:[],lazy:{},constructs:n,content:r(ZP),document:r(eU),flow:r(_j),string:r(bj),text:r(wj)};return i;function r(s){return o;function o(a){return Sj(i,s,a)}}}function Bj(e){for(;!s8(e););return e}const Pb=/[\0\t\n\r]/g;function Pj(){let e=1,t="",n=!0,i;return r;function r(s,o,a){const l=[];let c,d,u,f,m;for(s=t+s.toString(o),u=0,t="",n&&(s.charCodeAt(0)===65279&&u++,n=void 0);u<s.length;){if(Pb.lastIndex=u,c=Pb.exec(s),f=c&&c.index!==void 0?c.index:s.length,m=s.charCodeAt(f),!c){t=s.slice(u);break}if(m===10&&u===f&&i)l.push(-3),i=void 0;else switch(i&&(l.push(-5),i=void 0),u<f&&(l.push(s.slice(u,f)),e+=f-u),m){case 0:{l.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,l.push(-2);e++<d;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:i=!0,e=1}u=f+1}return a&&(i&&l.push(-5),t&&l.push(t),l.push(null)),l}}function Uj(e,t,n){return typeof t!="string"&&(n=t,t=void 0),QP(n)(Bj(Dj(n).document().write(Pj()(e,t,!0))))}const jj={tokenize:Wj,partial:!0},h8={tokenize:Kj,partial:!0},d8={tokenize:Gj,partial:!0},f8={tokenize:Yj,partial:!0},Hj={tokenize:Xj,partial:!0},m8={tokenize:zj,previous:g8},p8={tokenize:$j,previous:_8},as={tokenize:qj,previous:v8},Lr={},Vj={text:Lr};let Js=48;for(;Js<123;)Lr[Js]=as,Js++,Js===58?Js=65:Js===91&&(Js=97);Lr[43]=as;Lr[45]=as;Lr[46]=as;Lr[95]=as;Lr[72]=[as,p8];Lr[104]=[as,p8];Lr[87]=[as,m8];Lr[119]=[as,m8];function qj(e,t,n){const i=this;let r,s;return o;function o(u){return!K0(u)||!v8.call(i,i.previous)||ev(i.events)?n(u):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),a(u))}function a(u){return K0(u)?(e.consume(u),a):u===64?(e.consume(u),l):n(u)}function l(u){return u===46?e.check(Hj,d,c)(u):u===45||u===95||qn(u)?(s=!0,e.consume(u),l):d(u)}function c(u){return e.consume(u),r=!0,l}function d(u){return s&&r&&ei(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(u)):n(u)}}function zj(e,t,n){const i=this;return r;function r(o){return o!==87&&o!==119||!g8.call(i,i.previous)||ev(i.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(jj,e.attempt(h8,e.attempt(d8,s),n),n)(o))}function s(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(o)}}function $j(e,t,n){const i=this;let r="",s=!1;return o;function o(u){return(u===72||u===104)&&_8.call(i,i.previous)&&!ev(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),e.consume(u),a):n(u)}function a(u){if(ei(u)&&r.length<5)return r+=String.fromCodePoint(u),e.consume(u),a;if(u===58){const f=r.toLowerCase();if(f==="http"||f==="https")return e.consume(u),l}return n(u)}function l(u){return u===47?(e.consume(u),s?c:(s=!0,l)):n(u)}function c(u){return u===null||Ed(u)||Gt(u)||tl(u)||Z_(u)?n(u):e.attempt(h8,e.attempt(d8,d),n)(u)}function d(u){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(u)}}function Wj(e,t,n){let i=0;return r;function r(o){return(o===87||o===119)&&i<3?(i++,e.consume(o),r):o===46&&i===3?(e.consume(o),s):n(o)}function s(o){return o===null?n(o):t(o)}}function Kj(e,t,n){let i,r,s;return o;function o(c){return c===46||c===95?e.check(f8,l,a)(c):c===null||Gt(c)||tl(c)||c!==45&&Z_(c)?l(c):(s=!0,e.consume(c),o)}function a(c){return c===95?i=!0:(r=i,i=void 0),e.consume(c),o}function l(c){return r||i||!s?n(c):t(c)}}function Gj(e,t){let n=0,i=0;return r;function r(o){return o===40?(n++,e.consume(o),r):o===41&&i<n?s(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(f8,t,s)(o):o===null||Gt(o)||tl(o)?t(o):(e.consume(o),r)}function s(o){return o===41&&i++,e.consume(o),r}}function Yj(e,t,n){return i;function i(a){return a===33||a===34||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===63||a===95||a===126?(e.consume(a),i):a===38?(e.consume(a),s):a===93?(e.consume(a),r):a===60||a===null||Gt(a)||tl(a)?t(a):n(a)}function r(a){return a===null||a===40||a===91||Gt(a)||tl(a)?t(a):i(a)}function s(a){return ei(a)?o(a):n(a)}function o(a){return a===59?(e.consume(a),i):ei(a)?(e.consume(a),o):n(a)}}function Xj(e,t,n){return i;function i(s){return e.consume(s),r}function r(s){return qn(s)?n(s):t(s)}}function g8(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Gt(e)}function _8(e){return!ei(e)}function v8(e){return!(e===47||K0(e))}function K0(e){return e===43||e===45||e===46||e===95||qn(e)}function ev(e){let t=e.length,n=!1;for(;t--;){const i=e[t][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const Qj={exit:{literalAutolinkEmail:Jj,literalAutolinkHttp:eH,literalAutolinkWww:Zj}};function Zj(e){tv.call(this,e,"http://")}function Jj(e){tv.call(this,e,"mailto:")}function eH(e){tv.call(this,e)}function tv(e,t){const n=this.sliceSerialize(e);this.tag('<a href="'+Co((t||"")+n)+'">'),this.raw(this.encode(n)),this.tag("</a>")}const tH={tokenize:cH,partial:!0};function nH(){return{document:{[91]:{tokenize:oH,continuation:{tokenize:aH},exit:lH}},text:{[91]:{tokenize:sH},[93]:{add:"after",tokenize:iH,resolveTo:rH}}}}function iH(e,t,n){const i=this;let r=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o;for(;r--;){const l=i.events[r][1];if(l.type==="labelImage"){o=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return a;function a(l){if(!o||!o._balanced)return n(l);const c=Or(i.sliceSerialize({start:o.end,end:i.now()}));return c.codePointAt(0)!==94||!s.includes(c.slice(1))?n(l):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(l),e.exit("gfmFootnoteCallLabelMarker"),t(l))}}function rH(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},a=[e[n+1],e[n+2],["enter",i,t],e[n+3],e[n+4],["enter",r,t],["exit",r,t],["enter",s,t],["enter",o,t],["exit",o,t],["exit",s,t],e[e.length-2],e[e.length-1],["exit",i,t]];return e.splice(n,e.length-n+1,...a),e}function sH(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,o;return a;function a(u){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),l}function l(u){return u!==94?n(u):(e.enter("gfmFootnoteCallMarker"),e.consume(u),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(u){if(s>999||u===93&&!o||u===null||u===91||Gt(u))return n(u);if(u===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return r.includes(Or(i.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(u)}return Gt(u)||(o=!0),s++,e.consume(u),u===92?d:c}function d(u){return u===91||u===92||u===93?(e.consume(u),s++,c):c(u)}}function oH(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,o=0,a;return l;function l(h){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(h),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(h){return h===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(h),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):n(h)}function d(h){if(o>999||h===93&&!a||h===null||h===91||Gt(h))return n(h);if(h===93){e.exit("chunkString");const R=e.exit("gfmFootnoteDefinitionLabelString");return s=Or(i.sliceSerialize(R)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(h),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return Gt(h)||(a=!0),o++,e.consume(h),h===92?u:d}function u(h){return h===91||h===92||h===93?(e.consume(h),o++,d):d(h)}function f(h){return h===58?(e.enter("definitionMarker"),e.consume(h),e.exit("definitionMarker"),r.includes(s)||r.push(s),Tt(e,m,"gfmFootnoteDefinitionWhitespace")):n(h)}function m(h){return t(h)}}function aH(e,t,n){return e.check(Su,t,e.attempt(tH,t,n))}function lH(e){e.exit("gfmFootnoteDefinition")}function cH(e,t,n){const i=this;return Tt(e,r,"gfmFootnoteDefinitionIndent",4+1);function r(s){const o=i.events[i.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?t(s):n(s)}}const uH={}.hasOwnProperty,hH={};function dH(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function fH(e){const t=e||hH,n=t.label||"Footnotes",i=t.labelTagName||"h2",r=t.labelAttributes===null||t.labelAttributes===void 0?'class="sr-only"':t.labelAttributes,s=t.backLabel||dH,o=t.clobberPrefix===null||t.clobberPrefix===void 0?"user-content-":t.clobberPrefix;return{enter:{gfmFootnoteDefinition(){this.getData("tightStack").push(!1)},gfmFootnoteDefinitionLabelString(){this.buffer()},gfmFootnoteCallString(){this.buffer()}},exit:{gfmFootnoteDefinition(){let a=this.getData("gfmFootnoteDefinitions");const l=this.getData("gfmFootnoteDefinitionStack"),c=this.getData("tightStack"),d=l.pop(),u=this.resume();a||this.setData("gfmFootnoteDefinitions",a={}),uH.call(a,d)||(a[d]=u),c.pop(),this.setData("slurpOneLineEnding",!0),this.setData("lastWasTag")},gfmFootnoteDefinitionLabelString(a){let l=this.getData("gfmFootnoteDefinitionStack");l||this.setData("gfmFootnoteDefinitionStack",l=[]),l.push(Or(this.sliceSerialize(a))),this.resume(),this.buffer()},gfmFootnoteCallString(a){let l=this.getData("gfmFootnoteCallOrder"),c=this.getData("gfmFootnoteCallCounts");const d=Or(this.sliceSerialize(a));let u;this.resume(),l||this.setData("gfmFootnoteCallOrder",l=[]),c||this.setData("gfmFootnoteCallCounts",c={});const f=l.indexOf(d),m=Co(d.toLowerCase());f===-1?(l.push(d),c[d]=1,u=l.length):(c[d]++,u=f+1);const h=c[d];this.tag('<sup><a href="#'+o+"fn-"+m+'" id="'+o+"fnref-"+m+(h>1?"-"+h:"")+'" data-footnote-ref="" aria-describedby="footnote-label">'+String(u)+"</a></sup>")},null(){const a=this.getData("gfmFootnoteCallOrder")||[],l=this.getData("gfmFootnoteCallCounts")||{},c=this.getData("gfmFootnoteDefinitions")||{};let d=-1;for(a.length>0&&(this.lineEndingIfNeeded(),this.tag('<section data-footnotes="" class="footnotes"><'+i+' id="footnote-label"'+(r?" "+r:"")+">"),this.raw(this.encode(n)),this.tag("</"+i+">"),this.lineEndingIfNeeded(),this.tag("<ol>"));++d<a.length;){const u=a[d],f=Co(u.toLowerCase());let m=0;const h=[];for(;++m<=l[u];)h.push('<a href="#'+o+"fnref-"+f+(m>1?"-"+m:"")+'" data-footnote-backref="" aria-label="'+this.encode(typeof s=="string"?s:s(d,m))+'" class="data-footnote-backref">\u21A9'+(m>1?"<sup>"+m+"</sup>":"")+"</a>");const R=h.join(" ");let M=!1;this.lineEndingIfNeeded(),this.tag('<li id="'+o+"fn-"+f+'">'),this.lineEndingIfNeeded(),this.tag(c[u].replace(/<\/p>(?:\r?\n|\r)?$/,C=>(M=!0," "+R+C))),M||(this.lineEndingIfNeeded(),this.tag(R)),this.lineEndingIfNeeded(),this.tag("</li>")}a.length>0&&(this.lineEndingIfNeeded(),this.tag("</ol>"),this.lineEndingIfNeeded(),this.tag("</section>"))}}}}const mH={enter:{strikethrough(){this.tag("<del>")}},exit:{strikethrough(){this.tag("</del>")}}};function pH(e){let n=(e||{}).singleTilde;const i={tokenize:s,resolveAll:r};return n==null&&(n=!0),{text:{[126]:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(o,a){let l=-1;for(;++l<o.length;)if(o[l][0]==="enter"&&o[l][1].type==="strikethroughSequenceTemporary"&&o[l][1]._close){let c=l;for(;c--;)if(o[c][0]==="exit"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._open&&o[l][1].end.offset-o[l][1].start.offset===o[c][1].end.offset-o[c][1].start.offset){o[l][1].type="strikethroughSequence",o[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},o[c][1].start),end:Object.assign({},o[l][1].end)},u={type:"strikethroughText",start:Object.assign({},o[c][1].end),end:Object.assign({},o[l][1].start)},f=[["enter",d,a],["enter",o[c][1],a],["exit",o[c][1],a],["enter",u,a]],m=a.parser.constructs.insideSpan.null;m&&Ni(f,f.length,0,Xf(m,o.slice(c+1,l),a)),Ni(f,f.length,0,[["exit",u,a],["enter",o[l][1],a],["exit",o[l][1],a],["exit",d,a]]),Ni(o,c-1,l-c+3,f),l=c+f.length-2;break}}for(l=-1;++l<o.length;)o[l][1].type==="strikethroughSequenceTemporary"&&(o[l][1].type="data");return o}function s(o,a,l){const c=this.previous,d=this.events;let u=0;return f;function f(h){return c===126&&d[d.length-1][1].type!=="characterEscape"?l(h):(o.enter("strikethroughSequenceTemporary"),m(h))}function m(h){const R=Sd(c);if(h===126)return u>1?l(h):(o.consume(h),u++,m);if(u<2&&!n)return l(h);const M=o.exit("strikethroughSequenceTemporary"),C=Sd(h);return M._open=!C||C===2&&Boolean(R),M._close=!R||R===2&&Boolean(C),a(h)}}}const Zm={none:"",left:' align="left"',right:' align="right"',center:' align="center"'},gH={enter:{table(e){const t=e._align;this.lineEndingIfNeeded(),this.tag("<table>"),this.setData("tableAlign",t)},tableBody(){this.tag("<tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=Zm[e[t]];n===void 0?this.buffer():(this.lineEndingIfNeeded(),this.tag("<td"+n+">"))},tableHead(){this.lineEndingIfNeeded(),this.tag("<thead>")},tableHeader(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=Zm[e[t]];this.lineEndingIfNeeded(),this.tag("<th"+n+">")},tableRow(){this.setData("tableColumn",0),this.lineEndingIfNeeded(),this.tag("<tr>")}},exit:{codeTextData(e){let t=this.sliceSerialize(e);this.getData("tableAlign")&&(t=t.replace(/\\([\\|])/g,_H)),this.raw(this.encode(t))},table(){this.setData("tableAlign"),this.setData("slurpAllLineEndings"),this.lineEndingIfNeeded(),this.tag("</table>")},tableBody(){this.lineEndingIfNeeded(),this.tag("</tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn");t in e?(this.tag("</td>"),this.setData("tableColumn",t+1)):this.resume()},tableHead(){this.lineEndingIfNeeded(),this.tag("</thead>")},tableHeader(){const e=this.getData("tableColumn");this.tag("</th>"),this.setData("tableColumn",e+1)},tableRow(){const e=this.getData("tableAlign");let t=this.getData("tableColumn");for(;t<e.length;)this.lineEndingIfNeeded(),this.tag("<td"+Zm[e[t]]+"></td>"),t++;this.setData("tableColumn",t),this.lineEndingIfNeeded(),this.tag("</tr>")}}};function _H(e,t){return t==="|"?t:e}class vH{constructor(){this.map=[]}add(t,n,i){yH(this,t,n,i)}consume(t){if(this.map.sort((s,o)=>s[0]-o[0]),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(t.slice(this.map[n][0]+this.map[n][1])),i.push(this.map[n][2]),t.length=this.map[n][0];i.push([...t]),t.length=0;let r=i.pop();for(;r;)t.push(...r),r=i.pop();this.map.length=0}}function yH(e,t,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<e.map.length;){if(e.map[r][0]===t){e.map[r][1]+=n,e.map[r][2].push(...i);return}r+=1}e.map.push([t,n,i])}}function bH(e,t){let n=!1;const i=[];for(;t<e.length;){const r=e[t];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return i}const wH={flow:{null:{tokenize:EH,resolveAll:SH}}};function EH(e,t,n){const i=this;let r=0,s=0,o;return a;function a(g){let b=i.events.length-1;for(;b>-1;){const A=i.events[b][1].type;if(A==="lineEnding"||A==="linePrefix")b--;else break}const y=b>-1?i.events[b][1].type:null,w=y==="tableHead"||y==="tableRow"?N:l;return w===N&&i.parser.lazy[i.now().line]?n(g):w(g)}function l(g){return e.enter("tableHead"),e.enter("tableRow"),c(g)}function c(g){return g===124||(o=!0,s+=1),d(g)}function d(g){return g===null?n(g):et(g)?s>1?(s=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),m):n(g):bt(g)?Tt(e,d,"whitespace")(g):(s+=1,o&&(o=!1,r+=1),g===124?(e.enter("tableCellDivider"),e.consume(g),e.exit("tableCellDivider"),o=!0,d):(e.enter("data"),u(g)))}function u(g){return g===null||g===124||Gt(g)?(e.exit("data"),d(g)):(e.consume(g),g===92?f:u)}function f(g){return g===92||g===124?(e.consume(g),u):u(g)}function m(g){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(g):(e.enter("tableDelimiterRow"),o=!1,bt(g)?Tt(e,h,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(g):h(g))}function h(g){return g===45||g===58?M(g):g===124?(o=!0,e.enter("tableCellDivider"),e.consume(g),e.exit("tableCellDivider"),R):O(g)}function R(g){return bt(g)?Tt(e,M,"whitespace")(g):M(g)}function M(g){return g===58?(s+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(g),e.exit("tableDelimiterMarker"),C):g===45?(s+=1,C(g)):g===null||et(g)?F(g):O(g)}function C(g){return g===45?(e.enter("tableDelimiterFiller"),_(g)):O(g)}function _(g){return g===45?(e.consume(g),_):g===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(g),e.exit("tableDelimiterMarker"),x):(e.exit("tableDelimiterFiller"),x(g))}function x(g){return bt(g)?Tt(e,F,"whitespace")(g):F(g)}function F(g){return g===124?h(g):g===null||et(g)?!o||r!==s?O(g):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(g)):O(g)}function O(g){return n(g)}function N(g){return e.enter("tableRow"),v(g)}function v(g){return g===124?(e.enter("tableCellDivider"),e.consume(g),e.exit("tableCellDivider"),v):g===null||et(g)?(e.exit("tableRow"),t(g)):bt(g)?Tt(e,v,"whitespace")(g):(e.enter("data"),T(g))}function T(g){return g===null||g===124||Gt(g)?(e.exit("data"),v(g)):(e.consume(g),g===92?S:T)}function S(g){return g===92||g===124?(e.consume(g),T):T(g)}}function SH(e,t){let n=-1,i=!0,r=0,s=[0,0,0,0],o=[0,0,0,0],a=!1,l=0,c,d,u;const f=new vH;for(;++n<e.length;){const m=e[n],h=m[1];m[0]==="enter"?h.type==="tableHead"?(a=!1,l!==0&&(Ub(f,t,l,c,d),d=void 0,l=0),c={type:"table",start:Object.assign({},h.start),end:Object.assign({},h.end)},f.add(n,0,[["enter",c,t]])):h.type==="tableRow"||h.type==="tableDelimiterRow"?(i=!0,u=void 0,s=[0,0,0,0],o=[0,n+1,0,0],a&&(a=!1,d={type:"tableBody",start:Object.assign({},h.start),end:Object.assign({},h.end)},f.add(n,0,[["enter",d,t]])),r=h.type==="tableDelimiterRow"?2:d?3:1):r&&(h.type==="data"||h.type==="tableDelimiterMarker"||h.type==="tableDelimiterFiller")?(i=!1,o[2]===0&&(s[1]!==0&&(o[0]=o[1],u=Qu(f,t,s,r,void 0,u),s=[0,0,0,0]),o[2]=n)):h.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(o[0]=o[1],u=Qu(f,t,s,r,void 0,u)),s=o,o=[s[1],n,0,0])):h.type==="tableHead"?(a=!0,l=n):h.type==="tableRow"||h.type==="tableDelimiterRow"?(l=n,s[1]!==0?(o[0]=o[1],u=Qu(f,t,s,r,n,u)):o[1]!==0&&(u=Qu(f,t,o,r,n,u)),r=0):r&&(h.type==="data"||h.type==="tableDelimiterMarker"||h.type==="tableDelimiterFiller")&&(o[3]=n)}for(l!==0&&Ub(f,t,l,c,d),f.consume(t.events),n=-1;++n<t.events.length;){const m=t.events[n];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=bH(t.events,n))}return e}function Qu(e,t,n,i,r,s){const o=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",a="tableContent";n[0]!==0&&(s.end=Object.assign({},ya(t.events,n[0])),e.add(n[0],0,[["exit",s,t]]));const l=ya(t.events,n[1]);if(s={type:o,start:Object.assign({},l),end:Object.assign({},l)},e.add(n[1],0,[["enter",s,t]]),n[2]!==0){const c=ya(t.events,n[2]),d=ya(t.events,n[3]),u={type:a,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(n[2],0,[["enter",u,t]]),i!==2){const f=t.events[n[2]],m=t.events[n[3]];if(f[1].end=Object.assign({},m[1].end),f[1].type="chunkText",f[1].contentType="text",n[3]>n[2]+1){const h=n[2]+1,R=n[3]-n[2]-1;e.add(h,R,[])}}e.add(n[3]+1,0,[["exit",u,t]])}return r!==void 0&&(s.end=Object.assign({},ya(t.events,r)),e.add(r,0,[["exit",s,t]]),s=void 0),s}function Ub(e,t,n,i,r){const s=[],o=ya(t.events,n);r&&(r.end=Object.assign({},o),s.push(["exit",r,t])),i.end=Object.assign({},o),s.push(["exit",i,t]),e.add(n+1,0,s)}function ya(e,t){const n=e[t],i=n[0]==="enter"?"start":"end";return n[1][i]}const y8=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|title|textarea|xmp)(?=[\t\n\f\r />])/gi,TH=new RegExp("^"+y8.source,"i"),kH={exit:{htmlFlowData(e){jb.call(this,e,y8)},htmlTextData(e){jb.call(this,e,TH)}}};function jb(e,t){let n=this.sliceSerialize(e);this.options.allowDangerousHtml&&(n=n.replace(t,"&lt;$1$2")),this.raw(this.encode(n))}const AH={enter:{taskListCheck(){this.tag('<input type="checkbox" disabled="" ')}},exit:{taskListCheck(){this.tag("/>")},taskListCheckValueChecked(){this.tag('checked="" ')}}},xH={tokenize:IH},CH={text:{[91]:xH}};function IH(e,t,n){const i=this;return r;function r(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(l):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),s)}function s(l){return Gt(l)?(e.enter("taskListCheckValueUnchecked"),e.consume(l),e.exit("taskListCheckValueUnchecked"),o):l===88||l===120?(e.enter("taskListCheckValueChecked"),e.consume(l),e.exit("taskListCheckValueChecked"),o):n(l)}function o(l){return l===93?(e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),a):n(l)}function a(l){return et(l)?t(l):bt(l)?e.check({tokenize:RH},t,n)(l):n(l)}}function RH(e,t,n){return Tt(e,i,"whitespace");function i(r){return r===null?n(r):t(r)}}function MH(e){return J6([Vj,nH(),pH(e),wH,CH])}function OH(e){return e8([Qj,fH(e),mH,gH,kH,AH])}const kn={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,soh:1,stx:2,etx:3,eot:4,enq:5,ack:6,bel:7,bs:8,ht:9,lf:10,vt:11,ff:12,cr:13,so:14,si:15,dle:16,dc1:17,dc2:18,dc3:19,dc4:20,nak:21,syn:22,etb:23,can:24,em:25,sub:26,esc:27,fs:28,gs:29,rs:30,us:31,space:32,exclamationMark:33,quotationMark:34,numberSign:35,dollarSign:36,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,comma:44,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseA:65,uppercaseB:66,uppercaseC:67,uppercaseD:68,uppercaseE:69,uppercaseF:70,uppercaseG:71,uppercaseH:72,uppercaseI:73,uppercaseJ:74,uppercaseK:75,uppercaseL:76,uppercaseM:77,uppercaseN:78,uppercaseO:79,uppercaseP:80,uppercaseQ:81,uppercaseR:82,uppercaseS:83,uppercaseT:84,uppercaseU:85,uppercaseV:86,uppercaseW:87,uppercaseX:88,uppercaseY:89,uppercaseZ:90,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseA:97,lowercaseB:98,lowercaseC:99,lowercaseD:100,lowercaseE:101,lowercaseF:102,lowercaseG:103,lowercaseH:104,lowercaseI:105,lowercaseJ:106,lowercaseK:107,lowercaseL:108,lowercaseM:109,lowercaseN:110,lowercaseO:111,lowercaseP:112,lowercaseQ:113,lowercaseR:114,lowercaseS:115,lowercaseT:116,lowercaseU:117,lowercaseV:118,lowercaseW:119,lowercaseX:120,lowercaseY:121,lowercaseZ:122,leftCurlyBrace:123,verticalBar:124,rightCurlyBrace:125,tilde:126,del:127,degree:176,byteOrderMarker:65279,replacementCharacter:65533},NH=(e,t,n)=>{const i=o=>o===kn.carriageReturn||o===kn.lineFeed||o===kn.carriageReturnLineFeed||o===kn.eof?n(o):o===kn.backslash?(e.consume(o),r):o===kn.degree?(e.exit("underlineContent"),e.enter("underlineMarker"),e.consume(o),e.exit("underlineMarker"),e.exit("underline"),t):(e.consume(o),i),r=o=>o===kn.backslash||o===kn.degree?(e.consume(o),i):i(o),s=o=>o===kn.degree?n(o):i(o);return o=>(e.enter("underline"),e.enter("underlineMarker"),e.consume(o),e.exit("underlineMarker"),e.enter("underlineContent",{contentType:"string"}),s)},FH={name:"underline",tokenize:NH},LH={text:{176:FH}},DH={enter:{underline(){this.tag("<u>")}},exit:{underline(){this.tag("</u>")}}},BH=(e,t,n)=>{const i=o=>o===kn.carriageReturn||o===kn.lineFeed||o===kn.carriageReturnLineFeed||o===kn.eof?n(o):o===kn.backslash?(e.consume(o),r):o===kn.greaterThan?(e.exit("usertagContent"),e.enter("usertagMarker"),e.consume(o),e.exit("usertagMarker"),e.exit("usertag"),t):(e.consume(o),i),r=o=>o===kn.backslash||o===kn.greaterThan?(e.consume(o),i):i(o),s=o=>o===kn.atSign?(e.consume(o),e.exit("usertagMarker"),e.enter("usertagContent"),i):n(o);return o=>(e.enter("usertag"),e.enter("usertagMarker"),e.consume(o),s)},PH={name:"usertag",tokenize:BH},UH={text:{60:PH}},jH=e=>({exit:{usertagContent(t){const n=this.sliceSerialize(t);this.tag(`<span class="vac-text-tag" data-user-id="${n}">`);const i=e.find(r=>r._id===n);this.raw(`@${this.encode(i?i.username:n)}`),this.tag("</span>")}}});var HH=(e,{textFormatting:t})=>{if(t){let n=[];t.linkify||(n=["literalAutolink","literalAutolinkEmail"]);const i=Uj(e.replaceAll("<usertag>","<@").replaceAll("</usertag>",">"),{extensions:[{...MH(),disable:{null:n}},LH,UH],htmlExtensions:[OH(),DH,jH(t.users)]});if(t.singleLine){const r=document.createElement("div");return r.innerHTML=i,[{types:[],value:r.innerText}]}return[{types:["markdown"],value:i}]}return[{types:[],value:e}]};const nv=["png","jpg","jpeg","webp","svg","gif"],b8=["mp4","video/ogg","webm","quicktime"],VH=["mp3","audio/ogg","wav","mpeg"],qH={name:"FormatMessage",components:{SvgIcon:Bn},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{parsedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];let e;this.textFormatting.disabled?e={}:e={textFormatting:{linkify:this.linkify,linkOptions:this.linkOptions,singleLine:this.singleLine,reply:this.reply,users:this.users,...this.textFormatting}};const t=HH(this.content,e);return t.forEach(n=>{n.markdown=this.checkType(n,"markdown"),n.tag=this.checkType(n,"tag"),n.image=this.checkImageType(n)}),t}},methods:{checkType(e,t){return e.types&&e.types.indexOf(t)!==-1},checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const i=e.value.substring(t+1,e.value.length),r=t>0&&nv.some(s=>i.toLowerCase().includes(s));return r&&this.setImageSize(e),r},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",n);function n(i){const r=i.path[0].width/150;e.height=Math.round(i.path[0].height/r)+"px",t.removeEventListener("load",n)}},openTag(e){const t=e.target.getAttribute("data-user-id");if(!this.singleLine&&t){const n=this.users.find(i=>String(i._id)===t);this.$emit("open-user-tag",n)}}}},zH=["innerHTML"],$H={class:"vac-image-link-container"},WH={class:"vac-image-link-message"};function KH(e,t,n,i,r,s){const o=Ze("svg-icon");return ae(),_e("div",{class:mt(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[(ae(!0),_e(wt,null,ht(s.parsedMessage,(a,l)=>(ae(),_e(wt,{key:l},[a.markdown?(ae(),_e("div",{key:0,class:"markdown",onClick:t[0]||(t[0]=(...c)=>s.openTag&&s.openTag(...c)),innerHTML:a.value},null,8,zH)):(ae(),_e("div",{key:1,class:mt(["vac-format-container",{"vac-text-ellipsis":n.singleLine}])},[(ae(),Lt(JD(a.url?"a":"span"),{class:mt({"vac-text-ellipsis":n.singleLine,"vac-text-tag":!n.singleLine&&!n.reply&&a.tag}),href:a.href,target:a.href?n.linkOptions.target:null,rel:a.href?n.linkOptions.rel:null},{default:Je(()=>[n.deleted?(ae(),_e(wt,{key:0},[Pe(e.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},()=>[Ve(o,{name:"deleted",class:mt(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])]),ns(" "+ot(n.textMessages.MESSAGE_DELETED),1)],64)):a.url&&a.image?(ae(),_e(wt,{key:1},[Me("div",$H,[Me("div",{class:"vac-image-link",style:Zt({"background-image":`url('${a.value}')`,height:a.height})},null,4)]),Me("div",WH,ot(a.value),1)],64)):(ae(),_e(wt,{key:2},[ns(ot(a.value),1)],64))]),_:2},1032,["class","href","target","rel"]))],2))],64))),128))],2)}var Tu=Yt(qH,[["render",KH]]);const yo="__v-click-outside",w8=typeof window!="undefined",GH=typeof navigator!="undefined",YH=w8&&("ontouchstart"in window||GH&&navigator.msMaxTouchPoints>0),XH=YH?["touchstart"]:["click"],QH=e=>{const t=typeof e=="function";if(!t&&typeof e!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(n=>n),events:e.events||XH,isActive:e.isActive!==!1,detectIframe:e.detectIframe!==!1,capture:Boolean(e.capture)}},E8=({event:e,handler:t,middleware:n})=>{n(e)&&t(e)},ZH=({el:e,event:t,handler:n,middleware:i})=>{setTimeout(()=>{const{activeElement:r}=document;r&&r.tagName==="IFRAME"&&!e.contains(r)&&E8({event:t,handler:n,middleware:i})},0)},JH=({el:e,event:t,handler:n,middleware:i})=>{const r=t.path||t.composedPath&&t.composedPath();(r?r.indexOf(e)<0:!e.contains(t.target))&&E8({event:t,handler:n,middleware:i})},S8=(e,{value:t})=>{const{events:n,handler:i,middleware:r,isActive:s,detectIframe:o,capture:a}=QH(t);if(!!s){if(e[yo]=n.map(l=>({event:l,srcTarget:document.documentElement,handler:c=>JH({el:e,event:c,handler:i,middleware:r}),capture:a})),o){const l={event:"blur",srcTarget:window,handler:c=>ZH({el:e,event:c,handler:i,middleware:r}),capture:a};e[yo]=[...e[yo],l]}e[yo].forEach(({event:l,srcTarget:c,handler:d})=>setTimeout(()=>{!e[yo]||c.addEventListener(l,d,a)},0))}},T8=e=>{(e[yo]||[]).forEach(({event:n,srcTarget:i,handler:r,capture:s})=>i.removeEventListener(n,r,s)),delete e[yo]},eV=(e,{value:t,oldValue:n})=>{JSON.stringify(t)!==JSON.stringify(n)&&(T8(e),S8(e,{value:t}))},tV={beforeMount:S8,updated:eV,unmounted:T8};var Qf=w8?tV:{},k8=(e,t,n)=>{if(e.typingUsers&&e.typingUsers.length){const i=e.users.filter(r=>{if(r._id!==t&&e.typingUsers.indexOf(r._id)!==-1&&!(r.status&&r.status.state==="offline"))return!0});return i.length?e.users.length===2?n.IS_TYPING:i.map(r=>r.username).join(", ")+" "+n.IS_TYPING:void 0}};function $c(e,t){if(!(!t||!t.type))return e.some(n=>t.type.toLowerCase().includes(n))}function nl(e){return $c(nv,e)}function ku(e){return $c(b8,e)}function Hb(e){return $c(nv,e)||$c(b8,e)}function Zf(e){return $c(VH,e)}const nV={name:"RoomsContent",components:{SvgIcon:Bn,FormatMessage:Tu},directives:{clickOutside:Qf},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const n=this.room.users.find(i=>i._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:!n||n._id===this.currentUserId?t:`${n.username} - ${t}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(t=>t._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return k8(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const n=(t=(e=this.room.lastMessage)==null?void 0:e.files)==null?void 0:t[0];if(n){if(!n.duration)return`${n.name}.${n.extension}`;let i=Math.floor(n.duration);return(i-(i%=60))/60+(i>9?":":":0")+i}return""},isAudio(){return this.room.lastMessage.files?Zf(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},iV={class:"vac-room-container"},rV={class:"vac-name-container vac-text-ellipsis"},sV={class:"vac-title-container"},oV={class:"vac-room-name vac-text-ellipsis"},aV={key:1,class:"vac-text-date"},lV={key:0},cV={key:1,class:"vac-text-ellipsis"},uV={key:3,class:"vac-text-ellipsis"},hV={class:"vac-room-options-container"},dV={key:0,class:"vac-badge-counter vac-room-badge"},fV={key:0,class:"vac-menu-options"},mV={class:"vac-menu-list"},pV=["onClick"];function gV(e,t,n,i,r,s){const o=Ze("svg-icon"),a=Ze("format-message"),l=$f("click-outside");return ae(),_e("div",iV,[Pe(e.$slots,"room-list-item_"+n.room.roomId,{},()=>[Pe(e.$slots,"room-list-avatar_"+n.room.roomId,{},()=>[n.room.avatar?(ae(),_e("div",{key:0,class:"vac-avatar",style:Zt({"background-image":`url('${n.room.avatar}')`})},null,4)):Be("",!0)]),Me("div",rV,[Me("div",sV,[s.userStatus?(ae(),_e("div",{key:0,class:mt(["vac-state-circle",{"vac-state-online":s.userStatus==="online"}])},null,2)):Be("",!0),Pe(e.$slots,"room-list-info_"+n.room.roomId,{},()=>[Me("div",oV,ot(n.room.roomName),1)]),n.room.lastMessage?(ae(),_e("div",aV,ot(n.room.lastMessage.timestamp),1)):Be("",!0)]),Me("div",{class:mt(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!s.typingUsers}])},[s.isMessageCheckmarkVisible?(ae(),_e("span",lV,[Pe(e.$slots,"checkmark-icon_"+n.room.roomId,{},()=>[Ve(o,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Be("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&s.isAudio?(ae(),_e("div",cV,[Pe(e.$slots,"microphone-icon_"+n.room.roomId,{},()=>[Ve(o,{name:"microphone",class:"vac-icon-microphone"})]),ns(" "+ot(s.formattedDuration),1)])):n.room.lastMessage?(ae(),Lt(a,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:s.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!s.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Be("",!0),!n.room.lastMessage&&s.typingUsers?(ae(),_e("div",uV,ot(s.typingUsers),1)):Be("",!0),Me("div",hV,[n.room.unreadCount?(ae(),_e("div",dV,ot(n.room.unreadCount),1)):Be("",!0),Pe(e.$slots,"room-list-options_"+n.room.roomId,{},()=>[n.roomActions.length?(ae(),_e("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Ar(c=>r.roomMenuOpened=n.room.roomId,["stop"]))},[Pe(e.$slots,"room-list-options-icon_"+n.room.roomId,{},()=>[Ve(o,{name:"dropdown",param:"room"})])])):Be("",!0),n.roomActions.length?(ae(),Lt(fn,{key:1,name:"vac-slide-left"},{default:Je(()=>[r.roomMenuOpened===n.room.roomId?ts((ae(),_e("div",fV,[Me("div",mV,[(ae(!0),_e(wt,null,ht(n.roomActions,c=>(ae(),_e("div",{key:c.name},[Me("div",{class:"vac-menu-item",onClick:Ar(d=>s.roomActionHandler(c),["stop"])},ot(c.title),9,pV)]))),128))])])),[[l,s.closeRoomMenu]]):Be("",!0)]),_:1})):Be("",!0)])])],2)])])])}var _V=Yt(nV,[["render",gV]]),G0=(e,t,n,i=!1)=>!n||n===""?e:e.filter(r=>i?Zu(r[t]).startsWith(Zu(n)):Zu(r[t]).includes(Zu(n)));function Zu(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const vV={name:"RoomsList",components:{Loader:Yf,RoomsSearch:UP,RoomContent:_V},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=G0(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},yV={key:0,class:"vac-rooms-empty"},bV={key:1,id:"rooms-list",class:"vac-room-list"},wV=["id","onClick"],EV={key:0,id:"infinite-loader-rooms"};function SV(e,t,n,i,r,s){const o=Ze("rooms-search"),a=Ze("loader"),l=Ze("room-content");return ts((ae(),_e("div",{class:mt(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Pe(e.$slots,"rooms-header"),Pe(e.$slots,"rooms-list-search",{},()=>[Ve(o,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:s.searchRoom,onAddRoom:t[0]||(t[0]=c=>e.$emit("add-room"))},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Ve(a,{show:n.loadingRooms,type:"rooms"},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["show"]),!n.loadingRooms&&!n.rooms.length?(ae(),_e("div",yV,[Pe(e.$slots,"rooms-empty",{},()=>[ns(ot(n.textMessages.ROOMS_EMPTY),1)])])):Be("",!0),n.loadingRooms?Be("",!0):(ae(),_e("div",bV,[(ae(!0),_e(wt,null,ht(r.filteredRooms,c=>(ae(),_e("div",{id:c.roomId,key:c.roomId,class:mt(["vac-room-item",{"vac-room-selected":r.selectedRoomId===c.roomId}]),onClick:d=>s.openRoom(c)},[Ve(l,{"current-user-id":n.currentUserId,room:c,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:t[1]||(t[1]=d=>e.$emit("room-action-handler",d))},Vt({_:2},[ht(e.$slots,(d,u)=>({name:u,fn:Je(f=>[Pe(e.$slots,u,Ht(Bt(f)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,wV))),128)),Ve(fn,{name:"vac-fade-message"},{default:Je(()=>[n.rooms.length&&!n.loadingRooms?(ae(),_e("div",EV,[Ve(a,{show:r.showLoader,infinite:!0,type:"infinite-rooms"},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["show"])])):Be("",!0)]),_:3})]))],2)),[[Gf,n.showRoomsList]])}var TV=Yt(vV,[["render",SV]]);const kV={name:"RoomHeader",components:{SvgIcon:Bn},directives:{clickOutside:Qf},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return k8(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(n=>n._id!==this.currentUserId);if(!(e!=null&&e.status))return;let t="";return e.status.state==="online"?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},AV={class:"vac-room-header vac-app-border-b"},xV={class:"vac-room-wrapper"},CV={key:0,class:"vac-room-selection"},IV=["id"],RV=["onClick"],MV={class:"vac-selection-button-count"},OV={class:"vac-text-ellipsis"},NV={class:"vac-room-name vac-text-ellipsis"},FV={key:0,class:"vac-room-info vac-text-ellipsis"},LV={key:1,class:"vac-room-info vac-text-ellipsis"},DV={key:0,class:"vac-menu-options"},BV={class:"vac-menu-list"},PV=["onClick"];function UV(e,t,n,i,r,s){const o=Ze("svg-icon"),a=$f("click-outside");return ae(),_e("div",AV,[Pe(e.$slots,"room-header",{},()=>[Me("div",xV,[Ve(fn,{name:"vac-slide-up"},{default:Je(()=>[n.messageSelectionEnabled?(ae(),_e("div",CV,[(ae(!0),_e(wt,null,ht(n.messageSelectionActions,l=>(ae(),_e("div",{id:l.name,key:l.name},[Me("div",{class:"vac-selection-button",onClick:c=>s.messageSelectionActionHandler(l)},[ns(ot(l.title)+" ",1),Me("span",MV,ot(n.selectedMessagesTotal),1)],8,RV)],8,IV))),128)),Me("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=l=>e.$emit("cancel-message-selection"))},ot(n.textMessages.CANCEL_SELECT_MESSAGE),1)])):Be("",!0)]),_:1}),!n.messageSelectionEnabled&&r.messageSelectionAnimationEnded?(ae(),_e(wt,{key:0},[n.singleRoom?Be("",!0):(ae(),_e("div",{key:0,class:mt(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:t[1]||(t[1]=l=>e.$emit("toggle-rooms-list"))},[Pe(e.$slots,"toggle-icon",{},()=>[Ve(o,{name:"toggle"})])],2)),Me("div",{class:mt(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:t[2]||(t[2]=l=>e.$emit("room-info"))},[Pe(e.$slots,"room-header-avatar",{},()=>[n.room.avatar?(ae(),_e("div",{key:0,class:"vac-avatar",style:Zt({"background-image":`url('${n.room.avatar}')`})},null,4)):Be("",!0)]),Pe(e.$slots,"room-header-info",{},()=>[Me("div",OV,[Me("div",NV,ot(n.room.roomName),1),s.typingUsers?(ae(),_e("div",FV,ot(s.typingUsers),1)):(ae(),_e("div",LV,ot(s.userStatus),1))])])],2),n.room.roomId?Pe(e.$slots,"room-options",{key:1},()=>[n.menuActions.length?(ae(),_e("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=l=>r.menuOpened=!r.menuOpened)},[Pe(e.$slots,"menu-icon",{},()=>[Ve(o,{name:"menu"})])])):Be("",!0),n.menuActions.length?(ae(),Lt(fn,{key:1,name:"vac-slide-left"},{default:Je(()=>[r.menuOpened?ts((ae(),_e("div",DV,[Me("div",BV,[(ae(!0),_e(wt,null,ht(n.menuActions,l=>(ae(),_e("div",{key:l.name},[Me("div",{class:"vac-menu-item",onClick:c=>s.menuActionHandler(l)},ot(l.title),9,PV)]))),128))])])),[[a,s.closeMenu]]):Be("",!0)]),_:1})):Be("",!0)]):Be("",!0)],64)):Be("",!0)])])])}var jV=Yt(kV,[["render",UV]]);function Ju(e){if(typeof e!="string"||!e)throw new Error("expected a non-empty string, got: "+e)}function Jm(e){if(typeof e!="number")throw new Error("expected a number, got: "+e)}const HV=1,VV=1,oa="emoji",il="keyvalue",iv="favorites",qV="tokens",A8="tokens",zV="unicode",x8="count",$V="group",WV="order",C8="group-order",Y0="eTag",Td="url",Vb="skinTone",wl="readonly",rv="readwrite",I8="skinUnicodes",KV="skinUnicodes",GV="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",YV="en";function XV(e,t){const n=new Set,i=[];for(const r of e){const s=t(r);n.has(s)||(n.add(s),i.push(r))}return i}function qb(e){return XV(e,t=>t.unicode)}function QV(e){function t(n,i,r){const s=i?e.createObjectStore(n,{keyPath:i}):e.createObjectStore(n);if(r)for(const[o,[a,l]]of Object.entries(r))s.createIndex(o,a,{multiEntry:l});return s}t(il),t(oa,zV,{[A8]:[qV,!0],[C8]:[[$V,WV]],[I8]:[KV,!0]}),t(iv,void 0,{[x8]:[""]})}const X0={},kh={},kd={};function R8(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}async function ZV(e){const t=await new Promise((n,i)=>{const r=indexedDB.open(e,HV);X0[e]=r,r.onupgradeneeded=s=>{s.oldVersion<VV&&QV(r.result)},R8(n,i,r)});return t.onclose=()=>sv(e),t}function JV(e){return kh[e]||(kh[e]=ZV(e)),kh[e]}function ls(e,t,n,i){return new Promise((r,s)=>{const o=e.transaction(t,n,{durability:"relaxed"}),a=typeof t=="string"?o.objectStore(t):t.map(c=>o.objectStore(c));let l;i(a,o,c=>{l=c}),o.oncomplete=()=>r(l),o.onerror=()=>s(o.error)})}function sv(e){const t=X0[e],n=t&&t.result;if(n){n.close();const i=kd[e];if(i)for(const r of i)r()}delete X0[e],delete kh[e],delete kd[e]}function eq(e){return new Promise((t,n)=>{sv(e);const i=indexedDB.deleteDatabase(e);R8(t,n,i)})}function tq(e,t){let n=kd[e];n||(n=kd[e]=[]),n.push(t)}const nq=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function La(e){return e.split(/[\s_]+/).map(t=>!t.match(/\w/)||nq.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const iq=2;function M8(e){return e.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=iq)}function rq(e){return e.map(({annotation:n,emoticon:i,group:r,order:s,shortcodes:o,skins:a,tags:l,emoji:c,version:d})=>{const u=[...new Set(M8([...(o||[]).map(La).flat(),...l.map(La).flat(),...La(n),i]))].sort(),f={annotation:n,group:r,order:s,tags:l,tokens:u,unicode:c,version:d};if(i&&(f.emoticon=i),o&&(f.shortcodes=o),a){f.skinTones=[],f.skinUnicodes=[],f.skinVersions=[];for(const{tone:m,emoji:h,version:R}of a)f.skinTones.push(m),f.skinUnicodes.push(h),f.skinVersions.push(R)}return f})}function O8(e,t,n,i){e[t](n).onsuccess=r=>i&&i(r.target.result)}function Qo(e,t,n){O8(e,"get",t,n)}function N8(e,t,n){O8(e,"getAll",t,n)}function ov(e){e.commit&&e.commit()}function sq(e,t){let n=e[0];for(let i=1;i<e.length;i++){const r=e[i];t(n)>t(r)&&(n=r)}return n}function F8(e,t){const n=sq(e,r=>r.length),i=[];for(const r of n)e.some(s=>s.findIndex(o=>t(o)===t(r))===-1)||i.push(r);return i}async function oq(e){return!await av(e,il,Td)}async function aq(e,t,n){const[i,r]=await Promise.all([Y0,Td].map(s=>av(e,il,s)));return i===n&&r===t}async function lq(e,t){return ls(e,oa,wl,(i,r,s)=>{let o;const a=()=>{i.getAll(o&&IDBKeyRange.lowerBound(o,!0),50).onsuccess=l=>{const c=l.target.result;for(const d of c)if(o=d.unicode,t(d))return s(d);if(c.length<50)return s();a()}};a()})}async function L8(e,t,n,i){try{const r=rq(t);await ls(e,[oa,il],rv,([s,o],a)=>{let l,c,d=0;function u(){++d===2&&f()}function f(){if(!(l===i&&c===n)){s.clear();for(const m of r)s.put(m);o.put(i,Y0),o.put(n,Td),ov(a)}}Qo(o,Y0,m=>{l=m,u()}),Qo(o,Td,m=>{c=m,u()})})}finally{}}async function cq(e,t){return ls(e,oa,wl,(n,i,r)=>{const s=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);N8(n.index(C8),s,r)})}async function D8(e,t){const n=M8(La(t));return n.length?ls(e,oa,wl,(i,r,s)=>{const o=[],a=()=>{o.length===n.length&&l()},l=()=>{const c=F8(o,d=>d.unicode);s(c.sort((d,u)=>d.order<u.order?-1:1))};for(let c=0;c<n.length;c++){const d=n[c],u=c===n.length-1?IDBKeyRange.bound(d,d+"\uFFFF",!1,!0):IDBKeyRange.only(d);N8(i.index(A8),u,f=>{o.push(f),a()})}}):[]}async function uq(e,t){const n=await D8(e,t);return n.length?n.filter(i=>(i.shortcodes||[]).map(s=>s.toLowerCase()).includes(t.toLowerCase()))[0]||null:await lq(e,r=>(r.shortcodes||[]).includes(t.toLowerCase()))||null}async function hq(e,t){return ls(e,oa,wl,(n,i,r)=>Qo(n,t,s=>{if(s)return r(s);Qo(n.index(I8),t,o=>r(o||null))}))}function av(e,t,n){return ls(e,t,wl,(i,r,s)=>Qo(i,n,s))}function dq(e,t,n,i){return ls(e,t,rv,(r,s)=>{r.put(i,n),ov(s)})}function fq(e,t){return ls(e,iv,rv,(n,i)=>Qo(n,t,r=>{n.put((r||0)+1,t),ov(i)}))}function mq(e,t,n){return n===0?[]:ls(e,[iv,oa],wl,([i,r],s,o)=>{const a=[];i.index(x8).openCursor(void 0,"prev").onsuccess=l=>{const c=l.target.result;if(!c)return o(a);function d(m){if(a.push(m),a.length===n)return o(a);c.continue()}const u=c.primaryKey,f=t.byName(u);if(f)return d(f);Qo(r,u,m=>{if(m)return d(m);c.continue()})}})}const eh="";function pq(e,t){const n=new Map;for(const r of e){const s=t(r);for(const o of s){let a=n;for(let c=0;c<o.length;c++){const d=o.charAt(c);let u=a.get(d);u||(u=new Map,a.set(d,u)),a=u}let l=a.get(eh);l||(l=[],a.set(eh,l)),l.push(r)}}return(r,s)=>{let o=n;for(let c=0;c<r.length;c++){const d=r.charAt(c),u=o.get(d);if(u)o=u;else return[]}if(s)return o.get(eh)||[];const a=[],l=[o];for(;l.length;){const d=[...l.shift().entries()].sort((u,f)=>u[0]<f[0]?-1:1);for(const[u,f]of d)u===eh?a.push(...f):l.push(f)}return a}}const gq=["name","url"];function _q(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||gq.some(i=>!(i in e[0])));if(!t||n)throw new Error("Custom emojis are in the wrong format")}function zb(e){_q(e);const t=(f,m)=>f.name.toLowerCase()<m.name.toLowerCase()?-1:1,n=e.sort(t),r=pq(e,f=>[...new Set((f.shortcodes||[]).map(m=>La(m)).flat())]),s=f=>r(f,!0),o=f=>r(f,!1),a=f=>{const m=La(f),h=m.map((R,M)=>(M<m.length-1?s:o)(R));return F8(h,R=>R.name).sort(t)},l=new Map,c=new Map;for(const f of e){c.set(f.name.toLowerCase(),f);for(const m of f.shortcodes||[])l.set(m.toLowerCase(),f)}return{all:n,search:a,byShortcode:f=>l.get(f.toLowerCase()),byName:f=>c.get(f.toLowerCase())}}function Nl(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function B8(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const vq=["annotation","emoji","group","order","tags","version"];function yq(e){if(!e||!Array.isArray(e)||!e[0]||typeof e[0]!="object"||vq.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function P8(e,t){if(Math.floor(e.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+e.status)}async function bq(e){const t=await fetch(e,{method:"HEAD"});P8(t,e);const n=t.headers.get("etag");return B8(n),n}async function Q0(e){const t=await fetch(e);P8(t,e);const n=t.headers.get("etag");B8(n);const i=await t.json();return yq(i),[n,i]}function wq(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=-1;++r<i;)t+=String.fromCharCode(n[r]);return t}function Eq(e){for(var t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n),r=-1;++r<t;)i[r]=e.charCodeAt(r);return n}async function U8(e){const t=JSON.stringify(e),n=Eq(t),i=await crypto.subtle.digest("SHA-1",n),r=wq(i);return btoa(r)}async function Sq(e,t){let n,i=await bq(t);if(!i){const r=await Q0(t);i=r[0],n=r[1],i||(i=await U8(n))}await aq(e,t,i)||(n||(n=(await Q0(t))[1]),await L8(e,n,t,i))}async function Tq(e,t){let[n,i]=await Q0(t);n||(n=await U8(i)),await L8(e,i,t,n)}class j8{constructor({dataSource:t=GV,locale:n=YV,customEmoji:i=[]}={}){this.dataSource=t,this.locale=n,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=zb(i),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await JV(this._dbName);tq(this._dbName,this._clear);const n=this.dataSource;await oq(t)?await Tq(t,n):this._lazyUpdate=Sq(t,n)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return Jm(t),await this.ready(),qb(await cq(this._db,t)).map(Nl)}async getEmojiBySearchQuery(t){Ju(t),await this.ready();const n=this._custom.search(t),i=qb(await D8(this._db,t)).map(Nl);return[...n,...i]}async getEmojiByShortcode(t){Ju(t),await this.ready();const n=this._custom.byShortcode(t);return n||Nl(await uq(this._db,t))}async getEmojiByUnicodeOrName(t){Ju(t),await this.ready();const n=this._custom.byName(t);return n||Nl(await hq(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await av(this._db,il,Vb)||0}async setPreferredSkinTone(t){return Jm(t),await this.ready(),dq(this._db,il,Vb,t)}async incrementFavoriteEmojiCount(t){return Ju(t),await this.ready(),fq(this._db,t)}async getTopFavoriteEmoji(t){return Jm(t),await this.ready(),(await mq(this._db,this._custom,t)).map(Nl)}set customEmoji(t){this._custom=zb(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await sv(this._dbName)}async delete(){await this._shutdown(),await eq(this._dbName)}}function Wc(){}function H8(e){return e()}function $b(){return Object.create(null)}function Au(e){e.forEach(H8)}function V8(e){return typeof e=="function"}function kq(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let th;function Ad(e,t){return th||(th=document.createElement("a")),th.href=t,e===th.href}function Aq(e){return Object.keys(e).length===0}function xq(e){return e&&V8(e.destroy)?e.destroy:Wc}function zt(e,t){e.appendChild(t)}function hr(e,t,n){e.insertBefore(t,n||null)}function dr(e){e.parentNode.removeChild(e)}function jt(e){return document.createElement(e)}function Sr(e){return document.createTextNode(e)}function nr(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function de(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Tr(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Wb(e,t){e.value=t==null?"":t}function ds(e,t,n,i){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}let lv;function dc(e){lv=e}const Wl=[],Ta=[],Ah=[],Kb=[],q8=Promise.resolve();let Z0=!1;function z8(){Z0||(Z0=!0,q8.then($8))}function Cq(){return z8(),q8}function J0(e){Ah.push(e)}const e1=new Set;let nh=0;function $8(){const e=lv;do{for(;nh<Wl.length;){const t=Wl[nh];nh++,dc(t),Iq(t.$$)}for(dc(null),Wl.length=0,nh=0;Ta.length;)Ta.pop()();for(let t=0;t<Ah.length;t+=1){const n=Ah[t];e1.has(n)||(e1.add(n),n())}Ah.length=0}while(Wl.length);for(;Kb.length;)Kb.pop()();Z0=!1,e1.clear(),dc(e)}function Iq(e){if(e.fragment!==null){e.update(),Au(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J0)}}const Rq=new Set;function Mq(e,t){e&&e.i&&(Rq.delete(e),e.i(t))}const Oq=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Kl(e,t){e.d(1),t.delete(e.key)}function Gl(e,t,n,i,r,s,o,a,l,c,d,u){let f=e.length,m=s.length,h=f;const R={};for(;h--;)R[e[h].key]=h;const M=[],C=new Map,_=new Map;for(h=m;h--;){const N=u(r,s,h),v=n(N);let T=o.get(v);T?i&&T.p(N,t):(T=c(v,N),T.c()),C.set(v,M[h]=T),v in R&&_.set(v,Math.abs(h-R[v]))}const x=new Set,F=new Set;function O(N){Mq(N,1),N.m(a,d),o.set(N.key,N),d=N.first,m--}for(;f&&m;){const N=M[m-1],v=e[f-1],T=N.key,S=v.key;N===v?(d=N.first,f--,m--):C.has(S)?!o.has(T)||x.has(T)?O(N):F.has(S)?f--:_.get(T)>_.get(S)?(F.add(T),O(N)):(x.add(S),f--):(l(v,o),f--)}for(;f--;){const N=e[f];C.has(N.key)||l(N,o)}for(;m;)O(M[m-1]);return M}function Nq(e,t,n,i){const{fragment:r,on_mount:s,on_destroy:o,after_update:a}=e.$$;r&&r.m(t,n),i||J0(()=>{const l=s.map(H8).filter(V8);o?o.push(...l):Au(l),e.$$.on_mount=[]}),a.forEach(J0)}function Fq(e,t){const n=e.$$;n.fragment!==null&&(Au(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Lq(e,t){e.$$.dirty[0]===-1&&(Wl.push(e),z8(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Dq(e,t,n,i,r,s,o,a=[-1]){const l=lv;dc(e);const c=e.$$={fragment:null,ctx:null,props:s,update:Wc,not_equal:r,bound:$b(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:$b(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};o&&o(c.root);let d=!1;c.ctx=n?n(e,t.props||{},(u,f,...m)=>{const h=m.length?m[0]:f;return c.ctx&&r(c.ctx[u],c.ctx[u]=h)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](h),d&&Lq(e,u)),f}):[],c.update(),d=!0,Au(c.before_update),c.fragment=i?i(c.ctx):!1,t.target&&(c.fragment&&c.fragment.c(),Nq(e,t.target,void 0,void 0),$8()),dc(l)}class Bq{$destroy(){Fq(this,1),this.$destroy=Wc}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!Aq(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const W8=[[-1,"\u2728","custom"],[0,"\u{1F600}","smileys-emotion"],[1,"\u{1F44B}","people-body"],[3,"\u{1F431}","animals-nature"],[4,"\u{1F34E}","food-drink"],[5,"\u{1F3E0}\uFE0F","travel-places"],[6,"\u26BD","activities"],[7,"\u{1F4DD}","objects"],[8,"\u26D4\uFE0F","symbols"],[9,"\u{1F3C1}","flags"]].map(([e,t,n])=>({id:e,emoji:t,name:n})),ih=W8.slice(1),Pq=W8[0],Uq=2,Gb=6,K8=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function Yb(e){return e.unicode.includes("\u200D")}const jq={"\u{1FAE0}":14,"\u{1F972}":13.1,"\u{1F97B}":12.1,"\u{1F970}":11,"\u{1F929}":5,"\u{1F471}\u200D\u2640\uFE0F":4,"\u{1F923}":3,"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":2,"\u{1F600}":1,"\u{1F610}\uFE0F":.7,"\u{1F603}":.6},Hq=1e3,Vq="\u{1F590}\uFE0F",qq=8,zq=["\u{1F60A}","\u{1F612}","\u2665\uFE0F","\u{1F44D}\uFE0F","\u{1F60D}","\u{1F602}","\u{1F62D}","\u263A\uFE0F","\u{1F614}","\u{1F629}","\u{1F60F}","\u{1F495}","\u{1F64C}","\u{1F618}"],G8='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',$q=(e,t)=>e<t?-1:e>t?1:0,Xb=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const i=n.getContext("2d");return i.textBaseline="top",i.font=`100px ${G8}`,i.fillStyle=t,i.scale(.01,.01),i.fillText(e,0,0),i.getImageData(0,0,1,1).data},Wq=(e,t)=>{const n=[...e].join(","),i=[...t].join(",");return n===i&&!n.startsWith("0,0,0,")};function Kq(e){const t=Xb(e,"#000"),n=Xb(e,"#fff");return t&&n&&Wq(t,n)}function Gq(){const e=Object.entries(jq);try{for(const[t,n]of e)if(Kq(t))return n}catch{}finally{}return e[0][1]}const t1=new Promise(e=>K8(()=>e(Gq()))),ep=new Map,Yq="\uFE0F",Xq="\uD83C",Qq="\u200D",Zq=127995,Jq=57339;function ez(e,t){if(t===0)return e;const n=e.indexOf(Qq);return n!==-1?e.substring(0,n)+String.fromCodePoint(Zq+t-1)+e.substring(n):(e.endsWith(Yq)&&(e=e.substring(0,e.length-1)),e+Xq+String.fromCodePoint(Jq+t-1))}function fs(e){e.preventDefault(),e.stopPropagation()}function n1(e,t,n){return t+=e?-1:1,t<0?t=n.length-1:t>=n.length&&(t=0),t}function Y8(e,t){const n=new Set,i=[];for(const r of e){const s=t(r);n.has(s)||(n.add(s),i.push(r))}return i}function tz(e,t){const n=i=>{const r={};for(const s of i)typeof s.tone=="number"&&s.version<=t&&(r[s.tone]=s.unicode);return r};return e.map(({unicode:i,skins:r,shortcodes:s,url:o,name:a,category:l})=>({unicode:i,name:a,shortcodes:s,url:o,category:l,id:i||a,skins:r&&n(r),title:(s||[]).join(", ")}))}const xh=requestAnimationFrame;let nz=typeof ResizeObserver=="function";function iz(e,t){let n;return nz?(n=new ResizeObserver(i=>t(i[0].contentRect.width)),n.observe(e)):xh(()=>t(e.getBoundingClientRect().width)),{destroy(){n&&n.disconnect()}}}function Qb(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}let i1;function rz(e,t,n){for(const i of e){const r=n(i),s=Qb(r);typeof i1=="undefined"&&(i1=Qb(t));const o=s/1.8<i1;ep.set(i.unicode,o)}}function sz(e){return Y8(e,t=>t)}const{Map:Yl}=Oq;function Zb(e,t,n){const i=e.slice();return i[63]=t[n],i[65]=n,i}function Jb(e,t,n){const i=e.slice();return i[66]=t[n],i[65]=n,i}function e3(e,t,n){const i=e.slice();return i[63]=t[n],i[65]=n,i}function t3(e,t,n){const i=e.slice();return i[69]=t[n],i}function n3(e,t,n){const i=e.slice();return i[72]=t[n],i[65]=n,i}function i3(e,t){let n,i=t[72]+"",r,s,o,a,l,c;return{key:e,first:null,c(){n=jt("div"),r=Sr(i),de(n,"id",s="skintone-"+t[65]),de(n,"class",o="emoji hide-focus "+(t[65]===t[20]?"active":"")),de(n,"aria-selected",a=t[65]===t[20]),de(n,"role","option"),de(n,"title",l=t[0].skinTones[t[65]]),de(n,"tabindex","-1"),de(n,"aria-label",c=t[0].skinTones[t[65]]),this.first=n},m(d,u){hr(d,n,u),zt(n,r)},p(d,u){t=d,u[0]&512&&i!==(i=t[72]+"")&&Tr(r,i),u[0]&512&&s!==(s="skintone-"+t[65])&&de(n,"id",s),u[0]&1049088&&o!==(o="emoji hide-focus "+(t[65]===t[20]?"active":""))&&de(n,"class",o),u[0]&1049088&&a!==(a=t[65]===t[20])&&de(n,"aria-selected",a),u[0]&513&&l!==(l=t[0].skinTones[t[65]])&&de(n,"title",l),u[0]&513&&c!==(c=t[0].skinTones[t[65]])&&de(n,"aria-label",c)},d(d){d&&dr(n)}}}function r3(e,t){let n,i,r=t[69].emoji+"",s,o,a,l,c,d,u;function f(){return t[49](t[69])}return{key:e,first:null,c(){n=jt("button"),i=jt("div"),s=Sr(r),de(i,"class","nav-emoji emoji"),de(n,"role","tab"),de(n,"class","nav-button"),de(n,"aria-controls",o="tab-"+t[69].id),de(n,"aria-label",a=t[0].categories[t[69].name]),de(n,"aria-selected",l=!t[4]&&t[13].id===t[69].id),de(n,"title",c=t[0].categories[t[69].name]),this.first=n},m(m,h){hr(m,n,h),zt(n,i),zt(i,s),d||(u=nr(n,"click",f),d=!0)},p(m,h){t=m,h[0]&4096&&r!==(r=t[69].emoji+"")&&Tr(s,r),h[0]&4096&&o!==(o="tab-"+t[69].id)&&de(n,"aria-controls",o),h[0]&4097&&a!==(a=t[0].categories[t[69].name])&&de(n,"aria-label",a),h[0]&12304&&l!==(l=!t[4]&&t[13].id===t[69].id)&&de(n,"aria-selected",l),h[0]&4097&&c!==(c=t[0].categories[t[69].name])&&de(n,"title",c)},d(m){m&&dr(n),d=!1,u()}}}function oz(e){let t,n;return{c(){t=jt("img"),de(t,"class","custom-emoji"),Ad(t.src,n=e[63].url)||de(t,"src",n),de(t,"alt",""),de(t,"loading","lazy")},m(i,r){hr(i,t,r)},p(i,r){r[0]&32768&&!Ad(t.src,n=i[63].url)&&de(t,"src",n)},d(i){i&&dr(t)}}}function az(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Sr(t)},m(i,r){hr(i,n,r)},p(i,r){r[0]&33024&&t!==(t=i[27](i[63],i[8])+"")&&Tr(n,t)},d(i){i&&dr(n)}}}function s3(e,t){let n,i,r,s,o,a,l;function c(f,m){return f[63].unicode?az:oz}let d=c(t),u=d(t);return{key:e,first:null,c(){n=jt("button"),u.c(),de(n,"role",i=t[4]?"option":"menuitem"),de(n,"aria-selected",r=t[4]?t[65]==t[5]:""),de(n,"aria-label",s=t[28](t[63],t[8])),de(n,"title",o=t[63].title),de(n,"class",a="emoji "+(t[4]&&t[65]===t[5]?"active":"")),de(n,"id",l="emo-"+t[63].id),this.first=n},m(f,m){hr(f,n,m),u.m(n,null)},p(f,m){t=f,d===(d=c(t))&&u?u.p(t,m):(u.d(1),u=d(t),u&&(u.c(),u.m(n,null))),m[0]&16&&i!==(i=t[4]?"option":"menuitem")&&de(n,"role",i),m[0]&32816&&r!==(r=t[4]?t[65]==t[5]:"")&&de(n,"aria-selected",r),m[0]&33024&&s!==(s=t[28](t[63],t[8]))&&de(n,"aria-label",s),m[0]&32768&&o!==(o=t[63].title)&&de(n,"title",o),m[0]&32816&&a!==(a="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&de(n,"class",a),m[0]&32768&&l!==(l="emo-"+t[63].id)&&de(n,"id",l)},d(f){f&&dr(n),u.d()}}}function o3(e,t){let n,i=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",r,s,o,a,l=[],c=new Yl,d,u,f,m=t[66].emojis;const h=R=>R[63].id;for(let R=0;R<m.length;R+=1){let M=e3(t,m,R),C=h(M);c.set(C,l[R]=s3(C,M))}return{key:e,first:null,c(){n=jt("div"),r=Sr(i),a=jt("div");for(let R=0;R<l.length;R+=1)l[R].c();de(n,"id",s="menu-label-"+t[65]),de(n,"class",o="category "+(t[15].length===1&&t[15][0].category===""?"gone":"")),de(n,"aria-hidden","true"),de(a,"class","emoji-menu"),de(a,"role",d=t[4]?"listbox":"menu"),de(a,"aria-labelledby",u="menu-label-"+t[65]),de(a,"id",f=t[4]?"search-results":""),this.first=n},m(R,M){hr(R,n,M),zt(n,r),hr(R,a,M);for(let C=0;C<l.length;C+=1)l[C].m(a,null)},p(R,M){t=R,M[0]&40977&&i!==(i=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&Tr(r,i),M[0]&32768&&s!==(s="menu-label-"+t[65])&&de(n,"id",s),M[0]&32768&&o!==(o="category "+(t[15].length===1&&t[15][0].category===""?"gone":""))&&de(n,"class",o),M[0]&402686256&&(m=t[66].emojis,l=Gl(l,M,h,1,t,m,c,a,Kl,s3,null,e3)),M[0]&16&&d!==(d=t[4]?"listbox":"menu")&&de(a,"role",d),M[0]&32768&&u!==(u="menu-label-"+t[65])&&de(a,"aria-labelledby",u),M[0]&16&&f!==(f=t[4]?"search-results":"")&&de(a,"id",f)},d(R){R&&dr(n),R&&dr(a);for(let M=0;M<l.length;M+=1)l[M].d()}}}function lz(e){let t,n;return{c(){t=jt("img"),de(t,"class","custom-emoji"),Ad(t.src,n=e[63].url)||de(t,"src",n),de(t,"alt",""),de(t,"loading","lazy")},m(i,r){hr(i,t,r)},p(i,r){r[0]&1024&&!Ad(t.src,n=i[63].url)&&de(t,"src",n)},d(i){i&&dr(t)}}}function cz(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Sr(t)},m(i,r){hr(i,n,r)},p(i,r){r[0]&1280&&t!==(t=i[27](i[63],i[8])+"")&&Tr(n,t)},d(i){i&&dr(n)}}}function a3(e,t){let n,i,r,s;function o(c,d){return c[63].unicode?cz:lz}let a=o(t),l=a(t);return{key:e,first:null,c(){n=jt("button"),l.c(),de(n,"role","menuitem"),de(n,"aria-label",i=t[28](t[63],t[8])),de(n,"title",r=t[63].title),de(n,"class","emoji"),de(n,"id",s="fav-"+t[63].id),this.first=n},m(c,d){hr(c,n,d),l.m(n,null)},p(c,d){t=c,a===(a=o(t))&&l?l.p(t,d):(l.d(1),l=a(t),l&&(l.c(),l.m(n,null))),d[0]&1280&&i!==(i=t[28](t[63],t[8]))&&de(n,"aria-label",i),d[0]&1024&&r!==(r=t[63].title)&&de(n,"title",r),d[0]&1024&&s!==(s="fav-"+t[63].id)&&de(n,"id",s)},d(c){c&&dr(n),l.d()}}}function uz(e){let t,n,i,r,s,o,a,l,c,d=e[0].searchLabel+"",u,f,m=e[0].searchDescription+"",h,R,M,C,_,x,F,O=e[0].skinToneDescription+"",N,v,T=[],S=new Yl,g,b,y,w,A,E=[],j=new Yl,K,H,$,p,I,Z,D,ye,Oe=[],xe=new Yl,be,qe,Fe,we,Ye,lt=[],k=new Yl,L,q,W,G,ie,ce,J=e[9];const re=ue=>ue[72];for(let ue=0;ue<J.length;ue+=1){let ve=n3(e,J,ue),ee=re(ve);S.set(ee,T[ue]=i3(ee,ve))}let Q=e[12];const Ee=ue=>ue[69].id;for(let ue=0;ue<Q.length;ue+=1){let ve=t3(e,Q,ue),ee=Ee(ve);j.set(ee,E[ue]=r3(ee,ve))}let fe=e[15];const Te=ue=>ue[66].category;for(let ue=0;ue<fe.length;ue+=1){let ve=Jb(e,fe,ue),ee=Te(ve);xe.set(ee,Oe[ue]=o3(ee,ve))}let Ce=e[10];const Le=ue=>ue[63].id;for(let ue=0;ue<Ce.length;ue+=1){let ve=Zb(e,Ce,ue),ee=Le(ve);k.set(ee,lt[ue]=a3(ee,ve))}return{c(){t=jt("section"),n=jt("div"),i=jt("div"),r=jt("div"),s=jt("input"),c=jt("label"),u=Sr(d),f=jt("span"),h=Sr(m),R=jt("div"),M=jt("button"),C=Sr(e[21]),F=jt("span"),N=Sr(O),v=jt("div");for(let ue=0;ue<T.length;ue+=1)T[ue].c();A=jt("div");for(let ue=0;ue<E.length;ue+=1)E[ue].c();H=jt("div"),$=jt("div"),p=jt("div"),I=Sr(e[18]),D=jt("div"),ye=jt("div");for(let ue=0;ue<Oe.length;ue+=1)Oe[ue].c();Ye=jt("div");for(let ue=0;ue<lt.length;ue+=1)lt[ue].c();W=jt("button"),W.textContent="\u{1F600}",de(n,"class","pad-top"),de(s,"id","search"),de(s,"class","search"),de(s,"type","search"),de(s,"role","combobox"),de(s,"enterkeyhint","search"),de(s,"placeholder",o=e[0].searchLabel),de(s,"autocapitalize","none"),de(s,"autocomplete","off"),de(s,"spellcheck","true"),de(s,"aria-expanded",a=!!(e[4]&&e[1].length)),de(s,"aria-controls","search-results"),de(s,"aria-describedby","search-description"),de(s,"aria-autocomplete","list"),de(s,"aria-activedescendant",l=e[26]?`emo-${e[26]}`:""),de(c,"class","sr-only"),de(c,"for","search"),de(f,"id","search-description"),de(f,"class","sr-only"),de(r,"class","search-wrapper"),de(M,"id","skintone-button"),de(M,"class",_="emoji "+(e[6]?"hide-focus":"")),de(M,"aria-label",e[23]),de(M,"title",e[23]),de(M,"aria-describedby","skintone-description"),de(M,"aria-haspopup","listbox"),de(M,"aria-expanded",e[6]),de(M,"aria-controls","skintone-list"),de(R,"class",x="skintone-button-wrapper "+(e[19]?"expanded":"")),de(F,"id","skintone-description"),de(F,"class","sr-only"),de(v,"id","skintone-list"),de(v,"class",g="skintone-list "+(e[6]?"":"hidden no-animate")),ds(v,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),de(v,"role","listbox"),de(v,"aria-label",b=e[0].skinTonesLabel),de(v,"aria-activedescendant",y="skintone-"+e[20]),de(v,"aria-hidden",w=!e[6]),de(i,"class","search-row"),de(A,"class","nav"),de(A,"role","tablist"),ds(A,"grid-template-columns","repeat("+e[12].length+", 1fr)"),de(A,"aria-label",K=e[0].categoriesLabel),de($,"class","indicator"),ds($,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),de(H,"class","indicator-wrapper"),de(p,"class",Z="message "+(e[18]?"":"gone")),de(p,"role","alert"),de(p,"aria-live","polite"),de(D,"class",be="tabpanel "+(!e[14]||e[18]?"gone":"")),de(D,"role",qe=e[4]?"region":"tabpanel"),de(D,"aria-label",Fe=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),de(D,"id",we=e[4]?"":`tab-${e[13].id}`),de(D,"tabindex","0"),de(Ye,"class",L="favorites emoji-menu "+(e[18]?"gone":"")),de(Ye,"role","menu"),de(Ye,"aria-label",q=e[0].favoritesLabel),ds(Ye,"padding-inline-end",e[25]+"px"),de(W,"aria-hidden","true"),de(W,"tabindex","-1"),de(W,"class","abs-pos hidden emoji"),de(t,"class","picker"),de(t,"aria-label",G=e[0].regionLabel),de(t,"style",e[22])},m(ue,ve){hr(ue,t,ve),zt(t,n),zt(t,i),zt(i,r),zt(r,s),Wb(s,e[2]),zt(r,c),zt(c,u),zt(r,f),zt(f,h),zt(i,R),zt(R,M),zt(M,C),zt(i,F),zt(F,N),zt(i,v);for(let ee=0;ee<T.length;ee+=1)T[ee].m(v,null);e[48](v),zt(t,A);for(let ee=0;ee<E.length;ee+=1)E[ee].m(A,null);zt(t,H),zt(H,$),zt(t,p),zt(p,I),zt(t,D),zt(D,ye);for(let ee=0;ee<Oe.length;ee+=1)Oe[ee].m(ye,null);e[50](D),zt(t,Ye);for(let ee=0;ee<lt.length;ee+=1)lt[ee].m(Ye,null);zt(t,W),e[51](W),e[52](t),ie||(ce=[nr(s,"input",e[47]),nr(s,"keydown",e[30]),nr(M,"click",e[35]),nr(v,"focusout",e[38]),nr(v,"click",e[34]),nr(v,"keydown",e[36]),nr(v,"keyup",e[37]),nr(A,"keydown",e[32]),xq(e[29].call(null,ye)),nr(D,"click",e[33]),nr(Ye,"click",e[33])],ie=!0)},p(ue,ve){ve[0]&1&&o!==(o=ue[0].searchLabel)&&de(s,"placeholder",o),ve[0]&18&&a!==(a=!!(ue[4]&&ue[1].length))&&de(s,"aria-expanded",a),ve[0]&67108864&&l!==(l=ue[26]?`emo-${ue[26]}`:"")&&de(s,"aria-activedescendant",l),ve[0]&4&&Wb(s,ue[2]),ve[0]&1&&d!==(d=ue[0].searchLabel+"")&&Tr(u,d),ve[0]&1&&m!==(m=ue[0].searchDescription+"")&&Tr(h,m),ve[0]&2097152&&Tr(C,ue[21]),ve[0]&64&&_!==(_="emoji "+(ue[6]?"hide-focus":""))&&de(M,"class",_),ve[0]&8388608&&de(M,"aria-label",ue[23]),ve[0]&8388608&&de(M,"title",ue[23]),ve[0]&64&&de(M,"aria-expanded",ue[6]),ve[0]&524288&&x!==(x="skintone-button-wrapper "+(ue[19]?"expanded":""))&&de(R,"class",x),ve[0]&1&&O!==(O=ue[0].skinToneDescription+"")&&Tr(N,O),ve[0]&1049089&&(J=ue[9],T=Gl(T,ve,re,1,ue,J,S,v,Kl,i3,null,n3)),ve[0]&64&&g!==(g="skintone-list "+(ue[6]?"":"hidden no-animate"))&&de(v,"class",g),ve[0]&64&&ds(v,"transform","translateY("+(ue[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ve[0]&1&&b!==(b=ue[0].skinTonesLabel)&&de(v,"aria-label",b),ve[0]&1048576&&y!==(y="skintone-"+ue[20])&&de(v,"aria-activedescendant",y),ve[0]&64&&w!==(w=!ue[6])&&de(v,"aria-hidden",w),ve[0]&12305|ve[1]&1&&(Q=ue[12],E=Gl(E,ve,Ee,1,ue,Q,j,A,Kl,r3,null,t3)),ve[0]&4096&&ds(A,"grid-template-columns","repeat("+ue[12].length+", 1fr)"),ve[0]&1&&K!==(K=ue[0].categoriesLabel)&&de(A,"aria-label",K),ve[0]&16779264&&ds($,"transform","translateX("+(ue[24]?-1:1)*ue[11]*100+"%)"),ve[0]&262144&&Tr(I,ue[18]),ve[0]&262144&&Z!==(Z="message "+(ue[18]?"":"gone"))&&de(p,"class",Z),ve[0]&402694449&&(fe=ue[15],Oe=Gl(Oe,ve,Te,1,ue,fe,xe,ye,Kl,o3,null,Jb)),ve[0]&278528&&be!==(be="tabpanel "+(!ue[14]||ue[18]?"gone":""))&&de(D,"class",be),ve[0]&16&&qe!==(qe=ue[4]?"region":"tabpanel")&&de(D,"role",qe),ve[0]&8209&&Fe!==(Fe=ue[4]?ue[0].searchResultsLabel:ue[0].categories[ue[13].name])&&de(D,"aria-label",Fe),ve[0]&8208&&we!==(we=ue[4]?"":`tab-${ue[13].id}`)&&de(D,"id",we),ve[0]&402654464&&(Ce=ue[10],lt=Gl(lt,ve,Le,1,ue,Ce,k,Ye,Kl,a3,null,Zb)),ve[0]&262144&&L!==(L="favorites emoji-menu "+(ue[18]?"gone":""))&&de(Ye,"class",L),ve[0]&1&&q!==(q=ue[0].favoritesLabel)&&de(Ye,"aria-label",q),ve[0]&33554432&&ds(Ye,"padding-inline-end",ue[25]+"px"),ve[0]&1&&G!==(G=ue[0].regionLabel)&&de(t,"aria-label",G),ve[0]&4194304&&de(t,"style",ue[22])},i:Wc,o:Wc,d(ue){ue&&dr(t);for(let ve=0;ve<T.length;ve+=1)T[ve].d();e[48](null);for(let ve=0;ve<E.length;ve+=1)E[ve].d();for(let ve=0;ve<Oe.length;ve+=1)Oe[ve].d();e[50](null);for(let ve=0;ve<lt.length;ve+=1)lt[ve].d();e[51](null),e[52](null),ie=!1,Au(ce)}}}function hz(e,t,n){let{skinToneEmoji:i}=t,{i18n:r}=t,{database:s}=t,{customEmoji:o}=t,{customCategorySorting:a}=t,l=!0,c=[],d=[],u="",f="",m,h,R,M=!1,C=-1,_,x=!1,F=!1,O,N=0,v=0,T,S,g="",b=[],y=[],w,A=qq,E=!1,j=0,K=0,H=ih,$,p=!1,I;const Z=ee=>{m.getRootNode().getElementById(ee).focus()},D=(ee,Ne)=>{m.dispatchEvent(new CustomEvent(ee,{detail:Ne,bubbles:!0,composed:!0}))},ye=(ee,Ne)=>Ne&&ee.skins&&ee.skins[Ne]||ee.unicode,Oe=(ee,Ne)=>sz([ee.name||ye(ee,Ne),...ee.shortcodes||[]]).join(", "),xe=ee=>/^skintone-/.test(ee.id);t1.then(ee=>{ee||n(18,_=r.emojiUnsupportedMessage)});function be(ee){return iz(ee,Ne=>{{const B=getComputedStyle(m),U=parseInt(B.getPropertyValue("--num-columns"),10),z=B.getPropertyValue("direction")==="rtl",X=ee.parentElement.getBoundingClientRect().width-Ne;n(46,A=U),n(25,j=X),n(24,E=z)}})}function qe(ee){const Ne=m.getRootNode();rz(ee,h,U=>Ne.getElementById(`emo-${U.id}`)),n(1,c=c)}function Fe(ee){return!ee.unicode||!Yb(ee)||ep.get(ee.unicode)}async function we(ee){const Ne=await t1;return ee.filter(({version:B})=>!B||B<=Ne)}async function Ye(ee){return tz(ee,await t1)}async function lt(ee){if(typeof ee=="undefined")return[];const Ne=ee===-1?o:await s.getEmojiByGroup(ee);return Ye(await we(Ne))}async function k(ee){return Ye(await we(await s.getEmojiBySearchQuery(ee)))}function L(ee){if(!M||!c.length)return;const Ne=B=>{fs(ee),n(5,C=n1(B,C,c))};switch(ee.key){case"ArrowDown":return Ne(!1);case"ArrowUp":return Ne(!0);case"Enter":if(C!==-1)return fs(ee),G(c[C].id);c.length&&n(5,C=0)}}function q(ee){n(2,u=""),n(44,f=""),n(5,C=-1),n(11,K=H.findIndex(Ne=>Ne.id===ee.id))}function W(ee){const{target:Ne,key:B}=ee,U=z=>{z&&(fs(ee),z.focus())};switch(B){case"ArrowLeft":return U(Ne.previousSibling);case"ArrowRight":return U(Ne.nextSibling);case"Home":return U(Ne.parentElement.firstChild);case"End":return U(Ne.parentElement.lastChild)}}async function G(ee){const Ne=await s.getEmojiByUnicodeOrName(ee),B=[...c,...y].find(z=>z.id===ee),U=B.unicode&&ye(B,N);await s.incrementFavoriteEmojiCount(ee),D("emoji-click",{emoji:Ne,skinTone:N,...U&&{unicode:U},...B.name&&{name:B.name}})}async function ie(ee){const{target:Ne}=ee;if(!Ne.classList.contains("emoji"))return;fs(ee);const B=Ne.id.substring(4);G(B)}async function ce(ee){const{target:Ne}=ee;if(!xe(Ne))return;fs(ee);const B=parseInt(Ne.id.slice(9),10);n(8,N=B),n(6,x=!1),Z("skintone-button"),D("skin-tone-change",{skinTone:B}),s.setPreferredSkinTone(B)}async function J(ee){n(6,x=!x),n(20,v=N),x&&(fs(ee),xh(()=>Z(`skintone-${v}`)))}function re(ee){if(!x)return;const Ne=async B=>{fs(ee),n(20,v=B),await Cq(),Z(`skintone-${v}`)};switch(ee.key){case"ArrowUp":return Ne(n1(!0,v,b));case"ArrowDown":return Ne(n1(!1,v,b));case"Home":return Ne(0);case"End":return Ne(b.length-1);case"Enter":return ce(ee);case"Escape":return fs(ee),n(6,x=!1),Z("skintone-button")}}function Q(ee){if(!!x)switch(ee.key){case" ":return ce(ee)}}async function Ee(ee){const{relatedTarget:Ne}=ee;(!Ne||!xe(Ne))&&n(6,x=!1)}function fe(){u=this.value,n(2,u)}function Te(ee){Ta[ee?"unshift":"push"](()=>{O=ee,n(7,O)})}const Ce=ee=>q(ee);function Le(ee){Ta[ee?"unshift":"push"](()=>{R=ee,n(3,R)})}function ue(ee){Ta[ee?"unshift":"push"](()=>{h=ee,n(17,h)})}function ve(ee){Ta[ee?"unshift":"push"](()=>{m=ee,n(16,m)})}return e.$$set=ee=>{"skinToneEmoji"in ee&&n(40,i=ee.skinToneEmoji),"i18n"in ee&&n(0,r=ee.i18n),"database"in ee&&n(39,s=ee.database),"customEmoji"in ee&&n(41,o=ee.customEmoji),"customCategorySorting"in ee&&n(42,a=ee.customCategorySorting)},e.$$.update=()=>{if(e.$$.dirty[1]&1280&&o&&s&&n(39,s.customEmoji=o,s),e.$$.dirty[0]&1|e.$$.dirty[1]&256){async function ee(){let Ne=!1;const B=setTimeout(()=>{Ne=!0,n(18,_=r.loadingMessage)},Hq);try{await s.ready(),n(14,p=!0)}catch(U){console.error(U),n(18,_=r.networkErrorMessage)}finally{clearTimeout(B),Ne&&(Ne=!1,n(18,_=""))}}s&&ee()}if(e.$$.dirty[0]&6144|e.$$.dirty[1]&1024&&(o&&o.length?n(12,H=[Pq,...ih]):H!==ih&&(K&&n(11,K--,K),n(12,H=ih))),e.$$.dirty[0]&4&&K8(()=>{n(44,f=(u||"").trim()),n(5,C=-1)}),e.$$.dirty[0]&6144&&n(13,$=H[K]),e.$$.dirty[0]&24576|e.$$.dirty[1]&8192){async function ee(){if(!p)n(1,c=[]),n(4,M=!1);else if(f.length>=Uq){const Ne=f,B=await k(Ne);Ne===f&&(n(1,c=B),n(4,M=!0))}else if($){const Ne=$.id,B=await lt(Ne);Ne===$.id&&(n(1,c=B),n(4,M=!1))}}ee()}if(e.$$.dirty[0]&4112&&n(22,S=`
  --font-family: ${G8};
  --num-groups: ${H.length}; 
  --indicator-opacity: ${M?0:1}; 
  --num-skintones: ${Gb};`),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){p&&n(8,N=await s.getPreferredSkinTone())}ee()}if(e.$$.dirty[1]&512&&n(9,b=Array(Gb).fill().map((ee,Ne)=>ez(i,Ne))),e.$$.dirty[0]&768&&n(21,T=b[N]),e.$$.dirty[0]&257&&n(23,g=r.skinToneLabel.replace("{skinTone}",r.skinTones[N])),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){n(45,w=(await Promise.all(zq.map(Ne=>s.getEmojiByUnicodeOrName(Ne)))).filter(Boolean))}p&&ee()}if(e.$$.dirty[0]&16384|e.$$.dirty[1]&49408){async function ee(){const Ne=await s.getTopFavoriteEmoji(A),B=await Ye(Y8([...Ne,...w],U=>U.unicode||U.name).slice(0,A));n(10,y=B)}p&&w&&ee()}if(e.$$.dirty[0]&10){const ee=c.filter(Ne=>Ne.unicode).filter(Ne=>Yb(Ne)&&!ep.has(Ne.unicode));ee.length?xh(()=>qe(ee)):(n(1,c=c.filter(Fe)),xh(()=>{(R||{}).scrollTop=0}))}e.$$.dirty[0]&1026|e.$$.dirty[1]&4096,e.$$.dirty[0]&18|e.$$.dirty[1]&2048&&n(15,d=function(){if(M)return[{category:"",emojis:c}];const Ne=new Map;for(const B of c){const U=B.category||"";let z=Ne.get(U);z||(z=[],Ne.set(U,z)),z.push(B)}return[...Ne.entries()].map(([B,U])=>({category:B,emojis:U})).sort((B,U)=>a(B.category,U.category))}()),e.$$.dirty[0]&34&&n(26,I=C!==-1&&c[C].id),e.$$.dirty[0]&192&&(x?O.addEventListener("transitionend",()=>{n(19,F=!0)},{once:!0}):n(19,F=!1))},[r,c,u,R,M,C,x,O,N,b,y,K,H,$,p,d,m,h,_,F,v,T,S,g,E,j,I,ye,Oe,be,L,q,W,ie,ce,J,re,Q,Ee,s,i,o,a,l,f,w,A,fe,Te,Ce,Le,ue,ve]}class dz extends Bq{constructor(t){super(),Dq(this,t,hz,uz,kq,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const fz="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",mz="en";var pz={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading\u2026",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const X8=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Q8 extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const n=document.createElement("style");n.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(n),this._ctx={locale:mz,dataSource:fz,skinToneEmoji:Vq,customCategorySorting:$q,customEmoji:null,i18n:pz,...t};for(const i of X8)i!=="database"&&Object.prototype.hasOwnProperty.call(this,i)&&(this._ctx[i]=this[i],delete this[i]);this._dbFlush()}connectedCallback(){this._cmp=new dz({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t&&t.close().catch(n=>console.error(n))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(t,n,i){this._set(t.replace(/-([a-z])/g,(r,s)=>s.toUpperCase()),i)}_set(t,n){this._ctx[t]=n,this._cmp&&this._cmp.$set({[t]:n}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:n,database:i}=this._ctx;(!i||i.locale!==t||i.dataSource!==n)&&this._set("database",new j8({locale:t,dataSource:n}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const Z8={};for(const e of X8)Z8[e]={get(){return e==="database"&&this._dbCreate(),this._ctx[e]},set(t){if(e==="database")throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(Q8.prototype,Z8);customElements.get("emoji-picker")||customElements.define("emoji-picker",Q8);function J8(e,t){for(;e&&!e.querySelector(t);){e=e.parentNode;const n=e.querySelector(t);if(n)return n}return null}const gz={name:"EmojiPickerContainer",components:{SvgIcon:Bn},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:t})=>{this.$emit("add-emoji",{unicode:t.unicode})})},0)}},methods:{addCustomStyling(){const e=`.picker {
				border: none;
			}`,t=`.nav {
				overflow-x: auto;
			}`,n=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,i=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,r=document.createElement("style");r.textContent=e+t+n+i,this.$refs.emojiPicker.shadowRoot.appendChild(r)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,n){const i=t<500||n<700,r=J8(this.$el,"#room-footer");if(!r){i&&(this.emojiPickerRight="-50px");return}i?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200):(r.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},_z={class:"vac-emoji-wrapper"};function vz(e,t,n,i,r,s){const o=Ze("svg-icon"),a=Ze("emoji-picker");return ae(),_e("div",_z,[Me("div",{class:mt(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:t[0]||(t[0]=(...l)=>s.openEmoji&&s.openEmoji(...l))},[Pe(e.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},()=>[Ve(o,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])])],2),n.emojiOpened?(ae(),Lt(fn,{key:0,name:"vac-slide-up",appear:""},{default:Je(()=>[Me("div",{class:mt(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:Zt({height:`${r.emojiPickerHeight}px`,top:n.positionTop?r.emojiPickerHeight:`${r.emojiPickerTop}px`,right:r.emojiPickerRight,display:r.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(ae(),Lt(a,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):Be("",!0)],6)]),_:1})):Be("",!0)])}var eS=Yt(gz,[["render",vz]]);const yz={name:"RoomFiles",components:{Loader:Yf,SvgIcon:Bn},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return nl(this.file)},isVideo(){return ku(this.file)}}},bz={class:"vac-room-file-container"},wz=["src"],Ez={class:"vac-text-ellipsis"},Sz={key:0,class:"vac-text-ellipsis vac-text-extension"};function Tz(e,t,n,i,r,s){const o=Ze("loader"),a=Ze("svg-icon");return ae(),_e("div",bz,[Ve(o,{show:n.file.loading,type:"room-file"},Vt({_:2},[ht(e.$slots,(l,c)=>({name:c,fn:Je(d=>[Pe(e.$slots,c,Ht(Bt(d)))])}))]),1032,["show"]),Me("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=l=>e.$emit("remove-file",n.index))},[Pe(e.$slots,"image-close-icon",{},()=>[Ve(a,{name:"close",param:"image"})])]),s.isImage?(ae(),_e("div",{key:0,class:mt(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:Zt({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):s.isVideo?(ae(),_e("video",{key:1,controls:"",class:mt({"vac-blur-loading":n.file.loading})},[Me("source",{src:n.file.localUrl||n.file.url},null,8,wz)],2)):(ae(),_e("div",{key:2,class:mt(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[Me("div",null,[Pe(e.$slots,"file-icon",{},()=>[Ve(a,{name:"file"})])]),Me("div",Ez,ot(n.file.name),1),n.file.extension?(ae(),_e("div",Sz,ot(n.file.extension),1)):Be("",!0)],2))])}var kz=Yt(yz,[["render",Tz]]);const Az={name:"RoomFiles",components:{SvgIcon:Bn,RoomFile:kz},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},xz={key:0,class:"vac-room-files-container"},Cz={class:"vac-files-box"},Iz={class:"vac-icon-close"};function Rz(e,t,n,i,r,s){const o=Ze("room-file"),a=Ze("svg-icon");return ae(),Lt(fn,{name:"vac-slide-up"},{default:Je(()=>[n.files.length?(ae(),_e("div",xz,[Me("div",Cz,[(ae(!0),_e(wt,null,ht(n.files,(l,c)=>(ae(),_e("div",{key:c},[Ve(o,{file:l,index:c,onRemoveFile:t[0]||(t[0]=d=>e.$emit("remove-file",d))},Vt({_:2},[ht(e.$slots,(d,u)=>({name:u,fn:Je(f=>[Pe(e.$slots,u,Ht(Bt(f)))])}))]),1032,["file","index"])]))),128))]),Me("div",Iz,[Me("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=l=>e.$emit("reset-message"))},[Pe(e.$slots,"files-close-icon",{},()=>[Ve(a,{name:"close-outline"})])])])])):Be("",!0)]),_:3})}var Mz=Yt(Az,[["render",Rz]]);const Oz={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const n=t.getBoundingClientRect().width,i=t.getBoundingClientRect().left;let r=(e.clientX-i)/n;return r=r<0?0:r,r=r>1?1:r,r}}},Nz={class:"vac-player-progress"},Fz={class:"vac-line-container"};function Lz(e,t,n,i,r,s){return ae(),_e("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...o)=>s.onMouseDown&&s.onMouseDown(...o)),onMouseover:t[1]||(t[1]=o=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=o=>e.$emit("hover-audio-progress",!1))},[Me("div",Nz,[Me("div",Fz,[Me("div",{class:"vac-line-progress",style:Zt({width:`${n.percentage}%`})},null,4),Me("div",{class:mt(["vac-line-dot",{"vac-line-dot__active":r.isMouseDown}]),style:Zt({left:`${n.percentage}%`})},null,6)])])],544)}var Dz=Yt(Oz,[["render",Lz]]);const Bz={name:"AudioPlayer",components:{SvgIcon:Bn,AudioControl:Dz},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(e*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Pz={class:"vac-audio-player"},Uz=["id","src"];function jz(e,t,n,i,r,s){const o=Ze("svg-icon"),a=Ze("audio-control");return ae(),_e("div",null,[Me("div",Pz,[Me("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...l)=>s.playback&&s.playback(...l))},[r.isPlaying?Pe(e.$slots,"audio-pause-icon_"+n.messageId,{key:0},()=>[Ve(o,{name:"audio-pause"})]):Pe(e.$slots,"audio-play-icon_"+n.messageId,{key:1},()=>[Ve(o,{name:"audio-play"})])]),Ve(a,{percentage:r.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:s.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=l=>e.$emit("hover-audio-progress",l))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Me("audio",{id:s.playerUniqId,src:s.audioSource},null,8,Uz)])])}var cv=Yt(Bz,[["render",jz]]);const Hz={name:"RoomMessageReply",components:{SvgIcon:Bn,FormatMessage:Tu,AudioPlayer:cv},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(t=(e=this.messageReply)==null?void 0:e.files)!=null&&t.length?this.messageReply.files[0]:{}},isImage(){return nl(this.firstFile)},isVideo(){return ku(this.firstFile)},isAudio(){return Zf(this.firstFile)},isOtherFile(){var e,t;return((t=(e=this.messageReply)==null?void 0:e.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Vz={key:0,class:"vac-reply-container"},qz={class:"vac-reply-box"},zz={class:"vac-reply-info"},$z={class:"vac-reply-username"},Wz={class:"vac-reply-content"},Kz=["src"],Gz={key:1,controls:"",class:"vac-image-reply"},Yz=["src"],Xz={key:3,class:"vac-image-reply vac-file-container"},Qz={class:"vac-text-ellipsis"},Zz={key:0,class:"vac-text-ellipsis vac-text-extension"},Jz={class:"vac-icon-reply"};function e$(e,t,n,i,r,s){const o=Ze("format-message"),a=Ze("audio-player"),l=Ze("svg-icon");return ae(),Lt(fn,{name:"vac-slide-up"},{default:Je(()=>[n.messageReply?(ae(),_e("div",Vz,[Me("div",qz,[Me("div",zz,[Me("div",$z,ot(n.messageReply.username),1),Me("div",Wz,[Ve(o,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),s.isImage?(ae(),_e("img",{key:0,src:s.firstFile.url,class:"vac-image-reply"},null,8,Kz)):s.isVideo?(ae(),_e("video",Gz,[Me("source",{src:s.firstFile.url},null,8,Yz)])):s.isAudio?(ae(),Lt(a,{key:2,src:s.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["src"])):s.isOtherFile?(ae(),_e("div",Xz,[Me("div",null,[Pe(e.$slots,"file-icon",{},()=>[Ve(l,{name:"file"})])]),Me("div",Qz,ot(s.firstFile.name),1),s.firstFile.extension?(ae(),_e("div",Zz,ot(s.firstFile.extension),1)):Be("",!0)])):Be("",!0)]),Me("div",Jz,[Me("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=c=>e.$emit("reset-message"))},[Pe(e.$slots,"reply-close-icon",{},()=>[Ve(l,{name:"close-outline"})])])])])):Be("",!0)]),_:3})}var t$=Yt(Hz,[["render",e$]]);const n$={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},i$={key:0,class:"vac-tags-container"},r$=["onMouseover","onClick"],s$={class:"vac-tags-info"},o$={class:"vac-tags-username"};function a$(e,t,n,i,r,s){return ae(),Lt(fn,{name:"vac-slide-up"},{default:Je(()=>[n.filteredUsersTag.length?(ae(),_e("div",i$,[(ae(!0),_e(wt,null,ht(n.filteredUsersTag,(o,a)=>(ae(),_e("div",{key:o._id,class:mt(["vac-tags-box",{"vac-tags-box-active":a===r.activeItem}]),onMouseover:l=>r.activeItem=a,onClick:l=>e.$emit("select-user-tag",o)},[Me("div",s$,[o.avatar?(ae(),_e("div",{key:0,class:"vac-avatar vac-tags-avatar",style:Zt({"background-image":`url('${o.avatar}')`})},null,4)):Be("",!0),Me("div",o$,ot(o.username),1)])],42,r$))),128))])):Be("",!0)]),_:1})}var l$=Yt(n$,[["render",a$]]);const c$={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},u$={key:0,class:"vac-emojis-container"},h$=["onMouseover","onClick"];function d$(e,t,n,i,r,s){return ae(),Lt(fn,{name:"vac-slide-up"},{default:Je(()=>[n.filteredEmojis.length?(ae(),_e("div",u$,[(ae(!0),_e(wt,null,ht(n.filteredEmojis,(o,a)=>(ae(),_e("div",{key:o,class:mt(["vac-emoji-element",{"vac-emoji-element-active":a===r.activeItem}]),onMouseover:l=>r.activeItem=a,onClick:l=>e.$emit("select-emoji",o)},ot(o),43,h$))),128))])):Be("",!0)]),_:1})}var f$=Yt(c$,[["render",d$]]);const m$={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},p$={key:0,class:"vac-template-container vac-app-box-shadow"},g$=["onMouseover","onClick"],_$={class:"vac-template-info"},v$={class:"vac-template-tag"},y$={class:"vac-template-text"};function b$(e,t,n,i,r,s){return ae(),Lt(fn,{name:"vac-slide-up"},{default:Je(()=>[n.filteredTemplatesText.length?(ae(),_e("div",p$,[(ae(!0),_e(wt,null,ht(n.filteredTemplatesText,(o,a)=>(ae(),_e("div",{key:a,class:mt(["vac-template-box",{"vac-template-active":a===r.activeItem}]),onMouseover:l=>r.activeItem=a,onClick:l=>e.$emit("select-template-text",o)},[Me("div",_$,[Me("div",v$," /"+ot(o.tag),1),Me("div",y$,ot(o.text),1)])],42,g$))),128))])):Be("",!0)]),_:1})}var w$=Yt(m$,[["render",b$]]);function E$(e){return new Int8Array(e)}function tS(e){return new Int16Array(e)}function nS(e){return new Int32Array(e)}function iS(e){return new Float32Array(e)}function S$(e){return new Float64Array(e)}function rS(e){if(e.length==1)return iS(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(rS(e));return n}function sS(e){if(e.length==1)return nS(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(sS(e));return n}function oS(e){if(e.length==1)return tS(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(oS(e));return n}function aS(e){if(e.length==1)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(aS(e));return n}var lS={};lS.fill=function(e,t,n,i){if(arguments.length==2)for(var r=0;r<e.length;r++)e[r]=arguments[1];else for(var r=t;r<n;r++)e[r]=i};var xu={};xu.arraycopy=function(e,t,n,i,r){for(var s=t+r;t<s;)n[i++]=e[t++]};xu.out={};xu.out.println=function(e){console.log(e)};xu.out.printf=function(){console.log.apply(console,arguments)};var Jf={};Jf.SQRT2=1.4142135623730951;Jf.FAST_LOG10=function(e){return Math.log10(e)};Jf.FAST_LOG10_X=function(e,t){return Math.log10(e)*t};function is(e){this.ordinal=e}is.short_block_allowed=new is(0);is.short_block_coupled=new is(1);is.short_block_dispensed=new is(2);is.short_block_forced=new is(3);var cS={};cS.MAX_VALUE=34028235e31;function ji(e){this.ordinal=e}ji.vbr_off=new ji(0);ji.vbr_mt=new ji(1);ji.vbr_rh=new ji(2);ji.vbr_abr=new ji(3);ji.vbr_mtrh=new ji(4);ji.vbr_default=ji.vbr_mtrh;var T$=function(e){},De={System:xu,VbrMode:ji,Float:cS,ShortBlock:is,Util:Jf,Arrays:lS,new_array_n:aS,new_byte:E$,new_double:S$,new_float:iS,new_float_n:rS,new_int:nS,new_int_n:sS,new_short:tS,new_short_n:oS,assert:T$},k$=De.System,ln=De.Util,A$=De.Arrays,x$=De.new_float;function C$(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*ln.SQRT2*.5/2384e-9,.017876148*ln.SQRT2*.5/2384e-9,.003134727*ln.SQRT2*.5/2384e-9,.002457142*ln.SQRT2*.5/2384e-9,971317e-9*ln.SQRT2*.5/2384e-9,218868e-9*ln.SQRT2*.5/2384e-9,101566e-9*ln.SQRT2*.5/2384e-9,13828e-9*ln.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,n=36,i=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],r=i[P.SHORT_TYPE],s=i[P.SHORT_TYPE],o=i[P.SHORT_TYPE],a=i[P.SHORT_TYPE],l=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(f,m,h){for(var R=10,M=m+238-14-286,C=-15;C<0;C++){var _,x,F;_=e[R+-10],x=f[M+-224]*_,F=f[m+224]*_,_=e[R+-9],x+=f[M+-160]*_,F+=f[m+160]*_,_=e[R+-8],x+=f[M+-96]*_,F+=f[m+96]*_,_=e[R+-7],x+=f[M+-32]*_,F+=f[m+32]*_,_=e[R+-6],x+=f[M+32]*_,F+=f[m+-32]*_,_=e[R+-5],x+=f[M+96]*_,F+=f[m+-96]*_,_=e[R+-4],x+=f[M+160]*_,F+=f[m+-160]*_,_=e[R+-3],x+=f[M+224]*_,F+=f[m+-224]*_,_=e[R+-2],x+=f[m+-256]*_,F-=f[M+256]*_,_=e[R+-1],x+=f[m+-192]*_,F-=f[M+192]*_,_=e[R+0],x+=f[m+-128]*_,F-=f[M+128]*_,_=e[R+1],x+=f[m+-64]*_,F-=f[M+64]*_,_=e[R+2],x+=f[m+0]*_,F-=f[M+0]*_,_=e[R+3],x+=f[m+64]*_,F-=f[M+-64]*_,_=e[R+4],x+=f[m+128]*_,F-=f[M+-128]*_,_=e[R+5],x+=f[m+192]*_,F-=f[M+-192]*_,x*=e[R+6],_=F-x,h[30+C*2]=F+x,h[31+C*2]=e[R+7]*_,R+=18,m--,M++}{var x,F,O,N;F=f[m+-16]*e[R+-10],x=f[m+-32]*e[R+-2],F+=(f[m+-48]-f[m+16])*e[R+-9],x+=f[m+-96]*e[R+-1],F+=(f[m+-80]+f[m+48])*e[R+-8],x+=f[m+-160]*e[R+0],F+=(f[m+-112]-f[m+80])*e[R+-7],x+=f[m+-224]*e[R+1],F+=(f[m+-144]+f[m+112])*e[R+-6],x-=f[m+32]*e[R+2],F+=(f[m+-176]-f[m+144])*e[R+-5],x-=f[m+96]*e[R+3],F+=(f[m+-208]+f[m+176])*e[R+-4],x-=f[m+160]*e[R+4],F+=(f[m+-240]-f[m+208])*e[R+-3],x-=f[m+224],O=x-F,N=x+F,F=h[14],x=h[15]-F,h[31]=N+F,h[30]=O+x,h[15]=O-x,h[14]=N-F}{var v;v=h[28]-h[0],h[0]+=h[28],h[28]=v*e[R+-2*18+7],v=h[29]-h[1],h[1]+=h[29],h[29]=v*e[R+-2*18+7],v=h[26]-h[2],h[2]+=h[26],h[26]=v*e[R+-4*18+7],v=h[27]-h[3],h[3]+=h[27],h[27]=v*e[R+-4*18+7],v=h[24]-h[4],h[4]+=h[24],h[24]=v*e[R+-6*18+7],v=h[25]-h[5],h[5]+=h[25],h[25]=v*e[R+-6*18+7],v=h[22]-h[6],h[6]+=h[22],h[22]=v*ln.SQRT2,v=h[23]-h[7],h[7]+=h[23],h[23]=v*ln.SQRT2-h[7],h[7]-=h[6],h[22]-=h[7],h[23]-=h[22],v=h[6],h[6]=h[31]-v,h[31]=h[31]+v,v=h[7],h[7]=h[30]-v,h[30]=h[30]+v,v=h[22],h[22]=h[15]-v,h[15]=h[15]+v,v=h[23],h[23]=h[14]-v,h[14]=h[14]+v,v=h[20]-h[8],h[8]+=h[20],h[20]=v*e[R+-10*18+7],v=h[21]-h[9],h[9]+=h[21],h[21]=v*e[R+-10*18+7],v=h[18]-h[10],h[10]+=h[18],h[18]=v*e[R+-12*18+7],v=h[19]-h[11],h[11]+=h[19],h[19]=v*e[R+-12*18+7],v=h[16]-h[12],h[12]+=h[16],h[16]=v*e[R+-14*18+7],v=h[17]-h[13],h[13]+=h[17],h[17]=v*e[R+-14*18+7],v=-h[20]+h[24],h[20]+=h[24],h[24]=v*e[R+-12*18+7],v=-h[21]+h[25],h[21]+=h[25],h[25]=v*e[R+-12*18+7],v=h[4]-h[8],h[4]+=h[8],h[8]=v*e[R+-12*18+7],v=h[5]-h[9],h[5]+=h[9],h[9]=v*e[R+-12*18+7],v=h[0]-h[12],h[0]+=h[12],h[12]=v*e[R+-4*18+7],v=h[1]-h[13],h[1]+=h[13],h[13]=v*e[R+-4*18+7],v=h[16]-h[28],h[16]+=h[28],h[28]=v*e[R+-4*18+7],v=-h[17]+h[29],h[17]+=h[29],h[29]=v*e[R+-4*18+7],v=ln.SQRT2*(h[2]-h[10]),h[2]+=h[10],h[10]=v,v=ln.SQRT2*(h[3]-h[11]),h[3]+=h[11],h[11]=v,v=ln.SQRT2*(-h[18]+h[26]),h[18]+=h[26],h[26]=v-h[18],v=ln.SQRT2*(-h[19]+h[27]),h[19]+=h[27],h[27]=v-h[19],v=h[2],h[19]-=h[3],h[3]-=v,h[2]=h[31]-v,h[31]+=v,v=h[3],h[11]-=h[19],h[18]-=v,h[3]=h[30]-v,h[30]+=v,v=h[18],h[27]-=h[11],h[19]-=v,h[18]=h[15]-v,h[15]+=v,v=h[19],h[10]-=v,h[19]=h[14]-v,h[14]+=v,v=h[10],h[11]-=v,h[10]=h[23]-v,h[23]+=v,v=h[11],h[26]-=v,h[11]=h[22]-v,h[22]+=v,v=h[26],h[27]-=v,h[26]=h[7]-v,h[7]+=v,v=h[27],h[27]=h[6]-v,h[6]+=v,v=ln.SQRT2*(h[0]-h[4]),h[0]+=h[4],h[4]=v,v=ln.SQRT2*(h[1]-h[5]),h[1]+=h[5],h[5]=v,v=ln.SQRT2*(h[16]-h[20]),h[16]+=h[20],h[20]=v,v=ln.SQRT2*(h[17]-h[21]),h[17]+=h[21],h[21]=v,v=-ln.SQRT2*(h[8]-h[12]),h[8]+=h[12],h[12]=v-h[8],v=-ln.SQRT2*(h[9]-h[13]),h[9]+=h[13],h[13]=v-h[9],v=-ln.SQRT2*(h[25]-h[29]),h[25]+=h[29],h[29]=v-h[25],v=-ln.SQRT2*(h[24]+h[28]),h[24]-=h[28],h[28]=v-h[24],v=h[24]-h[16],h[24]=v,v=h[20]-v,h[20]=v,v=h[28]-v,h[28]=v,v=h[25]-h[17],h[25]=v,v=h[21]-v,h[21]=v,v=h[29]-v,h[29]=v,v=h[17]-h[1],h[17]=v,v=h[9]-v,h[9]=v,v=h[25]-v,h[25]=v,v=h[5]-v,h[5]=v,v=h[21]-v,h[21]=v,v=h[13]-v,h[13]=v,v=h[29]-v,h[29]=v,v=h[1]-h[0],h[1]=v,v=h[16]-v,h[16]=v,v=h[17]-v,h[17]=v,v=h[8]-v,h[8]=v,v=h[9]-v,h[9]=v,v=h[24]-v,h[24]=v,v=h[25]-v,h[25]=v,v=h[4]-v,h[4]=v,v=h[5]-v,h[5]=v,v=h[20]-v,h[20]=v,v=h[21]-v,h[21]=v,v=h[12]-v,h[12]=v,v=h[13]-v,h[13]=v,v=h[28]-v,h[28]=v,v=h[29]-v,h[29]=v,v=h[0],h[0]+=h[31],h[31]-=v,v=h[1],h[1]+=h[30],h[30]-=v,v=h[16],h[16]+=h[15],h[15]-=v,v=h[17],h[17]+=h[14],h[14]-=v,v=h[8],h[8]+=h[23],h[23]-=v,v=h[9],h[9]+=h[22],h[22]-=v,v=h[24],h[24]+=h[7],h[7]-=v,v=h[25],h[25]+=h[6],h[6]-=v,v=h[4],h[4]+=h[27],h[27]-=v,v=h[5],h[5]+=h[26],h[26]-=v,v=h[20],h[20]+=h[11],h[11]-=v,v=h[21],h[21]+=h[10],h[10]-=v,v=h[12],h[12]+=h[19],h[19]-=v,v=h[13],h[13]+=h[18],h[18]-=v,v=h[28],h[28]+=h[3],h[3]-=v,v=h[29],h[29]+=h[2],h[2]-=v}}function d(f,m){for(var h=0;h<3;h++){var R,M,C,_,x,F;_=f[m+2*3]*i[P.SHORT_TYPE][0]-f[m+5*3],R=f[m+0*3]*i[P.SHORT_TYPE][2]-f[m+3*3],M=_+R,C=_-R,_=f[m+5*3]*i[P.SHORT_TYPE][0]+f[m+2*3],R=f[m+3*3]*i[P.SHORT_TYPE][2]+f[m+0*3],x=_+R,F=-_+R,R=(f[m+1*3]*i[P.SHORT_TYPE][1]-f[m+4*3])*2069978111953089e-26,_=(f[m+4*3]*i[P.SHORT_TYPE][1]+f[m+1*3])*2069978111953089e-26,f[m+3*0]=M*190752519173728e-25+R,f[m+3*5]=-x*190752519173728e-25+_,C=C*.8660254037844387*1907525191737281e-26,x=x*.5*1907525191737281e-26+_,f[m+3*1]=C-x,f[m+3*2]=C+x,M=M*.5*1907525191737281e-26-R,F=F*.8660254037844387*1907525191737281e-26,f[m+3*3]=M+F,f[m+3*4]=M-F,m++}}function u(f,m,h){var R,M;{var C,_,x,F,O,N,v,T;C=h[17]-h[9],x=h[15]-h[11],F=h[14]-h[12],O=h[0]+h[8],N=h[1]+h[7],v=h[2]+h[6],T=h[3]+h[5],f[m+17]=O+v-T-(N-h[4]),M=(O+v-T)*s[12+7]+(N-h[4]),R=(C-x-F)*s[12+6],f[m+5]=R+M,f[m+6]=R-M,_=(h[16]-h[10])*s[12+6],N=N*s[12+7]+h[4],R=C*s[12+0]+_+x*s[12+1]+F*s[12+2],M=-O*s[12+4]+N-v*s[12+5]+T*s[12+3],f[m+1]=R+M,f[m+2]=R-M,R=C*s[12+1]-_-x*s[12+2]+F*s[12+0],M=-O*s[12+5]+N-v*s[12+3]+T*s[12+4],f[m+9]=R+M,f[m+10]=R-M,R=C*s[12+2]-_+x*s[12+0]-F*s[12+1],M=O*s[12+3]-N+v*s[12+4]-T*s[12+5],f[m+13]=R+M,f[m+14]=R-M}{var S,g,b,y,w,A,E,j;S=h[8]-h[0],b=h[6]-h[2],y=h[5]-h[3],w=h[17]+h[9],A=h[16]+h[10],E=h[15]+h[11],j=h[14]+h[12],f[m+0]=w+E+j+(A+h[13]),R=(w+E+j)*s[12+7]-(A+h[13]),M=(S-b+y)*s[12+6],f[m+11]=R+M,f[m+12]=R-M,g=(h[7]-h[1])*s[12+6],A=h[13]-A*s[12+7],R=w*s[12+3]-A+E*s[12+4]+j*s[12+5],M=S*s[12+2]+g+b*s[12+0]+y*s[12+1],f[m+3]=R+M,f[m+4]=R-M,R=-w*s[12+5]+A-E*s[12+3]-j*s[12+4],M=S*s[12+1]+g-b*s[12+2]-y*s[12+0],f[m+7]=R+M,f[m+8]=R-M,R=-w*s[12+4]+A-E*s[12+5]-j*s[12+3],M=S*s[12+0]-g+b*s[12+1]-y*s[12+2],f[m+15]=R+M,f[m+16]=R-M}}this.mdct_sub48=function(f,m,h){for(var R=m,M=286,C=0;C<f.channels_out;C++){for(var _=0;_<f.mode_gr;_++){for(var x,F=f.l3_side.tt[_][C],O=F.xr,N=0,v=f.sb_sample[C][1-_],T=0,S=0;S<18/2;S++)for(c(R,M,v[T]),c(R,M+32,v[T+1]),T+=2,M+=64,x=1;x<32;x+=2)v[T-1][x]*=-1;for(x=0;x<32;x++,N+=18){var g=F.block_type,b=f.sb_sample[C][_],y=f.sb_sample[C][1-_];if(F.mixed_block_flag!=0&&x<2&&(g=0),f.amp_filter[x]<1e-12)A$.fill(O,N+0,N+18,0);else{if(f.amp_filter[x]<1)for(var S=0;S<18;S++)y[S][l[x]]*=f.amp_filter[x];if(g==P.SHORT_TYPE){for(var S=-t/4;S<0;S++){var w=i[P.SHORT_TYPE][S+3];O[N+S*3+9]=b[9+S][l[x]]*w-b[8-S][l[x]],O[N+S*3+18]=b[14-S][l[x]]*w+b[15+S][l[x]],O[N+S*3+10]=b[15+S][l[x]]*w-b[14-S][l[x]],O[N+S*3+19]=y[2-S][l[x]]*w+y[3+S][l[x]],O[N+S*3+11]=y[3+S][l[x]]*w-y[2-S][l[x]],O[N+S*3+20]=y[8-S][l[x]]*w+y[9+S][l[x]]}d(O,N)}else{for(var A=x$(18),S=-n/4;S<0;S++){var E,j;E=i[g][S+27]*y[S+9][l[x]]+i[g][S+36]*y[8-S][l[x]],j=i[g][S+9]*b[S+9][l[x]]-i[g][S+18]*b[8-S][l[x]],A[S+9]=E-j*r[3+S+9],A[S+18]=E*r[3+S+9]+j}u(O,N,A)}}if(g!=P.SHORT_TYPE&&x!=0)for(var S=7;S>=0;--S){var K,H;K=O[N+S]*o[20+S]+O[N+-1-S]*a[28+S],H=O[N+S]*a[28+S]-O[N+-1-S]*o[20+S],O[N+-1-S]=K,O[N+S]=H}}}if(R=h,M=286,f.mode_gr==1)for(var $=0;$<18;$++)k$.arraycopy(f.sb_sample[C][1][$],0,f.sb_sample[C][0][$],0,32)}}}var I$=De.System,R$=De.new_float,M$=De.new_float_n;function xd(){this.l=R$(P.SBMAX_l),this.s=M$([P.SBMAX_s,3]);var e=this;this.assign=function(t){I$.arraycopy(t.l,0,e.l,0,P.SBMAX_l);for(var n=0;n<P.SBMAX_s;n++)for(var i=0;i<3;i++)e.s[n][i]=t.s[n][i]}}function ms(){this.thm=new xd,this.en=new xd}function It(e){var t=e;this.ordinal=function(){return t}}It.STEREO=new It(0);It.JOINT_STEREO=new It(1);It.DUAL_CHANNEL=new It(2);It.MONO=new It(3);It.NOT_SET=new It(4);var l3=De.System,rh=De.VbrMode,c3=De.new_array_n,u3=De.new_float,O$=De.new_float_n,N$=De.new_int,sh=De.assert;P.ENCDELAY=576;P.POSTDELAY=1152;P.MDCTDELAY=48;P.FFTOFFSET=224+P.MDCTDELAY;P.DECDELAY=528;P.SBLIMIT=32;P.CBANDS=64;P.SBPSY_l=21;P.SBPSY_s=12;P.SBMAX_l=22;P.SBMAX_s=13;P.PSFB21=6;P.PSFB12=6;P.BLKSIZE=1024;P.HBLKSIZE=P.BLKSIZE/2+1;P.BLKSIZE_s=256;P.HBLKSIZE_s=P.BLKSIZE_s/2+1;P.NORM_TYPE=0;P.START_TYPE=1;P.SHORT_TYPE=2;P.STOP_TYPE=3;P.MPG_MD_LR_LR=0;P.MPG_MD_LR_I=1;P.MPG_MD_MS_LR=2;P.MPG_MD_MS_I=3;P.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function P(){var e=P.FFTOFFSET,t=P.MPG_MD_MS_LR,n=null;this.psy=null;var i=null,r=null,s=null;this.setModules=function(d,u,f,m){n=d,this.psy=u,i=u,r=m,s=f};var o=new C$;function a(d){var u,f;if(d.ATH.useAdjust==0){d.ATH.adjust=1;return}if(f=d.loudness_sq[0][0],u=d.loudness_sq[1][0],d.channels_out==2?(f+=d.loudness_sq[0][1],u+=d.loudness_sq[1][1]):(f+=f,u+=u),d.mode_gr==2&&(f=Math.max(f,u)),f*=.5,f*=d.ATH.aaSensitivityP,f>.03125)d.ATH.adjust>=1?d.ATH.adjust=1:d.ATH.adjust<d.ATH.adjustLimit&&(d.ATH.adjust=d.ATH.adjustLimit),d.ATH.adjustLimit=1;else{var m=31.98*f+625e-6;d.ATH.adjust>=m?(d.ATH.adjust*=m*.075+.925,d.ATH.adjust<m&&(d.ATH.adjust=m)):d.ATH.adjustLimit>=m?d.ATH.adjust=m:d.ATH.adjust<d.ATH.adjustLimit&&(d.ATH.adjust=d.ATH.adjustLimit),d.ATH.adjustLimit=m}}function l(d){var u,f;for(sh(d.bitrate_index>=0&&d.bitrate_index<16),sh(d.mode_ext>=0&&d.mode_ext<4),d.bitrate_stereoMode_Hist[d.bitrate_index][4]++,d.bitrate_stereoMode_Hist[15][4]++,d.channels_out==2&&(d.bitrate_stereoMode_Hist[d.bitrate_index][d.mode_ext]++,d.bitrate_stereoMode_Hist[15][d.mode_ext]++),u=0;u<d.mode_gr;++u)for(f=0;f<d.channels_out;++f){var m=d.l3_side.tt[u][f].block_type|0;d.l3_side.tt[u][f].mixed_block_flag!=0&&(m=4),d.bitrate_blockType_Hist[d.bitrate_index][m]++,d.bitrate_blockType_Hist[d.bitrate_index][5]++,d.bitrate_blockType_Hist[15][m]++,d.bitrate_blockType_Hist[15][5]++}}function c(d,u){var f=d.internal_flags,m,h;if(f.lame_encode_frame_init==0){var R,M,C=u3(2014),_=u3(286+1152+576);for(f.lame_encode_frame_init=1,R=0,M=0;R<286+576*(1+f.mode_gr);++R)R<576*f.mode_gr?(C[R]=0,f.channels_out==2&&(_[R]=0)):(C[R]=u[0][M],f.channels_out==2&&(_[R]=u[1][M]),++M);for(h=0;h<f.mode_gr;h++)for(m=0;m<f.channels_out;m++)f.l3_side.tt[h][m].block_type=P.SHORT_TYPE;o.mdct_sub48(f,C,_),sh(f.mf_size>=P.BLKSIZE+d.framesize-P.FFTOFFSET),sh(f.mf_size>=512+d.framesize-32)}}this.lame_encode_mp3_frame=function(d,u,f,m,h,R){var M,C=c3([2,2]);C[0][0]=new ms,C[0][1]=new ms,C[1][0]=new ms,C[1][1]=new ms;var _=c3([2,2]);_[0][0]=new ms,_[0][1]=new ms,_[1][0]=new ms,_[1][1]=new ms;var x,F=[null,null],O=d.internal_flags,N=O$([2,4]),v=[.5,.5],T=[[0,0],[0,0]],S=[[0,0],[0,0]],g,b,y;if(F[0]=u,F[1]=f,O.lame_encode_frame_init==0&&c(d,F),O.padding=0,(O.slot_lag-=O.frac_SpF)<0&&(O.slot_lag+=d.out_samplerate,O.padding=1),O.psymodel!=0){var w,A=[null,null],E=0,j=N$(2);for(y=0;y<O.mode_gr;y++){for(b=0;b<O.channels_out;b++)A[b]=F[b],E=576+y*576-P.FFTOFFSET;if(d.VBR==rh.vbr_mtrh||d.VBR==rh.vbr_mt?w=i.L3psycho_anal_vbr(d,A,E,y,C,_,T[y],S[y],N[y],j):w=i.L3psycho_anal_ns(d,A,E,y,C,_,T[y],S[y],N[y],j),w!=0)return-4;for(d.mode==It.JOINT_STEREO&&(v[y]=N[y][2]+N[y][3],v[y]>0&&(v[y]=N[y][3]/v[y])),b=0;b<O.channels_out;b++){var K=O.l3_side.tt[y][b];K.block_type=j[b],K.mixed_block_flag=0}}}else for(y=0;y<O.mode_gr;y++)for(b=0;b<O.channels_out;b++)O.l3_side.tt[y][b].block_type=P.NORM_TYPE,O.l3_side.tt[y][b].mixed_block_flag=0,S[y][b]=T[y][b]=700;if(a(O),o.mdct_sub48(O,F[0],F[1]),O.mode_ext=P.MPG_MD_LR_LR,d.force_ms)O.mode_ext=P.MPG_MD_MS_LR;else if(d.mode==It.JOINT_STEREO){var H=0,$=0;for(y=0;y<O.mode_gr;y++)for(b=0;b<O.channels_out;b++)H+=S[y][b],$+=T[y][b];if(H<=1*$){var p=O.l3_side.tt[0],I=O.l3_side.tt[O.mode_gr-1];p[0].block_type==p[1].block_type&&I[0].block_type==I[1].block_type&&(O.mode_ext=P.MPG_MD_MS_LR)}}if(O.mode_ext==t?(x=_,g=S):(x=C,g=T),d.analysis&&O.pinfo!=null)for(y=0;y<O.mode_gr;y++)for(b=0;b<O.channels_out;b++)O.pinfo.ms_ratio[y]=O.ms_ratio[y],O.pinfo.ms_ener_ratio[y]=v[y],O.pinfo.blocktype[y][b]=O.l3_side.tt[y][b].block_type,O.pinfo.pe[y][b]=g[y][b],l3.arraycopy(O.l3_side.tt[y][b].xr,0,O.pinfo.xr[y][b],0,576),O.mode_ext==t&&(O.pinfo.ers[y][b]=O.pinfo.ers[y][b+2],l3.arraycopy(O.pinfo.energy[y][b+2],0,O.pinfo.energy[y][b],0,O.pinfo.energy[y][b].length));if(d.VBR==rh.vbr_off||d.VBR==rh.vbr_abr){var Z,D;for(Z=0;Z<18;Z++)O.nsPsy.pefirbuf[Z]=O.nsPsy.pefirbuf[Z+1];for(D=0,y=0;y<O.mode_gr;y++)for(b=0;b<O.channels_out;b++)D+=g[y][b];for(O.nsPsy.pefirbuf[18]=D,D=O.nsPsy.pefirbuf[9],Z=0;Z<9;Z++)D+=(O.nsPsy.pefirbuf[Z]+O.nsPsy.pefirbuf[18-Z])*P.fircoef[Z];for(D=670*5*O.mode_gr*O.channels_out/D,y=0;y<O.mode_gr;y++)for(b=0;b<O.channels_out;b++)g[y][b]*=D}if(O.iteration_loop.iteration_loop(d,g,v,x),n.format_bitstream(d),M=n.copy_buffer(O,m,h,R,1),d.bWriteVbrTag&&r.addVbrFrame(d),d.analysis&&O.pinfo!=null){for(b=0;b<O.channels_out;b++){var ye;for(ye=0;ye<e;ye++)O.pinfo.pcmdata[b][ye]=O.pinfo.pcmdata[b][ye+d.framesize];for(ye=e;ye<1600;ye++)O.pinfo.pcmdata[b][ye]=F[b][ye-e]}s.set_frame_pinfo(d,x)}return l(O),M}}var h3=De.Util,d3=De.new_float;function F$(){var e=d3(P.BLKSIZE),t=d3(P.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function i(s,o,a){var l=0,c,d,u;a<<=1;var f=o+a;c=4;do{var m,h,R,M,C,_,x;x=c>>1,M=c,C=c<<1,_=C+M,c=C<<1,d=o,u=d+x;do{var F,O,N,v;O=s[d+0]-s[d+M],F=s[d+0]+s[d+M],v=s[d+C]-s[d+_],N=s[d+C]+s[d+_],s[d+C]=F-N,s[d+0]=F+N,s[d+_]=O-v,s[d+M]=O+v,O=s[u+0]-s[u+M],F=s[u+0]+s[u+M],v=h3.SQRT2*s[u+_],N=h3.SQRT2*s[u+C],s[u+C]=F-N,s[u+0]=F+N,s[u+_]=O-v,s[u+M]=O+v,u+=c,d+=c}while(d<f);for(h=n[l+0],m=n[l+1],R=1;R<x;R++){var T,S;T=1-2*m*m,S=2*m*h,d=o+R,u=o+M-R;do{var g,b,y,F,O,w,N,A,v,E;b=S*s[d+M]-T*s[u+M],g=T*s[d+M]+S*s[u+M],O=s[d+0]-g,F=s[d+0]+g,w=s[u+0]-b,y=s[u+0]+b,b=S*s[d+_]-T*s[u+_],g=T*s[d+_]+S*s[u+_],v=s[d+C]-g,N=s[d+C]+g,E=s[u+C]-b,A=s[u+C]+b,b=m*N-h*E,g=h*N+m*E,s[d+C]=F-g,s[d+0]=F+g,s[u+_]=w-b,s[u+M]=w+b,b=h*A-m*v,g=m*A+h*v,s[u+C]=y-g,s[u+0]=y+g,s[d+_]=O-b,s[d+M]=O+b,u+=c,d+=c}while(d<f);T=h,h=T*n[l+0]-m*n[l+1],m=T*n[l+1]+m*n[l+0]}l+=2}while(c<a)}var r=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(s,o,a,l,c){for(var d=0;d<3;d++){var u=P.BLKSIZE_s/2,f=65535&576/3*(d+1),m=P.BLKSIZE_s/8-1;do{var h,R,M,C,_,x=r[m<<2]&255;h=t[x]*l[a][c+x+f],_=t[127-x]*l[a][c+x+f+128],R=h-_,h=h+_,M=t[x+64]*l[a][c+x+f+64],_=t[63-x]*l[a][c+x+f+192],C=M-_,M=M+_,u-=4,o[d][u+0]=h+M,o[d][u+2]=h-M,o[d][u+1]=R+C,o[d][u+3]=R-C,h=t[x+1]*l[a][c+x+f+1],_=t[126-x]*l[a][c+x+f+129],R=h-_,h=h+_,M=t[x+65]*l[a][c+x+f+65],_=t[62-x]*l[a][c+x+f+193],C=M-_,M=M+_,o[d][u+P.BLKSIZE_s/2+0]=h+M,o[d][u+P.BLKSIZE_s/2+2]=h-M,o[d][u+P.BLKSIZE_s/2+1]=R+C,o[d][u+P.BLKSIZE_s/2+3]=R-C}while(--m>=0);i(o[d],u,P.BLKSIZE_s/2)}},this.fft_long=function(s,o,a,l,c){var d=P.BLKSIZE/8-1,u=P.BLKSIZE/2;do{var f,m,h,R,M,C=r[d]&255;f=e[C]*l[a][c+C],M=e[C+512]*l[a][c+C+512],m=f-M,f=f+M,h=e[C+256]*l[a][c+C+256],M=e[C+768]*l[a][c+C+768],R=h-M,h=h+M,u-=4,o[u+0]=f+h,o[u+2]=f-h,o[u+1]=m+R,o[u+3]=m-R,f=e[C+1]*l[a][c+C+1],M=e[C+513]*l[a][c+C+513],m=f-M,f=f+M,h=e[C+257]*l[a][c+C+257],M=e[C+769]*l[a][c+C+769],R=h-M,h=h+M,o[u+P.BLKSIZE/2+0]=f+h,o[u+P.BLKSIZE/2+2]=f-h,o[u+P.BLKSIZE/2+1]=m+R,o[u+P.BLKSIZE/2+3]=m-R}while(--d>=0);i(o,u,P.BLKSIZE/2)},this.init_fft=function(s){for(var o=0;o<P.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/P.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/P.BLKSIZE);for(var o=0;o<P.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/P.BLKSIZE_s))}}var ha=De.VbrMode,f3=De.Float,da=De.ShortBlock,ui=De.Util,L$=De.Arrays,pn=De.new_float,qi=De.new_float_n,eo=De.new_int,ct=De.assert;function r1(){var e=new F$,t=2.302585092994046,n=2,i=16,r=2,s=16,o=.34,a=1/(14752*14752)/(P.BLKSIZE/2),l=.01,c=.8,d=.6,u=.3,f=3.5,m=21,h=.2302585093;function R(B){return B}function M(B,U){for(var z=0,Y=0;Y<P.BLKSIZE/2;++Y)z+=B[Y]*U.ATH.eql_w[Y];return z*=a,z}function C(B,U,z,Y,X,V,ne,oe,te,pe,le){var ge=B.internal_flags;if(te<2)e.fft_long(ge,Y[X],te,pe,le),e.fft_short(ge,V[ne],te,pe,le);else if(te==2){for(var se=P.BLKSIZE-1;se>=0;--se){var ke=Y[X+0][se],Se=Y[X+1][se];Y[X+0][se]=(ke+Se)*ui.SQRT2*.5,Y[X+1][se]=(ke-Se)*ui.SQRT2*.5}for(var We=2;We>=0;--We)for(var se=P.BLKSIZE_s-1;se>=0;--se){var ke=V[ne+0][We][se],Se=V[ne+1][We][se];V[ne+0][We][se]=(ke+Se)*ui.SQRT2*.5,V[ne+1][We][se]=(ke-Se)*ui.SQRT2*.5}}U[0]=Y[X+0][0],U[0]*=U[0];for(var se=P.BLKSIZE/2-1;se>=0;--se){var he=Y[X+0][P.BLKSIZE/2-se],je=Y[X+0][P.BLKSIZE/2+se];U[P.BLKSIZE/2-se]=(he*he+je*je)*.5}for(var We=2;We>=0;--We){z[We][0]=V[ne+0][We][0],z[We][0]*=z[We][0];for(var se=P.BLKSIZE_s/2-1;se>=0;--se){var he=V[ne+0][We][P.BLKSIZE_s/2-se],je=V[ne+0][We][P.BLKSIZE_s/2+se];z[We][P.BLKSIZE_s/2-se]=(he*he+je*je)*.5}}{for(var Qe=0,se=11;se<P.HBLKSIZE;se++)Qe+=U[se];ge.tot_ener[te]=Qe}if(B.analysis){for(var se=0;se<P.HBLKSIZE;se++)ge.pinfo.energy[oe][te][se]=ge.pinfo.energy_save[te][se],ge.pinfo.energy_save[te][se]=U[se];ge.pinfo.pe[oe][te]=ge.pe[te]}B.athaa_loudapprox==2&&te<2&&(ge.loudness_sq[oe][te]=ge.loudness_sq_save[te],ge.loudness_sq_save[te]=M(U,ge))}var _=8,x=23,F=15,O,N,v,T=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){O=Math.pow(10,(_+1)/16),N=Math.pow(10,(x+1)/16),v=Math.pow(10,F/10)}var g=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],b=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],y=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function w(B,U,z,Y,X,V){var ne;if(U>B)if(U<B*N)ne=U/B;else return B+U;else{if(B>=U*N)return B+U;ne=B/U}if(B+=U,Y+3<=3+3){if(ne>=O)return B;var oe=0|ui.FAST_LOG10_X(ne,16);return B*b[oe]}var oe=0|ui.FAST_LOG10_X(ne,16);if(V!=0?U=X.ATH.cb_s[z]*X.ATH.adjust:U=X.ATH.cb_l[z]*X.ATH.adjust,B<v*U){if(B>U){var te,pe;return te=1,oe<=13&&(te=y[oe]),pe=ui.FAST_LOG10_X(B/U,10/15),B*((g[oe]-te)*pe+te)}return oe>13?B:B*y[oe]}return B*g[oe]}var A=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function E(B,U,z){var Y;if(B<0&&(B=0),U<0&&(U=0),B<=0)return U;if(U<=0)return B;if(U>B?Y=U/B:Y=B/U,z>=-2&&z<=2){if(Y>=O)return B+U;var X=0|ui.FAST_LOG10_X(Y,16);return(B+U)*A[X]}return Y<N?B+U:(B<U&&(B=U),B)}function j(B,U){var z=B.internal_flags;if(z.channels_out>1){for(var Y=0;Y<P.SBMAX_l;Y++){var X=z.thm[0].l[Y],V=z.thm[1].l[Y];z.thm[0].l[Y]+=V*U,z.thm[1].l[Y]+=X*U}for(var Y=0;Y<P.SBMAX_s;Y++)for(var ne=0;ne<3;ne++){var X=z.thm[0].s[Y][ne],V=z.thm[1].s[Y][ne];z.thm[0].s[Y][ne]+=V*U,z.thm[1].s[Y][ne]+=X*U}}}function K(B){for(var U=0;U<P.SBMAX_l;U++)if(!(B.thm[0].l[U]>1.58*B.thm[1].l[U]||B.thm[1].l[U]>1.58*B.thm[0].l[U])){var z=B.mld_l[U]*B.en[3].l[U],Y=Math.max(B.thm[2].l[U],Math.min(B.thm[3].l[U],z));z=B.mld_l[U]*B.en[2].l[U];var X=Math.max(B.thm[3].l[U],Math.min(B.thm[2].l[U],z));B.thm[2].l[U]=Y,B.thm[3].l[U]=X}for(var U=0;U<P.SBMAX_s;U++)for(var V=0;V<3;V++)if(!(B.thm[0].s[U][V]>1.58*B.thm[1].s[U][V]||B.thm[1].s[U][V]>1.58*B.thm[0].s[U][V])){var z=B.mld_s[U]*B.en[3].s[U][V],Y=Math.max(B.thm[2].s[U][V],Math.min(B.thm[3].s[U][V],z));z=B.mld_s[U]*B.en[2].s[U][V];var X=Math.max(B.thm[3].s[U][V],Math.min(B.thm[2].s[U][V],z));B.thm[2].s[U][V]=Y,B.thm[3].s[U][V]=X}}function H(B,U,z){var Y=U,X=Math.pow(10,z);U*=2,Y*=2;for(var V=0;V<P.SBMAX_l;V++){var ne,oe,te,pe;if(pe=B.ATH.cb_l[B.bm_l[V]]*X,ne=Math.min(Math.max(B.thm[0].l[V],pe),Math.max(B.thm[1].l[V],pe)),oe=Math.max(B.thm[2].l[V],pe),te=Math.max(B.thm[3].l[V],pe),ne*U<oe+te){var le=ne*Y/(oe+te);oe*=le,te*=le}B.thm[2].l[V]=Math.min(oe,B.thm[2].l[V]),B.thm[3].l[V]=Math.min(te,B.thm[3].l[V])}X*=P.BLKSIZE_s/P.BLKSIZE;for(var V=0;V<P.SBMAX_s;V++)for(var ge=0;ge<3;ge++){var ne,oe,te,pe;if(pe=B.ATH.cb_s[B.bm_s[V]]*X,ne=Math.min(Math.max(B.thm[0].s[V][ge],pe),Math.max(B.thm[1].s[V][ge],pe)),oe=Math.max(B.thm[2].s[V][ge],pe),te=Math.max(B.thm[3].s[V][ge],pe),ne*U<oe+te){var le=ne*U/(oe+te);oe*=le,te*=le}B.thm[2].s[V][ge]=Math.min(B.thm[2].s[V][ge],oe),B.thm[3].s[V][ge]=Math.min(B.thm[3].s[V][ge],te)}}function $(B,U,z,Y,X){var V,ne,oe=0,te=0;for(V=ne=0;V<P.SBMAX_s;++ne,++V){for(var pe=B.bo_s[V],le=B.npart_s,ge=pe<le?pe:le;ne<ge;)ct(U[ne]>=0),ct(z[ne]>=0),oe+=U[ne],te+=z[ne],ne++;if(B.en[Y].s[V][X]=oe,B.thm[Y].s[V][X]=te,ne>=le){++V;break}ct(U[ne]>=0),ct(z[ne]>=0);{var se=B.PSY.bo_s_weight[V],ke=1-se;oe=se*U[ne],te=se*z[ne],B.en[Y].s[V][X]+=oe,B.thm[Y].s[V][X]+=te,oe=ke*U[ne],te=ke*z[ne]}}for(;V<P.SBMAX_s;++V)B.en[Y].s[V][X]=0,B.thm[Y].s[V][X]=0}function p(B,U,z,Y){var X,V,ne=0,oe=0;for(X=V=0;X<P.SBMAX_l;++V,++X){for(var te=B.bo_l[X],pe=B.npart_l,le=te<pe?te:pe;V<le;)ct(U[V]>=0),ct(z[V]>=0),ne+=U[V],oe+=z[V],V++;if(B.en[Y].l[X]=ne,B.thm[Y].l[X]=oe,V>=pe){++X;break}ct(U[V]>=0),ct(z[V]>=0);{var ge=B.PSY.bo_l_weight[X],se=1-ge;ne=ge*U[V],oe=ge*z[V],B.en[Y].l[X]+=ne,B.thm[Y].l[X]+=oe,ne=se*U[V],oe=se*z[V]}}for(;X<P.SBMAX_l;++X)B.en[Y].l[X]=0,B.thm[Y].l[X]=0}function I(B,U,z,Y,X,V){var ne=B.internal_flags,oe,te;for(te=oe=0;te<ne.npart_s;++te){for(var pe=0,le=ne.numlines_s[te],ge=0;ge<le;++ge,++oe){var se=U[V][oe];pe+=se}z[te]=pe}for(ct(te==ne.npart_s),oe=te=0;te<ne.npart_s;te++){var ke=ne.s3ind_s[te][0],Se=ne.s3_ss[oe++]*z[ke];for(++ke;ke<=ne.s3ind_s[te][1];)Se+=ne.s3_ss[oe]*z[ke],++oe,++ke;{var We=r*ne.nb_s1[X][te];Y[te]=Math.min(Se,We)}if(ne.blocktype_old[X&1]==P.SHORT_TYPE){var We=s*ne.nb_s2[X][te],he=Y[te];Y[te]=Math.min(We,he)}ne.nb_s2[X][te]=ne.nb_s1[X][te],ne.nb_s1[X][te]=Se,ct(Y[te]>=0)}for(;te<=P.CBANDS;++te)z[te]=0,Y[te]=0}function Z(B,U,z,Y){var X=B.internal_flags;B.short_blocks==da.short_block_coupled&&!(U[0]!=0&&U[1]!=0)&&(U[0]=U[1]=0);for(var V=0;V<X.channels_out;V++)Y[V]=P.NORM_TYPE,B.short_blocks==da.short_block_dispensed&&(U[V]=1),B.short_blocks==da.short_block_forced&&(U[V]=0),U[V]!=0?(ct(X.blocktype_old[V]!=P.START_TYPE),X.blocktype_old[V]==P.SHORT_TYPE&&(Y[V]=P.STOP_TYPE)):(Y[V]=P.SHORT_TYPE,X.blocktype_old[V]==P.NORM_TYPE&&(X.blocktype_old[V]=P.START_TYPE),X.blocktype_old[V]==P.STOP_TYPE&&(X.blocktype_old[V]=P.SHORT_TYPE)),z[V]=X.blocktype_old[V],X.blocktype_old[V]=Y[V]}function D(B,U,z){return z>=1?B:z<=0?U:U>0?Math.pow(B/U,z)*U:0}var ye=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Oe(B,U){for(var z=309.07,Y=0;Y<P.SBMAX_s-1;Y++)for(var X=0;X<3;X++){var V=B.thm.s[Y][X];if(V>0){var ne=V*U,oe=B.en.s[Y][X];oe>ne&&(oe>ne*1e10?z+=ye[Y]*(10*t):z+=ye[Y]*ui.FAST_LOG10(oe/ne))}}return z}var xe=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function be(B,U){for(var z=281.0575,Y=0;Y<P.SBMAX_l-1;Y++){var X=B.thm.l[Y];if(X>0){var V=X*U,ne=B.en.l[Y];ne>V&&(ne>V*1e10?z+=xe[Y]*(10*t):z+=xe[Y]*ui.FAST_LOG10(ne/V))}}return z}function qe(B,U,z,Y,X){var V,ne;for(V=ne=0;V<B.npart_l;++V){var oe=0,te=0,pe;for(pe=0;pe<B.numlines_l[V];++pe,++ne){var le=U[ne];oe+=le,te<le&&(te=le)}z[V]=oe,Y[V]=te,X[V]=oe*B.rnumlines_l[V],ct(B.rnumlines_l[V]>=0),ct(z[V]>=0),ct(Y[V]>=0),ct(X[V]>=0)}}function Fe(B,U,z,Y){var X=T.length-1,V=0,ne=z[V]+z[V+1];if(ne>0){var oe=U[V];oe<U[V+1]&&(oe=U[V+1]),ct(B.numlines_l[V]+B.numlines_l[V+1]-1>0),ne=20*(oe*2-ne)/(ne*(B.numlines_l[V]+B.numlines_l[V+1]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;for(V=1;V<B.npart_l-1;V++)if(ne=z[V-1]+z[V]+z[V+1],ne>0){var oe=U[V-1];oe<U[V]&&(oe=U[V]),oe<U[V+1]&&(oe=U[V+1]),ct(B.numlines_l[V-1]+B.numlines_l[V]+B.numlines_l[V+1]-1>0),ne=20*(oe*3-ne)/(ne*(B.numlines_l[V-1]+B.numlines_l[V]+B.numlines_l[V+1]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;if(ct(V==B.npart_l-1),ne=z[V-1]+z[V],ne>0){var oe=U[V-1];oe<U[V]&&(oe=U[V]),ct(B.numlines_l[V-1]+B.numlines_l[V]-1>0),ne=20*(oe*2-ne)/(ne*(B.numlines_l[V-1]+B.numlines_l[V]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;ct(V==B.npart_l-1)}var we=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(B,U,z,Y,X,V,ne,oe,te,pe){var le=B.internal_flags,ge=qi([2,P.BLKSIZE]),se=qi([2,3,P.BLKSIZE_s]),ke=pn(P.CBANDS+1),Se=pn(P.CBANDS+1),We=pn(P.CBANDS+2),he=eo(2),je=eo(2),Qe,Ie,ze,Re,Xe,Xt,He,it,ut=qi([2,576]),nn,Ei=eo(P.CBANDS+2),hn=eo(P.CBANDS+2);for(L$.fill(hn,0),Qe=le.channels_out,B.mode==It.JOINT_STEREO&&(Qe=4),B.VBR==ha.vbr_off?nn=le.ResvMax==0?0:le.ResvSize/le.ResvMax*.5:B.VBR==ha.vbr_rh||B.VBR==ha.vbr_mtrh||B.VBR==ha.vbr_mt?nn=.6:nn=1,Ie=0;Ie<le.channels_out;Ie++){var rn=U[Ie],li=z+576-350-m+192;for(Re=0;Re<576;Re++){var Si,Ti;for(Si=rn[li+Re+10],Ti=0,Xe=0;Xe<(m-1)/2-1;Xe+=2)Si+=we[Xe]*(rn[li+Re+Xe]+rn[li+Re+m-Xe]),Ti+=we[Xe+1]*(rn[li+Re+Xe+1]+rn[li+Re+m-Xe-1]);ut[Ie][Re]=Si+Ti}X[Y][Ie].en.assign(le.en[Ie]),X[Y][Ie].thm.assign(le.thm[Ie]),Qe>2&&(V[Y][Ie].en.assign(le.en[Ie+2]),V[Y][Ie].thm.assign(le.thm[Ie+2]))}for(Ie=0;Ie<Qe;Ie++){var Ji,er,Pn=pn(12),fr=[0,0,0,0],aa=pn(12),tm=1,dv,fv=pn(P.CBANDS),mv=pn(P.CBANDS),sn=[0,0,0,0],pv=pn(P.HBLKSIZE),gv=qi([3,P.HBLKSIZE_s]);for(ct(le.npart_s<=P.CBANDS),ct(le.npart_l<=P.CBANDS),Re=0;Re<3;Re++)Pn[Re]=le.nsPsy.last_en_subshort[Ie][Re+6],ct(le.nsPsy.last_en_subshort[Ie][Re+4]>0),aa[Re]=Pn[Re]/le.nsPsy.last_en_subshort[Ie][Re+4],fr[0]+=Pn[Re];if(Ie==2)for(Re=0;Re<576;Re++){var nm,im;nm=ut[0][Re],im=ut[1][Re],ut[0][Re]=nm+im,ut[1][Re]=nm-im}{var _v=ut[Ie&1],El=0;for(Re=0;Re<9;Re++){for(var fS=El+64,En=1;El<fS;El++)En<Math.abs(_v[El])&&(En=Math.abs(_v[El]));le.nsPsy.last_en_subshort[Ie][Re]=Pn[Re+3]=En,fr[1+Re/3]+=En,En>Pn[Re+3-2]?(ct(Pn[Re+3-2]>0),En=En/Pn[Re+3-2]):Pn[Re+3-2]>En*10?En=Pn[Re+3-2]/(En*10):En=0,aa[Re+3]=En}}if(B.analysis){var rm=aa[0];for(Re=1;Re<12;Re++)rm<aa[Re]&&(rm=aa[Re]);le.pinfo.ers[Y][Ie]=le.pinfo.ers_save[Ie],le.pinfo.ers_save[Ie]=rm}for(dv=Ie==3?le.nsPsy.attackthre_s:le.nsPsy.attackthre,Re=0;Re<12;Re++)sn[Re/3]==0&&aa[Re]>dv&&(sn[Re/3]=Re%3+1);for(Re=1;Re<4;Re++){var sm;fr[Re-1]>fr[Re]?(ct(fr[Re]>0),sm=fr[Re-1]/fr[Re]):(ct(fr[Re-1]>0),sm=fr[Re]/fr[Re-1]),sm<1.7&&(sn[Re]=0,Re==1&&(sn[0]=0))}for(sn[0]!=0&&le.nsPsy.lastAttacks[Ie]!=0&&(sn[0]=0),(le.nsPsy.lastAttacks[Ie]==3||sn[0]+sn[1]+sn[2]+sn[3]!=0)&&(tm=0,sn[1]!=0&&sn[0]!=0&&(sn[1]=0),sn[2]!=0&&sn[1]!=0&&(sn[2]=0),sn[3]!=0&&sn[2]!=0&&(sn[3]=0)),Ie<2?je[Ie]=tm:tm==0&&(je[0]=je[1]=0),te[Ie]=le.tot_ener[Ie],er=se,Ji=ge,C(B,pv,gv,Ji,Ie&1,er,Ie&1,Y,Ie,U,z),qe(le,pv,ke,fv,mv),Fe(le,fv,mv,Ei),it=0;it<3;it++){var om,ci;for(I(B,gv,Se,We,Ie,it),$(le,Se,We,Ie,it),He=0;He<P.SBMAX_s;He++){if(ci=le.thm[Ie].s[He][it],ci*=c,sn[it]>=2||sn[it+1]==1){var Sl=it!=0?it-1:2,En=D(le.thm[Ie].s[He][Sl],ci,d*nn);ci=Math.min(ci,En)}if(sn[it]==1){var Sl=it!=0?it-1:2,En=D(le.thm[Ie].s[He][Sl],ci,u*nn);ci=Math.min(ci,En)}else if(it!=0&&sn[it-1]==3||it==0&&le.nsPsy.lastAttacks[Ie]==3){var Sl=it!=2?it+1:0,En=D(le.thm[Ie].s[He][Sl],ci,u*nn);ci=Math.min(ci,En)}om=Pn[it*3+3]+Pn[it*3+4]+Pn[it*3+5],Pn[it*3+5]*6<om&&(ci*=.5,Pn[it*3+4]*6<om&&(ci*=.5)),le.thm[Ie].s[He][it]=ci}}for(le.nsPsy.lastAttacks[Ie]=sn[2],Xt=0,ze=0;ze<le.npart_l;ze++){for(var Ws=le.s3ind[ze][0],am=ke[Ws]*T[Ei[Ws]],Ks=le.s3_ll[Xt++]*am;++Ws<=le.s3ind[ze][1];)am=ke[Ws]*T[Ei[Ws]],Ks=w(Ks,le.s3_ll[Xt++]*am,Ws,Ws-ze,le,0);Ks*=.158489319246111,le.blocktype_old[Ie&1]==P.SHORT_TYPE?We[ze]=Ks:We[ze]=D(Math.min(Ks,Math.min(n*le.nb_1[Ie][ze],i*le.nb_2[Ie][ze])),Ks,nn),le.nb_2[Ie][ze]=le.nb_1[Ie][ze],le.nb_1[Ie][ze]=Ks}for(;ze<=P.CBANDS;++ze)ke[ze]=0,We[ze]=0;p(le,ke,We,Ie)}if((B.mode==It.STEREO||B.mode==It.JOINT_STEREO)&&B.interChRatio>0&&j(B,B.interChRatio),B.mode==It.JOINT_STEREO){var lm;K(le),lm=B.msfix,Math.abs(lm)>0&&H(le,lm,B.ATHlower*le.ATH.adjust)}for(Z(B,je,pe,he),Ie=0;Ie<Qe;Ie++){var Tl,kl=0,Cu,Iu;Ie>1?(Tl=oe,kl=-2,Cu=P.NORM_TYPE,(pe[0]==P.SHORT_TYPE||pe[1]==P.SHORT_TYPE)&&(Cu=P.SHORT_TYPE),Iu=V[Y][Ie-2]):(Tl=ne,kl=0,Cu=pe[Ie],Iu=X[Y][Ie]),Cu==P.SHORT_TYPE?Tl[kl+Ie]=Oe(Iu,le.masking_lower):Tl[kl+Ie]=be(Iu,le.masking_lower),B.analysis&&(le.pinfo.pe[Y][Ie]=Tl[kl+Ie])}return 0};function Ye(B,U,z,Y,X,V,ne,oe){var te=B.internal_flags;if(Y<2)e.fft_long(te,ne[oe],Y,U,z);else if(Y==2)for(var pe=P.BLKSIZE-1;pe>=0;--pe){var le=ne[oe+0][pe],ge=ne[oe+1][pe];ne[oe+0][pe]=(le+ge)*ui.SQRT2*.5,ne[oe+1][pe]=(le-ge)*ui.SQRT2*.5}V[0]=ne[oe+0][0],V[0]*=V[0];for(var pe=P.BLKSIZE/2-1;pe>=0;--pe){var se=ne[oe+0][P.BLKSIZE/2-pe],ke=ne[oe+0][P.BLKSIZE/2+pe];V[P.BLKSIZE/2-pe]=(se*se+ke*ke)*.5}{for(var Se=0,pe=11;pe<P.HBLKSIZE;pe++)Se+=V[pe];te.tot_ener[Y]=Se}if(B.analysis){for(var pe=0;pe<P.HBLKSIZE;pe++)te.pinfo.energy[X][Y][pe]=te.pinfo.energy_save[Y][pe],te.pinfo.energy_save[Y][pe]=V[pe];te.pinfo.pe[X][Y]=te.pe[Y]}}function lt(B,U,z,Y,X,V,ne,oe){var te=B.internal_flags;if(X==0&&Y<2&&e.fft_short(te,ne[oe],Y,U,z),Y==2)for(var pe=P.BLKSIZE_s-1;pe>=0;--pe){var le=ne[oe+0][X][pe],ge=ne[oe+1][X][pe];ne[oe+0][X][pe]=(le+ge)*ui.SQRT2*.5,ne[oe+1][X][pe]=(le-ge)*ui.SQRT2*.5}V[X][0]=ne[oe+0][X][0],V[X][0]*=V[X][0];for(var pe=P.BLKSIZE_s/2-1;pe>=0;--pe){var se=ne[oe+0][X][P.BLKSIZE_s/2-pe],ke=ne[oe+0][X][P.BLKSIZE_s/2+pe];V[X][P.BLKSIZE_s/2-pe]=(se*se+ke*ke)*.5}}function k(B,U,z,Y){var X=B.internal_flags;B.athaa_loudapprox==2&&z<2&&(X.loudness_sq[U][z]=X.loudness_sq_save[z],X.loudness_sq_save[z]=M(Y,X))}var L=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function q(B,U,z,Y,X,V,ne,oe,te,pe){for(var le=qi([2,576]),ge=B.internal_flags,se=ge.channels_out,ke=B.mode==It.JOINT_STEREO?4:se,Se=0;Se<se;Se++){firbuf=U[Se];for(var We=z+576-350-m+192,he=0;he<576;he++){var je,Qe;je=firbuf[We+he+10],Qe=0;for(var Ie=0;Ie<(m-1)/2-1;Ie+=2)je+=L[Ie]*(firbuf[We+he+Ie]+firbuf[We+he+m-Ie]),Qe+=L[Ie+1]*(firbuf[We+he+Ie+1]+firbuf[We+he+m-Ie-1]);le[Se][he]=je+Qe}X[Y][Se].en.assign(ge.en[Se]),X[Y][Se].thm.assign(ge.thm[Se]),ke>2&&(V[Y][Se].en.assign(ge.en[Se+2]),V[Y][Se].thm.assign(ge.thm[Se+2]))}for(var Se=0;Se<ke;Se++){var ze=pn(12),Re=pn(12),Xe=[0,0,0,0],Xt=le[Se&1],He=0,it=Se==3?ge.nsPsy.attackthre_s:ge.nsPsy.attackthre,ut=1;if(Se==2)for(var he=0,Ie=576;Ie>0;++he,--Ie){var nn=le[0][he],Ei=le[1][he];le[0][he]=nn+Ei,le[1][he]=nn-Ei}for(var he=0;he<3;he++)Re[he]=ge.nsPsy.last_en_subshort[Se][he+6],ct(ge.nsPsy.last_en_subshort[Se][he+4]>0),ze[he]=Re[he]/ge.nsPsy.last_en_subshort[Se][he+4],Xe[0]+=Re[he];for(var he=0;he<9;he++){for(var hn=He+64,rn=1;He<hn;He++)rn<Math.abs(Xt[He])&&(rn=Math.abs(Xt[He]));ge.nsPsy.last_en_subshort[Se][he]=Re[he+3]=rn,Xe[1+he/3]+=rn,rn>Re[he+3-2]?(ct(Re[he+3-2]>0),rn=rn/Re[he+3-2]):Re[he+3-2]>rn*10?rn=Re[he+3-2]/(rn*10):rn=0,ze[he+3]=rn}for(var he=0;he<3;++he){var li=Re[he*3+3]+Re[he*3+4]+Re[he*3+5],Si=1;Re[he*3+5]*6<li&&(Si*=.5,Re[he*3+4]*6<li&&(Si*=.5)),oe[Se][he]=Si}if(B.analysis){for(var Ti=ze[0],he=1;he<12;he++)Ti<ze[he]&&(Ti=ze[he]);ge.pinfo.ers[Y][Se]=ge.pinfo.ers_save[Se],ge.pinfo.ers_save[Se]=Ti}for(var he=0;he<12;he++)te[Se][he/3]==0&&ze[he]>it&&(te[Se][he/3]=he%3+1);for(var he=1;he<4;he++){var Ji=Xe[he-1],er=Xe[he],Pn=Math.max(Ji,er);Pn<4e4&&Ji<1.7*er&&er<1.7*Ji&&(he==1&&te[Se][0]<=te[Se][he]&&(te[Se][0]=0),te[Se][he]=0)}te[Se][0]<=ge.nsPsy.lastAttacks[Se]&&(te[Se][0]=0),(ge.nsPsy.lastAttacks[Se]==3||te[Se][0]+te[Se][1]+te[Se][2]+te[Se][3]!=0)&&(ut=0,te[Se][1]!=0&&te[Se][0]!=0&&(te[Se][1]=0),te[Se][2]!=0&&te[Se][1]!=0&&(te[Se][2]=0),te[Se][3]!=0&&te[Se][2]!=0&&(te[Se][3]=0)),Se<2?pe[Se]=ut:ut==0&&(pe[0]=pe[1]=0),ne[Se]=ge.tot_ener[Se]}}function W(B,U,z){if(z==0)for(var Y=0;Y<B.npart_s;Y++)B.nb_s2[U][Y]=B.nb_s1[U][Y],B.nb_s1[U][Y]=0}function G(B,U){for(var z=0;z<B.npart_l;z++)B.nb_2[U][z]=B.nb_1[U][z],B.nb_1[U][z]=0}function ie(B,U,z,Y){var X=T.length-1,V=0,ne=z[V]+z[V+1];if(ne>0){var oe=U[V];oe<U[V+1]&&(oe=U[V+1]),ct(B.numlines_s[V]+B.numlines_s[V+1]-1>0),ne=20*(oe*2-ne)/(ne*(B.numlines_s[V]+B.numlines_s[V+1]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;for(V=1;V<B.npart_s-1;V++)if(ne=z[V-1]+z[V]+z[V+1],ct(V+1<B.npart_s),ne>0){var oe=U[V-1];oe<U[V]&&(oe=U[V]),oe<U[V+1]&&(oe=U[V+1]),ct(B.numlines_s[V-1]+B.numlines_s[V]+B.numlines_s[V+1]-1>0),ne=20*(oe*3-ne)/(ne*(B.numlines_s[V-1]+B.numlines_s[V]+B.numlines_s[V+1]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;if(ct(V==B.npart_s-1),ne=z[V-1]+z[V],ne>0){var oe=U[V-1];oe<U[V]&&(oe=U[V]),ct(B.numlines_s[V-1]+B.numlines_s[V]-1>0),ne=20*(oe*2-ne)/(ne*(B.numlines_s[V-1]+B.numlines_s[V]-1));var te=0|ne;te>X&&(te=X),Y[V]=te}else Y[V]=0;ct(V==B.npart_s-1)}function ce(B,U,z,Y,X,V){var ne=B.internal_flags,oe=new float[P.CBANDS],te=pn(P.CBANDS),pe,le,ge,se=new int[P.CBANDS];for(ge=le=0;ge<ne.npart_s;++ge){var ke=0,Se=0,We=ne.numlines_s[ge];for(pe=0;pe<We;++pe,++le){var he=U[V][le];ke+=he,Se<he&&(Se=he)}z[ge]=ke,oe[ge]=Se,te[ge]=ke/We,ct(te[ge]>=0)}for(ct(ge==ne.npart_s);ge<P.CBANDS;++ge)oe[ge]=0,te[ge]=0;for(ie(ne,oe,te,se),le=ge=0;ge<ne.npart_s;ge++){var je=ne.s3ind_s[ge][0],Qe=ne.s3ind_s[ge][1],Ie,ze,Re,Xe,Xt;for(Ie=se[je],ze=1,Xe=ne.s3_ss[le]*z[je]*T[se[je]],++le,++je;je<=Qe;)Ie+=se[je],ze+=1,Re=ne.s3_ss[le]*z[je]*T[se[je]],Xe=E(Xe,Re,je-ge),++le,++je;Ie=(1+2*Ie)/(2*ze),Xt=T[Ie]*.5,Xe*=Xt,Y[ge]=Xe,ne.nb_s2[X][ge]=ne.nb_s1[X][ge],ne.nb_s1[X][ge]=Xe,Re=oe[ge],Re*=ne.minval_s[ge],Re*=Xt,Y[ge]>Re&&(Y[ge]=Re),ne.masking_lower>1&&(Y[ge]*=ne.masking_lower),Y[ge]>z[ge]&&(Y[ge]=z[ge]),ne.masking_lower<1&&(Y[ge]*=ne.masking_lower),ct(Y[ge]>=0)}for(;ge<P.CBANDS;++ge)z[ge]=0,Y[ge]=0}function J(B,U,z,Y,X){var V=pn(P.CBANDS),ne=pn(P.CBANDS),oe=eo(P.CBANDS+2),te;qe(B,U,z,V,ne),Fe(B,V,ne,oe);var pe=0;for(te=0;te<B.npart_l;te++){var le,ge,se,ke,Se=B.s3ind[te][0],We=B.s3ind[te][1],he=0,je=0;for(he=oe[Se],je+=1,ge=B.s3_ll[pe]*z[Se]*T[oe[Se]],++pe,++Se;Se<=We;)he+=oe[Se],je+=1,le=B.s3_ll[pe]*z[Se]*T[oe[Se]],ke=E(ge,le,Se-te),ge=ke,++pe,++Se;if(he=(1+2*he)/(2*je),se=T[he]*.5,ge*=se,B.blocktype_old[X&1]==P.SHORT_TYPE){var Qe=n*B.nb_1[X][te];Qe>0?Y[te]=Math.min(ge,Qe):Y[te]=Math.min(ge,z[te]*u)}else{var Ie=i*B.nb_2[X][te],ze=n*B.nb_1[X][te],Qe;Ie<=0&&(Ie=ge),ze<=0&&(ze=ge),B.blocktype_old[X&1]==P.NORM_TYPE?Qe=Math.min(ze,Ie):Qe=ze,Y[te]=Math.min(ge,Qe)}B.nb_2[X][te]=B.nb_1[X][te],B.nb_1[X][te]=ge,le=V[te],le*=B.minval_l[te],le*=se,Y[te]>le&&(Y[te]=le),B.masking_lower>1&&(Y[te]*=B.masking_lower),Y[te]>z[te]&&(Y[te]=z[te]),B.masking_lower<1&&(Y[te]*=B.masking_lower),ct(Y[te]>=0)}for(;te<P.CBANDS;++te)z[te]=0,Y[te]=0}function re(B,U){var z=B.internal_flags;B.short_blocks==da.short_block_coupled&&!(U[0]!=0&&U[1]!=0)&&(U[0]=U[1]=0);for(var Y=0;Y<z.channels_out;Y++)B.short_blocks==da.short_block_dispensed&&(U[Y]=1),B.short_blocks==da.short_block_forced&&(U[Y]=0)}function Q(B,U,z){for(var Y=B.internal_flags,X=0;X<Y.channels_out;X++){var V=P.NORM_TYPE;U[X]!=0?(ct(Y.blocktype_old[X]!=P.START_TYPE),Y.blocktype_old[X]==P.SHORT_TYPE&&(V=P.STOP_TYPE)):(V=P.SHORT_TYPE,Y.blocktype_old[X]==P.NORM_TYPE&&(Y.blocktype_old[X]=P.START_TYPE),Y.blocktype_old[X]==P.STOP_TYPE&&(Y.blocktype_old[X]=P.SHORT_TYPE)),z[X]=Y.blocktype_old[X],Y.blocktype_old[X]=V}}function Ee(B,U,z,Y,X,V,ne){for(var oe=V*2,te=V>0?Math.pow(10,X):1,pe,le,ge=0;ge<ne;++ge){var se=B[2][ge],ke=B[3][ge],Se=U[0][ge],We=U[1][ge],he=U[2][ge],je=U[3][ge];if(Se<=1.58*We&&We<=1.58*Se){var Qe=z[ge]*ke,Ie=z[ge]*se;le=Math.max(he,Math.min(je,Qe)),pe=Math.max(je,Math.min(he,Ie))}else le=he,pe=je;if(V>0){var ze,Re,Xe=Y[ge]*te;if(ze=Math.min(Math.max(Se,Xe),Math.max(We,Xe)),he=Math.max(le,Xe),je=Math.max(pe,Xe),Re=he+je,Re>0&&ze*oe<Re){var Xt=ze*oe/Re;he*=Xt,je*=Xt}le=Math.min(he,le),pe=Math.min(je,pe)}le>se&&(le=se),pe>ke&&(pe=ke),U[2][ge]=le,U[3][ge]=pe}}this.L3psycho_anal_vbr=function(B,U,z,Y,X,V,ne,oe,te,pe){var le=B.internal_flags,ge,se,ke=pn(P.HBLKSIZE),Se=qi([3,P.HBLKSIZE_s]),We=qi([2,P.BLKSIZE]),he=qi([2,3,P.BLKSIZE_s]),je=qi([4,P.CBANDS]),Qe=qi([4,P.CBANDS]),Ie=qi([4,3]),ze=.6,Re=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Xe=eo(2),Xt=B.mode==It.JOINT_STEREO?4:le.channels_out;q(B,U,z,Y,X,V,te,Ie,Re,Xe),re(B,Xe);{for(var He=0;He<Xt;He++){var it=He&1;ge=We,Ye(B,U,z,He,Y,ke,ge,it),k(B,Y,He,ke),Xe[it]!=0?J(le,ke,je[He],Qe[He],He):G(le,He)}Xe[0]+Xe[1]==2&&B.mode==It.JOINT_STEREO&&Ee(je,Qe,le.mld_cb_l,le.ATH.cb_l,B.ATHlower*le.ATH.adjust,B.msfix,le.npart_l);for(var He=0;He<Xt;He++){var it=He&1;Xe[it]!=0&&p(le,je[He],Qe[He],He)}}{for(var ut=0;ut<3;ut++){for(var He=0;He<Xt;++He){var it=He&1;Xe[it]!=0?W(le,He,ut):(se=he,lt(B,U,z,He,ut,Se,se,it),ce(B,Se,je[He],Qe[He],He,ut))}Xe[0]+Xe[1]==0&&B.mode==It.JOINT_STEREO&&Ee(je,Qe,le.mld_cb_s,le.ATH.cb_s,B.ATHlower*le.ATH.adjust,B.msfix,le.npart_s);for(var He=0;He<Xt;++He){var it=He&1;Xe[it]==0&&$(le,je[He],Qe[He],He,ut)}}for(var He=0;He<Xt;He++){var it=He&1;if(Xe[it]==0)for(var nn=0;nn<P.SBMAX_s;nn++){for(var Ei=pn(3),ut=0;ut<3;ut++){var hn=le.thm[He].s[nn][ut];if(hn*=c,Re[He][ut]>=2||Re[He][ut+1]==1){var rn=ut!=0?ut-1:2,li=D(le.thm[He].s[nn][rn],hn,d*ze);hn=Math.min(hn,li)}else if(Re[He][ut]==1){var rn=ut!=0?ut-1:2,li=D(le.thm[He].s[nn][rn],hn,u*ze);hn=Math.min(hn,li)}else if(ut!=0&&Re[He][ut-1]==3||ut==0&&le.nsPsy.lastAttacks[He]==3){var rn=ut!=2?ut+1:0,li=D(le.thm[He].s[nn][rn],hn,u*ze);hn=Math.min(hn,li)}hn*=Ie[He][ut],Ei[ut]=hn}for(var ut=0;ut<3;ut++)le.thm[He].s[nn][ut]=Ei[ut]}}}for(var He=0;He<Xt;He++)le.nsPsy.lastAttacks[He]=Re[He][2];Q(B,Xe,pe);for(var He=0;He<Xt;He++){var Si,Ti,Ji,er;He>1?(Si=oe,Ti=-2,Ji=P.NORM_TYPE,(pe[0]==P.SHORT_TYPE||pe[1]==P.SHORT_TYPE)&&(Ji=P.SHORT_TYPE),er=V[Y][He-2]):(Si=ne,Ti=0,Ji=pe[He],er=X[Y][He]),Ji==P.SHORT_TYPE?Si[Ti+He]=Oe(er,le.masking_lower):Si[Ti+He]=be(er,le.masking_lower),B.analysis&&(le.pinfo.pe[Y][He]=Si[Ti+He])}return 0};function fe(B,U){var z=B,Y;return z>=0?Y=-z*27:Y=z*U,Y<=-72?0:Math.exp(Y*h)}function Te(B){var U=0,z=0;{var Y=0,X,V;for(Y=0;fe(Y,B)>1e-20;Y-=1);for(X=Y,V=0;Math.abs(V-X)>1e-12;)Y=(V+X)/2,fe(Y,B)>0?V=Y:X=Y;U=X}{var Y=0,X,V;for(Y=0;fe(Y,B)>1e-20;Y+=1);for(X=0,V=Y;Math.abs(V-X)>1e-12;)Y=(V+X)/2,fe(Y,B)>0?X=Y:V=Y;z=V}{var ne=0,oe=1e3,te;for(te=0;te<=oe;++te){var Y=U+te*(z-U)/oe,pe=fe(Y,B);ne+=pe}{var le=(oe+1)/(ne*(z-U));return le}}}function Ce(B){var U,z,Y,X;return U=B,U>=0?U*=3:U*=1.5,U>=.5&&U<=2.5?(X=U-.5,z=8*(X*X-2*X)):z=0,U+=.474,Y=15.811389+7.5*U-17.5*Math.sqrt(1+U*U),Y<=-60?0:(U=Math.exp((z+Y)*h),U/=.6609193,U)}function Le(B){return B<0&&(B=0),B=B*.001,13*Math.atan(.76*B)+3.5*Math.atan(B*B/(7.5*7.5))}function ue(B,U,z,Y,X,V,ne,oe,te,pe,le,ge){var se=pn(P.CBANDS+1),ke=oe/(ge>15?2*576:2*192),Se=eo(P.HBLKSIZE),We;oe/=te;var he=0,je=0;for(We=0;We<P.CBANDS;We++){var Qe,Ie;for(Qe=Le(oe*he),se[We]=oe*he,Ie=he;Le(oe*Ie)-Qe<o&&Ie<=te/2;Ie++);for(B[We]=Ie-he,je=We+1;he<Ie;)Se[he++]=We;if(he>te/2){he=te/2,++We;break}}se[We]=oe*he;for(var ze=0;ze<ge;ze++){var Re,Xe,Xt,He,it;Xt=pe[ze],He=pe[ze+1],Re=0|Math.floor(.5+le*(Xt-.5)),Re<0&&(Re=0),Xe=0|Math.floor(.5+le*(He-.5)),Xe>te/2&&(Xe=te/2),z[ze]=(Se[Re]+Se[Xe])/2,U[ze]=Se[Xe];var ut=ke*He;ne[ze]=(ut-se[U[ze]])/(se[U[ze]+1]-se[U[ze]]),ne[ze]<0?ne[ze]=0:ne[ze]>1&&(ne[ze]=1),it=Le(oe*pe[ze]*le),it=Math.min(it,15.5)/15.5,V[ze]=Math.pow(10,1.25*(1-Math.cos(Math.PI*it))-2.5)}he=0;for(var nn=0;nn<je;nn++){var Ei=B[nn],Qe,hn;Qe=Le(oe*he),hn=Le(oe*(he+Ei-1)),Y[nn]=.5*(Qe+hn),Qe=Le(oe*(he-.5)),hn=Le(oe*(he+Ei-.5)),X[nn]=hn-Qe,he+=Ei}return je}function ve(B,U,z,Y,X,V){var ne=qi([P.CBANDS,P.CBANDS]),oe,te=0;if(V)for(var pe=0;pe<U;pe++)for(oe=0;oe<U;oe++){var le=Ce(z[pe]-z[oe])*Y[oe];ne[pe][oe]=le*X[pe]}else for(oe=0;oe<U;oe++)for(var ge=15+Math.min(21/z[oe],12),se=Te(ge),pe=0;pe<U;pe++){var le=se*fe(z[pe]-z[oe],ge)*Y[oe];ne[pe][oe]=le*X[pe]}for(var pe=0;pe<U;pe++){for(oe=0;oe<U&&!(ne[pe][oe]>0);oe++);for(B[pe][0]=oe,oe=U-1;oe>0&&!(ne[pe][oe]>0);oe--);B[pe][1]=oe,te+=B[pe][1]-B[pe][0]+1}for(var ke=pn(te),Se=0,pe=0;pe<U;pe++)for(oe=B[pe][0];oe<=B[pe][1];oe++)ke[Se++]=ne[pe][oe];return ke}function ee(B){var U=Le(B);return U=Math.min(U,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*U))-2.5)}this.psymodel_init=function(B){var U=B.internal_flags,z,Y=!0,X=13,V=24,ne=0,oe=0,te=-8.25,pe=-4.5,le=pn(P.CBANDS),ge=pn(P.CBANDS),se=pn(P.CBANDS),ke=B.out_samplerate;switch(B.experimentalZ){default:case 0:Y=!0;break;case 1:Y=!(B.VBR==ha.vbr_mtrh||B.VBR==ha.vbr_mt);break;case 2:Y=!1;break;case 3:X=8,ne=-1.75,oe=-.0125,te=-8.25,pe=-2.25;break}for(U.ms_ener_ratio_old=.25,U.blocktype_old[0]=U.blocktype_old[1]=P.NORM_TYPE,z=0;z<4;++z){for(var he=0;he<P.CBANDS;++he)U.nb_1[z][he]=1e20,U.nb_2[z][he]=1e20,U.nb_s1[z][he]=U.nb_s2[z][he]=1;for(var Se=0;Se<P.SBMAX_l;Se++)U.en[z].l[Se]=1e20,U.thm[z].l[Se]=1e20;for(var he=0;he<3;++he){for(var Se=0;Se<P.SBMAX_s;Se++)U.en[z].s[Se][he]=1e20,U.thm[z].s[Se][he]=1e20;U.nsPsy.lastAttacks[z]=0}for(var he=0;he<9;he++)U.nsPsy.last_en_subshort[z][he]=10}for(U.loudness_sq_save[0]=U.loudness_sq_save[1]=0,U.npart_l=ue(U.numlines_l,U.bo_l,U.bm_l,le,ge,U.mld_l,U.PSY.bo_l_weight,ke,P.BLKSIZE,U.scalefac_band.l,P.BLKSIZE/(2*576),P.SBMAX_l),ct(U.npart_l<P.CBANDS),z=0;z<U.npart_l;z++){var We=ne;le[z]>=X&&(We=oe*(le[z]-X)/(V-X)+ne*(V-le[z])/(V-X)),se[z]=Math.pow(10,We/10),U.numlines_l[z]>0?U.rnumlines_l[z]=1/U.numlines_l[z]:U.rnumlines_l[z]=0}U.s3_ll=ve(U.s3ind,U.npart_l,le,ge,se,Y);var he=0;for(z=0;z<U.npart_l;z++){var je;je=f3.MAX_VALUE;for(var Qe=0;Qe<U.numlines_l[z];Qe++,he++){var Ie=ke*he/(1e3*P.BLKSIZE),ze;ze=this.ATHformula(Ie*1e3,B)-20,ze=Math.pow(10,.1*ze),ze*=U.numlines_l[z],je>ze&&(je=ze)}U.ATH.cb_l[z]=je,je=-20+le[z]*20/10,je>6&&(je=100),je<-15&&(je=-15),je-=8,U.minval_l[z]=Math.pow(10,je/10)*U.numlines_l[z]}for(U.npart_s=ue(U.numlines_s,U.bo_s,U.bm_s,le,ge,U.mld_s,U.PSY.bo_s_weight,ke,P.BLKSIZE_s,U.scalefac_band.s,P.BLKSIZE_s/(2*192),P.SBMAX_s),ct(U.npart_s<P.CBANDS),he=0,z=0;z<U.npart_s;z++){var je,We=te;le[z]>=X&&(We=pe*(le[z]-X)/(V-X)+te*(V-le[z])/(V-X)),se[z]=Math.pow(10,We/10),je=f3.MAX_VALUE;for(var Qe=0;Qe<U.numlines_s[z];Qe++,he++){var Ie=ke*he/(1e3*P.BLKSIZE_s),ze;ze=this.ATHformula(Ie*1e3,B)-20,ze=Math.pow(10,.1*ze),ze*=U.numlines_s[z],je>ze&&(je=ze)}U.ATH.cb_s[z]=je,je=-7+le[z]*7/12,le[z]>12&&(je*=1+Math.log(1+je)*3.1),le[z]<12&&(je*=1+Math.log(1-je)*2.3),je<-15&&(je=-15),je-=8,U.minval_s[z]=Math.pow(10,je/10)*U.numlines_s[z]}U.s3_ss=ve(U.s3ind_s,U.npart_s,le,ge,se,Y),S(),e.init_fft(U),U.decay=Math.exp(-1*t/(l*ke/192));{var Re;Re=f,(B.exp_nspsytune&2)!=0&&(Re=1),Math.abs(B.msfix)>0&&(Re=B.msfix),B.msfix=Re;for(var Xe=0;Xe<U.npart_l;Xe++)U.s3ind[Xe][1]>U.npart_l-1&&(U.s3ind[Xe][1]=U.npart_l-1)}var Xt=576*U.mode_gr/ke;if(U.ATH.decay=Math.pow(10,-12/10*Xt),U.ATH.adjust=.01,U.ATH.adjustLimit=1,ct(U.bo_l[P.SBMAX_l-1]<=U.npart_l),ct(U.bo_s[P.SBMAX_s-1]<=U.npart_s),B.ATHtype!=-1){var Ie,He=B.out_samplerate/P.BLKSIZE,it=0;for(Ie=0,z=0;z<P.BLKSIZE/2;++z)Ie+=He,U.ATH.eql_w[z]=1/Math.pow(10,this.ATHformula(Ie,B)/10),it+=U.ATH.eql_w[z];for(it=1/it,z=P.BLKSIZE/2;--z>=0;)U.ATH.eql_w[z]*=it}{for(var Xe=he=0;Xe<U.npart_s;++Xe)for(z=0;z<U.numlines_s[Xe];++z)++he;for(var Xe=he=0;Xe<U.npart_l;++Xe)for(z=0;z<U.numlines_l[Xe];++z)++he}for(he=0,z=0;z<U.npart_l;z++){var Ie=ke*(he+U.numlines_l[z]/2)/(1*P.BLKSIZE);U.mld_cb_l[z]=ee(Ie),he+=U.numlines_l[z]}for(;z<P.CBANDS;++z)U.mld_cb_l[z]=1;for(he=0,z=0;z<U.npart_s;z++){var Ie=ke*(he+U.numlines_s[z]/2)/(1*P.BLKSIZE_s);U.mld_cb_s[z]=ee(Ie),he+=U.numlines_s[z]}for(;z<P.CBANDS;++z)U.mld_cb_s[z]=1;return 0};function Ne(B,U){B<-.3&&(B=3410),B/=1e3,B=Math.max(.1,B);var z=3.64*Math.pow(B,-.8)-6.8*Math.exp(-.6*Math.pow(B-3.4,2))+6*Math.exp(-.15*Math.pow(B-8.7,2))+(.6+.04*U)*.001*Math.pow(B,4);return z}this.ATHformula=function(B,U){var z;switch(U.ATHtype){case 0:z=Ne(B,9);break;case 1:z=Ne(B,-1);break;case 2:z=Ne(B,0);break;case 3:z=Ne(B,1)+6;break;case 4:z=Ne(B,U.ATHcurve);break;default:z=Ne(B,0);break}return z}}function D$(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=It.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Ms={};Ms.SFBMAX=P.SBMAX_s*3;var B$=De.new_float,to=De.new_int;function Cd(){this.xr=B$(576),this.l3_enc=to(576),this.scalefac=to(Ms.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=to(3),this.subblock_gain=to(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=to(Ms.SFBMAX),this.window=to(Ms.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=to(4),this.max_nonzero_coeff=0;var e=this;function t(i){return new Int32Array(i)}function n(i){return new Float32Array(i)}this.assign=function(i){e.xr=n(i.xr),e.l3_enc=t(i.l3_enc),e.scalefac=t(i.scalefac),e.xrpow_max=i.xrpow_max,e.part2_3_length=i.part2_3_length,e.big_values=i.big_values,e.count1=i.count1,e.global_gain=i.global_gain,e.scalefac_compress=i.scalefac_compress,e.block_type=i.block_type,e.mixed_block_flag=i.mixed_block_flag,e.table_select=t(i.table_select),e.subblock_gain=t(i.subblock_gain),e.region0_count=i.region0_count,e.region1_count=i.region1_count,e.preflag=i.preflag,e.scalefac_scale=i.scalefac_scale,e.count1table_select=i.count1table_select,e.part2_length=i.part2_length,e.sfb_lmax=i.sfb_lmax,e.sfb_smin=i.sfb_smin,e.psy_lmax=i.psy_lmax,e.sfbmax=i.sfbmax,e.psymax=i.psymax,e.sfbdivide=i.sfbdivide,e.width=t(i.width),e.window=t(i.window),e.count1bits=i.count1bits,e.sfb_partition_table=i.sfb_partition_table.slice(0),e.slen=t(i.slen),e.max_nonzero_coeff=i.max_nonzero_coeff}}var m3=De.new_int;function P$(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[m3(4),m3(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Cd}var oh=De.System,ah=De.new_int;function br(e,t,n,i){this.l=ah(1+P.SBMAX_l),this.s=ah(1+P.SBMAX_s),this.psfb21=ah(1+P.PSFB21),this.psfb12=ah(1+P.PSFB12);var r=this.l,s=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],oh.arraycopy(this.arrL,0,r,0,Math.min(this.arrL.length,this.l.length)),oh.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),oh.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),oh.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var s1=De.new_float,U$=De.new_float_n,j$=De.new_int;function H$(){this.last_en_subshort=U$([4,9]),this.lastAttacks=j$(4),this.pefirbuf=s1(19),this.longfact=s1(P.SBMAX_l),this.shortfact=s1(P.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function V$(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var q$=De.new_byte,z$=De.new_double,zi=De.new_float,no=De.new_float_n,tr=De.new_int,lh=De.new_int_n;At.MFSIZE=3*1152+P.ENCDELAY-P.MDCTDELAY;At.MAX_HEADER_BUF=256;At.MAX_BITS_PER_CHANNEL=4095;At.MAX_BITS_PER_GRANULE=7680;At.BPC=320;function At(){var e=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=no([2,At.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new P$,this.ms_ratio=zi(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=tr(2),this.CurrentStep=tr(2),this.masking_lower=0,this.bv_scf=tr(576),this.pseudohalf=tr(Ms.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*At.BPC+1),this.itime=z$(2),this.sideinfo_len=0,this.sb_sample=no([2,2,18,P.SBLIMIT]),this.amp_filter=zi(32);function t(){this.write_timing=0,this.ptr=0,this.buf=q$(e)}this.header=new Array(At.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new br,this.minval_l=zi(P.CBANDS),this.minval_s=zi(P.CBANDS),this.nb_1=no([4,P.CBANDS]),this.nb_2=no([4,P.CBANDS]),this.nb_s1=no([4,P.CBANDS]),this.nb_s2=no([4,P.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=zi(4),this.loudness_sq=no([2,2]),this.loudness_sq_save=zi(2),this.mld_l=zi(P.SBMAX_l),this.mld_s=zi(P.SBMAX_s),this.bm_l=tr(P.SBMAX_l),this.bo_l=tr(P.SBMAX_l),this.bm_s=tr(P.SBMAX_s),this.bo_s=tr(P.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=lh([P.CBANDS,2]),this.s3ind_s=lh([P.CBANDS,2]),this.numlines_s=tr(P.CBANDS),this.numlines_l=tr(P.CBANDS),this.rnumlines_l=zi(P.CBANDS),this.mld_cb_l=zi(P.CBANDS),this.mld_cb_s=zi(P.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=zi(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=tr(2),this.nsPsy=new H$,this.VBR_seek_table=new V$,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=lh([16,4+1]),this.bitrate_blockType_Hist=lh([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new xd;for(var n=0;n<this.thm.length;n++)this.thm[n]=new xd;for(var n=0;n<this.header.length;n++)this.header[n]=new t}var io=De.new_float;function $$(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=io(P.SBMAX_l),this.s=io(P.SBMAX_s),this.psfb21=io(P.PSFB21),this.psfb12=io(P.PSFB12),this.cb_l=io(P.CBANDS),this.cb_s=io(P.CBANDS),this.eql_w=io(P.BLKSIZE/2)}var hi=De.System,p3=De.Arrays;cn.STEPS_per_dB=100;cn.MAX_dB=120;cn.GAIN_NOT_ENOUGH_SAMPLES=-24601;cn.GAIN_ANALYSIS_ERROR=0;cn.GAIN_ANALYSIS_OK=1;cn.INIT_GAIN_ANALYSIS_ERROR=0;cn.INIT_GAIN_ANALYSIS_OK=1;cn.YULE_ORDER=10;cn.MAX_ORDER=cn.YULE_ORDER;cn.MAX_SAMP_FREQ=48e3;cn.RMS_WINDOW_TIME_NUMERATOR=1;cn.RMS_WINDOW_TIME_DENOMINATOR=20;cn.MAX_SAMPLES_PER_WINDOW=cn.MAX_SAMP_FREQ*cn.RMS_WINDOW_TIME_NUMERATOR/cn.RMS_WINDOW_TIME_DENOMINATOR+1;function cn(){var e=64.82,t=.95,n=cn.RMS_WINDOW_TIME_NUMERATOR,i=cn.RMS_WINDOW_TIME_DENOMINATOR,r=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],s=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(u,f,m,h,R,M){for(;R--!=0;)m[h]=1e-10+u[f+0]*M[0]-m[h-1]*M[1]+u[f-1]*M[2]-m[h-2]*M[3]+u[f-2]*M[4]-m[h-3]*M[5]+u[f-3]*M[6]-m[h-4]*M[7]+u[f-4]*M[8]-m[h-5]*M[9]+u[f-5]*M[10]-m[h-6]*M[11]+u[f-6]*M[12]-m[h-7]*M[13]+u[f-7]*M[14]-m[h-8]*M[15]+u[f-8]*M[16]-m[h-9]*M[17]+u[f-9]*M[18]-m[h-10]*M[19]+u[f-10]*M[20],++h,++f}function a(u,f,m,h,R,M){for(;R--!=0;)m[h]=u[f+0]*M[0]-m[h-1]*M[1]+u[f-1]*M[2]-m[h-2]*M[3]+u[f-2]*M[4],++h,++f}function l(u,f){for(var m=0;m<MAX_ORDER;m++)u.linprebuf[m]=u.lstepbuf[m]=u.loutbuf[m]=u.rinprebuf[m]=u.rstepbuf[m]=u.routbuf[m]=0;switch(0|f){case 48e3:u.reqindex=0;break;case 44100:u.reqindex=1;break;case 32e3:u.reqindex=2;break;case 24e3:u.reqindex=3;break;case 22050:u.reqindex=4;break;case 16e3:u.reqindex=5;break;case 12e3:u.reqindex=6;break;case 11025:u.reqindex=7;break;case 8e3:u.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return u.sampleWindow=0|(f*n+i-1)/i,u.lsum=0,u.rsum=0,u.totsamp=0,p3.ill(u.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(u,f){return l(u,f)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(u.linpre=MAX_ORDER,u.rinpre=MAX_ORDER,u.lstep=MAX_ORDER,u.rstep=MAX_ORDER,u.lout=MAX_ORDER,u.rout=MAX_ORDER,p3.fill(u.B,0),INIT_GAIN_ANALYSIS_OK)};function c(u){return u*u}this.AnalyzeSamples=function(u,f,m,h,R,M,C){var _,x,F,O,N,v,T;if(M==0)return GAIN_ANALYSIS_OK;switch(T=0,N=M,C){case 1:h=f,R=m;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(M<MAX_ORDER?(hi.arraycopy(f,m,u.linprebuf,MAX_ORDER,M),hi.arraycopy(h,R,u.rinprebuf,MAX_ORDER,M)):(hi.arraycopy(f,m,u.linprebuf,MAX_ORDER,MAX_ORDER),hi.arraycopy(h,R,u.rinprebuf,MAX_ORDER,MAX_ORDER));N>0;){v=N>u.sampleWindow-u.totsamp?u.sampleWindow-u.totsamp:N,T<MAX_ORDER?(_=u.linpre+T,x=u.linprebuf,F=u.rinpre+T,O=u.rinprebuf,v>MAX_ORDER-T&&(v=MAX_ORDER-T)):(_=m+T,x=f,F=R+T,O=h),o(x,_,u.lstepbuf,u.lstep+u.totsamp,v,r[u.reqindex]),o(O,F,u.rstepbuf,u.rstep+u.totsamp,v,r[u.reqindex]),a(u.lstepbuf,u.lstep+u.totsamp,u.loutbuf,u.lout+u.totsamp,v,s[u.reqindex]),a(u.rstepbuf,u.rstep+u.totsamp,u.routbuf,u.rout+u.totsamp,v,s[u.reqindex]),_=u.lout+u.totsamp,x=u.loutbuf,F=u.rout+u.totsamp,O=u.routbuf;for(var S=v%8;S--!=0;)u.lsum+=c(x[_++]),u.rsum+=c(O[F++]);for(S=v/8;S--!=0;)u.lsum+=c(x[_+0])+c(x[_+1])+c(x[_+2])+c(x[_+3])+c(x[_+4])+c(x[_+5])+c(x[_+6])+c(x[_+7]),_+=8,u.rsum+=c(O[F+0])+c(O[F+1])+c(O[F+2])+c(O[F+3])+c(O[F+4])+c(O[F+5])+c(O[F+6])+c(O[F+7]),F+=8;if(N-=v,T+=v,u.totsamp+=v,u.totsamp==u.sampleWindow){var g=cn.STEPS_per_dB*10*Math.log10((u.lsum+u.rsum)/u.totsamp*.5+1e-37),b=g<=0?0:0|g;b>=u.A.length&&(b=u.A.length-1),u.A[b]++,u.lsum=u.rsum=0,hi.arraycopy(u.loutbuf,u.totsamp,u.loutbuf,0,MAX_ORDER),hi.arraycopy(u.routbuf,u.totsamp,u.routbuf,0,MAX_ORDER),hi.arraycopy(u.lstepbuf,u.totsamp,u.lstepbuf,0,MAX_ORDER),hi.arraycopy(u.rstepbuf,u.totsamp,u.rstepbuf,0,MAX_ORDER),u.totsamp=0}if(u.totsamp>u.sampleWindow)return GAIN_ANALYSIS_ERROR}return M<MAX_ORDER?(hi.arraycopy(u.linprebuf,M,u.linprebuf,0,MAX_ORDER-M),hi.arraycopy(u.rinprebuf,M,u.rinprebuf,0,MAX_ORDER-M),hi.arraycopy(f,m,u.linprebuf,MAX_ORDER-M,M),hi.arraycopy(h,R,u.rinprebuf,MAX_ORDER-M,M)):(hi.arraycopy(f,m+M-MAX_ORDER,u.linprebuf,0,MAX_ORDER),hi.arraycopy(h,R+M-MAX_ORDER,u.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function d(u,f){var m,h=0;for(m=0;m<f;m++)h+=u[m];if(h==0)return GAIN_NOT_ENOUGH_SAMPLES;var R=0|Math.ceil(h*(1-t));for(m=f;m-- >0&&!((R-=u[m])<=0););return e-m/cn.STEPS_per_dB}this.GetTitleGain=function(u){for(var f=d(u.A,u.A.length),m=0;m<u.A.length;m++)u.B[m]+=u.A[m],u.A[m]=0;for(var m=0;m<MAX_ORDER;m++)u.linprebuf[m]=u.lstepbuf[m]=u.loutbuf[m]=u.rinprebuf[m]=u.rstepbuf[m]=u.routbuf[m]=0;return u.totsamp=0,u.lsum=u.rsum=0,f}}var fa=De.new_float,g3=De.new_int;function W$(){this.linprebuf=fa(void 0*2),this.linpre=0,this.lstepbuf=fa(void 0+void 0),this.lstep=0,this.loutbuf=fa(void 0+void 0),this.lout=0,this.rinprebuf=fa(void 0*2),this.rinpre=0,this.rstepbuf=fa(void 0+void 0),this.rstep=0,this.routbuf=fa(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=g3(0|void 0*void 0),this.B=g3(0|void 0*void 0)}function uS(e){this.bits=e}var _3=De.new_float,K$=De.new_int,v3=De.assert;function G$(e){var t=e;this.quantize=t,this.iteration_loop=function(n,i,r,s){var o=n.internal_flags,a=_3(Ms.SFBMAX),l=_3(576),c=K$(2),d=0,u,f=o.l3_side,m=new uS(d);this.quantize.rv.ResvFrameBegin(n,m),d=m.bits;for(var h=0;h<o.mode_gr;h++){u=this.quantize.qupvt.on_pe(n,i,c,d,h,h),o.mode_ext==P.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,h),this.quantize.qupvt.reduce_side(c,r[h],d,u));for(var R=0;R<o.channels_out;R++){var M,C,_=f.tt[h][R];_.block_type!=P.SHORT_TYPE?(M=0,C=o.PSY.mask_adjust-M):(M=0,C=o.PSY.mask_adjust_short-M),o.masking_lower=Math.pow(10,C*.1),this.quantize.init_outer_loop(o,_),this.quantize.init_xrpow(o,_,l)&&(this.quantize.qupvt.calc_xmin(n,s[h][R],_,a),this.quantize.outer_loop(n,_,a,l,R,c[R])),this.quantize.iteration_finish_one(o,h,R),v3(_.part2_3_length<=At.MAX_BITS_PER_CHANNEL),v3(_.part2_3_length<=c[R])}}this.quantize.rv.ResvFrameEnd(o,d)}}function St(e,t,n,i){this.xlen=e,this.linmax=t,this.table=n,this.hlen=i}var me={};me.t1HB=[1,1,1,0];me.t2HB=[1,2,1,3,1,1,3,2,0];me.t3HB=[3,2,1,1,1,1,3,2,0];me.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];me.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];me.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];me.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];me.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];me.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];me.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];me.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];me.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];me.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];me.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];me.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];me.t32HB=[1<<0,5<<1,4<<1,5<<2,6<<1,5<<2,4<<2,4<<3,7<<1,3<<2,6<<2,0<<3,7<<2,2<<3,3<<3,1<<4];me.t33HB=[15<<0,14<<1,13<<1,12<<2,11<<1,10<<2,9<<2,8<<3,7<<1,6<<2,5<<2,4<<3,3<<2,2<<3,1<<3,0<<4];me.t1l=[1,4,3,5];me.t2l=[1,4,7,4,5,7,6,7,8];me.t3l=[2,3,7,4,4,7,6,7,8];me.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];me.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];me.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];me.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];me.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];me.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];me.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];me.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];me.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];me.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];me.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];me.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];me.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];me.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4];me.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4];me.ht=[new St(0,0,null,null),new St(2,0,me.t1HB,me.t1l),new St(3,0,me.t2HB,me.t2l),new St(3,0,me.t3HB,me.t3l),new St(0,0,null,null),new St(4,0,me.t5HB,me.t5l),new St(4,0,me.t6HB,me.t6l),new St(6,0,me.t7HB,me.t7l),new St(6,0,me.t8HB,me.t8l),new St(6,0,me.t9HB,me.t9l),new St(8,0,me.t10HB,me.t10l),new St(8,0,me.t11HB,me.t11l),new St(8,0,me.t12HB,me.t12l),new St(16,0,me.t13HB,me.t13l),new St(0,0,null,me.t16_5l),new St(16,0,me.t15HB,me.t15l),new St(1,1,me.t16HB,me.t16l),new St(2,3,me.t16HB,me.t16l),new St(3,7,me.t16HB,me.t16l),new St(4,15,me.t16HB,me.t16l),new St(6,63,me.t16HB,me.t16l),new St(8,255,me.t16HB,me.t16l),new St(10,1023,me.t16HB,me.t16l),new St(13,8191,me.t16HB,me.t16l),new St(4,15,me.t24HB,me.t24l),new St(5,31,me.t24HB,me.t24l),new St(6,63,me.t24HB,me.t24l),new St(7,127,me.t24HB,me.t24l),new St(8,255,me.t24HB,me.t24l),new St(9,511,me.t24HB,me.t24l),new St(11,2047,me.t24HB,me.t24l),new St(13,8191,me.t24HB,me.t24l),new St(0,0,me.t32HB,me.t32l),new St(0,0,me.t33HB,me.t33l)];me.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];me.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];me.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];me.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];me.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];me.scfsi_band=[0,6,11,16,21];var ro=De.VbrMode,ch=De.Float,o1=De.Util,so=De.new_float,Y$=De.new_int,Fl=De.assert;Un.Q_MAX=256+1;Un.Q_MAX2=116;Un.LARGE_BITS=1e5;Un.IXMAX_VAL=8206;function Un(){var e=null,t=null,n=null;this.setModules=function(_,x,F){e=_,t=x,n=F};function i(_){return u[_+Un.Q_MAX2]}this.IPOW20=function(_){return f[_]};var r=2220446049250313e-31,s=Un.IXMAX_VAL,o=s+2,a=Un.Q_MAX,l=Un.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new br([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new br([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=so(a+l+1),f=so(a),m=so(o),h=so(o);this.adj43=h;function R(_,x){var F=n.ATHformula(x,_);return F-=c,F=Math.pow(10,F/10+_.ATHlower),F}function M(_){for(var x=_.internal_flags.ATH.l,F=_.internal_flags.ATH.psfb21,O=_.internal_flags.ATH.s,N=_.internal_flags.ATH.psfb12,v=_.internal_flags,T=_.out_samplerate,S=0;S<P.SBMAX_l;S++){var g=v.scalefac_band.l[S],b=v.scalefac_band.l[S+1];x[S]=ch.MAX_VALUE;for(var y=g;y<b;y++){var w=y*T/1152,A=R(_,w);x[S]=Math.min(x[S],A)}}for(var S=0;S<P.PSFB21;S++){var g=v.scalefac_band.psfb21[S],b=v.scalefac_band.psfb21[S+1];F[S]=ch.MAX_VALUE;for(var y=g;y<b;y++){var w=y*T/1152,A=R(_,w);F[S]=Math.min(F[S],A)}}for(var S=0;S<P.SBMAX_s;S++){var g=v.scalefac_band.s[S],b=v.scalefac_band.s[S+1];O[S]=ch.MAX_VALUE;for(var y=g;y<b;y++){var w=y*T/384,A=R(_,w);O[S]=Math.min(O[S],A)}O[S]*=v.scalefac_band.s[S+1]-v.scalefac_band.s[S]}for(var S=0;S<P.PSFB12;S++){var g=v.scalefac_band.psfb12[S],b=v.scalefac_band.psfb12[S+1];N[S]=ch.MAX_VALUE;for(var y=g;y<b;y++){var w=y*T/384,A=R(_,w);N[S]=Math.min(N[S],A)}N[S]*=v.scalefac_band.s[13]-v.scalefac_band.s[12]}if(_.noATH){for(var S=0;S<P.SBMAX_l;S++)x[S]=1e-20;for(var S=0;S<P.PSFB21;S++)F[S]=1e-20;for(var S=0;S<P.SBMAX_s;S++)O[S]=1e-20;for(var S=0;S<P.PSFB12;S++)N[S]=1e-20}v.ATH.floor=10*Math.log10(R(_,-1))}this.iteration_init=function(_){var x=_.internal_flags,F=x.l3_side,O;if(x.iteration_init_init==0){for(x.iteration_init_init=1,F.main_data_begin=0,M(_),m[0]=0,O=1;O<o;O++)m[O]=Math.pow(O,4/3);for(O=0;O<o-1;O++)h[O]=O+1-Math.pow(.5*(m[O]+m[O+1]),.75);for(h[O]=.5,O=0;O<a;O++)f[O]=Math.pow(2,(O-210)*-.1875);for(O=0;O<=a+l;O++)u[O]=Math.pow(2,(O-210-l)*.25);e.huffman_init(x);{var N,v,T,S;for(O=_.exp_nspsytune>>2&63,O>=32&&(O-=64),N=Math.pow(10,O/4/10),O=_.exp_nspsytune>>8&63,O>=32&&(O-=64),v=Math.pow(10,O/4/10),O=_.exp_nspsytune>>14&63,O>=32&&(O-=64),T=Math.pow(10,O/4/10),O=_.exp_nspsytune>>20&63,O>=32&&(O-=64),S=T*Math.pow(10,O/4/10),O=0;O<P.SBMAX_l;O++){var g;O<=6?g=N:O<=13?g=v:O<=20?g=T:g=S,x.nsPsy.longfact[O]=g}for(O=0;O<P.SBMAX_s;O++){var g;O<=5?g=N:O<=10?g=v:O<=11?g=T:g=S,x.nsPsy.shortfact[O]=g}}}},this.on_pe=function(_,x,F,O,N,v){var T=_.internal_flags,S=0,g,b=Y$(2),y,w=new uS(S),A=t.ResvMaxBits(_,O,w,v);S=w.bits;var E=S+A;for(E>At.MAX_BITS_PER_GRANULE&&(E=At.MAX_BITS_PER_GRANULE),g=0,y=0;y<T.channels_out;++y)F[y]=Math.min(At.MAX_BITS_PER_CHANNEL,S/T.channels_out),b[y]=0|F[y]*x[N][y]/700-F[y],b[y]>O*3/4&&(b[y]=O*3/4),b[y]<0&&(b[y]=0),b[y]+F[y]>At.MAX_BITS_PER_CHANNEL&&(b[y]=Math.max(0,At.MAX_BITS_PER_CHANNEL-F[y])),g+=b[y];if(g>A)for(y=0;y<T.channels_out;++y)b[y]=A*b[y]/g;for(y=0;y<T.channels_out;++y)F[y]+=b[y],A-=b[y];for(g=0,y=0;y<T.channels_out;++y)g+=F[y];if(g>At.MAX_BITS_PER_GRANULE){var j=0;for(y=0;y<T.channels_out;++y)F[y]*=At.MAX_BITS_PER_GRANULE,F[y]/=g,j+=F[y]}return E},this.reduce_side=function(_,x,F,O){Fl(_[0]+_[1]<=At.MAX_BITS_PER_GRANULE);var N=.33*(.5-x)/.5;N<0&&(N=0),N>.5&&(N=.5);var v=0|N*.5*(_[0]+_[1]);v>At.MAX_BITS_PER_CHANNEL-_[0]&&(v=At.MAX_BITS_PER_CHANNEL-_[0]),v<0&&(v=0),_[1]>=125&&(_[1]-v>125?(_[0]<F&&(_[0]+=v),_[1]-=v):(_[0]+=_[1]-125,_[1]=125)),v=_[0]+_[1],v>O&&(_[0]=O*_[0]/v,_[1]=O*_[1]/v),Fl(_[0]<=At.MAX_BITS_PER_CHANNEL),Fl(_[1]<=At.MAX_BITS_PER_CHANNEL),Fl(_[0]+_[1]<=At.MAX_BITS_PER_GRANULE)},this.athAdjust=function(_,x,F){var O=90.30873362,N=94.82444863,v=o1.FAST_LOG10_X(x,10),T=_*_,S=0;return v-=F,T>1e-20&&(S=1+o1.FAST_LOG10_X(T,10/O)),S<0&&(S=0),v*=S,v+=F+O-N,Math.pow(10,.1*v)},this.calc_xmin=function(_,x,F,O){var N=0,v=_.internal_flags,T,S=0,g=0,b=v.ATH,y=F.xr,w=_.VBR==ro.vbr_mtrh?1:0,A=v.masking_lower;for((_.VBR==ro.vbr_mtrh||_.VBR==ro.vbr_mt)&&(A=1),T=0;T<F.psy_lmax;T++){var E,j,K,H,$,p;_.VBR==ro.vbr_rh||_.VBR==ro.vbr_mtrh?j=athAdjust(b.adjust,b.l[T],b.floor):j=b.adjust*b.l[T],$=F.width[T],K=j/$,H=r,p=$>>1,E=0;do{var I,Z;I=y[S]*y[S],E+=I,H+=I<K?I:K,S++,Z=y[S]*y[S],E+=Z,H+=Z<K?Z:K,S++}while(--p>0);if(E>j&&g++,T==P.SBPSY_l){var D=j*v.nsPsy.longfact[T];H<D&&(H=D)}if(w!=0&&(j=H),!_.ATHonly){var ye=x.en.l[T];if(ye>0){var D;D=E*x.thm.l[T]*A/ye,w!=0&&(D*=v.nsPsy.longfact[T]),j<D&&(j=D)}}w!=0?O[N++]=j:O[N++]=j*v.nsPsy.longfact[T]}var Oe=575;if(F.block_type!=P.SHORT_TYPE)for(var xe=576;xe--!=0&&$i.EQ(y[xe],0);)Oe=xe;F.max_nonzero_coeff=Oe;for(var be=F.sfb_smin;T<F.psymax;be++,T+=3){var $,qe,Fe;for(_.VBR==ro.vbr_rh||_.VBR==ro.vbr_mtrh?Fe=athAdjust(b.adjust,b.s[be],b.floor):Fe=b.adjust*b.s[be],$=F.width[T],qe=0;qe<3;qe++){var E=0,j,K,H,p=$>>1;K=Fe/$,H=r;do{var I,Z;I=y[S]*y[S],E+=I,H+=I<K?I:K,S++,Z=y[S]*y[S],E+=Z,H+=Z<K?Z:K,S++}while(--p>0);if(E>Fe&&g++,be==P.SBPSY_s){var D=Fe*v.nsPsy.shortfact[be];H<D&&(H=D)}if(w!=0?j=H:j=Fe,!_.ATHonly&&!_.ATHshort){var ye=x.en.s[be][qe];if(ye>0){var D;D=E*x.thm.s[be][qe]*A/ye,w!=0&&(D*=v.nsPsy.shortfact[be]),j<D&&(j=D)}}w!=0?O[N++]=j:O[N++]=j*v.nsPsy.shortfact[be]}_.useTemporal&&(O[N-3]>O[N-3+1]&&(O[N-3+1]+=(O[N-3]-O[N-3+1])*v.decay),O[N-3+1]>O[N-3+2]&&(O[N-3+2]+=(O[N-3+1]-O[N-3+2])*v.decay))}return g};function C(_){this.s=_}this.calc_noise_core=function(_,x,F,O){var N=0,v=x.s,T=_.l3_enc;if(v>_.count1)for(;F--!=0;){var S;S=_.xr[v],v++,N+=S*S,S=_.xr[v],v++,N+=S*S}else if(v>_.big_values){var g=so(2);for(g[0]=0,g[1]=O;F--!=0;){var S;S=Math.abs(_.xr[v])-g[T[v]],v++,N+=S*S,S=Math.abs(_.xr[v])-g[T[v]],v++,N+=S*S}}else for(;F--!=0;){var S;S=Math.abs(_.xr[v])-m[T[v]]*O,v++,N+=S*S,S=Math.abs(_.xr[v])-m[T[v]]*O,v++,N+=S*S}return x.s=v,N},this.calc_noise=function(_,x,F,O,N){var v=0,T=0,S,g,b=0,y=0,w=0,A=-20,E=0,j=_.scalefac,K=0;for(O.over_SSD=0,S=0;S<_.psymax;S++){var H=_.global_gain-(j[K++]+(_.preflag!=0?d[S]:0)<<_.scalefac_scale+1)-_.subblock_gain[_.window[S]]*8,$=0;if(N!=null&&N.step[S]==H)$=N.noise[S],E+=_.width[S],F[v++]=$/x[T++],$=N.noise_log[S];else{var p=i(H);if(g=_.width[S]>>1,E+_.width[S]>_.max_nonzero_coeff){var I;I=_.max_nonzero_coeff-E+1,I>0?g=I>>1:g=0}var Z=new C(E);$=this.calc_noise_core(_,Z,g,p),E=Z.s,N!=null&&(N.step[S]=H,N.noise[S]=$),$=F[v++]=$/x[T++],$=o1.FAST_LOG10(Math.max($,1e-20)),N!=null&&(N.noise_log[S]=$)}if(N!=null&&(N.global_gain=_.global_gain),w+=$,$>0){var D;D=Math.max(0|$*10+.5,1),O.over_SSD+=D*D,b++,y+=$}A=Math.max(A,$)}return O.over_count=b,O.tot_noise=w,O.over_noise=y,O.max_noise=A,b},this.set_pinfo=function(_,x,F,O,N){var v=_.internal_flags,T,S,g,b,y,w=x.scalefac_scale==0?.5:1,A=x.scalefac,E=so(L3Side.SFBMAX),j=so(L3Side.SFBMAX),K=new CalcNoiseResult;calc_xmin(_,F,x,E),calc_noise(x,E,j,K,null);var H=0;for(S=x.sfb_lmax,x.block_type!=P.SHORT_TYPE&&x.mixed_block_flag==0&&(S=22),T=0;T<S;T++){var $=v.scalefac_band.l[T],p=v.scalefac_band.l[T+1],I=p-$;for(b=0;H<p;H++)b+=x.xr[H]*x.xr[H];b/=I,y=1e15,v.pinfo.en[O][N][T]=y*b,v.pinfo.xfsf[O][N][T]=y*E[T]*j[T]/I,F.en.l[T]>0&&!_.ATHonly?b=b/F.en.l[T]:b=0,v.pinfo.thr[O][N][T]=y*Math.max(b*F.thm.l[T],v.ATH.l[T]),v.pinfo.LAMEsfb[O][N][T]=0,x.preflag!=0&&T>=11&&(v.pinfo.LAMEsfb[O][N][T]=-w*d[T]),T<P.SBPSY_l&&(Fl(A[T]>=0),v.pinfo.LAMEsfb[O][N][T]-=w*A[T])}if(x.block_type==P.SHORT_TYPE)for(S=T,T=x.sfb_smin;T<P.SBMAX_s;T++)for(var $=v.scalefac_band.s[T],p=v.scalefac_band.s[T+1],I=p-$,Z=0;Z<3;Z++){for(b=0,g=$;g<p;g++)b+=x.xr[H]*x.xr[H],H++;b=Math.max(b/I,1e-20),y=1e15,v.pinfo.en_s[O][N][3*T+Z]=y*b,v.pinfo.xfsf_s[O][N][3*T+Z]=y*E[S]*j[S]/I,F.en.s[T][Z]>0?b=b/F.en.s[T][Z]:b=0,(_.ATHonly||_.ATHshort)&&(b=0),v.pinfo.thr_s[O][N][3*T+Z]=y*Math.max(b*F.thm.s[T][Z],v.ATH.s[T]),v.pinfo.LAMEsfb_s[O][N][3*T+Z]=-2*x.subblock_gain[Z],T<P.SBPSY_s&&(v.pinfo.LAMEsfb_s[O][N][3*T+Z]-=w*A[S]),S++}v.pinfo.LAMEqss[O][N]=x.global_gain,v.pinfo.LAMEmainbits[O][N]=x.part2_3_length+x.part2_length,v.pinfo.LAMEsfbits[O][N]=x.part2_length,v.pinfo.over[O][N]=K.over_count,v.pinfo.max_noise[O][N]=K.max_noise*10,v.pinfo.over_noise[O][N]=K.over_noise*10,v.pinfo.tot_noise[O][N]=K.tot_noise*10,v.pinfo.over_SSD[O][N]=K.over_SSD}}var X$=De.System,Q$=De.Arrays,Ll=De.new_int,a1=De.assert;function Kc(){var e=null;this.qupvt=null,this.setModules=function(g){this.qupvt=g,e=g};function t(g){this.bits=0|g}var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function i(g,b,y,w,A,E){var j=.5946/b;for(g=g>>1;g--!=0;)A[E++]=j>y[w++]?0:1,A[E++]=j>y[w++]?0:1}function r(g,b,y,w,A,E){g=g>>1;var j=g%2;for(g=g>>1;g--!=0;){var K,H,$,p,I,Z,D,ye;K=y[w++]*b,H=y[w++]*b,I=0|K,$=y[w++]*b,Z=0|H,p=y[w++]*b,D=0|$,K+=e.adj43[I],ye=0|p,H+=e.adj43[Z],A[E++]=0|K,$+=e.adj43[D],A[E++]=0|H,p+=e.adj43[ye],A[E++]=0|$,A[E++]=0|p}if(j!=0){var K,H,I,Z;K=y[w++]*b,H=y[w++]*b,I=0|K,Z=0|H,K+=e.adj43[I],H+=e.adj43[Z],A[E++]=0|K,A[E++]=0|H}}function s(g,b,y,w,A){var E,j,K=0,H,$=0,p=0,I=0,Z=b,D=0,ye=Z,Oe=0,xe=g,be=0;for(H=A!=null&&w.global_gain==A.global_gain,w.block_type==P.SHORT_TYPE?j=38:j=21,E=0;E<=j;E++){var qe=-1;if((H||w.block_type==P.NORM_TYPE)&&(qe=w.global_gain-(w.scalefac[E]+(w.preflag!=0?e.pretab[E]:0)<<w.scalefac_scale+1)-w.subblock_gain[w.window[E]]*8),a1(w.width[E]>=0),H&&A.step[E]==qe)$!=0&&(r($,y,xe,be,ye,Oe),$=0),p!=0&&(i(p,y,xe,be,ye,Oe),p=0);else{var Fe=w.width[E];if(K+w.width[E]>w.max_nonzero_coeff){var we;we=w.max_nonzero_coeff-K+1,Q$.fill(b,w.max_nonzero_coeff,576,0),Fe=we,Fe<0&&(Fe=0),E=j+1}if($==0&&p==0&&(ye=Z,Oe=D,xe=g,be=I),A!=null&&A.sfb_count1>0&&E>=A.sfb_count1&&A.step[E]>0&&qe>=A.step[E]?($!=0&&(r($,y,xe,be,ye,Oe),$=0,ye=Z,Oe=D,xe=g,be=I),p+=Fe):(p!=0&&(i(p,y,xe,be,ye,Oe),p=0,ye=Z,Oe=D,xe=g,be=I),$+=Fe),Fe<=0){p!=0&&(i(p,y,xe,be,ye,Oe),p=0),$!=0&&(r($,y,xe,be,ye,Oe),$=0);break}}E<=j&&(D+=w.width[E],I+=w.width[E],K+=w.width[E])}$!=0&&(r($,y,xe,be,ye,Oe),$=0),p!=0&&(i(p,y,xe,be,ye,Oe),p=0)}function o(g,b,y){var w=0,A=0;do{var E=g[b++],j=g[b++];w<E&&(w=E),A<j&&(A=j)}while(b<y);return w<A&&(w=A),w}function a(g,b,y,w,A,E){var j=me.ht[w].xlen*65536+me.ht[A].xlen,K=0,H;do{var $=g[b++],p=g[b++];$!=0&&($>14&&($=15,K+=j),$*=16),p!=0&&(p>14&&(p=15,K+=j),$+=p),K+=me.largetbl[$]}while(b<y);return H=K&65535,K>>=16,K>H&&(K=H,w=A),E.bits+=K,w}function l(g,b,y,w){var A=0,E=me.ht[1].hlen;do{var j=g[b+0]*2+g[b+1];b+=2,A+=E[j]}while(b<y);return w.bits+=A,1}function c(g,b,y,w,A){var E=0,j,K=me.ht[w].xlen,H;w==2?H=me.table23:H=me.table56;do{var $=g[b+0]*K+g[b+1];b+=2,E+=H[$]}while(b<y);return j=E&65535,E>>=16,E>j&&(E=j,w++),A.bits+=E,w}function d(g,b,y,w,A){var E=0,j=0,K=0,H=me.ht[w].xlen,$=me.ht[w].hlen,p=me.ht[w+1].hlen,I=me.ht[w+2].hlen;do{var Z=g[b+0]*H+g[b+1];b+=2,E+=$[Z],j+=p[Z],K+=I[Z]}while(b<y);var D=w;return E>j&&(E=j,D++),E>K&&(E=K,D=w+2),A.bits+=E,D}var u=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function f(g,b,y,w){var A=o(g,b,y);switch(A){case 0:return A;case 1:return l(g,b,y,w);case 2:case 3:return c(g,b,y,u[A-1],w);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return d(g,b,y,u[A-1],w);default:if(A>Un.IXMAX_VAL)return w.bits=Un.LARGE_BITS,-1;A-=15;var E;for(E=24;E<32&&!(me.ht[E].linmax>=A);E++);var j;for(j=E-8;j<24&&!(me.ht[j].linmax>=A);j++);return a(g,b,y,j,E,w)}}this.noquant_count_bits=function(g,b,y){var w=b.l3_enc,A=Math.min(576,b.max_nonzero_coeff+2>>1<<1);for(y!=null&&(y.sfb_count1=0);A>1&&(w[A-1]|w[A-2])==0;A-=2);b.count1=A;for(var E=0,j=0;A>3;A-=4){var K;if(((w[A-1]|w[A-2]|w[A-3]|w[A-4])&2147483647)>1)break;K=((w[A-4]*2+w[A-3])*2+w[A-2])*2+w[A-1],E+=me.t32l[K],j+=me.t33l[K]}var H=E;if(b.count1table_select=0,E>j&&(H=j,b.count1table_select=1),b.count1bits=H,b.big_values=A,A==0)return H;if(b.block_type==P.SHORT_TYPE)E=3*g.scalefac_band.s[3],E>b.big_values&&(E=b.big_values),j=b.big_values;else if(b.block_type==P.NORM_TYPE){if(E=b.region0_count=g.bv_scf[A-2],j=b.region1_count=g.bv_scf[A-1],j=g.scalefac_band.l[E+j+2],E=g.scalefac_band.l[E+1],j<A){var $=new t(H);b.table_select[2]=f(w,j,A,$),H=$.bits}}else b.region0_count=7,b.region1_count=P.SBMAX_l-1-7-1,E=g.scalefac_band.l[7+1],j=A,E>j&&(E=j);if(E=Math.min(E,A),j=Math.min(j,A),E>0){var $=new t(H);b.table_select[0]=f(w,0,E,$),H=$.bits}if(E<j){var $=new t(H);b.table_select[1]=f(w,E,j,$),H=$.bits}if(g.use_best_huffman==2&&(b.part2_3_length=H,best_huffman_divide(g,b),H=b.part2_3_length),y!=null&&b.block_type==P.NORM_TYPE){for(var p=0;g.scalefac_band.l[p]<b.big_values;)p++;y.sfb_count1=p}return H},this.count_bits=function(g,b,y,w){var A=y.l3_enc,E=Un.IXMAX_VAL/e.IPOW20(y.global_gain);if(y.xrpow_max>E)return Un.LARGE_BITS;if(s(b,A,e.IPOW20(y.global_gain),y,w),(g.substep_shaping&2)!=0)for(var j=0,K=y.global_gain+y.scalefac_scale,H=.634521682242439/e.IPOW20(K),$=0;$<y.sfbmax;$++){var p=y.width[$];if(g.pseudohalf[$]==0)j+=p;else{var I;for(I=j,j+=p;I<j;++I)A[I]=b[I]>=H?A[I]:0}}return this.noquant_count_bits(g,y,w)};function m(g,b,y,w,A,E,j){for(var K=b.big_values,H=0;H<=7+15;H++)w[H]=Un.LARGE_BITS;for(var H=0;H<16;H++){var $=g.scalefac_band.l[H+1];if($>=K)break;var p=0,I=new t(p),Z=f(y,0,$,I);p=I.bits;for(var D=0;D<8;D++){var ye=g.scalefac_band.l[H+D+2];if(ye>=K)break;var Oe=p;I=new t(Oe);var xe=f(y,$,ye,I);Oe=I.bits,w[H+D]>Oe&&(w[H+D]=Oe,A[H+D]=H,E[H+D]=Z,j[H+D]=xe)}}}function h(g,b,y,w,A,E,j,K){for(var H=b.big_values,$=2;$<P.SBMAX_l+1;$++){var p=g.scalefac_band.l[$];if(p>=H)break;var I=A[$-2]+b.count1bits;if(y.part2_3_length<=I)break;var Z=new t(I),D=f(w,p,H,Z);I=Z.bits,!(y.part2_3_length<=I)&&(y.assign(b),y.part2_3_length=I,y.region0_count=E[$-2],y.region1_count=$-2-E[$-2],y.table_select[0]=j[$-2],y.table_select[1]=K[$-2],y.table_select[2]=D)}}this.best_huffman_divide=function(g,b){var y=new Cd,w=b.l3_enc,A=Ll(7+15+1),E=Ll(7+15+1),j=Ll(7+15+1),K=Ll(7+15+1);if(!(b.block_type==P.SHORT_TYPE&&g.mode_gr==1)){y.assign(b),b.block_type==P.NORM_TYPE&&(m(g,b,w,A,E,j,K),h(g,y,b,w,A,E,j,K));var H=y.big_values;if(!(H==0||(w[H-2]|w[H-1])>1)&&(H=b.count1+2,!(H>576))){y.assign(b),y.count1=H;for(var $=0,p=0;H>y.big_values;H-=4){var I=((w[H-4]*2+w[H-3])*2+w[H-2])*2+w[H-1];$+=me.t32l[I],p+=me.t33l[I]}if(y.big_values=H,y.count1table_select=0,$>p&&($=p,y.count1table_select=1),y.count1bits=$,y.block_type==P.NORM_TYPE)h(g,y,b,w,A,E,j,K);else{if(y.part2_3_length=$,$=g.scalefac_band.l[7+1],$>H&&($=H),$>0){var Z=new t(y.part2_3_length);y.table_select[0]=f(w,0,$,Z),y.part2_3_length=Z.bits}if(H>$){var Z=new t(y.part2_3_length);y.table_select[1]=f(w,$,H,Z),y.part2_3_length=Z.bits}b.part2_3_length>y.part2_3_length&&b.assign(y)}}}};var R=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],M=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],C=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Kc.slen1_tab=C,Kc.slen2_tab=_;function x(g,b){for(var y,w=b.tt[1][g],A=b.tt[0][g],E=0;E<me.scfsi_band.length-1;E++){for(y=me.scfsi_band[E];y<me.scfsi_band[E+1]&&!(A.scalefac[y]!=w.scalefac[y]&&w.scalefac[y]>=0);y++);if(y==me.scfsi_band[E+1]){for(y=me.scfsi_band[E];y<me.scfsi_band[E+1];y++)w.scalefac[y]=-1;b.scfsi[g][E]=1}}var j=0,K=0;for(y=0;y<11;y++)w.scalefac[y]!=-1&&(K++,j<w.scalefac[y]&&(j=w.scalefac[y]));for(var H=0,$=0;y<P.SBPSY_l;y++)w.scalefac[y]!=-1&&($++,H<w.scalefac[y]&&(H=w.scalefac[y]));for(var E=0;E<16;E++)if(j<R[E]&&H<M[E]){var p=C[E]*K+_[E]*$;w.part2_length>p&&(w.part2_length=p,w.scalefac_compress=E)}}this.best_scalefac_store=function(g,b,y,w){var A=w.tt[b][y],E,j,K,H,$=0;for(K=0,E=0;E<A.sfbmax;E++){var p=A.width[E];for(K+=p,H=-p;H<0&&A.l3_enc[H+K]==0;H++);H==0&&(A.scalefac[E]=$=-2)}if(A.scalefac_scale==0&&A.preflag==0){var I=0;for(E=0;E<A.sfbmax;E++)A.scalefac[E]>0&&(I|=A.scalefac[E]);if((I&1)==0&&I!=0){for(E=0;E<A.sfbmax;E++)A.scalefac[E]>0&&(A.scalefac[E]>>=1);A.scalefac_scale=$=1}}if(A.preflag==0&&A.block_type!=P.SHORT_TYPE&&g.mode_gr==2){for(E=11;E<P.SBPSY_l&&!(A.scalefac[E]<e.pretab[E]&&A.scalefac[E]!=-2);E++);if(E==P.SBPSY_l){for(E=11;E<P.SBPSY_l;E++)A.scalefac[E]>0&&(A.scalefac[E]-=e.pretab[E]);A.preflag=$=1}}for(j=0;j<4;j++)w.scfsi[y][j]=0;for(g.mode_gr==2&&b==1&&w.tt[0][y].block_type!=P.SHORT_TYPE&&w.tt[1][y].block_type!=P.SHORT_TYPE&&(x(y,w),$=0),E=0;E<A.sfbmax;E++)A.scalefac[E]==-2&&(A.scalefac[E]=0);$!=0&&(g.mode_gr==2?this.scale_bitcount(A):this.scale_bitcount_lsf(g,A))};function F(g,b){for(var y=0;y<b;++y)if(g[y]<0)return!1;return!0}var O=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],N=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],v=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(g){var b,y,w=0,A=0,E,j=g.scalefac;if(a1(F(j,g.sfbmax)),g.block_type==P.SHORT_TYPE)E=O,g.mixed_block_flag!=0&&(E=N);else if(E=v,g.preflag==0){for(y=11;y<P.SBPSY_l&&!(j[y]<e.pretab[y]);y++);if(y==P.SBPSY_l)for(g.preflag=1,y=11;y<P.SBPSY_l;y++)j[y]-=e.pretab[y]}for(y=0;y<g.sfbdivide;y++)w<j[y]&&(w=j[y]);for(;y<g.sfbmax;y++)A<j[y]&&(A=j[y]);for(g.part2_length=Un.LARGE_BITS,b=0;b<16;b++)w<R[b]&&A<M[b]&&g.part2_length>E[b]&&(g.part2_length=E[b],g.scalefac_compress=b);return g.part2_length==Un.LARGE_BITS};var T=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(g,b){var y,w,A,E,j,K,H,$,p=Ll(4),I=b.scalefac;for(b.preflag!=0?y=2:y=0,H=0;H<4;H++)p[H]=0;if(b.block_type==P.SHORT_TYPE){w=1;var Z=e.nr_of_sfb_block[y][w];for($=0,A=0;A<4;A++)for(E=Z[A]/3,H=0;H<E;H++,$++)for(j=0;j<3;j++)I[$*3+j]>p[A]&&(p[A]=I[$*3+j])}else{w=0;var Z=e.nr_of_sfb_block[y][w];for($=0,A=0;A<4;A++)for(E=Z[A],H=0;H<E;H++,$++)I[$]>p[A]&&(p[A]=I[$])}for(K=!1,A=0;A<4;A++)p[A]>T[y][A]&&(K=!0);if(!K){var D,ye,Oe,xe;for(b.sfb_partition_table=e.nr_of_sfb_block[y][w],A=0;A<4;A++)b.slen[A]=S[p[A]];switch(D=b.slen[0],ye=b.slen[1],Oe=b.slen[2],xe=b.slen[3],y){case 0:b.scalefac_compress=(D*5+ye<<4)+(Oe<<2)+xe;break;case 1:b.scalefac_compress=400+(D*5+ye<<2)+Oe;break;case 2:b.scalefac_compress=500+D*3+ye;break;default:X$.err.printf(`intensity stereo not implemented yet
`);break}}if(!K)for(a1(b.sfb_partition_table!=null),b.part2_length=0,A=0;A<4;A++)b.part2_length+=b.slen[A]*b.sfb_partition_table[A];return K};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(g){for(var b=2;b<=576;b+=2){for(var y=0,w;g.scalefac_band.l[++y]<b;);for(w=n[y][0];g.scalefac_band.l[w+1]>b;)w--;for(w<0&&(w=n[y][0]),g.bv_scf[b-2]=w,w=n[y][1];g.scalefac_band.l[w+g.bv_scf[b-2]+2]>b;)w--;w<0&&(w=n[y][1]),g.bv_scf[b-1]=w}}}var gr=De.System,Z$=De.Arrays,J$=De.new_byte,eW=De.new_float_n,tW=De.new_int,gn=De.assert;$i.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=Math.abs(e)*1e-6:Math.abs(e-t)<=Math.abs(t)*1e-6};$i.NEQ=function(e,t){return!$i.EQ(e,t)};function $i(){var e=this,t=32773,n=null,i=null,r=null,s=null;this.setModules=function(T,S,g,b){n=T,i=S,r=g,s=b};var o=null,a=0,l=0,c=0;this.getframebits=function(T){var S=T.internal_flags,g;S.bitrate_index!=0?g=me.bitrate_table[T.version][S.bitrate_index]:g=T.brate;var b=0|(T.version+1)*72e3*g/T.out_samplerate+S.padding;return 8*b};function d(T){gr.arraycopy(T.header[T.w_ptr].buf,0,o,l,T.sideinfo_len),l+=T.sideinfo_len,a+=T.sideinfo_len*8,T.w_ptr=T.w_ptr+1&At.MAX_HEADER_BUF-1}function u(T,S,g){for(;g>0;){var b;c==0&&(c=8,l++,gn(T.header[T.w_ptr].write_timing>=a),T.header[T.w_ptr].write_timing==a&&d(T),o[l]=0),b=Math.min(g,c),g-=b,c-=b,o[l]|=S>>g<<c,a+=b}}function f(T,S,g){for(;g>0;){var b;c==0&&(c=8,l++,o[l]=0),b=Math.min(g,c),g-=b,c-=b,o[l]|=S>>g<<c,a+=b}}function m(T,S){var g=T.internal_flags,b;if(S>=8&&(u(g,76,8),S-=8),S>=8&&(u(g,65,8),S-=8),S>=8&&(u(g,77,8),S-=8),S>=8&&(u(g,69,8),S-=8),S>=32){var y=r.getLameShortVersion();if(S>=32)for(b=0;b<y.length&&S>=8;++b)S-=8,u(g,y.charAt(b),8)}for(;S>=1;S-=1)u(g,g.ancillary_flag,1),g.ancillary_flag^=T.disable_reservoir?0:1}function h(T,S,g){for(var b=T.header[T.h_ptr].ptr;g>0;){var y=Math.min(g,8-(b&7));g-=y,T.header[T.h_ptr].buf[b>>3]|=S>>g<<8-(b&7)-y,b+=y}T.header[T.h_ptr].ptr=b}function R(T,S){T<<=8;for(var g=0;g<8;g++)T<<=1,S<<=1,((S^T)&65536)!=0&&(S^=t);return S}this.CRC_writeheader=function(T,S){var g=65535;g=R(S[2]&255,g),g=R(S[3]&255,g);for(var b=6;b<T.sideinfo_len;b++)g=R(S[b]&255,g);S[4]=byte(g>>8),S[5]=byte(g&255)};function M(T,S){var g=T.internal_flags,b,y,w;if(b=g.l3_side,g.header[g.h_ptr].ptr=0,Z$.fill(g.header[g.h_ptr].buf,0,g.sideinfo_len,0),T.out_samplerate<16e3?h(g,4094,12):h(g,4095,12),h(g,T.version,1),h(g,4-3,2),h(g,T.error_protection?0:1,1),h(g,g.bitrate_index,4),h(g,g.samplerate_index,2),h(g,g.padding,1),h(g,T.extension,1),h(g,T.mode.ordinal(),2),h(g,g.mode_ext,2),h(g,T.copyright,1),h(g,T.original,1),h(g,T.emphasis,2),T.error_protection&&h(g,0,16),T.version==1){for(gn(b.main_data_begin>=0),h(g,b.main_data_begin,9),g.channels_out==2?h(g,b.private_bits,3):h(g,b.private_bits,5),w=0;w<g.channels_out;w++){var A;for(A=0;A<4;A++)h(g,b.scfsi[w][A],1)}for(y=0;y<2;y++)for(w=0;w<g.channels_out;w++){var E=b.tt[y][w];h(g,E.part2_3_length+E.part2_length,12),h(g,E.big_values/2,9),h(g,E.global_gain,8),h(g,E.scalefac_compress,4),E.block_type!=P.NORM_TYPE?(h(g,1,1),h(g,E.block_type,2),h(g,E.mixed_block_flag,1),E.table_select[0]==14&&(E.table_select[0]=16),h(g,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),h(g,E.table_select[1],5),h(g,E.subblock_gain[0],3),h(g,E.subblock_gain[1],3),h(g,E.subblock_gain[2],3)):(h(g,0,1),E.table_select[0]==14&&(E.table_select[0]=16),h(g,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),h(g,E.table_select[1],5),E.table_select[2]==14&&(E.table_select[2]=16),h(g,E.table_select[2],5),gn(E.region0_count>=0&&E.region0_count<16),gn(E.region1_count>=0&&E.region1_count<8),h(g,E.region0_count,4),h(g,E.region1_count,3)),h(g,E.preflag,1),h(g,E.scalefac_scale,1),h(g,E.count1table_select,1)}}else for(gn(b.main_data_begin>=0),h(g,b.main_data_begin,8),h(g,b.private_bits,g.channels_out),y=0,w=0;w<g.channels_out;w++){var E=b.tt[y][w];h(g,E.part2_3_length+E.part2_length,12),h(g,E.big_values/2,9),h(g,E.global_gain,8),h(g,E.scalefac_compress,9),E.block_type!=P.NORM_TYPE?(h(g,1,1),h(g,E.block_type,2),h(g,E.mixed_block_flag,1),E.table_select[0]==14&&(E.table_select[0]=16),h(g,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),h(g,E.table_select[1],5),h(g,E.subblock_gain[0],3),h(g,E.subblock_gain[1],3),h(g,E.subblock_gain[2],3)):(h(g,0,1),E.table_select[0]==14&&(E.table_select[0]=16),h(g,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),h(g,E.table_select[1],5),E.table_select[2]==14&&(E.table_select[2]=16),h(g,E.table_select[2],5),gn(E.region0_count>=0&&E.region0_count<16),gn(E.region1_count>=0&&E.region1_count<8),h(g,E.region0_count,4),h(g,E.region1_count,3)),h(g,E.scalefac_scale,1),h(g,E.count1table_select,1)}T.error_protection&&CRC_writeheader(g,g.header[g.h_ptr].buf);{var j=g.h_ptr;gn(g.header[j].ptr==g.sideinfo_len*8),g.h_ptr=j+1&At.MAX_HEADER_BUF-1,g.header[g.h_ptr].write_timing=g.header[j].write_timing+S,g.h_ptr==g.w_ptr&&gr.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function C(T,S){var g=me.ht[S.count1table_select+32],b,y=0,w=S.big_values,A=S.big_values;for(gn(S.count1table_select<2),b=(S.count1-S.big_values)/4;b>0;--b){var E=0,j=0,K;K=S.l3_enc[w+0],K!=0&&(j+=8,S.xr[A+0]<0&&E++),K=S.l3_enc[w+1],K!=0&&(j+=4,E*=2,S.xr[A+1]<0&&E++),K=S.l3_enc[w+2],K!=0&&(j+=2,E*=2,S.xr[A+2]<0&&E++),K=S.l3_enc[w+3],K!=0&&(j++,E*=2,S.xr[A+3]<0&&E++),w+=4,A+=4,u(T,E+g.table[j],g.hlen[j]),y+=g.hlen[j]}return y}function _(T,S,g,b,y){var w=me.ht[S],A=0;if(S==0)return A;for(var E=g;E<b;E+=2){var j=0,K=0,H=w.xlen,$=w.xlen,p=0,I=y.l3_enc[E],Z=y.l3_enc[E+1];if(I!=0&&(y.xr[E]<0&&p++,j--),S>15){if(I>14){var D=I-15;gn(D<=w.linmax),p|=D<<1,K=H,I=15}if(Z>14){var ye=Z-15;gn(ye<=w.linmax),p<<=H,p|=ye,K+=H,Z=15}$=16}Z!=0&&(p<<=1,y.xr[E+1]<0&&p++,j--),I=I*$+Z,K-=j,j+=w.hlen[I],u(T,w.table[I],j),u(T,p,K),A+=j+K}return A}function x(T,S){var g=3*T.scalefac_band.s[3];g>S.big_values&&(g=S.big_values);var b=_(T,S.table_select[0],0,g,S);return b+=_(T,S.table_select[1],g,S.big_values,S),b}function F(T,S){var g,b,y,w;g=S.big_values;var A=S.region0_count+1;return gn(A<T.scalefac_band.l.length),y=T.scalefac_band.l[A],A+=S.region1_count+1,gn(A<T.scalefac_band.l.length),w=T.scalefac_band.l[A],y>g&&(y=g),w>g&&(w=g),b=_(T,S.table_select[0],0,y,S),b+=_(T,S.table_select[1],y,w,S),b+=_(T,S.table_select[2],w,g,S),b}function O(T){var S,g,b,y,w=0,A=T.internal_flags,E=A.l3_side;if(T.version==1)for(S=0;S<2;S++)for(g=0;g<A.channels_out;g++){var j=E.tt[S][g],K=Kc.slen1_tab[j.scalefac_compress],H=Kc.slen2_tab[j.scalefac_compress];for(y=0,b=0;b<j.sfbdivide;b++)j.scalefac[b]!=-1&&(u(A,j.scalefac[b],K),y+=K);for(;b<j.sfbmax;b++)j.scalefac[b]!=-1&&(u(A,j.scalefac[b],H),y+=H);gn(y==j.part2_length),j.block_type==P.SHORT_TYPE?y+=x(A,j):y+=F(A,j),y+=C(A,j),gn(y==j.part2_3_length+j.part2_length),w+=y}else for(S=0,g=0;g<A.channels_out;g++){var j=E.tt[S][g],$,p,I=0;if(gn(j.sfb_partition_table!=null),y=0,b=0,p=0,j.block_type==P.SHORT_TYPE){for(;p<4;p++){var Z=j.sfb_partition_table[p]/3,D=j.slen[p];for($=0;$<Z;$++,b++)u(A,Math.max(j.scalefac[b*3+0],0),D),u(A,Math.max(j.scalefac[b*3+1],0),D),u(A,Math.max(j.scalefac[b*3+2],0),D),I+=3*D}y+=x(A,j)}else{for(;p<4;p++){var Z=j.sfb_partition_table[p],D=j.slen[p];for($=0;$<Z;$++,b++)u(A,Math.max(j.scalefac[b],0),D),I+=D}y+=F(A,j)}y+=C(A,j),gn(y==j.part2_3_length),gn(I==j.part2_length),w+=I+y}return w}function N(){this.total=0}function v(T,S){var g=T.internal_flags,b,y,w,A,E;return E=g.w_ptr,A=g.h_ptr-1,A==-1&&(A=At.MAX_HEADER_BUF-1),b=g.header[A].write_timing-a,S.total=b,b>=0&&(y=1+A-E,A<E&&(y=1+A-E+At.MAX_HEADER_BUF),b-=y*8*g.sideinfo_len),w=e.getframebits(T),b+=w,S.total+=w,S.total%8!=0?S.total=1+S.total/8:S.total=S.total/8,S.total+=l+1,b<0&&gr.err.println(`strange error flushing buffer ... 
`),b}this.flush_bitstream=function(T){var S=T.internal_flags,g,b,y=S.h_ptr-1;if(y==-1&&(y=At.MAX_HEADER_BUF-1),g=S.l3_side,!((b=v(T,new N))<0)){if(m(T,b),gn(S.header[y].write_timing+this.getframebits(T)==a),S.ResvSize=0,g.main_data_begin=0,S.findReplayGain){var w=n.GetTitleGain(S.rgdata);gn(NEQ(w,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),S.RadioGain=Math.floor(w*10+.5)|0}S.findPeakSample&&(S.noclipGainChange=Math.ceil(Math.log10(S.PeakSample/32767)*20*10)|0,S.noclipGainChange>0&&(EQ(T.scale,1)||EQ(T.scale,0))?S.noclipScale=Math.floor(32767/S.PeakSample*100)/100:S.noclipScale=-1)}},this.add_dummy_byte=function(T,S,g){for(var b=T.internal_flags,y;g-- >0;)for(f(b,S,8),y=0;y<At.MAX_HEADER_BUF;++y)b.header[y].write_timing+=8},this.format_bitstream=function(T){var S=T.internal_flags,g;g=S.l3_side;var b=this.getframebits(T);m(T,g.resvDrain_pre),M(T,b);var y=8*S.sideinfo_len;if(y+=O(T),m(T,g.resvDrain_post),y+=g.resvDrain_post,g.main_data_begin+=(b-y)/8,v(T,new N)!=S.ResvSize&&gr.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),g.main_data_begin*8!=S.ResvSize&&(gr.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*g.main_data_begin,S.ResvSize,g.resvDrain_post,g.resvDrain_pre,8*S.sideinfo_len,y-g.resvDrain_post-8*S.sideinfo_len,y,y%8,b),gr.err.println("This is a fatal error.  It has several possible causes:"),gr.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),gr.err.println(" 9%%  Your system is overclocked"),gr.err.println(" 1%%  bug in LAME encoding library"),S.ResvSize=g.main_data_begin*8),a>1e9){var w;for(w=0;w<At.MAX_HEADER_BUF;++w)S.header[w].write_timing-=a;a=0}return 0},this.copy_buffer=function(T,S,g,b,y){var w=l+1;if(w<=0)return 0;if(b!=0&&w>b)return-1;if(gr.arraycopy(o,0,S,g,w),l=-1,c=0,y!=0){var A=tW(1);if(A[0]=T.nMusicCRC,s.updateMusicCRC(A,S,g,w),T.nMusicCRC=A[0],w>0&&(T.VBR_seek_table.nBytesWritten+=w),T.decode_on_the_fly){for(var E=eW([2,1152]),j=w,K=-1,H;K!=0;)if(K=i.hip_decode1_unclipped(T.hip,S,g,j,E[0],E[1]),j=0,K==-1&&(K=0),K>0){if(T.findPeakSample){for(H=0;H<K;H++)E[0][H]>T.PeakSample?T.PeakSample=E[0][H]:-E[0][H]>T.PeakSample&&(T.PeakSample=-E[0][H]);if(T.channels_out>1)for(H=0;H<K;H++)E[1][H]>T.PeakSample?T.PeakSample=E[1][H]:-E[1][H]>T.PeakSample&&(T.PeakSample=-E[1][H])}if(T.findReplayGain&&n.AnalyzeSamples(T.rgdata,E[0],0,E[1],0,K,T.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return w},this.init_bit_stream_w=function(T){o=J$(st.LAME_MAXMP3BUFFER),T.h_ptr=T.w_ptr=0,T.header[T.h_ptr].write_timing=0,l=-1,c=0,a=0}}var nW=De.System,qt=De.VbrMode,l1=De.ShortBlock,oo=De.new_float,y3=De.new_int_n,iW=De.new_short_n,ps=De.assert;function st(){var e=this,t=128*1024;st.V9=410,st.V8=420,st.V7=430,st.V6=440,st.V5=450,st.V4=460,st.V3=470,st.V2=480,st.V1=490,st.V0=500,st.R3MIX=1e3,st.STANDARD=1001,st.EXTREME=1002,st.INSANE=1003,st.STANDARD_FAST=1004,st.EXTREME_FAST=1005,st.MEDIUM=1006,st.MEDIUM_FAST=1007;var n=16384+t;st.LAME_MAXMP3BUFFER=n;var i,r,s,o,a,l=new r1,c,d,u;this.enc=new P,this.setModules=function(p,I,Z,D,ye,Oe,xe,be,qe){i=p,r=I,s=Z,o=D,a=ye,c=Oe,d=be,u=qe,this.enc.setModules(r,l,o,c)};function f(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=oo(P.SBMAX_l),this.bo_s_weight=oo(P.SBMAX_s)}function m(){this.lowerlimit=0}function h(p,I){this.lowpass=I}var R=4294479419;function M(p){var I;return p.class_id=R,I=p.internal_flags=new At,p.mode=It.NOT_SET,p.original=1,p.in_samplerate=44100,p.num_channels=2,p.num_samples=-1,p.bWriteVbrTag=!0,p.quality=-1,p.short_blocks=null,I.subblock_gain=-1,p.lowpassfreq=0,p.highpassfreq=0,p.lowpasswidth=-1,p.highpasswidth=-1,p.VBR=qt.vbr_off,p.VBR_q=4,p.ATHcurve=-1,p.VBR_mean_bitrate_kbps=128,p.VBR_min_bitrate_kbps=0,p.VBR_max_bitrate_kbps=0,p.VBR_hard_min=0,I.VBR_min_bitrate=1,I.VBR_max_bitrate=13,p.quant_comp=-1,p.quant_comp_short=-1,p.msfix=-1,I.resample_ratio=1,I.OldValue[0]=180,I.OldValue[1]=180,I.CurrentStep[0]=4,I.CurrentStep[1]=4,I.masking_lower=1,I.nsPsy.attackthre=-1,I.nsPsy.attackthre_s=-1,p.scale=-1,p.athaa_type=-1,p.ATHtype=-1,p.athaa_loudapprox=-1,p.athaa_sensitivity=0,p.useTemporal=null,p.interChRatio=-1,I.mf_samples_to_encode=P.ENCDELAY+P.POSTDELAY,p.encoder_padding=0,I.mf_size=P.ENCDELAY-P.MDCTDELAY,p.findReplayGain=!1,p.decode_on_the_fly=!1,I.decode_on_the_fly=!1,I.findReplayGain=!1,I.findPeakSample=!1,I.RadioGain=0,I.AudiophileGain=0,I.noclipGainChange=0,I.noclipScale=-1,p.preset=0,p.write_id3tag_automatic=!0,0}this.lame_init=function(){var p=new D$;return M(p),p.lame_allocated_gfp=1,p};function C(p){return p>1?0:p<=0?1:Math.cos(Math.PI/2*p)}this.nearestBitrateFullIndex=function(p){var I=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],Z=0,D=0,ye=0,Oe=0;Oe=I[16],ye=16,D=I[16],Z=16;for(var xe=0;xe<16;xe++)if(Math.max(p,I[xe+1])!=p){Oe=I[xe+1],ye=xe+1,D=I[xe],Z=xe;break}return Oe-p>p-D?Z:ye};function _(p,I){var Z=44100;return I>=48e3?Z=48e3:I>=44100?Z=44100:I>=32e3?Z=32e3:I>=24e3?Z=24e3:I>=22050?Z=22050:I>=16e3?Z=16e3:I>=12e3?Z=12e3:I>=11025?Z=11025:I>=8e3&&(Z=8e3),p==-1?Z:(p<=15960&&(Z=44100),p<=15250&&(Z=32e3),p<=11220&&(Z=24e3),p<=9970&&(Z=22050),p<=7230&&(Z=16e3),p<=5420&&(Z=12e3),p<=4510&&(Z=11025),p<=3970&&(Z=8e3),I<Z?I>44100?48e3:I>32e3?44100:I>24e3?32e3:I>22050?24e3:I>16e3?22050:I>12e3?16e3:I>11025?12e3:I>8e3?11025:8e3:Z)}function x(p,I){switch(p){case 44100:return I.version=1,0;case 48e3:return I.version=1,1;case 32e3:return I.version=1,2;case 22050:return I.version=0,0;case 24e3:return I.version=0,1;case 16e3:return I.version=0,2;case 11025:return I.version=0,0;case 12e3:return I.version=0,1;case 8e3:return I.version=0,2;default:return I.version=0,-1}}function F(p,I,Z){Z<16e3&&(I=2);for(var D=me.bitrate_table[I][1],ye=2;ye<=14;ye++)me.bitrate_table[I][ye]>0&&Math.abs(me.bitrate_table[I][ye]-p)<Math.abs(D-p)&&(D=me.bitrate_table[I][ye]);return D}function O(p,I,Z){Z<16e3&&(I=2);for(var D=0;D<=14;D++)if(me.bitrate_table[I][D]>0&&me.bitrate_table[I][D]==p)return D;return-1}function N(p,I){var Z=[new h(8,2e3),new h(16,3700),new h(24,3900),new h(32,5500),new h(40,7e3),new h(48,7500),new h(56,1e4),new h(64,11e3),new h(80,13500),new h(96,15100),new h(112,15600),new h(128,17e3),new h(160,17500),new h(192,18600),new h(224,19400),new h(256,19700),new h(320,20500)],D=e.nearestBitrateFullIndex(I);p.lowerlimit=Z[D].lowpass}function v(p){var I=p.internal_flags,Z=32,D=-1;if(I.lowpass1>0){for(var ye=999,Oe=0;Oe<=31;Oe++){var xe=Oe/31;xe>=I.lowpass2&&(Z=Math.min(Z,Oe)),I.lowpass1<xe&&xe<I.lowpass2&&(ye=Math.min(ye,Oe))}ye==999?I.lowpass1=(Z-.75)/31:I.lowpass1=(ye-.75)/31,I.lowpass2=Z/31}if(I.highpass2>0&&I.highpass2<.9*(.75/31)&&(I.highpass1=0,I.highpass2=0,nW.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),I.highpass2>0){for(var be=-1,Oe=0;Oe<=31;Oe++){var xe=Oe/31;xe<=I.highpass1&&(D=Math.max(D,Oe)),I.highpass1<xe&&xe<I.highpass2&&(be=Math.max(be,Oe))}I.highpass1=D/31,be==-1?I.highpass2=(D+.75)/31:I.highpass2=(be+.75)/31}for(var Oe=0;Oe<32;Oe++){var qe,Fe,xe=Oe/31;I.highpass2>I.highpass1?qe=C((I.highpass2-xe)/(I.highpass2-I.highpass1+1e-20)):qe=1,I.lowpass2>I.lowpass1?Fe=C((xe-I.lowpass1)/(I.lowpass2-I.lowpass1+1e-20)):Fe=1,I.amp_filter[Oe]=qe*Fe}}function T(p){var I=p.internal_flags;switch(p.quality){default:case 9:I.psymodel=0,I.noise_shaping=0,I.noise_shaping_amp=0,I.noise_shaping_stop=0,I.use_best_huffman=0,I.full_outer_loop=0;break;case 8:p.quality=7;case 7:I.psymodel=1,I.noise_shaping=0,I.noise_shaping_amp=0,I.noise_shaping_stop=0,I.use_best_huffman=0,I.full_outer_loop=0;break;case 6:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.noise_shaping_amp=0,I.noise_shaping_stop=0,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=0,I.full_outer_loop=0;break;case 5:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.noise_shaping_amp=0,I.noise_shaping_stop=0,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=0,I.full_outer_loop=0;break;case 4:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.noise_shaping_amp=0,I.noise_shaping_stop=0,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=1,I.full_outer_loop=0;break;case 3:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.noise_shaping_amp=1,I.noise_shaping_stop=1,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=1,I.full_outer_loop=0;break;case 2:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.substep_shaping==0&&(I.substep_shaping=2),I.noise_shaping_amp=1,I.noise_shaping_stop=1,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=1,I.full_outer_loop=0;break;case 1:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.substep_shaping==0&&(I.substep_shaping=2),I.noise_shaping_amp=2,I.noise_shaping_stop=1,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=1,I.full_outer_loop=0;break;case 0:I.psymodel=1,I.noise_shaping==0&&(I.noise_shaping=1),I.substep_shaping==0&&(I.substep_shaping=2),I.noise_shaping_amp=2,I.noise_shaping_stop=1,I.subblock_gain==-1&&(I.subblock_gain=1),I.use_best_huffman=1,I.full_outer_loop=0;break}}function S(p){var I=p.internal_flags;p.frameNum=0,p.write_id3tag_automatic&&d.id3tag_write_v2(p),I.bitrate_stereoMode_Hist=y3([16,4+1]),I.bitrate_blockType_Hist=y3([16,4+1+1]),I.PeakSample=0,p.bWriteVbrTag&&c.InitVbrTag(p)}this.lame_init_params=function(p){var I=p.internal_flags;if(I.Class_ID=0,I.ATH==null&&(I.ATH=new $$),I.PSY==null&&(I.PSY=new f),I.rgdata==null&&(I.rgdata=new W$),I.channels_in=p.num_channels,I.channels_in==1&&(p.mode=It.MONO),I.channels_out=p.mode==It.MONO?1:2,I.mode_ext=P.MPG_MD_MS_LR,p.mode==It.MONO&&(p.force_ms=!1),p.VBR==qt.vbr_off&&p.VBR_mean_bitrate_kbps!=128&&p.brate==0&&(p.brate=p.VBR_mean_bitrate_kbps),p.VBR==qt.vbr_off||p.VBR==qt.vbr_mtrh||p.VBR==qt.vbr_mt||(p.free_format=!1),p.VBR==qt.vbr_off&&p.brate==0&&$i.EQ(p.compression_ratio,0)&&(p.compression_ratio=11.025),p.VBR==qt.vbr_off&&p.compression_ratio>0&&(p.out_samplerate==0&&(p.out_samplerate=map2MP3Frequency(int(.97*p.in_samplerate))),p.brate=0|p.out_samplerate*16*I.channels_out/(1e3*p.compression_ratio),I.samplerate_index=x(p.out_samplerate,p),p.free_format||(p.brate=F(p.brate,p.version,p.out_samplerate))),p.out_samplerate!=0&&(p.out_samplerate<16e3?(p.VBR_mean_bitrate_kbps=Math.max(p.VBR_mean_bitrate_kbps,8),p.VBR_mean_bitrate_kbps=Math.min(p.VBR_mean_bitrate_kbps,64)):p.out_samplerate<32e3?(p.VBR_mean_bitrate_kbps=Math.max(p.VBR_mean_bitrate_kbps,8),p.VBR_mean_bitrate_kbps=Math.min(p.VBR_mean_bitrate_kbps,160)):(p.VBR_mean_bitrate_kbps=Math.max(p.VBR_mean_bitrate_kbps,32),p.VBR_mean_bitrate_kbps=Math.min(p.VBR_mean_bitrate_kbps,320))),p.lowpassfreq==0){var Z=16e3;switch(p.VBR){case qt.vbr_off:{var D=new m;N(D,p.brate),Z=D.lowerlimit;break}case qt.vbr_abr:{var D=new m;N(D,p.VBR_mean_bitrate_kbps),Z=D.lowerlimit;break}case qt.vbr_rh:{var ye=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(p.VBR_q>=0&&p.VBR_q<=9){var Oe=ye[p.VBR_q],xe=ye[p.VBR_q+1],be=p.VBR_q_frac;Z=linear_int(Oe,xe,be)}else Z=19500;break}default:{var ye=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(p.VBR_q>=0&&p.VBR_q<=9){var Oe=ye[p.VBR_q],xe=ye[p.VBR_q+1],be=p.VBR_q_frac;Z=linear_int(Oe,xe,be)}else Z=19500}}p.mode==It.MONO&&(p.VBR==qt.vbr_off||p.VBR==qt.vbr_abr)&&(Z*=1.5),p.lowpassfreq=Z|0}if(p.out_samplerate==0&&(2*p.lowpassfreq>p.in_samplerate&&(p.lowpassfreq=p.in_samplerate/2),p.out_samplerate=_(p.lowpassfreq|0,p.in_samplerate)),p.lowpassfreq=Math.min(20500,p.lowpassfreq),p.lowpassfreq=Math.min(p.out_samplerate/2,p.lowpassfreq),p.VBR==qt.vbr_off&&(p.compression_ratio=p.out_samplerate*16*I.channels_out/(1e3*p.brate)),p.VBR==qt.vbr_abr&&(p.compression_ratio=p.out_samplerate*16*I.channels_out/(1e3*p.VBR_mean_bitrate_kbps)),p.bWriteVbrTag||(p.findReplayGain=!1,p.decode_on_the_fly=!1,I.findPeakSample=!1),I.findReplayGain=p.findReplayGain,I.decode_on_the_fly=p.decode_on_the_fly,I.decode_on_the_fly&&(I.findPeakSample=!0),I.findReplayGain&&i.InitGainAnalysis(I.rgdata,p.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return p.internal_flags=null,-6;switch(I.decode_on_the_fly&&!p.decode_only&&(I.hip!=null&&u.hip_decode_exit(I.hip),I.hip=u.hip_decode_init()),I.mode_gr=p.out_samplerate<=24e3?1:2,p.framesize=576*I.mode_gr,p.encoder_delay=P.ENCDELAY,I.resample_ratio=p.in_samplerate/p.out_samplerate,p.VBR){case qt.vbr_mt:case qt.vbr_rh:case qt.vbr_mtrh:{var qe=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];p.compression_ratio=qe[p.VBR_q]}break;case qt.vbr_abr:p.compression_ratio=p.out_samplerate*16*I.channels_out/(1e3*p.VBR_mean_bitrate_kbps);break;default:p.compression_ratio=p.out_samplerate*16*I.channels_out/(1e3*p.brate);break}if(p.mode==It.NOT_SET&&(p.mode=It.JOINT_STEREO),p.highpassfreq>0?(I.highpass1=2*p.highpassfreq,p.highpasswidth>=0?I.highpass2=2*(p.highpassfreq+p.highpasswidth):I.highpass2=(1+0)*2*p.highpassfreq,I.highpass1/=p.out_samplerate,I.highpass2/=p.out_samplerate):(I.highpass1=0,I.highpass2=0),p.lowpassfreq>0?(I.lowpass2=2*p.lowpassfreq,p.lowpasswidth>=0?(I.lowpass1=2*(p.lowpassfreq-p.lowpasswidth),I.lowpass1<0&&(I.lowpass1=0)):I.lowpass1=(1-0)*2*p.lowpassfreq,I.lowpass1/=p.out_samplerate,I.lowpass2/=p.out_samplerate):(I.lowpass1=0,I.lowpass2=0),v(p),I.samplerate_index=x(p.out_samplerate,p),I.samplerate_index<0)return p.internal_flags=null,-1;if(p.VBR==qt.vbr_off){if(p.free_format)I.bitrate_index=0;else if(p.brate=F(p.brate,p.version,p.out_samplerate),I.bitrate_index=O(p.brate,p.version,p.out_samplerate),I.bitrate_index<=0)return p.internal_flags=null,-1}else I.bitrate_index=1;p.analysis&&(p.bWriteVbrTag=!1),I.pinfo!=null&&(p.bWriteVbrTag=!1),r.init_bit_stream_w(I);for(var Fe=I.samplerate_index+3*p.version+6*(p.out_samplerate<16e3?1:0),we=0;we<P.SBMAX_l+1;we++)I.scalefac_band.l[we]=o.sfBandIndex[Fe].l[we];for(var we=0;we<P.PSFB21+1;we++){var Ye=(I.scalefac_band.l[22]-I.scalefac_band.l[21])/P.PSFB21,lt=I.scalefac_band.l[21]+we*Ye;I.scalefac_band.psfb21[we]=lt}I.scalefac_band.psfb21[P.PSFB21]=576;for(var we=0;we<P.SBMAX_s+1;we++)I.scalefac_band.s[we]=o.sfBandIndex[Fe].s[we];for(var we=0;we<P.PSFB12+1;we++){var Ye=(I.scalefac_band.s[13]-I.scalefac_band.s[12])/P.PSFB12,lt=I.scalefac_band.s[12]+we*Ye;I.scalefac_band.psfb12[we]=lt}I.scalefac_band.psfb12[P.PSFB12]=192,p.version==1?I.sideinfo_len=I.channels_out==1?4+17:4+32:I.sideinfo_len=I.channels_out==1?4+9:4+17,p.error_protection&&(I.sideinfo_len+=2),S(p),I.Class_ID=R;{var k;for(k=0;k<19;k++)I.nsPsy.pefirbuf[k]=700*I.mode_gr*I.channels_out;p.ATHtype==-1&&(p.ATHtype=4)}switch(ps(p.VBR_q<=9),ps(p.VBR_q>=0),p.VBR){case qt.vbr_mt:p.VBR=qt.vbr_mtrh;case qt.vbr_mtrh:{p.useTemporal==null&&(p.useTemporal=!1),s.apply_preset(p,500-p.VBR_q*10,0),p.quality<0&&(p.quality=LAME_DEFAULT_QUALITY),p.quality<5&&(p.quality=0),p.quality>5&&(p.quality=5),I.PSY.mask_adjust=p.maskingadjust,I.PSY.mask_adjust_short=p.maskingadjust_short,p.experimentalY?I.sfb21_extra=!1:I.sfb21_extra=p.out_samplerate>44e3,I.iteration_loop=new VBRNewIterationLoop(a);break}case qt.vbr_rh:{s.apply_preset(p,500-p.VBR_q*10,0),I.PSY.mask_adjust=p.maskingadjust,I.PSY.mask_adjust_short=p.maskingadjust_short,p.experimentalY?I.sfb21_extra=!1:I.sfb21_extra=p.out_samplerate>44e3,p.quality>6&&(p.quality=6),p.quality<0&&(p.quality=LAME_DEFAULT_QUALITY),I.iteration_loop=new VBROldIterationLoop(a);break}default:{var L;I.sfb21_extra=!1,p.quality<0&&(p.quality=LAME_DEFAULT_QUALITY),L=p.VBR,L==qt.vbr_off&&(p.VBR_mean_bitrate_kbps=p.brate),s.apply_preset(p,p.VBR_mean_bitrate_kbps,0),p.VBR=L,I.PSY.mask_adjust=p.maskingadjust,I.PSY.mask_adjust_short=p.maskingadjust_short,L==qt.vbr_off?I.iteration_loop=new G$(a):I.iteration_loop=new ABRIterationLoop(a);break}}if(ps(p.scale>=0),p.VBR!=qt.vbr_off){if(I.VBR_min_bitrate=1,I.VBR_max_bitrate=14,p.out_samplerate<16e3&&(I.VBR_max_bitrate=8),p.VBR_min_bitrate_kbps!=0&&(p.VBR_min_bitrate_kbps=F(p.VBR_min_bitrate_kbps,p.version,p.out_samplerate),I.VBR_min_bitrate=O(p.VBR_min_bitrate_kbps,p.version,p.out_samplerate),I.VBR_min_bitrate<0)||p.VBR_max_bitrate_kbps!=0&&(p.VBR_max_bitrate_kbps=F(p.VBR_max_bitrate_kbps,p.version,p.out_samplerate),I.VBR_max_bitrate=O(p.VBR_max_bitrate_kbps,p.version,p.out_samplerate),I.VBR_max_bitrate<0))return-1;p.VBR_min_bitrate_kbps=me.bitrate_table[p.version][I.VBR_min_bitrate],p.VBR_max_bitrate_kbps=me.bitrate_table[p.version][I.VBR_max_bitrate],p.VBR_mean_bitrate_kbps=Math.min(me.bitrate_table[p.version][I.VBR_max_bitrate],p.VBR_mean_bitrate_kbps),p.VBR_mean_bitrate_kbps=Math.max(me.bitrate_table[p.version][I.VBR_min_bitrate],p.VBR_mean_bitrate_kbps)}return p.tune&&(I.PSY.mask_adjust+=p.tune_value_a,I.PSY.mask_adjust_short+=p.tune_value_a),T(p),ps(p.scale>=0),p.athaa_type<0?I.ATH.useAdjust=3:I.ATH.useAdjust=p.athaa_type,I.ATH.aaSensitivityP=Math.pow(10,p.athaa_sensitivity/-10),p.short_blocks==null&&(p.short_blocks=l1.short_block_allowed),p.short_blocks==l1.short_block_allowed&&(p.mode==It.JOINT_STEREO||p.mode==It.STEREO)&&(p.short_blocks=l1.short_block_coupled),p.quant_comp<0&&(p.quant_comp=1),p.quant_comp_short<0&&(p.quant_comp_short=0),p.msfix<0&&(p.msfix=0),p.exp_nspsytune=p.exp_nspsytune|1,p.internal_flags.nsPsy.attackthre<0&&(p.internal_flags.nsPsy.attackthre=r1.NSATTACKTHRE),p.internal_flags.nsPsy.attackthre_s<0&&(p.internal_flags.nsPsy.attackthre_s=r1.NSATTACKTHRE_S),ps(p.scale>=0),p.scale<0&&(p.scale=1),p.ATHtype<0&&(p.ATHtype=4),p.ATHcurve<0&&(p.ATHcurve=4),p.athaa_loudapprox<0&&(p.athaa_loudapprox=2),p.interChRatio<0&&(p.interChRatio=0),p.useTemporal==null&&(p.useTemporal=!0),I.slot_lag=I.frac_SpF=0,p.VBR==qt.vbr_off&&(I.slot_lag=I.frac_SpF=(p.version+1)*72e3*p.brate%p.out_samplerate|0),o.iteration_init(p),l.psymodel_init(p),ps(p.scale>=0),0};function g(p,I){(p.in_buffer_0==null||p.in_buffer_nsamples<I)&&(p.in_buffer_0=oo(I),p.in_buffer_1=oo(I),p.in_buffer_nsamples=I)}this.lame_encode_flush=function(p,I,Z,D){var ye=p.internal_flags,Oe=iW([2,1152]),xe=0,be,qe,Fe,we,Ye=ye.mf_samples_to_encode-P.POSTDELAY,lt=b(p);if(ye.mf_samples_to_encode<1)return 0;for(be=0,p.in_samplerate!=p.out_samplerate&&(Ye+=16*p.out_samplerate/p.in_samplerate),Fe=p.framesize-Ye%p.framesize,Fe<576&&(Fe+=p.framesize),p.encoder_padding=Fe,we=(Ye+Fe)/p.framesize;we>0&&xe>=0;){var k=lt-ye.mf_size,L=p.frameNum;k*=p.in_samplerate,k/=p.out_samplerate,k>1152&&(k=1152),k<1&&(k=1),qe=D-be,D==0&&(qe=0),xe=this.lame_encode_buffer(p,Oe[0],Oe[1],k,I,Z,qe),Z+=xe,be+=xe,we-=L!=p.frameNum?1:0}if(ye.mf_samples_to_encode=0,xe<0||(qe=D-be,D==0&&(qe=0),r.flush_bitstream(p),xe=r.copy_buffer(ye,I,Z,qe,1),xe<0))return xe;if(Z+=xe,be+=xe,qe=D-be,D==0&&(qe=0),p.write_id3tag_automatic){if(d.id3tag_write_v1(p),xe=r.copy_buffer(ye,I,Z,qe,0),xe<0)return xe;be+=xe}return be},this.lame_encode_buffer=function(p,I,Z,D,ye,Oe,xe){var be=p.internal_flags,qe=[null,null];if(be.Class_ID!=R)return-3;if(D==0)return 0;g(be,D),qe[0]=be.in_buffer_0,qe[1]=be.in_buffer_1;for(var Fe=0;Fe<D;Fe++)qe[0][Fe]=I[Fe],be.channels_in>1&&(qe[1][Fe]=Z[Fe]);return y(p,qe[0],qe[1],D,ye,Oe,xe)};function b(p){var I=P.BLKSIZE+p.framesize-P.FFTOFFSET;return I=Math.max(I,512+p.framesize-32),I}function y(p,I,Z,D,ye,Oe,xe){var be=p.internal_flags,qe=0,Fe,we,Ye,lt,k,L=[null,null],q=[null,null];if(be.Class_ID!=R)return-3;if(D==0)return 0;if(k=r.copy_buffer(be,ye,Oe,xe,0),k<0)return k;if(Oe+=k,qe+=k,q[0]=I,q[1]=Z,$i.NEQ(p.scale,0)&&$i.NEQ(p.scale,1))for(we=0;we<D;++we)q[0][we]*=p.scale,be.channels_out==2&&(q[1][we]*=p.scale);if($i.NEQ(p.scale_left,0)&&$i.NEQ(p.scale_left,1))for(we=0;we<D;++we)q[0][we]*=p.scale_left;if($i.NEQ(p.scale_right,0)&&$i.NEQ(p.scale_right,1))for(we=0;we<D;++we)q[1][we]*=p.scale_right;if(p.num_channels==2&&be.channels_out==1)for(we=0;we<D;++we)q[0][we]=.5*(q[0][we]+q[1][we]),q[1][we]=0;lt=b(p),L[0]=be.mfbuf[0],L[1]=be.mfbuf[1];for(var W=0;D>0;){var G=[null,null],ie=0,ce=0;G[0]=q[0],G[1]=q[1];var J=new A;if($(p,L,G,W,D,J),ie=J.n_in,ce=J.n_out,be.findReplayGain&&!be.decode_on_the_fly&&i.AnalyzeSamples(be.rgdata,L[0],be.mf_size,L[1],be.mf_size,ce,be.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(D-=ie,W+=ie,be.channels_out==2,be.mf_size+=ce,ps(be.mf_size<=At.MFSIZE),be.mf_samples_to_encode<1&&(be.mf_samples_to_encode=P.ENCDELAY+P.POSTDELAY),be.mf_samples_to_encode+=ce,be.mf_size>=lt){var re=xe-qe;if(xe==0&&(re=0),Fe=w(p,L[0],L[1],ye,Oe,re),Fe<0)return Fe;for(Oe+=Fe,qe+=Fe,be.mf_size-=p.framesize,be.mf_samples_to_encode-=p.framesize,Ye=0;Ye<be.channels_out;Ye++)for(we=0;we<be.mf_size;we++)L[Ye][we]=L[Ye][we+p.framesize]}}return qe}function w(p,I,Z,D,ye,Oe){var xe=e.enc.lame_encode_mp3_frame(p,I,Z,D,ye,Oe);return p.frameNum++,xe}function A(){this.n_in=0,this.n_out=0}function E(){this.num_used=0}function j(p,I){return I!=0?j(I,p%I):p}function K(p,I,Z){var D=Math.PI*I;p/=Z,p<0&&(p=0),p>1&&(p=1);var ye=p-.5,Oe=.42-.5*Math.cos(2*p*Math.PI)+.08*Math.cos(4*p*Math.PI);return Math.abs(ye)<1e-9?D/Math.PI:Oe*Math.sin(Z*D*ye)/(Math.PI*Z*ye)}function H(p,I,Z,D,ye,Oe,xe,be,qe){var Fe=p.internal_flags,we,Ye=0,lt,k=p.out_samplerate/j(p.out_samplerate,p.in_samplerate);k>At.BPC&&(k=At.BPC);var L=Math.abs(Fe.resample_ratio-Math.floor(.5+Fe.resample_ratio))<1e-4?1:0,q=1/Fe.resample_ratio;q>1&&(q=1);var W=31;W%2==0&&--W,W+=L;var G=W+1;if(Fe.fill_buffer_resample_init==0){for(Fe.inbuf_old[0]=oo(G),Fe.inbuf_old[1]=oo(G),we=0;we<=2*k;++we)Fe.blackfilt[we]=oo(G);for(Fe.itime[0]=0,Fe.itime[1]=0,Ye=0;Ye<=2*k;Ye++){var ie=0,ce=(Ye-k)/(2*k);for(we=0;we<=W;we++)ie+=Fe.blackfilt[Ye][we]=K(we-ce,q,W);for(we=0;we<=W;we++)Fe.blackfilt[Ye][we]/=ie}Fe.fill_buffer_resample_init=1}var J=Fe.inbuf_old[qe];for(lt=0;lt<D;lt++){var re,Q;if(re=lt*Fe.resample_ratio,Ye=0|Math.floor(re-Fe.itime[qe]),W+Ye-W/2>=xe)break;var ce=re-Fe.itime[qe]-(Ye+.5*(W%2));Q=0|Math.floor(ce*2*k+k+.5);var Ee=0;for(we=0;we<=W;++we){var fe=0|we+Ye-W/2,Te;Te=fe<0?J[G+fe]:ye[Oe+fe],Ee+=Te*Fe.blackfilt[Q][we]}I[Z+lt]=Ee}if(be.num_used=Math.min(xe,W+Ye-W/2),Fe.itime[qe]+=be.num_used-lt*Fe.resample_ratio,be.num_used>=G)for(we=0;we<G;we++)J[we]=ye[Oe+be.num_used+we-G];else{var Ce=G-be.num_used;for(we=0;we<Ce;++we)J[we]=J[we+be.num_used];for(Ye=0;we<G;++we,++Ye)J[we]=ye[Oe+Ye];ps(Ye==be.num_used)}return lt}function $(p,I,Z,D,ye,Oe){var xe=p.internal_flags;if(xe.resample_ratio<.9999||xe.resample_ratio>1.0001)for(var be=0;be<xe.channels_out;be++){var qe=new E;Oe.n_out=H(p,I[be],xe.mf_size,p.framesize,Z[be],D,ye,qe,be),Oe.n_in=qe.num_used}else{Oe.n_out=Math.min(p.framesize,ye),Oe.n_in=Oe.n_out;for(var Fe=0;Fe<Oe.n_out;++Fe)I[0][xe.mf_size+Fe]=Z[0][D+Fe],xe.channels_out==2&&(I[1][xe.mf_size+Fe]=Z[1][D+Fe])}}}var _r=De.VbrMode;function rW(){function e(c,d,u,f,m,h,R,M,C,_,x,F,O,N,v){this.vbr_q=c,this.quant_comp=d,this.quant_comp_s=u,this.expY=f,this.st_lrm=m,this.st_s=h,this.masking_adj=R,this.masking_adj_short=M,this.ath_lower=C,this.ath_curve=_,this.ath_sensitivity=x,this.interch=F,this.safejoint=O,this.sfb21mod=N,this.msfix=v}function t(c,d,u,f,m,h,R,M,C,_,x,F,O,N){this.quant_comp=d,this.quant_comp_s=u,this.safejoint=f,this.nsmsfix=m,this.st_lrm=h,this.st_s=R,this.nsbass=M,this.scale=C,this.masking_adj=_,this.ath_lower=x,this.ath_curve=F,this.interch=O,this.sfscale=N}var n;this.setModules=function(c){n=c};var i=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],r=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function s(c,d,u){var f=c.VBR==_r.vbr_rh?i:r,m=c.VBR_q_frac,h=f[d],R=f[d+1],M=h;h.st_lrm=h.st_lrm+m*(R.st_lrm-h.st_lrm),h.st_s=h.st_s+m*(R.st_s-h.st_s),h.masking_adj=h.masking_adj+m*(R.masking_adj-h.masking_adj),h.masking_adj_short=h.masking_adj_short+m*(R.masking_adj_short-h.masking_adj_short),h.ath_lower=h.ath_lower+m*(R.ath_lower-h.ath_lower),h.ath_curve=h.ath_curve+m*(R.ath_curve-h.ath_curve),h.ath_sensitivity=h.ath_sensitivity+m*(R.ath_sensitivity-h.ath_sensitivity),h.interch=h.interch+m*(R.interch-h.interch),h.msfix=h.msfix+m*(R.msfix-h.msfix),l(c,M.vbr_q),u!=0?c.quant_comp=M.quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=M.quant_comp),u!=0?c.quant_comp_short=M.quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=M.quant_comp_s),M.expY!=0&&(c.experimentalY=M.expY!=0),u!=0?c.internal_flags.nsPsy.attackthre=M.st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=M.st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=M.st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=M.st_s),u!=0?c.maskingadjust=M.masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=M.masking_adj),u!=0?c.maskingadjust_short=M.masking_adj_short:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=M.masking_adj_short),u!=0?c.ATHlower=-M.ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-M.ath_lower/10),u!=0?c.ATHcurve=M.ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=M.ath_curve),u!=0?c.athaa_sensitivity=M.ath_sensitivity:Math.abs(c.athaa_sensitivity- -1)>0||(c.athaa_sensitivity=M.ath_sensitivity),M.interch>0&&(u!=0?c.interChRatio=M.interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=M.interch)),M.safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|M.safejoint),M.sfb21mod>0&&(c.exp_nspsytune=c.exp_nspsytune|M.sfb21mod<<20),u!=0?c.msfix=M.msfix:Math.abs(c.msfix- -1)>0||(c.msfix=M.msfix),u==0&&(c.VBR_q=d,c.VBR_q_frac=m)}var o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function a(c,d,u){var f=d,m=n.nearestBitrateFullIndex(d);if(c.VBR=_r.vbr_abr,c.VBR_mean_bitrate_kbps=f,c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,320),c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,8),c.brate=c.VBR_mean_bitrate_kbps,c.VBR_mean_bitrate_kbps>320&&(c.disable_reservoir=!0),o[m].safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|2),o[m].sfscale>0&&(c.internal_flags.noise_shaping=2),Math.abs(o[m].nsbass)>0){var h=int(o[m].nsbass*4);h<0&&(h+=64),c.exp_nspsytune=c.exp_nspsytune|h<<2}return u!=0?c.quant_comp=o[m].quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=o[m].quant_comp),u!=0?c.quant_comp_short=o[m].quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=o[m].quant_comp_s),u!=0?c.msfix=o[m].nsmsfix:Math.abs(c.msfix- -1)>0||(c.msfix=o[m].nsmsfix),u!=0?c.internal_flags.nsPsy.attackthre=o[m].st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=o[m].st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=o[m].st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=o[m].st_s),u!=0?c.scale=o[m].scale:Math.abs(c.scale- -1)>0||(c.scale=o[m].scale),u!=0?c.maskingadjust=o[m].masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=o[m].masking_adj),o[m].masking_adj>0?u!=0?c.maskingadjust_short=o[m].masking_adj*.9:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[m].masking_adj*.9):u!=0?c.maskingadjust_short=o[m].masking_adj*1.1:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[m].masking_adj*1.1),u!=0?c.ATHlower=-o[m].ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-o[m].ath_lower/10),u!=0?c.ATHcurve=o[m].ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=o[m].ath_curve),u!=0?c.interChRatio=o[m].interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=o[m].interch),d}this.apply_preset=function(c,d,u){switch(d){case st.R3MIX:{d=st.V3,c.VBR=_r.vbr_mtrh;break}case st.MEDIUM:{d=st.V4,c.VBR=_r.vbr_rh;break}case st.MEDIUM_FAST:{d=st.V4,c.VBR=_r.vbr_mtrh;break}case st.STANDARD:{d=st.V2,c.VBR=_r.vbr_rh;break}case st.STANDARD_FAST:{d=st.V2,c.VBR=_r.vbr_mtrh;break}case st.EXTREME:{d=st.V0,c.VBR=_r.vbr_rh;break}case st.EXTREME_FAST:{d=st.V0,c.VBR=_r.vbr_mtrh;break}case st.INSANE:return d=320,c.preset=d,a(c,d,u),c.VBR=_r.vbr_off,d}switch(c.preset=d,d){case st.V9:return s(c,9,u),d;case st.V8:return s(c,8,u),d;case st.V7:return s(c,7,u),d;case st.V6:return s(c,6,u),d;case st.V5:return s(c,5,u),d;case st.V4:return s(c,4,u),d;case st.V3:return s(c,3,u),d;case st.V2:return s(c,2,u),d;case st.V1:return s(c,1,u),d;case st.V0:return s(c,0,u),d}return d>=8&&d<=320?a(c,d,u):(c.preset=0,d)};function l(c,d){var u=0;return d<0&&(u=-1,d=0),d>9&&(u=-1,d=9),c.VBR_q=d,c.VBR_q_frac=0,u}}function sW(){this.setModules=function(e,t){}}function c1(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var b3=De.new_float,oW=De.new_int;function aW(){this.global_gain=0,this.sfb_count1=0,this.step=oW(39),this.noise=b3(39),this.noise_log=b3(39)}var gs=De.System,w3=De.VbrMode,u1=De.Util,ma=De.Arrays,Dl=De.new_float,Bl=De.assert;function lW(){var e;this.rv=null;var t;this.qupvt=null;var n,i=new sW,r;this.setModules=function(C,_,x,F){e=C,t=_,this.rv=_,n=x,this.qupvt=x,r=F,i.setModules(n,r)},this.ms_convert=function(C,_){for(var x=0;x<576;++x){var F=C.tt[_][0].xr[x],O=C.tt[_][1].xr[x];C.tt[_][0].xr[x]=(F+O)*(u1.SQRT2*.5),C.tt[_][1].xr[x]=(F-O)*(u1.SQRT2*.5)}};function s(C,_,x,F){F=0;for(var O=0;O<=x;++O){var N=Math.abs(C.xr[O]);F+=N,_[O]=Math.sqrt(N*Math.sqrt(N)),_[O]>C.xrpow_max&&(C.xrpow_max=_[O])}return F}this.init_xrpow=function(C,_,x){var F=0,O=0|_.max_nonzero_coeff;if(_.xrpow_max=0,ma.fill(x,O,576,0),F=s(_,x,O,F),F>1e-20){var N=0;(C.substep_shaping&2)!=0&&(N=1);for(var v=0;v<_.psymax;v++)C.pseudohalf[v]=N;return!0}return ma.fill(_.l3_enc,0,576,0),!1};function o(C,_){var x=C.ATH,F=_.xr;if(_.block_type!=P.SHORT_TYPE)for(var O=!1,N=P.PSFB21-1;N>=0&&!O;N--){var v=C.scalefac_band.psfb21[N],T=C.scalefac_band.psfb21[N+1],S=n.athAdjust(x.adjust,x.psfb21[N],x.floor);C.nsPsy.longfact[21]>1e-12&&(S*=C.nsPsy.longfact[21]);for(var g=T-1;g>=v;g--)if(Math.abs(F[g])<S)F[g]=0;else{O=!0;break}}else for(var b=0;b<3;b++)for(var O=!1,N=P.PSFB12-1;N>=0&&!O;N--){var v=C.scalefac_band.s[12]*3+(C.scalefac_band.s[13]-C.scalefac_band.s[12])*b+(C.scalefac_band.psfb12[N]-C.scalefac_band.psfb12[0]),T=v+(C.scalefac_band.psfb12[N+1]-C.scalefac_band.psfb12[N]),y=n.athAdjust(x.adjust,x.psfb12[N],x.floor);C.nsPsy.shortfact[12]>1e-12&&(y*=C.nsPsy.shortfact[12]);for(var g=T-1;g>=v;g--)if(Math.abs(F[g])<y)F[g]=0;else{O=!0;break}}}this.init_outer_loop=function(C,_){_.part2_3_length=0,_.big_values=0,_.count1=0,_.global_gain=210,_.scalefac_compress=0,_.table_select[0]=0,_.table_select[1]=0,_.table_select[2]=0,_.subblock_gain[0]=0,_.subblock_gain[1]=0,_.subblock_gain[2]=0,_.subblock_gain[3]=0,_.region0_count=0,_.region1_count=0,_.preflag=0,_.scalefac_scale=0,_.count1table_select=0,_.part2_length=0,_.sfb_lmax=P.SBPSY_l,_.sfb_smin=P.SBPSY_s,_.psy_lmax=C.sfb21_extra?P.SBMAX_l:P.SBPSY_l,_.psymax=_.psy_lmax,_.sfbmax=_.sfb_lmax,_.sfbdivide=11;for(var x=0;x<P.SBMAX_l;x++)_.width[x]=C.scalefac_band.l[x+1]-C.scalefac_band.l[x],_.window[x]=3;if(_.block_type==P.SHORT_TYPE){var F=Dl(576);_.sfb_smin=0,_.sfb_lmax=0,_.mixed_block_flag!=0&&(_.sfb_smin=3,_.sfb_lmax=C.mode_gr*2+4),_.psymax=_.sfb_lmax+3*((C.sfb21_extra?P.SBMAX_s:P.SBPSY_s)-_.sfb_smin),_.sfbmax=_.sfb_lmax+3*(P.SBPSY_s-_.sfb_smin),_.sfbdivide=_.sfbmax-18,_.psy_lmax=_.sfb_lmax;var O=C.scalefac_band.l[_.sfb_lmax];gs.arraycopy(_.xr,0,F,0,576);for(var x=_.sfb_smin;x<P.SBMAX_s;x++)for(var N=C.scalefac_band.s[x],v=C.scalefac_band.s[x+1],T=0;T<3;T++)for(var S=N;S<v;S++)_.xr[O++]=F[3*S+T];for(var g=_.sfb_lmax,x=_.sfb_smin;x<P.SBMAX_s;x++)_.width[g]=_.width[g+1]=_.width[g+2]=C.scalefac_band.s[x+1]-C.scalefac_band.s[x],_.window[g]=0,_.window[g+1]=1,_.window[g+2]=2,g+=3}_.count1bits=0,_.sfb_partition_table=n.nr_of_sfb_block[0][0],_.slen[0]=0,_.slen[1]=0,_.slen[2]=0,_.slen[3]=0,_.max_nonzero_coeff=575,ma.fill(_.scalefac,0),o(C,_)};function a(C){this.ordinal=C}a.BINSEARCH_NONE=new a(0),a.BINSEARCH_UP=new a(1),a.BINSEARCH_DOWN=new a(2);function l(C,_,x,F,O){var N,v=C.CurrentStep[F],T=!1,S=C.OldValue[F],g=a.BINSEARCH_NONE;for(_.global_gain=S,x-=_.part2_length;;){var b;if(N=r.count_bits(C,O,_,null),v==1||N==x)break;N>x?(g==a.BINSEARCH_DOWN&&(T=!0),T&&(v/=2),g=a.BINSEARCH_UP,b=v):(g==a.BINSEARCH_UP&&(T=!0),T&&(v/=2),g=a.BINSEARCH_DOWN,b=-v),_.global_gain+=b,_.global_gain<0&&(_.global_gain=0,T=!0),_.global_gain>255&&(_.global_gain=255,T=!0)}for(Bl(_.global_gain>=0),Bl(_.global_gain<256);N>x&&_.global_gain<255;)_.global_gain++,N=r.count_bits(C,O,_,null);return C.CurrentStep[F]=S-_.global_gain>=4?4:2,C.OldValue[F]=_.global_gain,_.part2_3_length=N,N}this.trancate_smallspectrums=function(C,_,x,F){var O=Dl(Ms.SFBMAX);if(!((C.substep_shaping&4)==0&&_.block_type==P.SHORT_TYPE||(C.substep_shaping&128)!=0)){n.calc_noise(_,x,O,new c1,null);for(var v=0;v<576;v++){var N=0;_.l3_enc[v]!=0&&(N=Math.abs(_.xr[v])),F[v]=N}var v=0,T=8;_.block_type==P.SHORT_TYPE&&(T=6);do{var S,g,b,y,w=_.width[T];if(v+=w,!(O[T]>=1)&&(ma.sort(F,v-w,w),!BitStream.EQ(F[v-1],0))){S=(1-O[T])*x[T],g=0,y=0;do{var A;for(b=1;y+b<w&&!BitStream.NEQ(F[y+v-w],F[y+v+b-w]);b++);if(A=F[y+v-w]*F[y+v-w]*b,S<A){y!=0&&(g=F[y+v-w-1]);break}S-=A,y+=b}while(y<w);if(!BitStream.EQ(g,0))do Math.abs(_.xr[v-w])<=g&&(_.l3_enc[v-w]=0);while(--w>0)}}while(++T<_.psymax);_.part2_3_length=r.noquant_count_bits(C,_,null)}};function c(C){for(var _=0;_<C.sfbmax;_++)if(C.scalefac[_]+C.subblock_gain[C.window[_]]==0)return!1;return!0}function d(C){return u1.FAST_LOG10(.368+.632*C*C*C)}function u(C,_){for(var x=1e-37,F=0;F<_.psymax;F++)x+=d(C[F]);return Math.max(1e-20,x)}function f(C,_,x,F,O){var N;switch(C){default:case 9:{_.over_count>0?(N=x.over_SSD<=_.over_SSD,x.over_SSD==_.over_SSD&&(N=x.bits<_.bits)):N=x.max_noise<0&&x.max_noise*10+x.bits<=_.max_noise*10+_.bits;break}case 0:N=x.over_count<_.over_count||x.over_count==_.over_count&&x.over_noise<_.over_noise||x.over_count==_.over_count&&BitStream.EQ(x.over_noise,_.over_noise)&&x.tot_noise<_.tot_noise;break;case 8:x.max_noise=u(O,F);case 1:N=x.max_noise<_.max_noise;break;case 2:N=x.tot_noise<_.tot_noise;break;case 3:N=x.tot_noise<_.tot_noise&&x.max_noise<_.max_noise;break;case 4:N=x.max_noise<=0&&_.max_noise>.2||x.max_noise<=0&&_.max_noise<0&&_.max_noise>x.max_noise-.2&&x.tot_noise<_.tot_noise||x.max_noise<=0&&_.max_noise>0&&_.max_noise>x.max_noise-.2&&x.tot_noise<_.tot_noise+_.over_noise||x.max_noise>0&&_.max_noise>-.05&&_.max_noise>x.max_noise-.1&&x.tot_noise+x.over_noise<_.tot_noise+_.over_noise||x.max_noise>0&&_.max_noise>-.1&&_.max_noise>x.max_noise-.15&&x.tot_noise+x.over_noise+x.over_noise<_.tot_noise+_.over_noise+_.over_noise;break;case 5:N=x.over_noise<_.over_noise||BitStream.EQ(x.over_noise,_.over_noise)&&x.tot_noise<_.tot_noise;break;case 6:N=x.over_noise<_.over_noise||BitStream.EQ(x.over_noise,_.over_noise)&&(x.max_noise<_.max_noise||BitStream.EQ(x.max_noise,_.max_noise)&&x.tot_noise<=_.tot_noise);break;case 7:N=x.over_count<_.over_count||x.over_noise<_.over_noise;break}return _.over_count==0&&(N=N&&x.bits<_.bits),N}function m(C,_,x,F,O){var N=C.internal_flags,v;_.scalefac_scale==0?v=1.2968395546510096:v=1.6817928305074292;for(var T=0,S=0;S<_.sfbmax;S++)T<x[S]&&(T=x[S]);var g=N.noise_shaping_amp;switch(g==3&&(O?g=2:g=1),g){case 2:break;case 1:T>1?T=Math.pow(T,.5):T*=.95;break;case 0:default:T>1?T=1:T*=.95;break}for(var b=0,S=0;S<_.sfbmax;S++){var y=_.width[S],w;if(b+=y,!(x[S]<T)){if((N.substep_shaping&2)!=0&&(N.pseudohalf[S]=N.pseudohalf[S]==0?1:0,N.pseudohalf[S]==0&&N.noise_shaping_amp==2))return;for(_.scalefac[S]++,w=-y;w<0;w++)F[b+w]*=v,F[b+w]>_.xrpow_max&&(_.xrpow_max=F[b+w]);if(N.noise_shaping_amp==2)return}}}function h(C,_){for(var x=1.2968395546510096,F=0,O=0;O<C.sfbmax;O++){var N=C.width[O],v=C.scalefac[O];if(C.preflag!=0&&(v+=n.pretab[O]),F+=N,(v&1)!=0){v++;for(var T=-N;T<0;T++)_[F+T]*=x,_[F+T]>C.xrpow_max&&(C.xrpow_max=_[F+T])}C.scalefac[O]=v>>1}C.preflag=0,C.scalefac_scale=1}function R(C,_,x){var F,O=_.scalefac;for(F=0;F<_.sfb_lmax;F++)if(O[F]>=16)return!0;for(var N=0;N<3;N++){var v=0,T=0;for(F=_.sfb_lmax+N;F<_.sfbdivide;F+=3)v<O[F]&&(v=O[F]);for(;F<_.sfbmax;F+=3)T<O[F]&&(T=O[F]);if(!(v<16&&T<8)){if(_.subblock_gain[N]>=7)return!0;_.subblock_gain[N]++;var S=C.scalefac_band.l[_.sfb_lmax];for(F=_.sfb_lmax+N;F<_.sfbmax;F+=3){var g,b=_.width[F],y=O[F];if(y=y-(4>>_.scalefac_scale),y>=0){O[F]=y,S+=b*3;continue}O[F]=0;{var w=210+(y<<_.scalefac_scale+1);g=n.IPOW20(w)}S+=b*(N+1);for(var A=-b;A<0;A++)x[S+A]*=g,x[S+A]>_.xrpow_max&&(_.xrpow_max=x[S+A]);S+=b*(3-N-1)}{var g=n.IPOW20(202);S+=_.width[F]*(N+1);for(var A=-_.width[F];A<0;A++)x[S+A]*=g,x[S+A]>_.xrpow_max&&(_.xrpow_max=x[S+A])}}}return!1}function M(C,_,x,F,O){var N=C.internal_flags;m(C,_,x,F,O);var v=c(_);return v?!1:(N.mode_gr==2?v=r.scale_bitcount(_):v=r.scale_bitcount_lsf(N,_),v?(N.noise_shaping>1&&(ma.fill(N.pseudohalf,0),_.scalefac_scale==0?(h(_,F),v=!1):_.block_type==P.SHORT_TYPE&&N.subblock_gain>0&&(v=R(N,_,F)||c(_))),v||(N.mode_gr==2?v=r.scale_bitcount(_):v=r.scale_bitcount_lsf(N,_)),!v):!0)}this.outer_loop=function(C,_,x,F,O,N){var v=C.internal_flags,T=new Cd,S=Dl(576),g=Dl(Ms.SFBMAX),b=new c1,y,w=new aW,A=9999999,E=!1,j=!1,K=0;if(l(v,_,N,O,F),v.noise_shaping==0)return 100;n.calc_noise(_,x,g,b,w),b.bits=_.part2_3_length,T.assign(_);var H=0;for(gs.arraycopy(F,0,S,0,576);!E;){do{var $=new c1,p,I=255;if((v.substep_shaping&2)!=0?p=20:p=3,v.sfb21_extra&&(g[T.sfbmax]>1||T.block_type==P.SHORT_TYPE&&(g[T.sfbmax+1]>1||g[T.sfbmax+2]>1))||!M(C,T,g,F,j))break;T.scalefac_scale!=0&&(I=254);var Z=N-T.part2_length;if(Z<=0)break;for(;(T.part2_3_length=r.count_bits(v,F,T,w))>Z&&T.global_gain<=I;)T.global_gain++;if(T.global_gain>I)break;if(b.over_count==0){for(;(T.part2_3_length=r.count_bits(v,F,T,w))>A&&T.global_gain<=I;)T.global_gain++;if(T.global_gain>I)break}if(n.calc_noise(T,x,g,$,w),$.bits=T.part2_3_length,_.block_type!=P.SHORT_TYPE?y=C.quant_comp:y=C.quant_comp_short,y=f(y,b,$,T,g)?1:0,y!=0)A=_.part2_3_length,b=$,_.assign(T),H=0,gs.arraycopy(F,0,S,0,576);else if(v.full_outer_loop==0&&(++H>p&&b.over_count==0||v.noise_shaping_amp==3&&j&&H>30||v.noise_shaping_amp==3&&j&&T.global_gain-K>15))break}while(T.global_gain+T.scalefac_scale<255);v.noise_shaping_amp==3?j?E=!0:(T.assign(_),gs.arraycopy(S,0,F,0,576),H=0,K=T.global_gain,j=!0):E=!0}return Bl(_.global_gain+_.scalefac_scale<=255),C.VBR==w3.vbr_rh||C.VBR==w3.vbr_mtrh?gs.arraycopy(S,0,F,0,576):(v.substep_shaping&1)!=0&&trancate_smallspectrums(v,_,x,F),b.over_count},this.iteration_finish_one=function(C,_,x){var F=C.l3_side,O=F.tt[_][x];r.best_scalefac_store(C,_,x,F),C.use_best_huffman==1&&r.best_huffman_divide(C,O),t.ResvAdjust(C,O)},this.VBR_encode_granule=function(C,_,x,F,O,N,v){var T=C.internal_flags,S=new Cd,g=Dl(576),b=v,y=v+1,w=(v+N)/2,A,E,j=0,K=T.sfb21_extra;Bl(b<=LameInternalFlags.MAX_BITS_PER_CHANNEL),ma.fill(S.l3_enc,0);do w>b-42?T.sfb21_extra=!1:T.sfb21_extra=K,E=outer_loop(C,_,x,F,O,w),E<=0?(j=1,y=_.part2_3_length,S.assign(_),gs.arraycopy(F,0,g,0,576),v=y-32,A=v-N,w=(v+N)/2):(N=w+32,A=v-N,w=(v+N)/2,j!=0&&(j=2,_.assign(S),gs.arraycopy(g,0,F,0,576)));while(A>12);T.sfb21_extra=K,j==2&&gs.arraycopy(S.l3_enc,0,_.l3_enc,0,576),Bl(_.part2_3_length<=b)},this.get_framebits=function(C,_){var x=C.internal_flags;x.bitrate_index=x.VBR_min_bitrate;var F=e.getframebits(C);x.bitrate_index=1,F=e.getframebits(C);for(var O=1;O<=x.VBR_max_bitrate;O++){x.bitrate_index=O;var N=new MeanBits(F);_[O]=t.ResvFrameBegin(C,N),F=N.bits}},this.VBR_old_prepare=function(C,_,x,F,O,N,v,T,S){var g=C.internal_flags,b,y=0,w=1,A=0;g.bitrate_index=g.VBR_max_bitrate;var E=t.ResvFrameBegin(C,new MeanBits(0))/g.mode_gr;get_framebits(C,N);for(var j=0;j<g.mode_gr;j++){var K=n.on_pe(C,_,T[j],E,j,0);g.mode_ext==P.MPG_MD_MS_LR&&(ms_convert(g.l3_side,j),n.reduce_side(T[j],x[j],E,K));for(var H=0;H<g.channels_out;++H){var $=g.l3_side.tt[j][H];$.block_type!=P.SHORT_TYPE?(y=1.28/(1+Math.exp(3.5-_[j][H]/300))-.05,b=g.PSY.mask_adjust-y):(y=2.56/(1+Math.exp(3.5-_[j][H]/300))-.14,b=g.PSY.mask_adjust_short-y),g.masking_lower=Math.pow(10,b*.1),init_outer_loop(g,$),S[j][H]=n.calc_xmin(C,F[j][H],$,O[j][H]),S[j][H]!=0&&(w=0),v[j][H]=126,A+=T[j][H]}}for(var j=0;j<g.mode_gr;j++)for(var H=0;H<g.channels_out;H++)A>N[g.VBR_max_bitrate]&&(T[j][H]*=N[g.VBR_max_bitrate],T[j][H]/=A),v[j][H]>T[j][H]&&(v[j][H]=T[j][H]);return w},this.bitpressure_strategy=function(C,_,x,F){for(var O=0;O<C.mode_gr;O++)for(var N=0;N<C.channels_out;N++){for(var v=C.l3_side.tt[O][N],T=_[O][N],S=0,g=0;g<v.psy_lmax;g++)T[S++]*=1+.029*g*g/P.SBMAX_l/P.SBMAX_l;if(v.block_type==P.SHORT_TYPE)for(var g=v.sfb_smin;g<P.SBMAX_s;g++)T[S++]*=1+.029*g*g/P.SBMAX_s/P.SBMAX_s,T[S++]*=1+.029*g*g/P.SBMAX_s/P.SBMAX_s,T[S++]*=1+.029*g*g/P.SBMAX_s/P.SBMAX_s;F[O][N]=0|Math.max(x[O][N],.9*F[O][N])}},this.VBR_new_prepare=function(C,_,x,F,O,N){var v=C.internal_flags,T=1,S=0,g=0,b;if(C.free_format){v.bitrate_index=0;var y=new MeanBits(S);b=t.ResvFrameBegin(C,y),S=y.bits,O[0]=b}else{v.bitrate_index=v.VBR_max_bitrate;var y=new MeanBits(S);t.ResvFrameBegin(C,y),S=y.bits,get_framebits(C,O),b=O[v.VBR_max_bitrate]}for(var w=0;w<v.mode_gr;w++){n.on_pe(C,_,N[w],S,w,0),v.mode_ext==P.MPG_MD_MS_LR&&ms_convert(v.l3_side,w);for(var A=0;A<v.channels_out;++A){var E=v.l3_side.tt[w][A];v.masking_lower=Math.pow(10,v.PSY.mask_adjust*.1),init_outer_loop(v,E),n.calc_xmin(C,x[w][A],E,F[w][A])!=0&&(T=0),g+=N[w][A]}}for(var w=0;w<v.mode_gr;w++)for(var A=0;A<v.channels_out;A++)g>b&&(N[w][A]*=b,N[w][A]/=g);return T},this.calc_target_bits=function(C,_,x,F,O,N){var v=C.internal_flags,T=v.l3_side,S,g,b,y,w=0;v.bitrate_index=v.VBR_max_bitrate;var A=new MeanBits(w);for(N[0]=t.ResvFrameBegin(C,A),w=A.bits,v.bitrate_index=1,w=e.getframebits(C)-v.sideinfo_len*8,O[0]=w/(v.mode_gr*v.channels_out),w=C.VBR_mean_bitrate_kbps*C.framesize*1e3,(v.substep_shaping&1)!=0&&(w*=1.09),w/=C.out_samplerate,w-=v.sideinfo_len*8,w/=v.mode_gr*v.channels_out,S=.93+.07*(11-C.compression_ratio)/(11-5.5),S<.9&&(S=.9),S>1&&(S=1),g=0;g<v.mode_gr;g++){var E=0;for(b=0;b<v.channels_out;b++){if(F[g][b]=int(S*w),_[g][b]>700){var j=int((_[g][b]-700)/1.4),K=T.tt[g][b];F[g][b]=int(S*w),K.block_type==P.SHORT_TYPE&&j<w/2&&(j=w/2),j>w*3/2?j=w*3/2:j<0&&(j=0),F[g][b]+=j}F[g][b]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(F[g][b]=LameInternalFlags.MAX_BITS_PER_CHANNEL),E+=F[g][b]}if(E>LameInternalFlags.MAX_BITS_PER_GRANULE)for(b=0;b<v.channels_out;++b)F[g][b]*=LameInternalFlags.MAX_BITS_PER_GRANULE,F[g][b]/=E}if(v.mode_ext==P.MPG_MD_MS_LR)for(g=0;g<v.mode_gr;g++)n.reduce_side(F[g],x[g],w*v.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(y=0,g=0;g<v.mode_gr;g++)for(b=0;b<v.channels_out;b++)F[g][b]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(F[g][b]=LameInternalFlags.MAX_BITS_PER_CHANNEL),y+=F[g][b];if(y>N[0])for(g=0;g<v.mode_gr;g++)for(b=0;b<v.channels_out;b++)F[g][b]*=N[0],F[g][b]/=y}}var E3=De.assert;function cW(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var i=t.internal_flags,r,s=i.l3_side,o=e.getframebits(t);n.bits=(o-i.sideinfo_len*8)/i.mode_gr;var a=8*256*i.mode_gr-8;t.brate>320?r=8*int(t.brate*1e3/(t.out_samplerate/1152)/8+.5):(r=8*1440,t.strict_ISO&&(r=8*int(32e4/(t.out_samplerate/1152)/8+.5))),i.ResvMax=r-o,i.ResvMax>a&&(i.ResvMax=a),(i.ResvMax<0||t.disable_reservoir)&&(i.ResvMax=0);var l=n.bits*i.mode_gr+Math.min(i.ResvSize,i.ResvMax);return l>r&&(l=r),E3(i.ResvMax%8==0),E3(i.ResvMax>=0),s.resvDrain_pre=0,i.pinfo!=null&&(i.pinfo.mean_bits=n.bits/2,i.pinfo.resvsize=i.ResvSize),l},this.ResvMaxBits=function(t,n,i,r){var s=t.internal_flags,o,a=s.ResvSize,l=s.ResvMax;r!=0&&(a+=n),(s.substep_shaping&1)!=0&&(l*=.9),i.bits=n,a*10>l*9?(o=a-l*9/10,i.bits+=o,s.substep_shaping|=128):(o=0,s.substep_shaping&=127,!t.disable_reservoir&&(s.substep_shaping&1)==0&&(i.bits-=.1*n));var c=a<s.ResvMax*6/10?a:s.ResvMax*6/10;return c-=o,c<0&&(c=0),c},this.ResvAdjust=function(t,n){t.ResvSize-=n.part2_3_length+n.part2_length},this.ResvFrameEnd=function(t,n){var i,r=t.l3_side;t.ResvSize+=n*t.mode_gr;var s=0;r.resvDrain_post=0,r.resvDrain_pre=0,(i=t.ResvSize%8)!=0&&(s+=i),i=t.ResvSize-s-t.ResvMax,i>0&&(s+=i);{var o=Math.min(r.main_data_begin*8,s)/8;r.resvDrain_pre+=8*o,s-=8*o,t.ResvSize-=8*o,r.main_data_begin-=o}r.resvDrain_post+=s,t.ResvSize-=s}}function uW(){var e="http://www.mp3dev.org/",t=3,n=98,i=4,r=0,s=93;this.getLameVersion=function(){return t+"."+n+"."+i},this.getLameShortVersion=function(){return t+"."+n+"."+i},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+n+"r"},this.getPsyVersion=function(){return r+"."+s},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var hW=De.System,h1=De.VbrMode,S3=De.ShortBlock,dW=De.Arrays,uh=De.new_byte,fW=De.assert;Gc.NUMTOCENTRIES=100;Gc.MAXFRAMESIZE=2880;function Gc(){var e,t,n;this.setModules=function(w,A,E){e=w,t=A,n=E};var i=1,r=2,s=4,o=8,a=Gc.NUMTOCENTRIES,l=Gc.MAXFRAMESIZE,c=a+4+4+4+4+4,d=c+9+1+1+8+1+1+3+1+1+2+4+2+2,u=128,f=64,m=32,h=null,R="Xing",M="Info",C=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function _(w,A){if(w.nVbrNumFrames++,w.sum+=A,w.seen++,!(w.seen<w.want)&&(w.pos<w.size&&(w.bag[w.pos]=w.sum,w.pos++,w.seen=0),w.pos==w.size)){for(var E=1;E<w.size;E+=2)w.bag[E/2]=w.bag[E];w.want*=2,w.pos/=2}}function x(w,A){if(!(w.pos<=0))for(var E=1;E<a;++E){var j=E/a,K,H,$=0|Math.floor(j*w.pos);$>w.pos-1&&($=w.pos-1),K=w.bag[$],H=w.sum;var p=0|256*K/H;p>255&&(p=255),A[E]=255&p}}this.addVbrFrame=function(w){var A=w.internal_flags,E=Tables.bitrate_table[w.version][A.bitrate_index];fW(A.VBR_seek_table.bag!=null),_(A.VBR_seek_table,E)};function F(w,A){var E=w[A+0]&255;return E<<=8,E|=w[A+1]&255,E<<=8,E|=w[A+2]&255,E<<=8,E|=w[A+3]&255,E}function O(w,A,E){w[A+0]=255&(E>>24&255),w[A+1]=255&(E>>16&255),w[A+2]=255&(E>>8&255),w[A+3]=255&(E&255)}function N(w,A,E){w[A+0]=255&(E>>8&255),w[A+1]=255&(E&255)}function v(w,A){return new String(w,A,R.length(),h).equals(R)||new String(w,A,M.length(),h).equals(M)}function T(w,A,E){return 255&(w<<A|E&~(-1<<A))}function S(w,A){var E=w.internal_flags;A[0]=T(A[0],8,255),A[1]=T(A[1],3,7),A[1]=T(A[1],1,w.out_samplerate<16e3?0:1),A[1]=T(A[1],1,w.version),A[1]=T(A[1],2,4-3),A[1]=T(A[1],1,w.error_protection?0:1),A[2]=T(A[2],4,E.bitrate_index),A[2]=T(A[2],2,E.samplerate_index),A[2]=T(A[2],1,0),A[2]=T(A[2],1,w.extension),A[3]=T(A[3],2,w.mode.ordinal()),A[3]=T(A[3],2,E.mode_ext),A[3]=T(A[3],1,w.copyright),A[3]=T(A[3],1,w.original),A[3]=T(A[3],2,w.emphasis),A[0]=255;var j=255&(A[1]&241),K;w.version==1?K=u:w.out_samplerate<16e3?K=m:K=f,w.VBR==h1.vbr_off&&(K=w.brate);var H;w.free_format?H=0:H=255&16*e.BitrateIndex(K,w.version,w.out_samplerate),w.version==1?(A[1]=255&(j|10),j=255&(A[2]&13),A[2]=255&(H|j)):(A[1]=255&(j|2),j=255&(A[2]&13),A[2]=255&(H|j))}this.getVbrTag=function(w){var A=new VBRTagData,E=0;A.flags=0;var j=w[E+1]>>3&1,K=w[E+2]>>2&3,H=w[E+3]>>6&3,$=w[E+2]>>4&15;if($=Tables.bitrate_table[j][$],w[E+1]>>4==14?A.samprate=Tables.samplerate_table[2][K]:A.samprate=Tables.samplerate_table[j][K],j!=0?H!=3?E+=32+4:E+=17+4:H!=3?E+=17+4:E+=9+4,!v(w,E))return null;E+=4,A.hId=j;var p=A.flags=F(w,E);if(E+=4,(p&i)!=0&&(A.frames=F(w,E),E+=4),(p&r)!=0&&(A.bytes=F(w,E),E+=4),(p&s)!=0){if(A.toc!=null)for(var I=0;I<a;I++)A.toc[I]=w[E+I];E+=a}A.vbrScale=-1,(p&o)!=0&&(A.vbrScale=F(w,E),E+=4),A.headersize=(j+1)*72e3*$/A.samprate,E+=21;var Z=w[E+0]<<4;Z+=w[E+1]>>4;var D=(w[E+1]&15)<<8;return D+=w[E+2]&255,(Z<0||Z>3e3)&&(Z=-1),(D<0||D>3e3)&&(D=-1),A.encDelay=Z,A.encPadding=D,A},this.InitVbrTag=function(w){var A=w.internal_flags,E;w.version==1?E=u:w.out_samplerate<16e3?E=m:E=f,w.VBR==h1.vbr_off&&(E=w.brate);var j=(w.version+1)*72e3*E/w.out_samplerate,K=A.sideinfo_len+d;if(A.VBR_seek_table.TotalFrameSize=j,j<K||j>l){w.bWriteVbrTag=!1;return}A.VBR_seek_table.nVbrNumFrames=0,A.VBR_seek_table.nBytesWritten=0,A.VBR_seek_table.sum=0,A.VBR_seek_table.seen=0,A.VBR_seek_table.want=1,A.VBR_seek_table.pos=0,A.VBR_seek_table.bag==null&&(A.VBR_seek_table.bag=new int[400],A.VBR_seek_table.size=400);var H=uh(l);S(w,H);for(var $=A.VBR_seek_table.TotalFrameSize,p=0;p<$;++p)t.add_dummy_byte(w,H[p]&255,1)};function g(w,A){var E=A^w;return A=A>>8^C[E&255],A}this.updateMusicCRC=function(w,A,E,j){for(var K=0;K<j;++K)w[0]=g(A[E+K],w[0])};function b(w,A,E,j,K){var H=w.internal_flags,$=0,p=w.encoder_delay,I=w.encoder_padding,Z=100-10*w.VBR_q-w.quality,D=n.getLameVeryShortVersion(),ye,Oe=0,xe,be=[1,5,3,2,4,0,3],qe=0|(w.lowpassfreq/100+.5>255?255:w.lowpassfreq/100+.5),Fe=0,we=0,Ye=0,lt=w.internal_flags.noise_shaping,k=0,L=0,q=0,W=0,G=0,ie=(w.exp_nspsytune&1)!=0,ce=(w.exp_nspsytune&2)!=0,J=!1,re=!1,Q=w.internal_flags.nogap_total,Ee=w.internal_flags.nogap_current,fe=w.ATHtype,Te=0,Ce;switch(w.VBR){case vbr_abr:Ce=w.VBR_mean_bitrate_kbps;break;case vbr_off:Ce=w.brate;break;default:Ce=w.VBR_min_bitrate_kbps}switch(w.VBR.ordinal()<be.length?ye=be[w.VBR.ordinal()]:ye=0,xe=16*Oe+ye,H.findReplayGain&&(H.RadioGain>510&&(H.RadioGain=510),H.RadioGain<-510&&(H.RadioGain=-510),we=8192,we|=3072,H.RadioGain>=0?we|=H.RadioGain:(we|=512,we|=-H.RadioGain)),H.findPeakSample&&(Fe=Math.abs(0|H.PeakSample/32767*Math.pow(2,23)+.5)),Q!=-1&&(Ee>0&&(re=!0),Ee<Q-1&&(J=!0)),Te=fe+((ie?1:0)<<4)+((ce?1:0)<<5)+((J?1:0)<<6)+((re?1:0)<<7),Z<0&&(Z=0),w.mode){case MONO:k=0;break;case STEREO:k=1;break;case DUAL_CHANNEL:k=2;break;case JOINT_STEREO:w.force_ms?k=4:k=3;break;case NOT_SET:default:k=7;break}w.in_samplerate<=32e3?q=0:w.in_samplerate==48e3?q=2:w.in_samplerate>48e3?q=3:q=1,(w.short_blocks==S3.short_block_forced||w.short_blocks==S3.short_block_dispensed||w.lowpassfreq==-1&&w.highpassfreq==-1||w.scale_left<w.scale_right||w.scale_left>w.scale_right||w.disable_reservoir&&w.brate<320||w.noATH||w.ATHonly||fe==0||w.in_samplerate<=32e3)&&(L=1),W=lt+(k<<2)+(L<<5)+(q<<6),G=H.nMusicCRC,O(E,j+$,Z),$+=4;for(var Le=0;Le<9;Le++)E[j+$+Le]=255&D.charAt(Le);$+=9,E[j+$]=255&xe,$++,E[j+$]=255&qe,$++,O(E,j+$,Fe),$+=4,N(E,j+$,we),$+=2,N(E,j+$,Ye),$+=2,E[j+$]=255&Te,$++,Ce>=255?E[j+$]=255:E[j+$]=255&Ce,$++,E[j+$]=255&p>>4,E[j+$+1]=255&(p<<4)+(I>>8),E[j+$+2]=255&I,$+=3,E[j+$]=255&W,$++,E[j+$++]=0,N(E,j+$,w.preset),$+=2,O(E,j+$,A),$+=4,N(E,j+$,G),$+=2;for(var ue=0;ue<$;ue++)K=g(E[j+ue],K);return N(E,j+$,K),$+=2,$}function y(w){w.seek(0);var A=uh(10);w.readFully(A);var E;return new String(A,"ISO-8859-1").startsWith("ID3")?E=0:E=((A[6]&127)<<21|(A[7]&127)<<14|(A[8]&127)<<7|A[9]&127)+A.length,E}this.getLameTagFrame=function(w,A){var E=w.internal_flags;if(!w.bWriteVbrTag||E.Class_ID!=Lame.LAME_ID||E.VBR_seek_table.pos<=0)return 0;if(A.length<E.VBR_seek_table.TotalFrameSize)return E.VBR_seek_table.TotalFrameSize;dW.fill(A,0,E.VBR_seek_table.TotalFrameSize,0),S(w,A);var j=uh(a);if(w.free_format)for(var K=1;K<a;++K)j[K]=255&255*K/100;else x(E.VBR_seek_table,j);var H=E.sideinfo_len;w.error_protection&&(H-=2),w.VBR==h1.vbr_off?(A[H++]=255&M.charAt(0),A[H++]=255&M.charAt(1),A[H++]=255&M.charAt(2),A[H++]=255&M.charAt(3)):(A[H++]=255&R.charAt(0),A[H++]=255&R.charAt(1),A[H++]=255&R.charAt(2),A[H++]=255&R.charAt(3)),O(A,H,i+r+s+o),H+=4,O(A,H,E.VBR_seek_table.nVbrNumFrames),H+=4;var $=E.VBR_seek_table.nBytesWritten+E.VBR_seek_table.TotalFrameSize;O(A,H,0|$),H+=4,hW.arraycopy(j,0,A,H,j.length),H+=j.length,w.error_protection&&t.CRC_writeheader(E,A);for(var p=0,K=0;K<H;K++)p=g(A[K],p);return H+=b(w,$,A,H,p),E.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(w,A){var E=w.internal_flags;if(E.VBR_seek_table.pos<=0||(A.seek(A.length()),A.length()==0))return-1;var j=y(A);A.seek(j);var K=uh(l),H=getLameTagFrame(w,K);return H>K.length?-1:(H<1||A.write(K,0,H),0)}}var T3=De.new_byte,mW=De.assert;function pW(){this.setModules=function(e,t){}}function gW(){this.setModules=function(e,t,n){}}function _W(){}function vW(){this.setModules=function(e,t){}}function yW(e,t,n){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,n=128);var i=new st,r=new pW,s=new cn,o=new $i,a=new rW,l=new Un,c=new lW,d=new Gc,u=new uW,f=new vW,m=new cW,h=new Kc,R=new gW,M=new _W;i.setModules(s,o,a,l,c,d,u,f,M),o.setModules(s,M,u,d),f.setModules(o,u),a.setModules(i),c.setModules(o,m,l,h),l.setModules(h,m,i.enc.psy),m.setModules(o),h.setModules(l),d.setModules(i,o,u),r.setModules(R,M),R.setModules(u,f,a);var C=i.lame_init();C.num_channels=e,C.in_samplerate=t,C.brate=n,C.mode=It.STEREO,C.quality=3,C.bWriteVbrTag=!1,C.disable_reservoir=!0,C.write_id3tag_automatic=!1,i.lame_init_params(C);var _=1152,x=0|1.25*_+7200,F=T3(x);this.encodeBuffer=function(O,N){e==1&&(N=O),mW(O.length==N.length),O.length>_&&(_=O.length,x=0|1.25*_+7200,F=T3(x));var v=i.lame_encode_buffer(C,O,N,O.length,F,0,x);return new Int8Array(F.subarray(0,v))},this.flush=function(){var O=i.lame_encode_flush(C,F,0,x);return new Int8Array(F.subarray(0,O))}}function em(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}em("RIFF");em("WAVE");em("fmt ");em("data");class bW{constructor(t){this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new yW(1,this.sampleRate,this.bitRate)}encode(t){const i=this._convertBuffer(t);let r=i.length;for(let s=0;r>=0;s+=1152){const o=i.subarray(s,s+1152),a=this.encoder.encodeBuffer(o);this.dataBuffer.push(new Int8Array(a)),r-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const t=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:t,url:URL.createObjectURL(t)}}_floatTo16BitPCM(t,n){for(let i=0;i<t.length;i++){const r=Math.max(-1,Math.min(1,t[i]));n[i]=r<0?r*32768:r*32767}}_convertBuffer(t){const n=new Float32Array(t),i=new Int16Array(t.length);return this._floatTo16BitPCM(n,i),i}}class wW{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new bW(this.encoderOptions))}stop(){this.stream.getTracks().forEach(n=>n.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;t=this.lameEncoder.finish(),t.duration=this.duration,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,this.processor.onaudioprocess=n=>{const i=n.inputBuffer.getChannelData(0);let r=0;this.lameEncoder&&this.lameEncoder.encode(i);for(let s=0;s<i.length;++s)r+=i[s]*i[s];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(r/i.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}var k3=window.chrome,uv=window.navigator,EW=uv.vendor,SW=typeof window.opr!="undefined",TW=uv.userAgent.indexOf("Edg")>-1,kW=uv.userAgent.match("CriOS");function AW(){return kW?!0:k3!==null&&typeof k3!="undefined"&&EW==="Google Inc."&&SW===!1&&TW===!1}function A3(){var e=xW(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function xW(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const CW={name:"RoomFooter",components:{SvgIcon:Bn,EmojiPickerContainer:eS,RoomFiles:Mz,RoomMessageReply:t$,RoomUsersTag:l$,RoomEmojis:f$,RoomTemplatesText:w$},directives:{clickOutside:Qf},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new j8({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=A3();let t=!0;this.getTextareaRef().addEventListener("keyup",n=>{n.key==="Enter"&&!n.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!n.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){A3()&&e||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const t=AW()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+t,this.cursorRangePosition+t),this.cursorRangePosition=null}))},onChangeInput(){var e,t,n;(((e=this.getTextareaRef())==null?void 0:e.value)||((t=this.getTextareaRef())==null?void 0:t.value)==="")&&(this.message=(n=this.getTextareaRef())==null?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-t*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const n=(t=e.clipboardData)==null?void 0:t.items;n&&Array.from(n).forEach(i=>{if(i.type.includes("image")){const r=i.getAsFile();this.onFileChange([r])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition("/"),i=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+i+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t+e.text.length+i.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async t=>{const n=URL.createObjectURL(t),i=t.name.lastIndexOf(".");this.files.push({loading:!0,name:t.name.substring(0,i),size:t.size,type:t.type,extension:t.name.substring(i+1),localUrl:n});const r=await fetch(n).then(o=>o.blob());let s=this.files.find(o=>o.localUrl===n);s&&(s.blob=r,s.loading=!1,delete s.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const t=this.recorder.records[0];this.files.push({blob:t.blob,name:`audio.${this.format}`,size:t.blob.size,duration:t.duration,type:t.blob.type,audio:!0,localUrl:URL.createObjectURL(t.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t||this.isFileLoading)return;this.selectedUsersTag.forEach(i=>{t=t.replace(`@${i.username}`,`<usertag>${i._id}</usertag>`)});const n=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||((e=this.editedMessage.files)==null?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const n=t,i="<usertag>",r="</usertag>";[...t.matchAll(new RegExp(i,"gi"))].map(o=>o.index).forEach(o=>{const a=n.substring(o+i.length,n.indexOf(r,o)),l=this.room.users.find(c=>c._id===a);t=t.replace(`${i}${a}${r}`,`@${(l==null?void 0:l.username)||"unknown"}`),this.selectUserTag(l,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||e===":"&&!this.emojisSuggestionEnabled||e==="@"&&(!this.userTagsEnabled||!this.room.users)||e==="/"&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let n=t;for(;n>0&&this.message.charAt(n-1)!==e&&(this.message.charAt(n-1)!==" "||e!==":");)n--;const i=this.message.charAt(n-2),r=!i.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)===e&&(!i||i===" "||r)){const s=this.message.substring(n,t);e===":"?this.updateEmojis(s):e==="@"?this.updateShowUsersTag(s):e==="/"&&this.updateShowTemplatesText(s)}else this.resetFooterList(e)},updateShowUsersTag(e){this.filteredUsersTag=G0(this.room.users,"username",e,!0).filter(t=>t._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:n,endPosition:i}=this.getCharPosition("@"),r=this.message.substr(i,i).length?"":" ";this.message=this.message.substr(0,n)+e.username+r+this.message.substr(i,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=n+e.username.length+r.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=G0(this.templatesText,"tag",e,!0)},getCharPosition(e){let n=this.getTextareaRef().selectionStart;for(;n>0&&this.message.charAt(n-1)!==e;)n--;const i=this.getTextareaRef().selectionEnd;return{position:n,endPosition:i}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(n=>n.unicode)},resetFooterList(e=null){e===":"?this.filteredEmojis=[]:e==="@"?this.filteredUsersTag=[]:e==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new wW({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},IW={key:0,class:"vac-icon-textarea-left"},RW=Me("div",{class:"vac-dot-audio-record"},null,-1),MW={class:"vac-dot-audio-record-time"},OW=["placeholder"],NW={class:"vac-icon-textarea"},FW={key:1},LW=["multiple","accept","capture"];function DW(e,t,n,i,r,s){const o=Ze("room-emojis"),a=Ze("room-users-tag"),l=Ze("room-templates-text"),c=Ze("room-message-reply"),d=Ze("room-files"),u=Ze("svg-icon"),f=Ze("emoji-picker-container"),m=$f("click-outside");return ts((ae(),_e("div",{id:"room-footer",class:mt(["vac-room-footer",{"vac-app-box-shadow":s.shadowFooter}])},[Ve(o,{"filtered-emojis":r.filteredEmojis,"select-item":r.selectEmojiItem,"active-up-or-down":r.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=h=>s.selectEmoji(h)),onActivateItem:t[1]||(t[1]=h=>r.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Ve(a,{"filtered-users-tag":r.filteredUsersTag,"select-item":r.selectUsersTagItem,"active-up-or-down":r.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=h=>s.selectUserTag(h)),onActivateItem:t[3]||(t[3]=h=>r.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Ve(l,{"filtered-templates-text":r.filteredTemplatesText,"select-item":r.selectTemplatesTextItem,"active-up-or-down":r.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=h=>s.selectTemplateText(h)),onActivateItem:t[5]||(t[5]=h=>r.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Ve(c,{room:n.room,"message-reply":r.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:s.resetMessage},Vt({_:2},[ht(e.$slots,(h,R)=>({name:R,fn:Je(M=>[Pe(e.$slots,R,Ht(Bt(M)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Ve(d,{files:r.files,onRemoveFile:s.removeFile,onResetMessage:s.resetMessage},Vt({_:2},[ht(e.$slots,(h,R)=>({name:R,fn:Je(M=>[Pe(e.$slots,R,Ht(Bt(M)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),Me("div",{class:mt(["vac-box-footer",{"vac-box-footer-border":!r.files.length}])},[n.showAudio&&!r.files.length?(ae(),_e("div",IW,[r.isRecording?(ae(),_e(wt,{key:0},[Me("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...h)=>s.stopRecorder&&s.stopRecorder(...h))},[Pe(e.$slots,"audio-stop-icon",{},()=>[Ve(u,{name:"close-outline"})])]),RW,Me("div",MW,ot(s.recordedTime),1),Me("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=h=>s.toggleRecorder(!1))},[Pe(e.$slots,"audio-check-icon",{},()=>[Ve(u,{name:"checkmark"})])])],64)):(ae(),_e("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=h=>s.toggleRecorder(!0))},[Pe(e.$slots,"microphone-icon",{},()=>[Ve(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Be("",!0),Me("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:mt(["vac-textarea",{"vac-textarea-outline":r.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...h)=>s.onChangeInput&&s.onChangeInput(...h)),onKeydown:[t[10]||(t[10]=ho((...h)=>s.escapeTextarea&&s.escapeTextarea(...h),["esc"])),t[11]||(t[11]=ho(Ar((...h)=>s.selectItem&&s.selectItem(...h),["exact","prevent"]),["enter"])),t[13]||(t[13]=ho(Ar(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=ho((...h)=>s.selectItem&&s.selectItem(...h),["tab"])),t[15]||(t[15]=ho(h=>s.updateActiveUpOrDown(h,-1),["up"])),t[16]||(t[16]=ho(h=>s.updateActiveUpOrDown(h,1),["down"]))],onPaste:t[12]||(t[12]=(...h)=>s.onPasteImage&&s.onPasteImage(...h))},null,42,OW),Me("div",NW,[r.editedMessage._id?(ae(),_e("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...h)=>s.resetMessage&&s.resetMessage(...h))},[Pe(e.$slots,"edit-close-icon",{},()=>[Ve(u,{name:"close-outline"})])])):Be("",!0),n.showEmojis?ts((ae(),_e("div",FW,[Pe(e.$slots,"emoji-picker",G_({emojiOpened:r.emojiOpened},{addEmoji:s.addEmoji}),()=>[Ve(f,{"emoji-opened":r.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:s.addEmoji,onOpenEmoji:t[18]||(t[18]=h=>r.emojiOpened=h)},{"emoji-picker-icon":Je(()=>[Pe(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[m,()=>r.emojiOpened=!1]]):Be("",!0),n.showFiles?(ae(),_e("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...h)=>s.launchFilePicker&&s.launchFilePicker(...h))},[Pe(e.$slots,"paperclip-icon",{},()=>[Ve(u,{name:"paperclip"})])])):Be("",!0),n.textareaActionEnabled?(ae(),_e("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...h)=>s.textareaActionHandler&&s.textareaActionHandler(...h))},[Pe(e.$slots,"custom-action-icon",{},()=>[Ve(u,{name:"deleted"})])])):Be("",!0),n.showFiles?(ae(),_e("input",{key:4,ref:"file",type:"file",multiple:n.multipleFiles?!0:null,accept:n.acceptedFiles,capture:n.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=h=>s.onFileChange(h.target.files))},null,40,LW)):Be("",!0),n.showSendIcon?(ae(),_e("div",{key:5,class:mt(["vac-svg-button",{"vac-send-disabled":s.isMessageEmpty}]),onClick:t[22]||(t[22]=(...h)=>s.sendMessage&&s.sendMessage(...h))},[Pe(e.$slots,"send-icon",{},()=>[Ve(u,{name:"send",param:s.isMessageEmpty||s.isFileLoading?"disabled":""},null,8,["param"])])],2)):Be("",!0)])],2)],2)),[[Gf,Object.keys(n.room).length&&n.showFooter]])}var BW=Yt(CW,[["render",DW]]);const PW={name:"MessageReply",components:{AudioPlayer:cv,SvgIcon:Bn,FormatMessage:Tu},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(n=>n._id===e);return t?t.username:""},firstFile(){var e,t;return(t=(e=this.message.replyMessage)==null?void 0:e.files)!=null&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return Zf(this.firstFile)},isImage(){return nl(this.firstFile)},isVideo(){return ku(this.firstFile)},isOtherFile(){var e;return((e=this.message.replyMessage.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},UW={class:"vac-reply-message"},jW={class:"vac-reply-username"},HW={key:0,class:"vac-image-reply-container"},VW={key:1,class:"vac-video-reply-container"},qW={controls:""},zW=["src"],$W={key:3,class:"vac-file-container"},WW={class:"vac-text-ellipsis"},KW={key:0,class:"vac-text-ellipsis vac-text-extension"},GW={class:"vac-reply-content"};function YW(e,t,n,i,r,s){const o=Ze("audio-player"),a=Ze("svg-icon"),l=Ze("format-message");return ae(),_e("div",UW,[Me("div",jW,ot(s.replyUsername),1),s.isImage?(ae(),_e("div",HW,[Me("div",{class:"vac-message-image vac-message-image-reply",style:Zt({"background-image":`url('${s.firstFile.url}')`})},null,4)])):s.isVideo?(ae(),_e("div",VW,[Me("video",qW,[Me("source",{src:s.firstFile.url},null,8,zW)])])):s.isAudio?(ae(),Lt(o,{key:2,src:s.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=c=>e.progressTime=c),onHoverAudioProgress:t[1]||(t[1]=c=>e.hoverAudioProgress=c)},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["src"])):s.isOtherFile?(ae(),_e("div",$W,[Me("div",null,[Pe(e.$slots,"file-icon",{},()=>[Ve(a,{name:"file"})])]),Me("div",WW,ot(s.firstFile.name),1),s.firstFile.extension?(ae(),_e("div",KW,ot(s.firstFile.extension),1)):Be("",!0)])):Be("",!0),Me("div",GW,[Ve(l,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var XW=Yt(PW,[["render",YW]]);const QW={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const i=54*Math.PI;return{radius:35,stroke:4,normalizedRadius:27,circumference:i}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},ZW={ref:"progress",class:"vac-progress-wrapper"},JW=["height","width"],eK=["stroke-dasharray","stroke-width","r","cx","cy"],tK={class:"vac-progress-text"},nK=Me("span",{class:"vac-progress-pourcent"},"%",-1);function iK(e,t,n,i,r,s){return ae(),Lt(fn,{name:"vac-fade-spinner",appear:""},{default:Je(()=>[Me("div",ZW,[(ae(),_e("svg",{height:r.radius*2,width:r.radius*2},[Me("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":r.circumference+" "+r.circumference,style:Zt({strokeDashoffset:s.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":r.stroke,fill:"transparent",r:r.normalizedRadius,cx:r.radius,cy:r.radius},null,12,eK)],8,JW)),Me("div",{class:"vac-progress-content",style:Zt({height:r.radius*2-19+"px",width:r.radius*2-19+"px"})},[Me("div",tK,[ns(ot(n.progress),1),nK])],4)],512)]),_:1})}var hS=Yt(QW,[["render",iK]]);const rK={name:"MessageFile",components:{SvgIcon:Bn,Loader:Yf,ProgressBar:hS},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1||this.imageLoading},isImage(){return nl(this.file)},isVideo(){return ku(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!nl(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},sK={class:"vac-message-file-container"},oK={key:0,class:"vac-image-buttons"},aK={controls:""},lK=["src"];function cK(e,t,n,i,r,s){const o=Ze("progress-bar"),a=Ze("loader"),l=Ze("svg-icon");return ae(),_e("div",sK,[s.isImage?(ae(),_e("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=c=>r.imageHover=!0),onMouseleave:t[3]||(t[3]=c=>r.imageHover=!1),onClick:t[4]||(t[4]=c=>s.openFile(c,"preview"))},[n.file.progress>=0?(ae(),Lt(o,{key:0,progress:n.file.progress,style:Zt({top:`${r.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(ae(),Lt(a,{key:1,show:s.isImageLoading,type:"message-file","message-id":n.message._id,style:Zt({top:`${r.imageResponsive.loaderTop}px`})},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["show","message-id","style"])),Me("div",{class:mt(["vac-message-image",{"vac-blur-loading":s.isImageLoading&&n.message.senderId===n.currentUserId}]),style:Zt({"background-image":`url('${s.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${r.imageResponsive.maxHeight}px`})},[Ve(fn,{name:"vac-fade-image"},{default:Je(()=>[!n.messageSelectionEnabled&&r.imageHover&&!s.isImageLoading?(ae(),_e("div",oK,[Me("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=c=>s.openFile(c,"preview"))},[Pe(e.$slots,"eye-icon_"+n.message._id,{},()=>[Ve(l,{name:"eye"})])]),Me("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=c=>s.openFile(c,"download"))},[Pe(e.$slots,"document-icon_"+n.message._id,{},()=>[Ve(l,{name:"document"})])])])):Be("",!0)]),_:3})],6)],544)):s.isVideo?(ae(),_e("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Ar(c=>s.openFile(c,"preview"),["prevent"]))},[n.file.progress>=0?(ae(),Lt(o,{key:0,progress:n.file.progress},null,8,["progress"])):Be("",!0),Me("video",aK,[Me("source",{src:n.file.url},null,8,lK)])])):Be("",!0)])}var uK=Yt(rK,[["render",cK]]);const hK={name:"MessageFiles",components:{SvgIcon:Bn,FormatMessage:Tu,ProgressBar:hS,MessageFile:uK},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>Hb(e))},otherFiles(){return this.message.files.filter(e=>!Hb(e))}},methods:{openFile(e,t,n){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:n}))}}},dK={class:"vac-message-files-container"},fK=["onClick"],mK={class:"vac-svg-button"},pK={class:"vac-text-ellipsis"},gK={key:0,class:"vac-text-ellipsis vac-text-extension"};function _K(e,t,n,i,r,s){const o=Ze("message-file"),a=Ze("progress-bar"),l=Ze("svg-icon"),c=Ze("format-message");return ae(),_e("div",dK,[(ae(!0),_e(wt,null,ht(s.imageVideoFiles,(d,u)=>(ae(),_e("div",{key:u+"iv"},[Ve(o,{file:d,"current-user-id":n.currentUserId,message:n.message,index:u,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=f=>e.$emit("open-file",f))},Vt({_:2},[ht(e.$slots,(f,m)=>({name:m,fn:Je(h=>[Pe(e.$slots,m,Ht(Bt(h)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(ae(!0),_e(wt,null,ht(s.otherFiles,(d,u)=>(ae(),_e("div",{key:u+"a",class:"vac-file-wrapper"},[d.progress>=0?(ae(),Lt(a,{key:0,progress:d.progress,style:{top:"44px"}},null,8,["progress"])):Be("",!0),Me("div",{class:mt(["vac-file-container",{"vac-file-container-progress":d.progress>=0}]),onClick:f=>s.openFile(f,d,"download")},[Me("div",mK,[Pe(e.$slots,"document-icon",{},()=>[Ve(l,{name:"document"})])]),Me("div",pK,ot(d.name),1),d.extension?(ae(),_e("div",gK,ot(d.extension),1)):Be("",!0)],10,fK)]))),128)),Ve(c,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:t[1]||(t[1]=d=>e.$emit("open-user-tag",d))},null,8,["message-id","content","users","text-formatting","link-options"])])}var vK=Yt(hK,[["render",_K]]);const yK={name:"MessageActions",components:{SvgIcon:Bn,EmojiPickerContainer:eS},directives:{clickOutside:Qf},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=J8(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-n>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},bK={class:"vac-message-actions-wrapper"},wK={key:"3"},EK={class:"vac-menu-list"},SK=["onClick"];function TK(e,t,n,i,r,s){const o=Ze("svg-icon"),a=Ze("emoji-picker-container"),l=$f("click-outside");return ae(),_e("div",bK,[Me("div",{class:"vac-options-container",style:Zt({display:n.hoverAudioProgress?"none":"initial",width:s.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[Ve(Q_,{name:"vac-slide-left",tag:"span"},{default:Je(()=>[s.isMessageActions||s.isMessageReactions?(ae(),_e("div",{key:"1",class:mt(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):Be("",!0),s.isMessageActions?(ae(),_e("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...c)=>s.openOptions&&s.openOptions(...c))},[Pe(e.$slots,"dropdown-icon_"+n.message._id,{},()=>[Ve(o,{name:"dropdown",param:"message"})])],512)):Be("",!0),s.isMessageReactions?ts((ae(),_e("div",wK,[Pe(e.$slots,"emoji-picker",G_({emojiOpened:r.emojiOpened},{addEmoji:s.sendMessageReaction}),()=>[Ve(a,{class:"vac-message-emojis",style:Zt({right:s.isMessageActions?"30px":"5px"}),"emoji-opened":r.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:s.sendMessageReaction,onOpenEmoji:s.openEmoji},Vt({_:2},[ht(e.$slots,(c,d)=>({name:d,fn:Je(u=>[Pe(e.$slots,d,Ht(Bt(u)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[l,s.closeEmoji]]):Be("",!0)]),_:3})],4),s.filteredMessageActions.length?(ae(),Lt(fn,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Je(()=>[r.optionsOpened?ts((ae(),_e("div",{key:0,ref:"menuOptions",class:mt(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:Zt({top:`${r.menuOptionsTop}px`})},[Me("div",EK,[(ae(!0),_e(wt,null,ht(s.filteredMessageActions,c=>(ae(),_e("div",{key:c.name},[Me("div",{class:"vac-menu-item",onClick:d=>s.messageActionHandler(c)},ot(c.title),9,SK)]))),128))])],6)),[[l,s.closeOptions]]):Be("",!0)]),_:1},8,["name"])):Be("",!0)])}var kK=Yt(yK,[["render",TK]]);const AK={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},xK=["onClick"];function CK(e,t,n,i,r,s){return n.message.deleted?Be("",!0):(ae(),Lt(Q_,{key:0,name:"vac-slide-left",tag:"span"},{default:Je(()=>[(ae(!0),_e(wt,null,ht(n.message.reactions,(o,a)=>ts((ae(),_e("button",{key:a+0,class:mt(["vac-button-reaction",{"vac-reaction-me":o.indexOf(n.currentUserId)!==-1}]),style:Zt({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:l=>s.sendMessageReaction({unicode:a},o)},[ns(ot(a),1),Me("span",null,ot(o.length),1)],14,xK)),[[Gf,o.length]])),128))]),_:1}))}var IK=Yt(AK,[["render",CK]]);function RK(e){if(!((i,r)=>r.every(s=>{let o=!1;return(s.type[0]==="array"&&Array.isArray(i[s.key])||s.type.find(a=>a===typeof i[s.key]))&&(o=!0),o&&hv(i,s.key)}))(e,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function MK(e){if(!((i,r)=>r.every(s=>s.type.find(a=>a===typeof i[s.key])&&hv(i,s.key)))(e,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function OK(e){if(!((i,r)=>r.every(s=>s.type.find(a=>a===typeof i[s.key])&&hv(i,s.key)))(e,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function hv(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&e[t]!==void 0}const NK={name:"RoomMessage",components:{SvgIcon:Bn,FormatMessage:Tu,AudioPlayer:cv,MessageReply:XW,MessageFiles:vK,MessageActions:kK,MessageReactions:IK},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return(e=this.message.files)==null?void 0:e.some(t=>Zf(t))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){if(!e.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=e.reduce((t,n)=>n.index<t.index?n:t)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){OK(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&t.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},FK=["id"],LK={key:0,class:"vac-card-info vac-card-date"},DK={key:1,class:"vac-line-new"},BK={key:2,class:"vac-card-info vac-card-system"},PK={key:1,class:"vac-avatar-offset"},UK={key:0,class:"vac-progress-time"},jK={class:"vac-text-timestamp"},HK={key:0,class:"vac-icon-edited"},VK={key:1},qK=Me("div",{class:"vac-failure-text"},"!",-1),zK=[qK],$K={key:3,class:"vac-avatar-current-offset"};function WK(e,t,n,i,r,s){const o=Ze("format-message"),a=Ze("message-reply"),l=Ze("message-files"),c=Ze("audio-player"),d=Ze("svg-icon"),u=Ze("message-actions"),f=Ze("message-reactions");return ae(),_e("div",{id:n.message._id,ref:"message",class:"vac-message-wrapper"},[s.showDate?(ae(),_e("div",LK,ot(n.message.date),1)):Be("",!0),r.newMessage._id===n.message._id?(ae(),_e("div",DK,ot(n.textMessages.NEW_MESSAGES),1)):Be("",!0),n.message.system?(ae(),_e("div",BK,[Pe(e.$slots,"message_"+n.message._id,{},()=>[Ve(o,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:s.openUserTag},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(ae(),_e("div",{key:3,class:mt(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}]),onClick:t[8]||(t[8]=(...m)=>s.selectMessage&&s.selectMessage(...m))},[Pe(e.$slots,"message_"+n.message._id,{},()=>[n.message.senderId!==n.currentUserId?Pe(e.$slots,"message-avatar_"+n.message._id,{key:0},()=>[n.message.avatar?(ae(),_e("div",{key:0,class:"vac-avatar",style:Zt({"background-image":`url('${n.message.avatar}')`})},null,4)):Be("",!0)]):Be("",!0),s.hasSenderUserAvatar&&!n.message.avatar?(ae(),_e("div",PK)):Be("",!0),Me("div",{class:mt(["vac-message-container",{"vac-message-container-offset":s.messageOffset}])},[Me("div",{class:mt(["vac-message-card",{"vac-message-highlight":s.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":s.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...m)=>s.onHoverMessage&&s.onHoverMessage(...m)),onMouseleave:t[6]||(t[6]=(...m)=>s.onLeaveMessage&&s.onLeaveMessage(...m))},[s.showUsername?(ae(),_e("div",{key:0,class:mt(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[Me("span",null,ot(n.message.username),1)],2)):Be("",!0),!n.message.deleted&&n.message.replyMessage?(ae(),Lt(a,{key:1,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Be("",!0),!!n.message.deleted||!n.message.files||!n.message.files.length?(ae(),Lt(o,{key:2,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:s.openUserTag},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!s.isAudio||n.message.files.length>1?(ae(),Lt(l,{key:3,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:s.openFile,onOpenUserTag:s.openUserTag},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(ae(),_e(wt,{key:4},[Ve(c,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=m=>r.progressTime=m),onHoverAudioProgress:t[1]||(t[1]=m=>r.hoverAudioProgress=m)},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?Be("",!0):(ae(),_e("div",UK,ot(r.progressTime),1))],64)),Me("div",jK,[n.message.edited&&!n.message.deleted?(ae(),_e("div",HK,[Pe(e.$slots,"pencil-icon_"+n.message._id,{},()=>[Ve(d,{name:"pencil"})])])):Be("",!0),Me("span",null,ot(n.message.timestamp),1),s.isCheckmarkVisible?(ae(),_e("span",VK,[Pe(e.$slots,"checkmark-icon_"+n.message._id,{},()=>[Ve(d,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Be("",!0)]),Ve(u,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":r.messageHover,"hover-message-id":r.hoverMessageId,"hover-audio-progress":r.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=m=>r.messageHover=m),onUpdateOptionsOpened:t[3]||(t[3]=m=>r.optionsOpened=m),onUpdateEmojiOpened:t[4]||(t[4]=m=>r.emojiOpened=m),onMessageActionHandler:s.messageActionHandler,onSendMessageReaction:s.sendMessageReaction},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Ve(f,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:s.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Pe(e.$slots,"message-failure_"+n.message._id,{},()=>[n.message.failure&&n.message.senderId===n.currentUserId?(ae(),_e("div",{key:0,class:mt(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:t[7]||(t[7]=m=>e.$emit("open-failed-message",{message:n.message}))},zK,2)):Be("",!0)]),n.message.senderId===n.currentUserId?Pe(e.$slots,"message-avatar_"+n.message._id,{key:2},()=>[n.message.avatar?(ae(),_e("div",{key:0,class:"vac-avatar vac-avatar-current",style:Zt({"background-image":`url('${n.message.avatar}')`})},null,4)):Be("",!0)]):Be("",!0),s.hasCurrentUserAvatar&&!n.message.avatar?(ae(),_e("div",$K)):Be("",!0)])],2))],8,FK)}var KK=Yt(NK,[["render",WK]]);const GK={name:"ChatRoom",components:{Loader:Yf,SvgIcon:Bn,RoomHeader:jV,RoomFooter:BW,RoomMessage:KK},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((n,i)=>{this.showNewMessagesDivider&&!n.seen&&n.senderId!==this.currentUserId&&this.newMessages.push({_id:n._id,index:i})}),(t==null?void 0:t.length)===(e==null?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,n=new ResizeObserver(r=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),n.disconnect())});for(var i=0;i<e.children.length;i++)n.observe(e.children[i])},touchStart(e){if(!this.singleRoom&&e.changedTouches.length===1){const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;addEventListener("touchend",i=>this.touchEnd(i,t,n),{once:!0})}},touchEnd(e,t,n){if(e.changedTouches.length===1){const i=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY,s=i-t>100,o=Math.abs(r-n)>50;s&&!o&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const n=this.$refs.scrollContainer;!n||(e(),setTimeout(()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:n}){if(t!==this.messages.length-1)return;const i=n.offsetHeight+60;setTimeout(()=>{const r=this.$refs.scrollContainer;let s=!1;r&&(s=this.getBottomScroll(r)>i),e.senderId===this.currentUserId?s?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():s?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":this.initReplyMessage=t,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=t,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":this.selectedMessages=[t],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:n,scrollTop:i}=e;return t-n-i},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e&&(e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth")))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},YK={class:"vac-container-center vac-room-empty"},XK={class:"vac-messages-container"},QK={key:0,class:"vac-text-started"},ZK={key:1,class:"vac-text-started"},JK={key:0,id:"infinite-loader-messages"},eG={key:2},tG={key:0,class:"vac-badge-counter vac-messages-count"};function nG(e,t,n,i,r,s){const o=Ze("room-header"),a=Ze("loader"),l=Ze("room-message"),c=Ze("svg-icon"),d=Ze("room-footer");return ts((ae(),_e("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Ar((...u)=>s.onDropFiles&&s.onDropFiles(...u),["prevent"])),onDragenter:t[13]||(t[13]=Ar(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Ar(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Ar(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...u)=>s.touchStart&&s.touchStart(...u))},[s.showNoRoom?Pe(e.$slots,"no-room-selected",{key:0},()=>[Me("div",YK,[Me("div",null,ot(n.textMessages.ROOM_EMPTY),1)])]):(ae(),Lt(o,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:s.room,"message-selection-enabled":r.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":r.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=u=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=u=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=u=>e.$emit("menu-action-handler",u)),onMessageSelectionActionHandler:s.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=u=>r.messageSelectionEnabled=!1)},Vt({_:2},[ht(e.$slots,(u,f)=>({name:f,fn:Je(m=>[Pe(e.$slots,f,Ht(Bt(m)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Me("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...u)=>s.onContainerScroll&&s.onContainerScroll(...u))},[Ve(a,{show:r.loadingMessages,type:"messages"},Vt({_:2},[ht(e.$slots,(u,f)=>({name:f,fn:Je(m=>[Pe(e.$slots,f,Ht(Bt(m)))])}))]),1032,["show"]),Me("div",XK,[Me("div",{class:mt({"vac-messages-hidden":r.loadingMessages})},[Ve(fn,{name:"vac-fade-message"},{default:Je(()=>[Me("div",null,[s.showNoMessages?(ae(),_e("div",QK,[Pe(e.$slots,"messages-empty",{},()=>[ns(ot(n.textMessages.MESSAGES_EMPTY),1)])])):Be("",!0),s.showMessagesStarted?(ae(),_e("div",ZK,ot(n.textMessages.CONVERSATION_STARTED)+" "+ot(n.messages[0].date),1)):Be("",!0)])]),_:3}),n.messages.length&&!n.messagesLoaded?(ae(),_e("div",JK,[Ve(a,{show:!0,infinite:!0,type:"infinite-messages"},Vt({_:2},[ht(e.$slots,(u,f)=>({name:f,fn:Je(m=>[Pe(e.$slots,f,Ht(Bt(m)))])}))]),1024)])):Be("",!0),(ae(),Lt(Q_,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:Je(()=>[(ae(!0),_e(wt,null,ht(n.messages,(u,f)=>(ae(),_e("div",{key:u.indexId||u._id},[Ve(l,{"current-user-id":n.currentUserId,message:u,index:f,messages:n.messages,"edited-message-id":r.editedMessageId,"message-actions":n.messageActions,"room-users":s.room.users,"text-messages":n.textMessages,"new-messages":r.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":r.messageSelectionEnabled,"selected-messages":r.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:s.onMessageAdded,onMessageActionHandler:s.messageActionHandler,onOpenFile:s.openFile,onOpenUserTag:s.openUserTag,onOpenFailedMessage:t[4]||(t[4]=m=>e.$emit("open-failed-message",m)),onSendMessageReaction:s.sendMessageReaction,onSelectMessage:s.selectMessage,onUnselectMessage:s.unselectMessage},Vt({_:2},[ht(e.$slots,(m,h)=>({name:h,fn:Je(R=>[Pe(e.$slots,h,Ht(Bt(R)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),r.loadingMessages?Be("",!0):(ae(),_e("div",eG,[Ve(fn,{name:"vac-bounce"},{default:Je(()=>[r.scrollIcon?(ae(),_e("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...u)=>s.scrollToBottom&&s.scrollToBottom(...u))},[Ve(fn,{name:"vac-bounce"},{default:Je(()=>[r.scrollMessagesCount?(ae(),_e("div",tG,ot(r.scrollMessagesCount),1)):Be("",!0)]),_:1}),Pe(e.$slots,"scroll-icon",{},()=>[Ve(c,{name:"dropdown",param:"scroll"})])])):Be("",!0)]),_:3})])),Ve(d,{room:s.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":n.multipleFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":r.initReplyMessage,"init-edit-message":r.initEditMessage,"dropped-files":r.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=u=>r.editedMessageId=u),onEditMessage:t[8]||(t[8]=u=>e.$emit("edit-message",u)),onSendMessage:t[9]||(t[9]=u=>e.$emit("send-message",u)),onTypingMessage:t[10]||(t[10]=u=>e.$emit("typing-message",u)),onTextareaActionHandler:t[11]||(t[11]=u=>e.$emit("textarea-action-handler",u))},Vt({_:2},[ht(e.$slots,(u,f)=>({name:f,fn:Je(m=>[Pe(e.$slots,f,Ht(Bt(m)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","multiple-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Gf,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}var iG=Yt(GK,[["render",nG]]);const rG={name:"MediaPreview",components:{SvgIcon:Bn},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return nl(this.file)},isVideo(){return ku(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},sG={key:0,class:"vac-media-preview-container"},oG={key:1,class:"vac-media-preview-container"},aG={controls:"",autoplay:""},lG=["src"],cG={class:"vac-svg-button"};function uG(e,t,n,i,r,s){const o=Ze("svg-icon");return ae(),_e("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Ar((...a)=>s.closeModal&&s.closeModal(...a),["stop"])),onKeydown:t[1]||(t[1]=ho((...a)=>s.closeModal&&s.closeModal(...a),["esc"]))},[Ve(fn,{name:"vac-bounce-preview",appear:""},{default:Je(()=>[s.isImage?(ae(),_e("div",sG,[Me("div",{class:"vac-image-preview",style:Zt({"background-image":`url('${n.file.url}')`})},null,4)])):s.isVideo?(ae(),_e("div",oG,[Me("video",aG,[Me("source",{src:n.file.url},null,8,lG)])])):Be("",!0)]),_:1}),Me("div",cG,[Pe(e.$slots,"preview-close-icon",{},()=>[Ve(o,{name:"close-outline",param:"preview"})])])],544)}var hG=Yt(rG,[["render",uG]]),dG={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const fG={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},mG=({general:e,container:t,header:n,footer:i,sidemenu:r,content:s,dropdown:o,message:a,markdown:l,room:c,emoji:d,icons:u})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-footer-bg-color":i.background,"--chat-border-style-input":i.borderStyleInput,"--chat-border-color-input-selected":i.borderInputSelected,"--chat-footer-bg-color-reply":i.backgroundReply,"--chat-footer-bg-color-tag-active":i.backgroundTagActive,"--chat-footer-bg-color-tag":i.backgroundTag,"--chat-content-bg-color":s.background,"--chat-sidemenu-bg-color":r.background,"--chat-sidemenu-bg-color-hover":r.backgroundHover,"--chat-sidemenu-bg-color-active":r.backgroundActive,"--chat-sidemenu-color-active":r.colorActive,"--chat-sidemenu-border-color-search":r.borderColorSearch,"--chat-dropdown-bg-color":o.background,"--chat-dropdown-bg-color-hover":o.backgroundHover,"--chat-message-bg-color":a.background,"--chat-message-bg-color-me":a.backgroundMe,"--chat-message-color-started":a.colorStarted,"--chat-message-bg-color-deleted":a.backgroundDeleted,"--chat-message-bg-color-selected":a.backgroundSelected,"--chat-message-color-deleted":a.colorDeleted,"--chat-message-color-username":a.colorUsername,"--chat-message-color-timestamp":a.colorTimestamp,"--chat-message-bg-color-date":a.backgroundDate,"--chat-message-color-date":a.colorDate,"--chat-message-bg-color-system":a.backgroundSystem,"--chat-message-color-system":a.colorSystem,"--chat-message-color":a.color,"--chat-message-bg-color-media":a.backgroundMedia,"--chat-message-bg-color-reply":a.backgroundReply,"--chat-message-color-reply-username":a.colorReplyUsername,"--chat-message-color-reply-content":a.colorReply,"--chat-message-color-tag":a.colorTag,"--chat-message-bg-color-image":a.backgroundImage,"--chat-message-color-new-messages":a.colorNewMessages,"--chat-message-bg-color-scroll-counter":a.backgroundScrollCounter,"--chat-message-color-scroll-counter":a.colorScrollCounter,"--chat-message-bg-color-reaction":a.backgroundReaction,"--chat-message-border-style-reaction":a.borderStyleReaction,"--chat-message-bg-color-reaction-hover":a.backgroundReactionHover,"--chat-message-border-style-reaction-hover":a.borderStyleReactionHover,"--chat-message-color-reaction-counter":a.colorReactionCounter,"--chat-message-bg-color-reaction-me":a.backgroundReactionMe,"--chat-message-border-style-reaction-me":a.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":a.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":a.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":a.colorReactionCounterMe,"--chat-message-bg-color-audio-record":a.backgroundAudioRecord,"--chat-message-bg-color-audio-line":a.backgroundAudioLine,"--chat-message-bg-color-audio-progress":a.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":a.backgroundAudioProgressSelector,"--chat-message-color-file-extension":a.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm});var pG=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.markdown p{margin:0}.markdown ol{display:flex;flex-direction:column;list-style-position:inside}.markdown ul{display:flex;flex-direction:column}.markdown code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.markdown p code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-item:not(.vac-room-selected){cursor:pointer}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const gG={name:"ChatContainer",components:{RoomsList:TV,Room:iG,MediaPreview:hG},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:""},multipleFiles:{type:[Boolean,String],default:!0},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...dG,...this.textMessagesCasted}},cssVars(){const e=fG[this.theme],t={};return Object.keys(e).map(n=>{t[n]={...e[n],...this.stylesCasted[n]||{}}}),mG(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const n=e.index||0,i=t.index||0;return this.roomsOrder==="asc"?n<i?-1:i<n?1:0:n>i?-1:i>n?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},multipleFilesCasted(){return this.castBoolean(this.multipleFiles)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find(n=>n.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const n=e.find(i=>i.roomId===this.roomId)||{};this.fetchRoom({room:n})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const n=this.roomsCasted.find(i=>i.roomId===e);this.fetchRoom({room:n})}else t&&!e&&(this.room={})}},room(e){!e||Object.entries(e).length===0||(RK(e),e.users.forEach(t=>{MK(t)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return e==="true"||e===!0},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?typeof e=="object"?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&t.action==="preview"?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},_G={class:"vac-chat-container"};function vG(e,t,n,i,r,s){const o=Ze("rooms-list"),a=Ze("room"),l=Ze("media-preview");return ae(),_e("div",{class:"vac-card-window",style:Zt([{height:n.height},s.cssVars])},[Me("div",_G,[s.singleRoomCasted?Be("",!0):(ae(),Lt(o,{key:0,"current-user-id":n.currentUserId,rooms:s.orderedRooms,"loading-rooms":s.loadingRoomsCasted,"rooms-loaded":s.roomsLoadedCasted,room:r.room,"room-actions":s.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":s.t,"show-search":s.showSearchCasted,"show-add-room":s.showAddRoomCasted,"show-rooms-list":r.showRoomsList&&s.roomsListOpenedCasted,"text-formatting":s.textFormattingCasted,"link-options":s.linkOptionsCasted,"is-mobile":r.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:s.fetchRoom,onFetchMoreRooms:s.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=c=>r.loadingMoreRooms=c),onAddRoom:s.addRoom,onSearchRoom:s.searchRoom,onRoomActionHandler:s.roomActionHandler},Vt({_:2},[ht(r.slots,c=>({name:c.slot,fn:Je(d=>[Pe(e.$slots,c.slot,Ht(Bt(d)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Ve(a,{"current-user-id":n.currentUserId,rooms:s.roomsCasted,"room-id":r.room.roomId||"","load-first-room":s.loadFirstRoomCasted,messages:s.messagesCasted,"room-message":n.roomMessage,"messages-loaded":s.messagesLoadedCasted,"menu-actions":s.menuActionsCasted,"message-actions":s.messageActionsCasted,"message-selection-actions":s.messageSelectionActionsCasted,"auto-scroll":s.autoScrollCasted,"show-send-icon":s.showSendIconCasted,"show-files":s.showFilesCasted,"show-audio":s.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":s.showEmojisCasted,"show-reaction-emojis":s.showReactionEmojisCasted,"show-new-messages-divider":s.showNewMessagesDividerCasted,"show-footer":s.showFooterCasted,"text-messages":s.t,"single-room":s.singleRoomCasted,"show-rooms-list":r.showRoomsList&&s.roomsListOpenedCasted,"text-formatting":s.textFormattingCasted,"link-options":s.linkOptionsCasted,"is-mobile":r.isMobile,"loading-rooms":s.loadingRoomsCasted,"room-info-enabled":s.roomInfoEnabledCasted,"textarea-action-enabled":s.textareaActionEnabledCasted,"textarea-auto-focus":s.textareaAutoFocusCasted,"user-tags-enabled":s.userTagsEnabledCasted,"emojis-suggestion-enabled":s.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":s.multipleFilesCasted,"templates-text":s.templatesTextCasted,"username-options":s.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:s.toggleRoomsList,onRoomInfo:s.roomInfo,onFetchMessages:s.fetchMessages,onSendMessage:s.sendMessage,onEditMessage:s.editMessage,onDeleteMessage:s.deleteMessage,onOpenFile:s.openFile,onOpenUserTag:s.openUserTag,onOpenFailedMessage:s.openFailedMessage,onMenuActionHandler:s.menuActionHandler,onMessageActionHandler:s.messageActionHandler,onMessageSelectionActionHandler:s.messageSelectionActionHandler,onSendMessageReaction:s.sendMessageReaction,onTypingMessage:s.typingMessage,onTextareaActionHandler:s.textareaActionHandler},Vt({_:2},[ht(r.slots,c=>({name:c.slot,fn:Je(d=>[Pe(e.$slots,c.slot,Ht(Bt(d)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","multiple-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Ve(fn,{name:"vac-fade-preview",appear:""},{default:Je(()=>[r.showMediaPreview?(ae(),Lt(l,{key:0,file:r.previewFile,onCloseMediaPreview:t[1]||(t[1]=c=>r.showMediaPreview=!1)},Vt({_:2},[ht(r.slots,c=>({name:c.slot,fn:Je(d=>[Pe(e.$slots,c.slot,Ht(Bt(d)))])}))]),1032,["file"])):Be("",!0)]),_:3})],4)}var yG=Yt(gG,[["render",vG],["styles",[pG]]]);const bG=aP(yG),x3="vue-advanced-chat";function wG(){customElements.get(x3)||customElements.define(x3,bG)}var dS=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n};wG();const EG={props:{currentUserId:{type:String,required:!0},theme:{type:String,required:!0},isDevice:{type:Boolean,required:!0}},emits:["show-demo-options"],data(){return{roomsPerPage:15,rooms:[],roomId:"",startRooms:null,endRooms:null,roomsLoaded:!1,loadingRooms:!0,allUsers:[],loadingLastMessageByRoom:0,roomsLoadedCount:0,selectedRoom:null,messagesPerPage:20,messages:[],messagesLoaded:!1,roomMessage:"",lastLoadedMessage:null,previousLastLoadedMessage:null,roomsListeners:[],listeners:[],typingMessageCache:"",disableForm:!1,addNewRoom:null,addRoomUsername:"",inviteRoomId:null,invitedUsername:"",removeRoomId:null,removeUserId:"",removeUsers:[],roomActions:[{name:"inviteUser",title:"Invite User"},{name:"removeUser",title:"Remove User"},{name:"deleteRoom",title:"Delete Room"}],menuActions:[{name:"inviteUser",title:"Invite User"},{name:"removeUser",title:"Remove User"},{name:"deleteRoom",title:"Delete Room"}],messageSelectionActions:[{name:"deleteMessages",title:"Delete"}],styles:{container:{borderRadius:"4px"}},templatesText:[{tag:"help",text:"This is the help"},{tag:"action",text:"This is the action"},{tag:"action 2",text:"This is the second action"}]}},computed:{loadedRooms(){return this.rooms.slice(0,this.roomsLoadedCount)},screenHeight(){return this.isDevice?window.innerHeight+"px":"calc(100vh - 80px)"}},mounted(){this.addCss(),this.fetchRooms(),TL(this.currentUserId)},methods:{async addCss(){},resetRooms(){this.loadingRooms=!0,this.loadingLastMessageByRoom=0,this.roomsLoadedCount=0,this.rooms=[],this.roomsLoaded=!0,this.startRooms=null,this.endRooms=null,this.roomsListeners.forEach(e=>e()),this.roomsListeners=[],this.resetMessages()},resetMessages(){this.messages=[],this.messagesLoaded=!1,this.lastLoadedMessage=null,this.previousLastLoadedMessage=null,this.listeners.forEach(e=>e()),this.listeners=[]},fetchRooms(){this.resetRooms(),this.fetchMoreRooms()},async fetchMoreRooms(){if(this.endRooms&&!this.startRooms){this.roomsLoaded=!0;return}const e=sL(this.currentUserId,this.roomsPerPage,this.startRooms),{data:t,docs:n}=await aL(e);this.roomsLoaded=t.length===0||t.length<this.roomsPerPage,this.startRooms&&(this.endRooms=this.startRooms),this.startRooms=n[n.length-1];const i=[];t.forEach(a=>{a.users.forEach(l=>{!this.allUsers.find(d=>(d==null?void 0:d._id)===l)&&i.indexOf(l)===-1&&i.push(l)})});const r=[];i.forEach(a=>{const l=nL(a);r.push(l)}),this.allUsers=[...this.allUsers,...await Promise.all(r)];const s={};t.forEach(a=>{s[a.id]={...a,users:[]},a.users.forEach(l=>{const c=this.allUsers.find(d=>(d==null?void 0:d._id)===l);c&&s[a.id].users.push(c)})});const o=[];Object.keys(s).forEach(a=>{const l=s[a],c=l.users.filter(u=>u._id!==this.currentUserId);l.roomName=c.map(u=>u.username).join(", ")||"Myself";const d=c.length===1&&c[0].avatar?c[0].avatar:AL;o.push({...l,roomId:a,avatar:d,index:l.lastUpdated.seconds,lastMessage:{content:"Room created",timestamp:jm(new Date(l.lastUpdated.seconds),l.lastUpdated)}})}),this.rooms=this.rooms.concat(o),o.forEach(a=>this.listenLastMessage(a)),this.rooms.length||(this.loadingRooms=!1,this.roomsLoadedCount=0),this.listenUsersOnlineStatus(o),this.listenRooms(e)},listenLastMessage(e){const t=_L(e.roomId,n=>{n.forEach(i=>{const r=this.formatLastMessage(i,e),s=this.rooms.findIndex(o=>e.roomId===o.roomId);this.rooms[s].lastMessage=r,this.rooms=[...this.rooms]}),this.loadingLastMessageByRoom<this.rooms.length&&(this.loadingLastMessageByRoom++,this.loadingLastMessageByRoom===this.rooms.length&&(this.loadingRooms=!1,this.roomsLoadedCount=this.rooms.length))});this.roomsListeners.push(t)},formatLastMessage(e,t){var r,s;if(!e.timestamp)return;let n=e.content;if((r=e.files)!=null&&r.length){const o=e.files[0];n=`${o.name}.${o.extension||o.type}`}const i=e.sender_id!==this.currentUserId?(s=t.users.find(o=>e.sender_id===o._id))==null?void 0:s.username:"";return{...e,_id:e.id,content:n,senderId:e.sender_id,timestamp:jm(new Date(e.timestamp.seconds*1e3),e.timestamp),username:i,distributed:!0,seen:e.sender_id===this.currentUserId?e.seen:null,new:e.sender_id!==this.currentUserId&&(!e.seen||!e.seen[this.currentUserId])}},fetchMessages({room:e,options:t={}}){if(this.$emit("show-demo-options",!1),t.reset&&this.resetMessages(),this.previousLastLoadedMessage&&!this.lastLoadedMessage){this.messagesLoaded=!0;return}this.selectedRoom=e.roomId,S0(e.roomId,this.messagesPerPage,this.lastLoadedMessage).then(({data:n,docs:i})=>{this.selectedRoom===e.roomId&&((n.length===0||n.length<this.messagesPerPage)&&setTimeout(()=>{this.messagesLoaded=!0},0),t.reset&&(this.messages=[]),n.forEach(r=>{const s=this.formatMessage(e,r);this.messages.unshift(s)}),this.lastLoadedMessage&&(this.previousLastLoadedMessage=this.lastLoadedMessage),this.lastLoadedMessage=i[i.length-1],this.listenMessages(e))})},listenMessages(e){const t=pL(e.roomId,this.lastLoadedMessage,this.previousLastLoadedMessage,n=>{n.forEach(i=>{const r=this.formatMessage(e,i),s=this.messages.findIndex(o=>o._id===i.id);s===-1?this.messages=this.messages.concat([r]):(this.messages[s]=r,this.messages=[...this.messages]),this.markMessagesSeen(e,i)})});this.listeners.push(t)},markMessagesSeen(e,t){t.sender_id!==this.currentUserId&&(!t.seen||!t.seen[this.currentUserId])&&ql(e.roomId,t.id,{[`seen.${this.currentUserId}`]:new Date})},formatMessage(e,t){var i;const n={...t,senderId:t.sender_id,_id:t.id,seconds:t.timestamp.seconds,timestamp:A0(t.timestamp,"HH:mm"),date:A0(t.timestamp,"DD MMMM YYYY"),username:(i=e.users.find(r=>t.sender_id===r._id))==null?void 0:i.username,distributed:!0};return t.replyMessage&&(n.replyMessage={...t.replyMessage,senderId:t.replyMessage.sender_id}),n},async sendMessage({content:e,roomId:t,files:n,replyMessage:i}){const r={sender_id:this.currentUserId,content:e,timestamp:new Date};n&&(r.files=this.formattedFiles(n)),i&&(r.replyMessage={_id:i._id,content:i.content,sender_id:i.senderId},i.files&&(r.replyMessage.files=i.files));const{id:s}=await dL(t,r);if(n)for(let o=0;o<n.length;o++)await this.uploadFile({file:n[o],messageId:s,roomId:t});Pc(t,{lastUpdated:new Date})},async editMessage({messageId:e,newContent:t,roomId:n,files:i}){var s;const r={edited:new Date};if(r.content=t,i?r.files=this.formattedFiles(i):r.files=JF,await ql(n,e,r),i)for(let o=0;o<i.length;o++)(s=i[o])!=null&&s.blob&&await this.uploadFile({file:i[o],messageId:e,roomId:n})},async deleteMessage({message:e,roomId:t}){await ql(t,e._id,{deleted:new Date});const{files:n}=e;n&&n.forEach(i=>{T0(this.currentUserId,e._id,i)})},async uploadFile({file:e,messageId:t,roomId:n}){return new Promise(i=>{let r=e.extension||e.type;(r==="svg"||r==="pdf")&&(r=e.type),EL(this.currentUserId,t,e,r,s=>{this.updateFileProgress(t,e.localUrl,s)},s=>{i(!1)},async s=>{const o=await hL(n,t);o.files.forEach(a=>{a.url===e.localUrl&&(a.url=s)}),await ql(n,t,{files:o.files}),i(!0)})})},updateFileProgress(e,t,n){const i=this.messages.find(r=>r._id===e);!i||!i.files||(i.files.find(r=>r.url===t).progress=n,this.messages=[...this.messages])},formattedFiles(e){const t=[];return e.forEach(n=>{const i={name:n.name,size:n.size,type:n.type,extension:n.extension||n.type,url:n.url||n.localUrl};n.audio&&(i.audio=!0,i.duration=n.duration),t.push(i)}),t},openFile({file:e}){window.open(e.file.url,"_blank")},async openUserTag({user:e}){let t;if(this.rooms.forEach(o=>{if(o.users.length===2){const a=o.users[0]._id,l=o.users[1]._id;(a===e._id||a===this.currentUserId)&&(l===e._id||l===this.currentUserId)&&(t=o.roomId)}}),t){this.roomId=t;return}const n=await W2(this.currentUserId,e._id);if(n.data.length)return this.loadRoom(n);const i=await W2(e._id,this.currentUserId);if(i.data.length)return this.loadRoom(i);const r=e._id===this.currentUserId?[this.currentUserId]:[e._id,this.currentUserId],s=await Sa({users:r,lastUpdated:new Date});this.roomId=s.id,this.fetchRooms()},async loadRoom(e){e.forEach(async t=>{this.loadingRooms||(await Pc(t.id,{lastUpdated:new Date}),this.roomId=t.id,this.fetchRooms())})},menuActionHandler({action:e,roomId:t}){switch(e.name){case"inviteUser":return this.inviteUser(t);case"removeUser":return this.removeUser(t);case"deleteRoom":return this.deleteRoom(t)}},messageSelectionActionHandler({action:e,messages:t,roomId:n}){switch(e.name){case"deleteMessages":t.forEach(i=>{this.deleteMessage({message:i,roomId:n})})}},async sendMessageReaction({reaction:e,remove:t,messageId:n,roomId:i}){vL(i,n,this.currentUserId,e.unicode,t?"remove":"add")},typingMessage({message:e,roomId:t}){if(t){if((e==null?void 0:e.length)>1){this.typingMessageCache=e;return}if((e==null?void 0:e.length)===1&&this.typingMessageCache){this.typingMessageCache=e;return}this.typingMessageCache=e,uL(t,this.currentUserId,e?"add":"remove")}},async listenRooms(e){const t=fL(e,n=>{n.forEach(i=>{const r=this.rooms.find(s=>s.roomId===i.id);r&&(r.typingUsers=i.typingUsers,r.index=i.lastUpdated.seconds)})});this.roomsListeners.push(t)},listenUsersOnlineStatus(e){e.forEach(t=>{t.users.forEach(n=>{const i=SL(k0(n._id),r=>{if(!r||!r.val())return;const s=jm(new Date(r.val().lastChanged),new Date(r.val().lastChanged));n.status={...r.val(),lastChanged:s};const o=this.rooms.findIndex(a=>t.roomId===a.roomId);this.rooms[o]=t,this.rooms=[...this.rooms]});this.roomsListeners.push(i)})})},addRoom(){this.resetForms(),this.addNewRoom=!0},async createRoom(){this.disableForm=!0;const{id:e}=await z2({username:this.addRoomUsername});await $2(e,{_id:e}),await Sa({users:[e,this.currentUserId],lastUpdated:new Date}),this.addNewRoom=!1,this.addRoomUsername="",this.fetchRooms()},inviteUser(e){this.resetForms(),this.inviteRoomId=e},async addRoomUser(){this.disableForm=!0;const{id:e}=await z2({username:this.invitedUsername});await $2(e,{_id:e}),await lL(this.inviteRoomId,e),this.inviteRoomId=null,this.invitedUsername="",this.fetchRooms()},removeUser(e){this.resetForms(),this.removeRoomId=e,this.removeUsers=this.rooms.find(t=>t.roomId===e).users},async deleteRoomUser(){this.disableForm=!0,await cL(this.removeRoomId,this.removeUserId),this.removeRoomId=null,this.removeUserId="",this.fetchRooms()},async deleteRoom(e){const t=this.rooms.find(n=>n.roomId===e);if(t.users.find(n=>n._id==="SGmFnBZB4xxMv9V4CVlW")||t.users.find(n=>n._id==="6jMsIXUrBHBj7o2cRlau"))return alert("Nope, for demo purposes you cannot delete this room");S0(e).then(({data:n})=>{n.forEach(i=>{BE(e,i.id),i.files&&i.files.forEach(r=>{T0(this.currentUserId,i.id,r)})})}),await LE(e),this.fetchRooms()},resetForms(){this.disableForm=!1,this.addNewRoom=null,this.addRoomUsername="",this.inviteRoomId=null,this.invitedUsername="",this.removeRoomId=null,this.removeUserId=""}}},SG=e=>(ET("data-v-05b6fd62"),e=e(),ST(),e),TG=["disabled"],kG=["disabled"],AG=SG(()=>wn("option",{default:"",value:""},"Select User",-1)),xG=["value"],CG=["disabled"],IG=["height","theme","styles","current-user-id","room-id","rooms","loading-rooms","rooms-loaded","messages","messages-loaded","room-message","room-actions","menu-actions","message-selection-actions","templates-text"];function RG(e,t,n,i,r,s){return _i(),Ki("div",{class:Da(["window-container",{"window-mobile":n.isDevice}])},[r.addNewRoom?(_i(),Ki("form",{key:0,onSubmit:t[2]||(t[2]=_m((...o)=>s.createRoom&&s.createRoom(...o),["prevent"]))},[mh(wn("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.addRoomUsername=o),type:"text",placeholder:"Add username"},null,512),[[Xv,r.addRoomUsername]]),wn("button",{type:"submit",disabled:r.disableForm||!r.addRoomUsername}," Create Room ",8,TG),wn("button",{class:"button-cancel",onClick:t[1]||(t[1]=o=>r.addNewRoom=!1)},"Cancel")],32)):wo("",!0),r.inviteRoomId?(_i(),Ki("form",{key:1,onSubmit:t[5]||(t[5]=_m((...o)=>s.addRoomUser&&s.addRoomUser(...o),["prevent"]))},[mh(wn("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.invitedUsername=o),type:"text",placeholder:"Add username"},null,512),[[Xv,r.invitedUsername]]),wn("button",{type:"submit",disabled:r.disableForm||!r.invitedUsername}," Add User ",8,kG),wn("button",{class:"button-cancel",onClick:t[4]||(t[4]=o=>r.inviteRoomId=null)},"Cancel")],32)):wo("",!0),r.removeRoomId?(_i(),Ki("form",{key:2,onSubmit:t[8]||(t[8]=_m((...o)=>s.deleteRoomUser&&s.deleteRoomUser(...o),["prevent"]))},[mh(wn("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>r.removeUserId=o)},[AG,(_i(!0),Ki(Wi,null,mw(r.removeUsers,o=>(_i(),Ki("option",{key:o._id,value:o._id},z3(o.username),9,xG))),128))],512),[[Bw,r.removeUserId]]),wn("button",{type:"submit",disabled:r.disableForm||!r.removeUserId}," Remove User ",8,CG),wn("button",{class:"button-cancel",onClick:t[7]||(t[7]=o=>r.removeRoomId=null)},"Cancel")],32)):wo("",!0),wn("vue-advanced-chat",{ref:"chatWindow",height:s.screenHeight,theme:n.theme,styles:JSON.stringify(r.styles),"current-user-id":n.currentUserId,"room-id":r.roomId,rooms:JSON.stringify(s.loadedRooms),"loading-rooms":r.loadingRooms,"rooms-loaded":r.roomsLoaded,messages:JSON.stringify(r.messages),"messages-loaded":r.messagesLoaded,"room-message":r.roomMessage,"room-actions":JSON.stringify(r.roomActions),"menu-actions":JSON.stringify(r.menuActions),"message-selection-actions":JSON.stringify(r.messageSelectionActions),"templates-text":JSON.stringify(r.templatesText),onFetchMoreRooms:t[9]||(t[9]=(...o)=>s.fetchMoreRooms&&s.fetchMoreRooms(...o)),onFetchMessages:t[10]||(t[10]=o=>s.fetchMessages(o.detail[0])),onSendMessage:t[11]||(t[11]=o=>s.sendMessage(o.detail[0])),onEditMessage:t[12]||(t[12]=o=>s.editMessage(o.detail[0])),onDeleteMessage:t[13]||(t[13]=o=>s.deleteMessage(o.detail[0])),onOpenFile:t[14]||(t[14]=o=>s.openFile(o.detail[0])),onOpenUserTag:t[15]||(t[15]=o=>s.openUserTag(o.detail[0])),onAddRoom:t[16]||(t[16]=o=>s.addRoom(o.detail[0])),onRoomActionHandler:t[17]||(t[17]=o=>s.menuActionHandler(o.detail[0])),onMenuActionHandler:t[18]||(t[18]=o=>s.menuActionHandler(o.detail[0])),onMessageSelectionActionHandler:t[19]||(t[19]=o=>s.messageSelectionActionHandler(o.detail[0])),onSendMessageReaction:t[20]||(t[20]=o=>s.sendMessageReaction(o.detail[0])),onTypingMessage:t[21]||(t[21]=o=>s.typingMessage(o.detail[0])),onToggleRoomsList:t[22]||(t[22]=o=>e.$emit("show-demo-options",o.detail[0].opened))},null,40,IG)],2)}var MG=dS(EG,[["render",RG],["__scopeId","data-v-05b6fd62"]]),OG="/vue-advanced-chat/assets/github.12794390.svg";const NG={components:{ChatContainer:MG},data(){return{theme:"light",showChat:!0,users:[{_id:"6R0MijpK6M4AIrwaaCY2",username:"Luke",avatar:"https://66.media.tumblr.com/avatar_c6a8eae4303e_512.pnj"},{_id:"SGmFnBZB4xxMv9V4CVlW",username:"Leia",avatar:"https://media.glamour.com/photos/5695e9d716d0dc3747eea3ef/master/w_1600,c_limit/beauty-2015-12-princess-leia-1-main.jpg"},{_id:"6jMsIXUrBHBj7o2cRlau",username:"Yoda",avatar:"https://vignette.wikia.nocookie.net/teamavatarone/images/4/45/Yoda.jpg/revision/latest?cb=20130224160049"}],currentUserId:"6R0MijpK6M4AIrwaaCY2",isDevice:!1,showDemoOptions:!0,updatingData:!1}},computed:{showOptions(){return!this.isDevice||this.showDemoOptions}},watch:{currentUserId(){this.showChat=!1,setTimeout(()=>this.showChat=!0,150)}},mounted(){this.isDevice=window.innerWidth<500,window.addEventListener("resize",e=>{e.isTrusted&&(this.isDevice=window.innerWidth<500)})},methods:{resetData(){oL().then(({data:e})=>{e.forEach(async t=>{await S0(t.id).then(({data:n})=>{n.forEach(i=>{BE(t.id,i.id),i.files&&i.files.forEach(r=>{T0(this.currentUserId,i.id,r)})})}),LE(t.id)})}),tL().then(({data:e})=>{e.forEach(t=>{iL(t.id)})})},async addData(){this.updatingData=!0;const e=this.users[0];await Um(e._id,e);const t=this.users[1];await Um(t._id,t);const n=this.users[2];await Um(n._id,n),await Sa({users:[e._id,t._id],lastUpdated:new Date}),await Sa({users:[e._id,n._id],lastUpdated:new Date}),await Sa({users:[t._id,n._id],lastUpdated:new Date}),await Sa({users:[e._id,t._id,n._id],lastUpdated:new Date}),this.updatingData=!1,location.reload()}}},FG=["value"],LG={key:2,class:"button-theme"},DG=wn("button",{class:"button-github"},[wn("a",{href:"https://github.com/advanced-chat/vue-advanced-chat"},[wn("img",{src:OG})])],-1);function BG(e,t,n,i,r,s){const o=WT("chat-container");return _i(),Ki("div",null,[wn("div",{class:Da(["app-container",{"app-mobile":r.isDevice,"app-mobile-dark":r.theme==="dark"}])},[s.showOptions?(_i(),Ki("span",{key:0,class:Da(["user-logged",{"user-logged-dark":r.theme==="dark"}])}," Logged as ",2)):wo("",!0),s.showOptions?mh((_i(),Ki("select",{key:1,"onUpdate:modelValue":t[0]||(t[0]=a=>r.currentUserId=a)},[(_i(!0),Ki(Wi,null,mw(r.users,a=>(_i(),Ki("option",{key:a._id,value:a._id},z3(a.username),9,FG))),128))],512)),[[Bw,r.currentUserId]]):wo("",!0),s.showOptions?(_i(),Ki("div",LG,[wn("button",{class:"button-light",onClick:t[1]||(t[1]=a=>r.theme="light")}," Light "),wn("button",{class:"button-dark",onClick:t[2]||(t[2]=a=>r.theme="dark")}," Dark "),DG])):wo("",!0),r.showChat?(_i(),kw(o,{key:3,"current-user-id":r.currentUserId,theme:r.theme,"is-device":r.isDevice,onShowDemoOptions:t[3]||(t[3]=a=>r.showDemoOptions=a)},null,8,["current-user-id","theme","is-device"])):wo("",!0)],2)])}var PG=dS(NG,[["render",BG]]);const UG=dA({render:()=>Ck(PG)});UG.mount("#app");
